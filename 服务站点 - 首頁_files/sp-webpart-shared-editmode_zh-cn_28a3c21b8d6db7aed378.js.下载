(()=>{var e=document.currentScript;define("c79b9f88-6338-40fb-b463-3aad22a88b15_0.1.0",["@microsoft/sp-diagnostics","@microsoft/sp-loader","tslib","react","react-dom","@microsoft/sp-core-library","@ms/sp-component-utilities","@microsoft/sp-http","@microsoft/sp-page-context","@ms/odsp-utilities-bundle","@microsoft/sp-http-base","@ms/odsp-core-bundle","@ms/office-ui-fabric-react-bundle","@ms/sp-telemetry","@microsoft/load-themed-styles","@microsoft/sp-webpart-base","@microsoft/sp-property-pane","@ms/sp-fluentui-migration-reactdom-render-bundle","@ms/sp-fluentui-migration-spinner-bundle","@ms/sp-fluentui-migration-label-bundle","@ms/sp-fluentui-migration-tooltip-bundle","@ms/sp-fluentui-migration-button-bundle","@ms/sp-fluentui-migration-textfield-bundle"],(t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D,I)=>(()=>{"use strict";var x,C,O,w={424:e=>{e.exports=_},676:e=>{e.exports=o},207:e=>{e.exports=t},909:e=>{e.exports=c},737:e=>{e.exports=u},414:e=>{e.exports=n},408:e=>{e.exports=d},877:e=>{e.exports=b},642:e=>{e.exports=h},698:e=>{e.exports=f},939:e=>{e.exports=l},141:e=>{e.exports=p},773:e=>{e.exports=s},926:e=>{e.exports=D},738:e=>{e.exports=y},976:e=>{e.exports=g},779:e=>{e.exports=v},327:e=>{e.exports=I},253:e=>{e.exports=S},27:e=>{e.exports=m},959:e=>{e.exports=i},398:e=>{e.exports=r},280:e=>{e.exports=a}},E={};function A(e){var t=E[e];if(void 0!==t)return t.exports;var n=E[e]={exports:{}};return w[e](n,n.exports,A),n.exports}A.m=w,A.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return A.d(t,{a:t}),t},A.d=(e,t)=>{for(var n in t)A.o(t,n)&&!A.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},A.f={},A.e=e=>Promise.all(Object.keys(A.f).reduce((t,n)=>(A.f[n](e,t),t),[])),A.u=e=>"chunk."+({112:"adaptive-card-extension-supported-icon-map",220:"MoveCopyDataSource",769:"webpack-shared-editmode-fabric-dialog",875:"ms/sp-filepicker-host"}[e]||e)+"_"+({875:1}[e]?"zh-cn":"none")+"_"+{112:"6ba1e1fe87fc0a5e34d9",220:"8c5099e5cf70bbb74e3b",769:"66f99ab4d84297e572eb",822:"f0e3c537d5ac6b0c6b2e",875:"af4c355c14356ea60a2d"}[e]+".js",A.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),x={},C="c79b9f88-6338-40fb-b463-3aad22a88b15_0.1.0:",A.l=(e,t,n,a)=>{if(x[e])x[e].push(t);else{var i,r;if(void 0!==n)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var c=o[s];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==C+n){i=c;break}}i||(r=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,A.nc&&i.setAttribute("nonce",A.nc),i.setAttribute("data-webpack",C+n),i.src=e,0!==i.src.indexOf(window.location.origin+"/")&&(i.crossOrigin="anonymous")),x[e]=[t];var d=(t,n)=>{i.onerror=i.onload=null,clearTimeout(l);var a=x[e];if(delete x[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach(e=>e(n)),t)return t(n)},l=setTimeout(d.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=d.bind(null,i.onerror),i.onload=d.bind(null,i.onload),r&&document.head.appendChild(i)}},A.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},O=e?e.src:"",A.p=O.slice(0,O.lastIndexOf("/")+1),A.f.compat=(e,t)=>{for(var n=function(e){var t={i:"17ce0976-e69a-4355-be84-89b69a74717d",v:"0.3.28",m:816};return{875:[{i:"a9f7aaec-2fc2-4fd9-9f54-45a0e79d6b14",v:"0.1.0",m:819},{i:"32b9363b-09ff-4959-929a-cab2663fb223",m:658},{i:"73e1dc6c-8441-42cc-ad47-4bd3659f8a3a",v:"1.21.0",m:529},t],769:[t]}[e]||[]}(e),a=0;a<n.length;a++)A.m[n[a].m]||(e=>{t.push(L.SPComponentLoader.loadComponentById(e.i,e.v).then(t=>{A.m[e.m]=e=>e.exports=t}))})(n[a])};var L=A(414);(()=>{var e={530:0};A.f.j=(t,n)=>{var a=A.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise((n,i)=>a=e[t]=[n,i]);n.push(a[2]=i);var r=A.p+A.u(t),o=new Error;A.l(r,n=>{if(A.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",o.name="ChunkLoadError",o.type=i,o.request=r,a[1](o)}},"chunk-"+t,t)}};var t=(t,n)=>{var a,i,[r,o,s]=n,c=0;if(r.some(t=>0!==e[t])){for(a in o)A.o(o,a)&&(A.m[a]=o[a]);s&&s(A)}for(t&&t(n);c<r.length;c++)i=r[c],A.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self["webpackJsonp_c79b9f88-6338-40fb-b463-3aad22a88b15_0.1.0"]=self["webpackJsonp_c79b9f88-6338-40fb-b463-3aad22a88b15_0.1.0"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var k={};return(()=>{A.r(k),A.d(k,{DeferredDialog:()=>X,DeferredDialogContent:()=>te,DeferredDialogFooter:()=>$,DocLibraryContext:()=>Y,FilePickerLoader:()=>n,LazyDialog:()=>J,LazyDialogContent:()=>ee,LazyDialogFooter:()=>Z,LinkTextBox:()=>Ce,LocalFilePreview:()=>Q,OpenSPFilePickerHost:()=>d,PropertyPaneAudienceToggle:()=>ye,SPFileHandler:()=>z,SPFileHandlerError:()=>S,SPFilePickerHostLoader:()=>c,ThumbnailSourceType:()=>re,ThumbnailType:()=>ie.ThumbnailType,calculateExifOrientation:()=>p,convertDataUriToArrayBuffer:()=>m,encodeQuerySegment:()=>M,ensureOrientation:()=>f,ensureURLEncoded:()=>R,getDefaultHeaders:()=>B,getFallbackSharingLinkRequestBody:()=>j,getIconUrl:()=>_e,getMotionToggleTooltipLabel:()=>De,getPropertyPaneThumbnail:()=>pe,getSharePointImageUrl:()=>H,handleFileUploadError:()=>L,isExternalSharePointAsset:()=>F,isValidGuid:()=>N,mapServerResponseToUploadResult:()=>P,replaceSpecialCharacters:()=>T,rotatedExifOrientation:()=>u,supportedIcons:()=>me});var e=A(207),t=A(414);const n=function(){function n(){}return n.load=function(n,a){return t.SPComponentLoader.loadComponentById("a81a5cf6-c9ad-4a0a-85aa-68c03d2d22a2").then(function(t){var i=new t.FilePicker(n);return i.initialize(a),i.fetchData().catch(function(t){return e._TraceLogger.logError(e._LogSource.create("FilePickerLoader"),t,"fetchData")}),i})},n}();var a=A(280),i=A(959),r=A(398),o=A.n(r),s=i.lazy(function(){return Promise.all([A.e(822),A.e(875)]).then(A.bind(A,234)).then(function(e){return{default:e.SPFilePickerHost}})});function c(e){return i.createElement(i.Suspense,{fallback:!1},i.createElement(s,(0,a.__assign)({},e)))}function d(e,t){o().render(i.createElement(c,(0,a.__assign)({},e)),t)}var l=A(676),u=[5,6,7,8];function f(t,n){if(t&&t.src){var a=l._BrowserDetection.getBrowserInformation();a.browser===l._Browser.Firefox||(a.browser===l._Browser.Chrome||a.browser===l._Browser.EdgeChromium)&&a.browserVersion&&a.browserVersion.greaterThan(l.Version.parse("81.0.0.0"))?t.style.visibility="visible":m(t.src).then(function(e){return p(e)}).then(function(e){if(void 0===e||isNaN(e)||1===e)return t.style.transform=void 0,void(t.style.visibility="visible");var a;switch(-1!==[5,6,7,8].indexOf(e)&&n&&n(),e){case 2:a="-1, 0, 0, 1, 0, 0";break;case 3:a="-1, 0, 0, -1, 0, 0";break;case 4:a="1, 0, 0, -1, 0, 0";break;case 5:a="0, 1, 1, 0, 0, 0";break;case 6:a="0, 1, -1, 0, 0, 0";break;case 7:a="0, -1, -1, 0, 0, 0";break;case 8:a="0, -1, 1, 0, 0, 0"}t.style.transform="matrix(".concat(a,")"),t.style.visibility="visible"}).catch(function(t){return e._TraceLogger.logError(e._LogSource.create("ensureOrientation"),t,"convertDataUriToArrayBuffer")})}}function p(e){if(!e)return Promise.resolve(void 0);var t=new DataView(e);if(65496!==t.getUint16(0,!1))return Promise.resolve(void 0);for(var n=t.byteLength,a=2;a<n;){var i=t.getUint16(a,!1);if(a+=2,65505===i){if(1165519206!==t.getUint32(a+=2,!1))return Promise.resolve(void 0);var r=18761===t.getUint16(a+=6,!1);a+=t.getUint32(a+4,r);var o=t.getUint16(a,r);a+=2;for(var s=0;s<o;s++)if(274===t.getUint16(a+12*s,r)){var c=t.getUint16(a+12*s+8,r);return Promise.resolve(c)}}else{if(65280!=(65280&i))break;a+=t.getUint16(a,!1)}}return Promise.resolve(void 0)}function m(e){return fetch(e).then(function(e){return e.arrayBuffer()}).catch(function(e){})}var _=A(773),h=A(909),b=A(408),g=A(939),v=A(698),y=A(737),S=function(e){function t(n,a){var i=e.call(this,n)||this;return i.__proto__=t.prototype,i.errorCode=a,i}return(0,a.__extends)(t,e),t}(Error);const D=JSON.parse('{"Y$":"此页面的安全验证已超时。请刷新页面，或使用浏览器中的后退按钮重试。","JL":"文件或文件夹 {0} 包含无效的字符(例如 # % * : < > ? / | )，因此不可选择。","ze":"访问被拒绝。你无权执行此操作或访问此资源。","wk":"无法上传此项目。请刷新页面。"}');var I,x;function C(){return l._SPKillSwitch.isActivated("42f427de-65a5-49c9-9e71-1c1c6a677c11")}function O(){return l._SPKillSwitch.isActivated("e8f99b98-01b3-40b3-93ba-3e3cf9070b88")}function w(){return l._SPKillSwitch.isActivated("3f9bf326-f86b-4992-b5fe-87eae7ab8390")}function E(){return l._SPKillSwitch.isActivated("215d1cd5-38da-4f1f-8da8-d3ff1cfe4cd0")}function L(e,t,n,a){var i={odataErrorCode:e.code,odataErrorMessage:e.message&&e.message.value,correlationId:n?n.toString():void 0};throw U(e,"-2130575252")?(t.writeExpectedFailure("SecurityValidationTimeOut",void 0,i),new S(D.Y$,e.code)):U(e,"-2130575245")?(t.writeExpectedFailure("InvalidCharacters",void 0,i),new S(l.Text.format(D.JL,a),e.code)):U(e,"-2147024891")?(t.writeExpectedFailure("NoPermission",void 0,i),new S(D.ze,e.code)):U(e,"-2130575257")||U(e,"-2130575342")?(t.writeExpectedFailure("FileFolderAlreadyExists",void 0,i),new S(D.ze,e.code)):(t.writeUnexpectedFailure("UncategorizedError",void 0,i),new S(D.wk,e.code))}function M(e,t,n){return"".concat(e,"=%27").concat(g.UriEncoding.encodeRestUriStringToken(t,n),"%27")}function P(e){return{listId:e.ListId,uniqueId:e.UniqueId,serverRelativeUrl:e.ServerRelativeUrl,title:e.Title}}function T(e){var t=E()?new RegExp("[&/\\# ,+()$~'\":*?<>{}|]|%2.","g"):new RegExp("[&/\\\\# ,+()$~'\":*?<>{}|\\s\\u00A0\\u1680\\u180E\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\u200B]|%2.","g");return e?e.replace(t,"-"):""}function U(e,t){return!!e.code&&String(e.code).indexOf(t)>-1}function F(e,t){return Boolean(l._SPFlight.isEnabled(61766)&&(null==t?void 0:t.SiteId)&&(null==t?void 0:t.WebId)&&(null==t?void 0:t.ListId)&&(null==t?void 0:t.UniqueId)&&(e.site.id.toString()!==l.Guid.parse(t.SiteId).toString()||e.web.id.toString()!==l.Guid.parse(t.WebId).toString()))}function H(e){var t=e.ServerAbsoluteUrl||e.Link,n=new g.Uri(t),a=n.getAuthority()===window.location.host?n.getPath():t;return E()?a:R(a)||a}function R(e){if(e)return g.UriEncoding.encodeURIComponent(e,!0)}function N(e){return"{"===e[0]&&(e=e.substring(1,e.length-1)),l.Guid.isValid(e)&&"00000000-0000-0000-0000-000000000000"!==e}function B(){var e=new Headers;return e.append("accept","application/json; odata=nometadata"),e.append("OData-version","3.0"),e}function j(){return JSON.stringify({request:{createLink:!0,settings:{allowAnonymousAccess:!1,linkKind:I.organizationView,nav:"",password:"",restrictShareMembership:!1,role:x.view,scope:1,updatePassword:!1}}})}!function(e){e[e.uninitialized=0]="uninitialized",e[e.direct=1]="direct",e[e.organizationView=2]="organizationView",e[e.organizationEdit=3]="organizationEdit",e[e.anonymousView=4]="anonymousView",e[e.anonymousEdit=5]="anonymousEdit",e[e.flexible=6]="flexible",e[e.requestAccess=7]="requestAccess"}(I||(I={})),function(e){e[e.none=0]="none",e[e.view=1]="view",e[e.edit=2]="edit",e[e.owner=3]="owner",e[e.review=6]="review",e[e.restrictedview=7]="restrictedview",e[e.submit=8]="submit",e[e.manageList=9]="manageList"}(x||(x={}));var V=function(){function e(){}return e.isWebPartAudienceTargetingEnabled=function(){return l._SPFlight.isEnabled(60668)},e}(),z=function(){function t(e){var n=this;this._ensureMoveCopyDataSource=function(){return n._moveCopyDataSource||(n._moveCopyDataSource=Promise.all([Promise.all([A.e(822),A.e(220)]).then(A.bind(A,656))]).then(function(e){return new e[0].MoveCopyAsyncDataSource({},{dataRequestor:new v.DataRequestor({qosName:"SPFileMoveCopyAsync"},{pageContext:n._pageContext.legacyPageContext,tokenProvider:n._getMoveDataSourceTokenProvider()})})})),n._moveCopyDataSource},this._getMoveDataSourceTokenProvider=function(){return{getAuthToken:function(e){return y._AadTokenProviders.configurable._getTokenInternal(new g.Uri(e.url).getLeftPart(g.UriPartial.authority),y._AadTokenProviders.preAuthorizedConfiguration)}}},e.serviceScope.whenFinished(function(){n._httpClient=e.serviceScope.consume(h.SPHttpClient.serviceKey),n._pageContext=e.serviceScope.consume(b.PageContext.serviceKey),n._pageService=e.serviceScope.consume((0,_.getPageServiceServiceKey)())}),this._qosPrefix=e.qosPrefix,this._containerUrl=e.containerUrl,t._isDisableSitePagesStrongBinding=e.isDisableSitePagesStrongBinding}return Object.defineProperty(t,"pagePathName",{get:function(){return-1!==window.location.pathname.toUpperCase().indexOf("/NEWPAGE.ASPX")&&e._TraceLogger.logError(t._logSource,new Error("Page media upload before page titled.")),window.location.pathname},enumerable:!1,configurable:!0}),t.getFileNameFromUrl=function(e){var t,n=new RegExp("^(?:[a-z]+:)?//","i"),a=e.replace(/\/$/,"");if(!(t=n.test(a)?new URL(a).pathname.split("/").pop():a.split("/").pop()))throw new Error("Could not parse file name from url: ".concat(e));return t},t.replaceSpecialCharacters=function(e){return T(e)},t.validateFileType=function(e,t){var n,a=(null==e?void 0:e.name)||e,i=a.lastIndexOf(".");return-1!==i&&(n=a.substring(i+1,a.length),t.indexOf(n.toLowerCase())>-1)},t._isPageAssetFolderBindingEnabled=function(){return!l._SPKillSwitch.isActivated("5b8b049b-2476-4c92-8599-2e0a94837a43")&&l._SPFlight.isEnabled(60296)&&!this._isDisableSitePagesStrongBinding},t.prototype.readFile=function(n){var a=this;return this._reader||(this._reader=new FileReader),new Promise(function(i,r){n||(e._TraceLogger.logVerbose(t._logSource,"File is undefined"),r(new RangeError("FileUndefined"))),a._reader.onloadend=function(){return i(a._reader.result)},a._reader.onerror=function(){e._TraceLogger.logVerbose(t._logSource,"Error occurred when reading the file"),r(a._reader.error)},a._reader.readAsDataURL(n)})},t.prototype.uploadLocalFile=function(e,n,a,i,r,o){var s=this;return void 0===i&&(i=!1),void 0===o&&(o=!1),t._isPageAssetFolderBindingEnabled()?this._pageService.getItemUpdateQueue().then(function(t){return t.executeActionAsync(function(){return s._uploadLocalFile(e,n,a,i,r,o)})}):this._uploadLocalFile(e,n,a,i,r,o)},t.prototype.moveCopyExternalFileToSiteAssets=function(n,i){return void 0===i&&(i=!1),(0,a.__awaiter)(this,void 0,void 0,function(){var r,o,s,c,d,l,u,f,p,m,h,b,g,v,y,I,x=this;return(0,a.__generator)(this,function(a){switch(a.label){case 0:return r=n.fileAbsoluteUrl,o=n.fileName,s=n.sharepointId,c=n.listItemUniqueId,d=n.siteAbsoluteUrl,l=new e._QosMonitor("".concat(this._qosPrefix,".moveCopyExternalFileToSiteAssets")),u=o||t.getFileNameFromUrl(r),u="".concat("copy-(1)-").concat(o),f=Math.floor(1e5+9e5*Math.random()),p=_.ExtensionHelper.getExtension(o),u=o.replace(RegExp(".".concat(p),"i"),"-".concat(f,".").concat(p)),[4,this._ensureMoveCopyDataSource()];case 1:return m=a.sent(),h={isFolder:!1,itemFullUrl:decodeURI(r),sharepointId:s,listItemUniqueId:c,displayName:u},[4,this.getSitePagesAssetFolderUrl()];case 2:b=a.sent(),g={webAbsoluteUrl:b,folderPath:""},a.label=3;case 3:return a.trys.push([3,5,,6]),v={},y=function(e){var t=e.get(h.itemFullUrl)||e.get(h.sharepointId);if(t&&t.jobFinishedResult){var n=t.jobFinishedResult;v={listId:n.listId,serverRelativeUrl:"".concat("/"!==x._pageContext.web.serverRelativeUrl?x._pageContext.web.serverRelativeUrl:"","/").concat(n.siteRelativeUrl),title:o,uniqueId:n.uniqueId}}if(t&&t.error){var a=t.error;throw l.writeUnexpectedFailure("RuntimeError",a,{errorDetails:JSON.stringify(a)}),new S(D.wk)}},[4,m.moveCopyItems({items:[h],destinationItem:g,isMove:i,customizedFileName:[u],sourceWebAbsoluteUrl:d||this._pageContext.web.absoluteUrl,onMoveCopyProgress:y})];case 4:return a.sent(),l.writeSuccess(),[2,v];case 5:throw I=a.sent(),l.writeUnexpectedFailure("RuntimeError",I,{errorDetails:JSON.stringify(I)}),new S(D.wk);case 6:return[2]}})})},t.prototype.uploadExternalFile=function(e,n,a){var i=this;return(!E()||l._SPFlight.isEnabled(1342)||l._SPFlight.isEnabled(61192))&&(n=t.replaceSpecialCharacters(n)),t._isPageAssetFolderBindingEnabled()?this._pageService.getItemUpdateQueue().then(function(t){return t.executeActionAsync(function(){return i._uploadExternalFile(e,n,a)})}):this._uploadExternalFile(e,n)},t.prototype.validateMimeType=function(e,t){if(e.type){var n=e.type.slice(e.type.lastIndexOf("/")+1);if(n)return t.indexOf(n.toLowerCase())>-1}return!1},t.prototype.getSitePagesAssetFolderUrl=function(){var t=this,n=new e._QosMonitor("".concat(this._qosPrefix,".getOrCreateAssetFolderApi")),a=this._getOrCreateAssetFolderApiPostUrl(),i=B();return this._httpClient.post(a,h.SPHttpClient.configurations.v1,{headers:i,body:void 0}).then(function(e){return e.json()}).then(function(e){if(""===e.value)throw n.writeUnexpectedFailure("EmptyResponse",void 0),new S(D.wk);return n.writeSuccess(),g.Uri.concatenate(new g.Uri(t._pageContext.web.absoluteUrl).getLeftPart(g.UriPartial.authority),e.value)}).catch(function(e){throw n.writeUnexpectedFailure("RuntimeError",e,{errorDetails:JSON.stringify(e)}),new S(D.wk)})},t.prototype.getPageName=function(n){void 0===n&&(n=""),n=n.trim();var a=this.removeExtension(n),i=t.replaceSpecialCharacters(a),r=new e._QosMonitor("FilePicker.UploadItem.GetPageName");if(i)r.writeSuccess();else{var o=this._pageContext.listItem&&this._pageContext.listItem.id||"fastPageCreation";r.writeUnexpectedFailure("EmptyPageName",void 0,{pathNameTrimmedLen:n.length,isPathNameEndWithSlash:("/"===n[n.length-1]).toString(),isPageTitleEmpty:(!a.trim()).toString(),pageId:o.toString()}),i=o.toString()}return i},t.prototype.removeExtension=function(e){var t=e.lastIndexOf("/"),n=-1===t?e:e.substring(t+1),a=n.lastIndexOf(".");return-1===a?n:n.substring(0,a)},t.prototype.getFallbackSharingLink=function(t,n){var a,i,r=new e._QosMonitor("".concat(this._qosPrefix,".GetFallbackSharingLink")),o=null===(i=null===(a=this._pageContext)||void 0===a?void 0:a.web)||void 0===i?void 0:i.absoluteUrl;if(void 0===o)return Promise.resolve(void 0);var s=o+"/_api/web/Lists(@a1)/GetItemByUniqueId(@a2)/ShareLink?@a1='".concat(t,"'&@a2='").concat(n,"'"),c=B();c.append("Prefer","DirectUrlWithShareToken"),t&&N(t.slice(1,-1))&&c.append("X-SP-REQUESTRESOURCES","WEBPROPERTIES, list=".concat(t.slice(1,-1)));var d=j();return this._httpClient.post(s,h.SPHttpClient.configurations.v1,{headers:c,body:d}).then(function(e){return e.json()}).then(function(e){var t,n;if(e&&e.sharingLinkInfo)return r.writeSuccess(),null!==(t=e.sharingLinkInfo.Url)&&void 0!==t?t:void 0;var a=e["odata.error"];if(a){var i={odataErrorCode:a.code,odataErrorMessage:(null===(n=a.message)||void 0===n?void 0:n.value)||""};r.writeUnexpectedFailure("ErrorResponse",void 0,i)}else r.writeUnexpectedFailure("EmptyResponse")}).catch(function(e){r.writeUnexpectedFailure("RuntimeError")})},t.prototype._uploadCore=function(e,t){var n=this._pageContext&&this._pageContext.web&&this._pageContext.web.absoluteUrl||"",a=B(),i=g.Uri.concatenate(n,e);return this._httpClient.post(i,h.SPHttpClient.configurations.v1,{headers:a,body:t})},t.prototype._uploadLocalFile=function(n,a,i,r,o,s){var c,d=this;void 0===r&&(r=!1),void 0===s&&(s=!1);var u,f=n instanceof File?E()?n.name:t.replaceSpecialCharacters(n.name):void 0,p=E()?a||f:t.replaceSpecialCharacters(a||f),m=!l._SPKillSwitch.isActivated("24ae812f-4669-4754-920f-322c88338efb")&&n instanceof File?n.size:void 0,_=new e._QosMonitor("".concat(this._qosPrefix,".UploadLocalFile"));t._isPageAssetFolderBindingEnabled()&&!r&&(u=o||(null===(c=this._pageContext.listItem)||void 0===c?void 0:c.id));var h,b=this._getEndPoint(p,u,void 0,i,m);return this._uploadCore(b,n).then(function(e){return h=e.correlationId,e.json()}).then(function(e){var t=e["odata.error"];if(!t){var n=P(e);return l._SPFlight.isEnabled(62406)&&s?d.getFallbackSharingLink(n.listId,n.uniqueId).then(function(e){return _.writeSuccess(),n.fallbackShareLink=e,n}):n}L(t,_,h,p)}).catch(function(e){throw _.writeUnexpectedFailure("RuntimeError",e,{errorDetails:JSON.stringify(e)}),new S(D.wk)})},t.prototype._uploadExternalFile=function(n,a,i){var r,o,s=this._getEndPoint(a,t._isPageAssetFolderBindingEnabled()?null===(r=this._pageContext.listItem)||void 0===r?void 0:r.id:void 0,n,void 0,void 0,i),c=new e._QosMonitor("".concat(this._qosPrefix,".UploadExternalFile"));return this._uploadCore(s,void 0).then(function(e){return o=e.correlationId,e.json()}).then(function(e){var t=e["odata.error"];if(t){var n={odataErrorCode:t.code,odataErrorMessage:t.message&&t.message.value,correlationId:o?o.toString():void 0};throw c.writeUnexpectedFailure("UncategorizedError",void 0,n),new S(D.wk,t.code)}return c.writeSuccess(),P(e)}).catch(function(e){throw c.writeUnexpectedFailure("RuntimeError",e,{errorDetails:JSON.stringify(e)}),new S(D.wk)})},t.prototype._getEndPoint=function(e,n,a,i,r,o){e=encodeURIComponent(e);var s="$select=ListId,ServerRelativeUrl,Title,UniqueId",c=t._isPageAssetFolderBindingEnabled()&&void 0!==n?"&".concat("pageId","=").concat(n):"",d=r?"&".concat("fileSize","=").concat(r):"";if(this._containerUrl){var u=encodeURIComponent(this._containerUrl);return"/_api/web/GetFolderByServerRelativeUrl("+l.UrlUtilities.convertToODataStringLiteral(u)+")/Files/Add(url="+l.UrlUtilities.convertToODataStringLiteral(e)+", overwrite=false)?".concat(s)}return a?"/_api/sitepages/AddImageFromExternalUrl?"+this._createSitePageEndpoint(e,i,o)+"&"+M("externalUrl",a,o)+"".concat(c,"&").concat(s):"/_api/sitepages/AddImage?"+this._createSitePageEndpoint(e,i)+"".concat(c).concat(d,"&").concat(s)},t.prototype._getOrCreateAssetFolderApiPostUrl=function(){var e,n=this.getPageName(t.pagePathName),a=t._isPageAssetFolderBindingEnabled()?null===(e=this._pageContext.listItem)||void 0===e?void 0:e.id:void 0,i=t._isPageAssetFolderBindingEnabled()&&void 0!==a?"&pageId=".concat(a):"",r="/_api/sitepages/GetOrCreateAssetFolder?"+M("pageName",n)+i+"&createFolderIfNeeded=true",o=this._pageContext&&this._pageContext.web&&this._pageContext.web.absoluteUrl||"";return g.Uri.concatenate(o,r)},t.prototype._createSitePageEndpoint=function(e,n,a){var i=n||this.getPageName(t.pagePathName);return M("imageFileName",e)+"&"+M("pageName",i,a)},t._logSource=e._LogSource.create("PublishingWebPartSPFileHandler"),t}(),G=A(141),K=A(27),W=A(424);W.loadStyles('.a_a_7c0c6d12{background-position:50%;background-repeat:no-repeat;background-size:cover;height:100%;margin:0 auto;width:100%;z-index:0}.a_a_7c0c6d12:before{background-color:"[theme:blackTranslucent40, default: rgba(0,0,0,.4)]";bottom:0;content:"";display:block;height:100%;left:0;position:absolute;right:0;top:0;width:100%}.a_a_7c0c6d12 .b_a_7c0c6d12{color:#fff;padding:10px;position:absolute;text-align:center;top:50%;transform:translate(-50%,-50%)}[dir=ltr] .a_a_7c0c6d12 .b_a_7c0c6d12{left:50%}[dir=rtl] .a_a_7c0c6d12 .b_a_7c0c6d12{right:50%}.a_a_7c0c6d12 .b_a_7c0c6d12 .c_a_7c0c6d12{animation:e_a_7c0c6d12 2s linear infinite;display:block;font-size:48px;margin:8px 0}@keyframes e_a_7c0c6d12{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.a_a_7c0c6d12 .f_a_7c0c6d12{max-height:100%;max-width:100%;opacity:.5;position:relative;visibility:hidden}.a_a_7c0c6d12 .g_a_7c0c6d12{color:"[theme:white, default: #ffffff]";font-size:21px;font-weight:100;font-weight:300}.a_a_7c0c6d12 img{display:block;margin:0 auto;max-width:100%}.a_a_7c0c6d12 img:not([src]){display:none}',!0);const q=JSON.parse('{"zV":"仍在上传图像。如果离开此页，该图像可能丢失。","l":"上传图像时显示的预览图像。","Hg":"此图像文件貌似不受支持。请选择其他图像。"}'),Q=function(t){function n(e){var n=t.call(this,e)||this;return n._isImageFlipped=!1,n._handleImageLoad=function(e){f(e.target,function(){n._isImageFlipped=!0})},n._startUpload=function(e){var t=new K._QosMonitor(n.props.QosTag);try{var a="",i=n._getPrefix(),r="src"in e;if(e instanceof File&&z.validateFileType(e,_.spConstants.imageExtensions))a="".concat(i,"-").concat(z.replaceSpecialCharacters(e.name));else if(e instanceof Blob&&n._spFileHandler.validateMimeType(e,_.spConstants.imageExtensions))a="".concat(i,".").concat(e.type.split("/").pop());else{if(!r||!z.validateFileType(e.src,_.spConstants.imageExtensions))return n._onUploadError(new Error(q.Hg)),void t.writeExpectedFailure("InvalidFileType");e=e,a="".concat(i,"-").concat(z.replaceSpecialCharacters(e.name))}window.addEventListener("beforeunload",n._promptUploadingWarning),(e instanceof File||e instanceof Blob?n._spFileHandler.uploadLocalFile(e,a):n._spFileHandler.uploadExternalFile(e.src,a)).then(function(a){n._onUploadComplete(a,e instanceof File?e.name:void 0),t.writeSuccess()}).catch(function(e){t.writeUnexpectedFailure("UploadPromise",e),n._onUploadError(e)})}catch(e){t.writeUnexpectedFailure("CatchAll",e),n._onUploadError(e)}},n._startUploadFromExternalUrl=function(e){var t=new K._QosMonitor(n.props.QosTag);try{var a=e.lastIndexOf("/"),i=e.substring(a+1),r=n._getPrefix()+z.replaceSpecialCharacters(i);window.addEventListener("beforeunload",n._promptUploadingWarning),n._spFileHandler.uploadExternalFile(e,r).then(function(e){n._onUploadComplete(e,r),t.writeSuccess()}).catch(function(e){n.props.localFile?n._startUpload(n.props.localFile):(t.writeUnexpectedFailure("UploadPromise",e),n._onUploadError(e))})}catch(e){t.writeUnexpectedFailure("CatchAll",e),n._onUploadError(e)}},n._onUploadComplete=function(e,t){if(window.removeEventListener("beforeunload",n._promptUploadingWarning),n._imagePreview&&n._imagePreview.naturalHeight&&n._imagePreview.naturalWidth){var a=n._isImageFlipped?n._imagePreview.naturalHeight:n._imagePreview.naturalWidth,i=n._isImageFlipped?n._imagePreview.naturalWidth:n._imagePreview.naturalHeight;n.props.onUploadComplete(e,t,a,i)}else n.props.onUploadComplete(e,t)},n._onUploadError=function(e){window.removeEventListener("beforeunload",n._promptUploadingWarning),n.props.onUploadError&&n.props.onUploadError(e,n.props.externalFile?n.props.externalFile.src:void 0)},n._getPrefix=function(){return Math.floor(4294967296*Math.random()).toString()},n._spFileHandler=new z({serviceScope:e.serviceScope,qosPrefix:e.QosTag}),n.state={imageDataString:void 0},n}return(0,a.__extends)(n,t),n.prototype.UNSAFE_componentWillMount=function(){var e=this.props,t=e.externalFile,n=e.imageUrl,a=e.localFile,i=e.pageContext;t?this._startUpload(t):n&&_.UrlUtility.isValidURL(n)&&!_.UrlUtility.isVanityUrl(n,i)?this._startUploadFromExternalUrl(n):a&&this._startUpload(a)},n.prototype.componentDidMount=function(){this._setStateForLocalFile()},n.prototype.componentWillUnmount=function(){this._rejectPromise&&(this._rejectPromise(),this._rejectPromise=void 0)},n.prototype.render=function(){var e=i.createElement("img",{className:"f_a_7c0c6d12",alt:q.l,src:this.state.imageDataString,ref:this._resolveRef("_imagePreview"),onLoad:this._handleImageLoad});return i.createElement("div",{className:"a_a_7c0c6d12",ref:this._resolveRef("_root"),"data-automation-id":"localFilePreview"},this.state.imageDataString&&e,i.createElement("div",{className:"b_a_7c0c6d12"},i.createElement(G.Icon,{iconName:"Sync",className:"c_a_7c0c6d12"}),i.createElement("span",{className:"g_a_7c0c6d12","aria-live":"assertive","aria-atomic":!0},this.props.uploadingMessage)))},n.prototype._setStateForLocalFile=function(){var t=this;this.props.localFile?new Promise(function(e,n){t._rejectPromise=n,e(t._spFileHandler.readFile(t.props.localFile))}).then(function(e){t.setState({imageDataString:e})}).catch(function(t){e._TraceLogger.logError(e._LogSource.create("LocalFilePreview"),t,"ReadLocalFile")}):this.props.externalFile&&this.setState({imageDataString:this.props.externalFile.src})},n.prototype._promptUploadingWarning=function(e){var t=q.zV;return e.returnValue=t,t},n}(G.BaseComponent),Y=function(){function e(e,t,n){var a,i,r,o=this;e.whenFinished(function(){o._spHttpClient=e.consume(h.SPHttpClient.serviceKey),r=e.consume(b.PageContext.serviceKey)}),!l._SPKillSwitch.isActivated("2097ba85-7386-407a-b0e8-a92e4f1f4053")&&n?(this._webAbsoluteUrl=n.webAbsoluteUrl||"",this._webId=n.webId,this._siteId=n.siteId):((null==r?void 0:r.web)?(this._webAbsoluteUrl=r.web.absoluteUrl,this._webId=r.web.id&&r.web.id.toString()||""):this._webAbsoluteUrl=this._webId="",this._siteId=(null===(i=null===(a=null==r?void 0:r.site)||void 0===a?void 0:a.id)||void 0===i?void 0:i.toString())||""),this._errorCallback=t}return Object.defineProperty(e.prototype,"defaultDocumentLibrary",{get:function(){var e=g.Uri.concatenate(this._webAbsoluteUrl,"_api/web/DefaultDocumentLibrary?$expand=RootFolder");return this._spHttpClient.get(e,h.SPHttpClient.configurations.v1).then(function(e){return e.json()})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"siteContext",{get:function(){var e=this;return this._siteContext?Promise.resolve(this._siteContext):this._getContainingFolderSiteContext().then(function(t){return e._siteContext=t,t})},enumerable:!1,configurable:!0}),e.prototype._getContainingFolderSiteContext=function(){var e=this,t={webAbsoluteUrl:this._webAbsoluteUrl,libraryName:"",defaultLibraryId:"",pickerDomain:window.location.protocol+"//"+window.location.hostname,siteId:this._siteId,webId:this._webId},n=new K._QosMonitor("GetWebDefaultLibrary");return this.defaultDocumentLibrary.then(function(e){if(e.error)throw new Error(e.error.code);return t.libraryName=e.RootFolder.Name,t.defaultLibraryId=e.Id,n.writeSuccess(),t}).catch(function(a){if(a.message.indexOf("-2146232832")>=0?n.writeExpectedFailure("ListDeleted"):n.writeUnexpectedFailure(void 0,a),e._errorCallback)return e._errorCallback(t),t;throw a})},e}();var J=i.lazy(function(){return A.e(769).then(A.bind(A,934)).then(function(e){return{default:e.Dialog}})});function X(e){var t=e.fallback,n=void 0===t?i.createElement(i.Fragment,null):t,r=(0,a.__rest)(e,["fallback"]);return i.createElement(i.Suspense,{fallback:n},i.createElement(J,(0,a.__assign)({},r)))}var Z=i.lazy(function(){return A.e(769).then(A.bind(A,934)).then(function(e){return{default:e.DialogFooter}})});function $(e){var t=e.fallback,n=void 0===t?i.createElement(i.Fragment,null):t,r=(0,a.__rest)(e,["fallback"]);return i.createElement(i.Suspense,{fallback:n},i.createElement(Z,(0,a.__assign)({},r)))}var ee=i.lazy(function(){return A.e(769).then(A.bind(A,934)).then(function(e){return{default:e.DialogContent}})});function te(e){var t=e.fallback,n=void 0===t?i.createElement(i.Fragment,null):t,r=(0,a.__rest)(e,["fallback"]);return i.createElement(i.Suspense,{fallback:n},i.createElement(ee,(0,a.__assign)({},r)))}var ne=A(976),ae=A(642),ie=A(877),re={Image:1,FabricReactIcon:2,AutoSelect:3};const oe=JSON.parse('{"eu":"缩略图的可选文字字段","rZ":"缩略图","Wi":"自动选择","dt":"自定义图像","uH":"库","N6":"正在上传...","X4":"0||1||2-","O_":"{0} 个字符||{0} 个字符||{0} 个字符","Mg":"字符数上限: {0} - 超出 {1} 个","Wk":"字符数上限: {0} - 还可输入 {1} 个字符数","TS":"{0} 个字符"}');var se=function(e){function t(n){var a=e.call(this,n)||this;return a._onValidChange=function(e){var t,n,i,r;a._handleGetErrorMessage(e||"")||(l._SPKillSwitch.isActivated("3ffa6b5d-b309-4f16-a93d-86d9e47d73cb")?null===(r=(i=a.props).onChange)||void 0===r||r.call(i,e):null===(n=(t=a.props).onChange)||void 0===n||n.call(t,a.props.label,e),a.props.onValidChange&&a.props.onValidChange(e||""))},a._handleGetErrorMessage=function(e){if(!e||e.length<=a.props.maxCharacters)return"";var n=t._getLocalizedCount(a.props.maxCharacters),i=t._getLocalizedCount(e.length-a.props.maxCharacters);return g.StringHelper.format(oe.Mg,n,i)},a._getLimitedLengthMessage=function(e){return e>=0?g.StringHelper.format(oe.Wk,g.StringHelper.format(oe.TS,a.props.maxCharacters),t._getLocalizedCount(e)):""},a.state={value:n.initialValue||""},a}return(0,a.__extends)(t,e),t.getTextFieldGroup=function(e,n){return(0,ae.PropertyPaneCustomField)({key:e,onRender:function(r,o,s){var c=i.createElement(t,(0,a.__assign)({key:e,onChange:s},n));ne.render(c,r)},onDispose:function(e){r.unmountComponentAtNode(e)}})},t._getLocalizedCount=function(e){return g.StringHelper.formatWithLocalizedCountValue(oe.O_,oe.X4,e)},t.prototype.render=function(){return i.createElement(_.LimitedLengthTextField,{label:this.props.label,multiline:this.props.multiline,value:this.state.value,defaultValue:this.state.value,onChanged:this._onValidChange,maxLength:this.props.maxCharacters,getLimitedLengthMessage:this._getLimitedLengthMessage})},t}(i.PureComponent),ce=A(779),de=function(t){function n(e){var n=t.call(this,e)||this;return n.state={isRenderBackup:!1},n}return(0,a.__extends)(n,t),n.prototype.render=function(){var e,t,n,a,r=this._content,o=void 0;return!l._SPKillSwitch.isActivated("d3e7d14b-3886-4b5c-9b1b-d1ba5675074d")&&(null===(e=this.props.thumbnail)||void 0===e?void 0:e.type)===ie.ThumbnailType.FabricReactIcon&&(null===(t=this.props.thumbnail)||void 0===t?void 0:t.iconColor)&&(o=null===(n=this.props.thumbnail)||void 0===n?void 0:n.iconColor),!!r&&i.createElement("div",{role:"img",className:this.props.className,"aria-label":null===(a=this.props.thumbnail)||void 0===a?void 0:a.altText,style:o?{fill:o}:void 0},r)},Object.defineProperty(n.prototype,"_content",{get:function(){if(this.props.onRenderThumbnail)return this.props.onRenderThumbnail();var t=this.props.thumbnail;if(t)switch(t.type){case ie.ThumbnailType.FabricReactIcon:return i.createElement(G.Icon,{iconName:t.iconName,style:t.iconColor?{color:t.iconColor}:void 0,role:"presentation",className:this.props.iconClassName});case ie.ThumbnailType.IconSizeImage:var n={className:this.props.iconClassName,imageFit:G.ImageFit.cover,src:t.iconUrl,role:"presentation",alt:t.altText};return i.createElement(G.Icon,{iconType:G.IconType.image,style:t.iconColor?{color:t.iconColor}:void 0,imageProps:n,className:this.props.iconClassName});case ie.ThumbnailType.Image:var a={imageFit:void 0!==t.imageFit?t.imageFit:G.ImageFit.cover,src:this.state.isRenderBackup&&t.backupImageUrl?t.backupImageUrl:t.imageUrl,alt:t.altText,title:t.altText?t.altText:void 0,role:t.altText?void 0:"presentation",className:this.props.iconClassName,onLoadingStateChange:this._handleImageLoadingStateChange,styles:{image:{width:"100%",height:"100%"}}};return C()||(this._imageMonitor=new e._QosMonitor("".concat(this.props.qosPrefix,".ImageLoad"))),i.createElement(G.Icon,{iconType:G.IconType.image,imageProps:a,className:this.props.iconClassName});default:return}},enumerable:!1,configurable:!0}),n.prototype._handleImageLoadingStateChange=function(e){!C()&&this._imageMonitor&&(e===G.ImageLoadState.loaded?this._imageMonitor.writeSuccess():e===G.ImageLoadState.error&&this._imageMonitor.writeUnexpectedFailure("ImageLoadError",void 0,{isRenderBackup:this.state.isRenderBackup})),this.setState(function(t){if(e===G.ImageLoadState.error&&!t.isRenderBackup)return{isRenderBackup:!0}})},(0,a.__decorate)([G.autobind],n.prototype,"_handleImageLoadingStateChange",null),n}(i.PureComponent);W.loadStyles('.i_c_7c0c6d12{position:relative}.i_c_7c0c6d12.j_c_7c0c6d12{background-color:"[theme:neutralLight, default: #edebe9]"}.k_c_7c0c6d12{padding-bottom:56.25%;width:100%}.l_c_7c0c6d12{height:100px;width:100px}.m_c_7c0c6d12{align-items:center;bottom:0;display:flex;justify-content:center;left:0;overflow:hidden;position:absolute;right:0;top:0}.m_c_7c0c6d12.n_c_7c0c6d12{font-size:64px;line-height:100%;text-align:center}.m_c_7c0c6d12.o_c_7c0c6d12 .p_c_7c0c6d12{height:100%;width:100%}.m_c_7c0c6d12.q_c_7c0c6d12 .p_c_7c0c6d12{height:64px;width:64px}.r_c_7c0c6d12{left:50%;margin:0;position:absolute;top:50%;transform:translate(-50%,-50%)}',!0);var le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.render=function(){var e,t,n,a,r,o=(0,G.css)(this.props.wrapperClassName,"i_c_7c0c6d12",this.props.previewFullWidth?"k_c_7c0c6d12":"l_c_7c0c6d12",((e={}).j_c_7c0c6d12=this.props.previewGrayBackground,e)),s=(0,G.css)("m_c_7c0c6d12",((t={}).n_c_7c0c6d12=(null===(n=this.props.thumbnail)||void 0===n?void 0:n.type)===ie.ThumbnailType.FabricReactIcon,t.q_c_7c0c6d12=(null===(a=this.props.thumbnail)||void 0===a?void 0:a.type)===ie.ThumbnailType.IconSizeImage,t.o_c_7c0c6d12=(null===(r=this.props.thumbnail)||void 0===r?void 0:r.type)===ie.ThumbnailType.Image,t));return this.props.showLoading?i.createElement("div",{className:o},i.createElement(ce.Spinner,{className:"r_c_7c0c6d12",type:G.SpinnerType.large,label:oe.N6})):i.createElement("div",{className:o},i.createElement(de,{thumbnail:this.props.thumbnail,className:s,iconClassName:(0,G.css)(this.props.iconClassName,"p_c_7c0c6d12"),qosPrefix:this.props.qosPrefix,onRenderThumbnail:this.props.onRenderThumbnail}))},t}(i.PureComponent),ue=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._shouldShowThumbnailRenderer=function(){return O()?Boolean(t.props.thumbnail&&(t.props.thumbnail.iconName||t.props.thumbnail.imageUrl||t.props.thumbnail.backupImageUrl)):Boolean(t.props.thumbnail&&(t.props.thumbnail.iconName||t.props.thumbnail.imageUrl||t.props.thumbnail.backupImageUrl))||t._isCustomIconPresent},t._renderCustomIcon=function(){return t.props.customIconSet.get(t.props.customSelectedIconName)},t}return(0,a.__extends)(t,e),t.prototype.render=function(){return l._SPKillSwitch.isActivated("31582809-6161-4521-87df-a8eb72575445")||!this.props.thumbnail||this.props.thumbnail.altText||(this.props.thumbnail.altText=this.props.customSelectedIconName?this.props.customSelectedIconName.split("_").join(" "):"Custom Selected Thumbnail"),this._shouldShowThumbnailRenderer()?i.createElement(le,{thumbnail:this.props.thumbnail,previewFullWidth:this.props.previewFullWidth,previewGrayBackground:this.props.previewGrayBackground,wrapperClassName:this.props.thumbnailRendererWrapperClassName,iconClassName:this.props.thumbnailRendererIconClassName,qosPrefix:this.props.qosPrefix,onRenderThumbnail:this._isCustomIconPresent?this._renderCustomIcon:void 0}):null},Object.defineProperty(t.prototype,"_isCustomIconPresent",{get:function(){return Boolean(this.props.customIconSet&&this.props.customSelectedIconName)},enumerable:!1,configurable:!0}),t}(i.PureComponent);function fe(e,t,n){return se.getTextFieldGroup(n,{label:oe.eu,initialValue:t,multiline:!1,maxCharacters:255,onValidChange:e})}function pe(e,t,n,a,r,o,s,c){var d=[],l=[];switch(r.autoSelectOptions.enabled&&l.push({key:re.AutoSelect,disabled:r.disabled&&!w(),text:r.autoSelectOptions.optionLabel||oe.Wi,checked:a===re.AutoSelect}),r.imageOptions.enabled&&l.push({key:re.Image,disabled:r.disabled&&!w(),text:r.imageOptions.optionLabel||oe.dt,checked:a===re.Image}),r.iconOptions.enabled&&l.push({key:re.FabricReactIcon,disabled:r.disabled&&!w(),text:r.iconOptions.optionLabel||oe.uH,checked:a===re.FabricReactIcon}),d.push((0,ae.PropertyPaneChoiceGroup)(t,{options:l,label:(null==s?void 0:s.pickerLabelOverride)||oe.rZ})),a){case re.Image:d.push(function(e,t,n,a,i,r,o){return(0,ie.PropertyPaneThumbnailPicker)("imagePicker",{serviceScope:t,onItemChanged:a,thumbnail:n.thumbnailInfo,callerName:e,previewFullWidth:null==i?void 0:i.previewFullWidth,previewGrayBackground:null==i?void 0:i.previewGrayBackground,thumbnailRendererWrapperClassName:null==i?void 0:i.thumbnailRendererWrapperClassName,thumbnailRendererIconClassName:null==i?void 0:i.thumbnailRendererIconClassName,onItemDeleted:n.itemDeleteCallback,forceFullUrl:r,disabled:o})}(e,n,r.imageOptions,r.imageChangeCallback,s,r.ensureImageFullUrl,r.disabled)),o&&d.push(fe(o.altTextChangeCallback,o.currentAltText,o.altTextFieldKey));break;case re.AutoSelect:d.push(function(e,t,n,a,r){var o={thumbnail:e,previewFullWidth:null==t?void 0:t.previewFullWidth,previewGrayBackground:null==t?void 0:t.previewGrayBackground,thumbnailRendererWrapperClassName:null==t?void 0:t.thumbnailRendererWrapperClassName,thumbnailRendererIconClassName:null==t?void 0:t.thumbnailRendererIconClassName,qosPrefix:n,customIconSet:a,customSelectedIconName:r},s=i.createElement(ue,o);return(0,ae.PropertyPaneCustomField)({key:"imagePicker",onRender:function(e){ne.render(s,e)}})}(r.autoSelectOptions.thumbnailInfo,s,e,r.customIconSet,r.customSelectedIconName)),o&&d.push(fe(o.altTextChangeCallback,o.currentAltText,o.altTextFieldKey));break;case re.FabricReactIcon:d.push(function(e,t,n,a,i,r,o,s){return(0,ie.PropertyPaneIconPicker)("iconPicker",{thumbnail:t.thumbnailInfo,onItemChanged:e,previewFullWidth:null==n?void 0:n.previewFullWidth,previewGrayBackground:null==n?void 0:n.previewGrayBackground,thumbnailRendererWrapperClassName:null==n?void 0:n.thumbnailRendererWrapperClassName,thumbnailRendererIconClassName:null==n?void 0:n.thumbnailRendererIconClassName,callerName:a,customIconSet:i,customSelectedIconName:r,onItemDeleted:t.itemDeleteCallback,_extendedIcons:o,disabled:s})}(r.iconChangeCallback,r.iconOptions,s,e,r.customIconSet,r.customSelectedIconName,r.extendedIcons,r.disabled))}return d}var me=["airplane_take_off","alert","alert_urgent","approvals_app","apps","apps_add_in","archive","attach","backpack","balloon","beach","bed","block","board","bookmark","bug","building","building_bank","building_shop","building_skyscraper","calendar_checkmark","calendar_clock","calendar_edit","calendar_question_mark","calendar_reply","calendar_sync","calendar_work_week","call","camera","cart","channel","channel_add","channel_alert","channel_share","chat","city","clipboard","clipboard_paste","clock","cloud_download","comment_mention","comment_multiple","communication","compass_northwest","compose","conference_room","contact_card_group","copy","cube","currency_dollar_euro","dentist","desktop","desktop_mac","doctor","document","document_add","document_catch_up","document_question_mark","drafts","drink_beer","drink_coffee","dumbbell","emoji","emoji_add","error_circle","filter","flag","flag_off","flash","flash_checkmark","glasses","globe","grid","guest","hat_graduation","headset","heart","highlight","home","home_checkmark","image","image_edit","important","info","inking_tool","inprivate_account","key","laptop","leaf_two","library","lightbulb","link","location","location_off","lock_closed","mail","mail_inbox","map_drive","math_formula","meet_now","megaphone","mic_off","mic_on","mic_prohibited","money","movies_and_tv","music_note_2","my_location","options","page_fit","paint_brush","paint_bucket","payment","people","people_add","people_call","people_community","people_search","people_team","person","person_add","person_available","person_call","person_clock","person_mail","person_prohibited","person_question_mark","person_support","premium","reading_list","record","remote","reward","ribbon","rocket","ruler","run","savings","search","send","settings","shield","shifts","slide_text","snooze","speaker_0","speaker_1","sport","star","stop","store_microsoft","sync_off","table","table_simple","tab","tag","target","tasks","tent","tetris_app","thumb_like","timer","trophy","tv","vault","vehicle_bicycle","vehicle_bus","vehicle_cab","vehicle_car","vehicle_subway","video","video_person","voicemail","warning","weather_moon","weather_moon_off"];function _e(e){return A.e(112).then(A.bind(A,537)).then(function(t){return t.supportedIconMap.get(e)})}var he=A(738),be=A(253),ge=A(926);W.loadStyles(".h_b_7c0c6d12{display:inline-flex}",!0);const ve=JSON.parse('{"Gy":"启用受众设定","kl":"启用受众设定，以向网站中的特定受众推广内容。","Hi":"使受众设定能够显示或隐藏此 Web 部件中的内容。若要显示或隐藏整个 Web 部件，请转到访问群体目标部分。","_A":"按 Enter 以了解详细信息。","$$":"{0} {1}","s1":"开","KX":"关","dX":"已启用受众设定。","IF":"已禁用受众设定。"}');function ye(e,t){var n=V.isWebPartAudienceTargetingEnabled()?ve.Hi:ve.kl,a=g.StringHelper.format(ve.$$,n,ve._A),r=t.labelText||ve.Gy,o=i.createElement("div",{className:"h_b_7c0c6d12"},i.createElement(he.Label,{"aria-label":r},r),i.createElement(be.TooltipHost,{content:n},i.createElement(ge.IconButton,{"aria-label":a,iconProps:{iconName:"info"},href:t.infoLink,target:"_blank"}))),s=l._SPKillSwitch.isActivated("f8859d52-a5fb-46d1-94be-0babc89a0c19");return(0,ie.PropertyPaneToggle)(e,{key:e,_label:o,onText:ve.s1,offText:ve.KX,ariaLabel:s?void 0:r,onAriaLabel:s?ve.dX:void 0,offAriaLabel:s?ve.IF:void 0,dataAutomationId:t.dataAutomationId})}const Se=JSON.parse('{"i":"浏览页面时添加深度效果。预览或发布以查看动画。","v":"浏览页面时添加深度效果。发布以查看动画。"}');function De(){return l._SPFlight.isEnabled(62201)||1===l._SPExperiment.getVariantAndLogExposure(90345)?Se.i:Se.v}var Ie=A(327);const xe=JSON.parse('{"k":"链接"}');var Ce=function(e){function t(t){var n=e.call(this,t)||this;return n._onChange=function(e,t){var a;if(n.props.enforceHttps){var i=null!==(a=n._ensureProtocol(t))&&void 0!==a?a:"https://";n.setState({textValue:i}),n.props.onUrlUpdated(i)}else n.props.disableProtocolCheck?(n.props.onUrlUpdated(t),n.setState({textValue:t})):(n._ensureProtocolDebounced(t),n.setState({textValue:t}))},n._ensureProtocol=function(e){if(e){if(n.props.enforceHttps)return _.UrlUtility.ensureSchema(e,["https"]);var t=new g.Uri(e).getScheme()?e:n.props.prefix?"".concat(e):"https://".concat(e);n.props.onUrlUpdated(t),n.setState({textValue:t})}},n._ensureProtocolDebounced=(new G.Async).debounce(n._ensureProtocol,1e3),n.state={textValue:t.initialUrl},n}return(0,a.__extends)(t,e),t.prototype.render=function(){return i.createElement(Ie.TextField,{value:this.state.textValue,placeholder:this.props.prefix?"":"https://",onChange:this._onChange,label:this.props.label||xe.k,prefix:this.props.prefix,disabled:this.props.disabled})},t}(i.PureComponent)})(),k})())})();