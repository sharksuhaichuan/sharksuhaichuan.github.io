/*! For license information please see office-browser-feedback_none_5ad46bfa2ad7be5f2912.js.LICENSE.txt */
(()=>{var e=document.currentScript;define("069100e9-5e61-4cba-9e4b-7f8a3c22f869_0.2.4",["tslib","@microsoft/sp-core-library","@microsoft/sp-diagnostics","@microsoft/sp-loader"],(t,n,a,i)=>(()=>{"use strict";var r,o={48:(e,t,n)=>{e.exports=n.p+"officebrowserfeedback.min_baeebb5f3f596c88d0a5.css"}
,679:(e,t,n)=>{e.exports=n.p+"officebrowserfeedback.min_0fd2aa9b5a016f66698a.js"}
,807:(e,t,n)=>{e.exports=n.p+"officebrowserfeedback_floodgate.min_f9789426370a2e5439f2.js"}
,676:e=>{e.exports=n},207:e=>{e.exports=a},414:e=>{e.exports=i},280:e=>{e.exports=t}},s={};function c(e){var t=s[e];if(void 0!==t)return t.exports;var n=s[e]={exports:{}};return o[e](n,n.exports,c),n.exports}c.m=o,c.d=(e,t)=>{for(var n in t)c.o(t,n)&&!c.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},c.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r=e?e.src:"",c.p=r.slice(0,r.lastIndexOf("/")+1),c.b=document.baseURI||self.location.href;var d={};return(()=>{c.r(d),c.d(d,{getTelemetrySink:()=>nr,loadFeedbackAsync:()=>er,loadFloodgateAsync:()=>tr,officeFeedbackCssUrl:()=>Ji,officeFeedbackIntlBaseUrl:()=>$i});var e=c(280);function t(e,t,a){return n(e,0,t,a)}function n(e,t,n,a){return{name:e,dataType:t,value:n,classification:a||4}}function a(e,t){return e?e+"."+t:t}function i(e,n,i,r,o){void 0===o&&(o=4),r&&e.push(t("".concat(a(n,i)),r,o))}function r(e,t,i,r){"boolean"==typeof r&&e.push(function(e,t,a){return n(e,1,t,void 0)}("".concat(a(t,i)),r))}var o,s=function(e){var t="User",n=[];return i(n,t,"PrimaryIdentityHash",e.primaryIdentityHash),i(n,t,"PrimaryIdentitySpace",e.primaryIdentitySpace),i(n,t,"TenantId",e.tenantId,1),i(n,t,"TenantGroup",e.tenantGroup,1),r(n,t,"IsAnonymous",e.isAnonymous),r(n,t,"IsSignedIn",e.isSignedIn),n};!function(e){e.Web="Web",e.Desktop="Desktop",e.Universal="Universal",e.Mobile="Mobile",e.Win32="Win32",e.iOS="iOS",e.Android="Android"}(o||(o={}));var l,u,f,p=function(e){var t="App",n=[];return i(n,t,"Name",e.name,1),i(n,t,"Platform",e.platform,1),i(n,t,"Version",e.version,1),n},m=function(e){var t="Session",n=[];return i(n,t,"Id",e.id,1),i(n,t,"EcsETag",e.ecsETag,1),n};!function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Production="Production"}(l||(l={})),function(e){var n,a,o,s,c="Copilot";(s=e.FeatureActionType||(e.FeatureActionType={})).IsEnabled="IsEnabled",s.IsSeen="IsSeen",s.IsTried="IsTried",s.IsKept="IsKept",s.IsRejected="IsRejected",(o=e.Capability||(e.Capability={})).ContentGeneration="Content Generation",o.Commanding="Commanding",o.QAandSummaries="QA and Summaries",o.Collaboration="Collaboration",o.Suggestions="Suggestions",(a=e.EntryPoint||(e.EntryPoint={})).Chat="Chat",a.Canvas="Canvas",(n=e.Verb||(e.Verb={})).Create="Create",n.Command="Command",n.Ask="Ask",n.Summarize="Summarize",n.Share="Share",n.Analyze="Analyze",e.getFields=function(e){var n=[];return i(n,c,"FeatureActionType",e.featureActionType),r(n,c,"IsUserInitiated",e.isUserInitiated),i(n,c,"FeatureName",e.featureName),i(n,c,"SubFeatureName",e.subFeatureName),i(n,c,"Capability",e.capability),r(n,c,"IsThumbsUp",e.isThumbsUp),i(n,c,"EntryPoint",e.entryPoint),i(n,c,"Verb",e.verb),i(n,c,"InteractionId",e.interactionId),n.push(t("zC.".concat(c),"Office.System.Copilot")),n}}(u||(u={})),function(e){var n,a="Asha";(n=e.EventType||(e.EventType={})).Pillar="Pillar",n.Error="Error",e.getFields=function(e){var n=[];return i(n,a,"EventType",e.eventType),i(n,a,"Pillar",e.pillar),i(n,a,"Scenario",e.scenario),i(n,a,"Veto",e.veto),i(n,a,"Error",e.error),r(n,a,"InStaging",e.inStaging),r(n,a,"IsSessionEndingError",e.isSessionEndingError),r(n,a,"IsIntentional",e.isIntentional),r(n,a,"IsInternal",e.isInternal),n.push(t("zC.".concat(a),"Office.System.Asha")),n}}(f||(f={}));var _,h=(_=[],{fireEvent:function(e){_.forEach(function(t){return t(e)})},addListener:function(e){e&&_.push(e)}});function b(e,t,n){h.fireEvent({level:e,category:t,message:n})}function g(e,t,n){b(0,e,function(){var e=n instanceof Error?n.message:"";return"".concat(t,": ").concat(e)})}var v="function",y="object",S="undefined",D=Object,I=D.prototype,x=D.assign,C=D.create,O=D.defineProperty,w=I.hasOwnProperty,E=null;function A(e){void 0===e&&(e=!0);var t=!1===e?null:E;return t||(typeof globalThis!==S&&(t=globalThis),t||typeof self===S||(t=self),t||typeof window===S||(t=window),t||typeof c.g===S||(t=c.g),E=t),t}function L(e){throw new TypeError(e)}function k(e){if(C)return C(e);if(null==e)return{};var t=typeof e;function n(){}return t!==y&&t!==v&&L("Object prototype may only be an Object:"+e),n.prototype=e,new n}var M="",P="extensionConfig",T=O,U=D.freeze,F=(D.seal,D.keys),H=String.prototype,R=H.trim,N=H.endsWith,B=H.startsWith,j=Date.prototype.toISOString,V=Array.isArray,z=I.toString,G=w.toString,K=G.call(D),W=/-([a-z])/g,q=/([^\w\d_$])/g,Q=/^(\d+[\w\d_$])/,Y=Object.getPrototypeOf;function J(e){return void 0===e||typeof e===S}function X(e){return null===e||J(e)}function Z(e){return!X(e)}function $(e,t){return!(!e||!w.call(e,t))}function ee(e){return!(!e||typeof e!==y)}function te(e){return!(!e||typeof e!==v)}function ne(e){var t=e;return t&&se(t)&&(t=(t=(t=t.replace(W,function(e,t){return t.toUpperCase()})).replace(q,"_")).replace(Q,function(e,t){return"_"+t})),t}function ae(e,t){if(e)for(var n in e)w.call(e,n)&&t.call(e,n,e[n])}function ie(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=B?e.startsWith(t):function(e,t){var n=!1,a=t?t.length:0;if(e&&a&&e.length>=a&&!(n=e===t)){for(var i=0;i<a;i++)if(e[i]!==t[i])return!1;n=!0}return n}(e,t)),n}function re(e,t){return!(!e||!t)&&-1!==e.indexOf(t)}var oe=V||function(e){return!(!e||"[object Array]"!==z.call(e))};function se(e){return"string"==typeof e}function ce(e){return"number"==typeof e}function de(e){return"boolean"==typeof e}function le(e){var t=!1;if(e&&"object"==typeof e){var n=Y?Y(e):function(e){if(e){if(Y)return Y(e);var t=e.__proto__||e.prototype||e.constructor;if(t)return t}return null}(e);n?(n.constructor&&w.call(n,"constructor")&&(n=n.constructor),t=typeof n===v&&G.call(n)===K):t=!0}return t}function ue(e){if(e)return j?e.toISOString():function(e){if(e&&e.getUTCFullYear){var t=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}(e)}function fe(e,t,n){var a=e.length;try{for(var i=0;i<a&&(!(i in e)||-1!==t.call(n||e,e[i],i,e));i++);}catch(e){}}function pe(e,t,n){if(e){if(e.indexOf)return e.indexOf(t,n);var a=e.length,i=n||0;try{for(var r=Math.max(i>=0?i:a-Math.abs(i),0);r<a;r++)if(r in e&&e[r]===t)return r}catch(e){}}return-1}function me(e){return e&&(e=R&&e.trim?e.trim():e.replace?e.replace(/^\s+|(?=\s)\s+$/g,M):e),e}var _e=!{toString:null}.propertyIsEnumerable("toString"),he=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function be(e){var t=typeof e;if(t===v||t===y&&null!==e||L("objKeys called on non-object"),!_e&&F)return F(e);var n=[];for(var a in e)e&&w.call(e,a)&&n.push(a);if(_e)for(var i=he.length,r=0;r<i;r++)e&&w.call(e,he[r])&&n.push(he[r]);return n}function ge(e,t,n,a){if(T)try{var i={enumerable:!0,configurable:!0};return n&&(i.get=n),a&&(i.set=a),T(e,t,i),!0}catch(e){}return!1}var ve=U||function(e){return e};function ye(){var e=Date;return e.now?e.now():(new e).getTime()}function Se(e){return function(e){return!(!e||"[object Error]"!==z.call(e))}(e)?e.name:M}function De(e,t,n,a,i){var r=n;return e&&((r=e[t])===n||i&&!i(r)||a&&!a(n)||(r=n,e[t]=r)),r}function Ie(e,t,n){var a;return e?!(a=e[t])&&X(a)&&(a=J(n)?{}:n,e[t]=a):a=J(n)?{}:n,a}function xe(e,t){return X(e)?t:e}function Ce(e){return!!e}function Oe(e){throw new Error(e)}function we(e,t,n,a,i){e&&t&&n&&(!1!==i||J(e[t]))&&(e[t]=function(e,t){var n=null,a=null;return te(e)?n=e:a=e,function(){var e=arguments;if(n&&(a=n()),a)return a[t].apply(a,e)}}(n,a))}function Ee(e){return e&&x&&(e=D(x({},e))),e}function Ae(e,t,n,a,i,r){var o=arguments,s=o[0]||{},c=o.length,d=!1,l=1;for(c>0&&de(s)&&(d=s,s=o[l]||{},l++),ee(s)||(s={});l<c;l++){var u=o[l],f=oe(u),p=ee(u);for(var m in u){var _=f&&m in u||p&&w.call(u,m);if(_){var h=u[m],b=void 0;if(d&&h&&((b=oe(h))||le(h))){var g=s[m];b?oe(g)||(g=[]):le(g)||(g={}),h=Ae(d,g,h)}void 0!==h&&(s[m]=h)}}}return s}var Le="User.PrimaryIdentityHash",ke="User.PrimaryIdentitySpace",Me="User.TenantId",Pe="User.IsAnonymous",Te="User.IsSignedIn";function Ue(e,t,n,a){var i=!0;if(t)for(var r=function(t){var r,o=t.classification,s=t.dataType,c=t.name;if(o&&!(4===o||1===o||2===a&&32===o||3===a&&2048===o))return i=!1,"break";if(3===a&&n&&3!==s&&1!==s&&2!==s&&"OTelJS.Version"!==c&&"OTelJS.Sink"!==c)return b(0,1,function(){return"DNM: Invalid field type "+c}),i=!1,"break";r=n?"zC."===c.substr(0,3)?"zC.Data."+c.substr(3):"Data."+c:c;var d=void 0;switch(s){case 3:d=6;break;case 2:d=4;break;case 4:d=8;break;case 0:return e[r]="string"==typeof t.value?t.value.substr(0,25e3):t.value,"continue";default:return e[r]=t.value,"continue"}var l={value:t.value,propertyType:d};e[r]=l},o=0,s=t;o<s.length&&"break"!==r(s[o]);o++);return i}function Fe(e){b(0,1,function(){return"Invalid "+e})}function He(e){return se(e)&&""!=e}function Re(e,t){return Object.values(t).includes(e)}function Ne(e){return Re(e,o)}function Be(e){return Re(e,l)}function je(e){return["MSACID","MSAPUID","OrgIdCID","OrgIdPUID","UserObjectId","Other"].includes(e)}function Ve(e){return!e||"Other"==e}function ze(e,t){var n=!0;function a(t,a){a(e[t])||(Fe(t),n=!1)}function i(e){return new RegExp("^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$",t?"":"i").test(e)}return a("App.Name",He),a("App.Platform",t?Ne:He),a("App.Version",He),a("Session.Id",i),t?(a("Release.AudienceGroup",Be),a(Te,de),e[Te]?(a(Le,He),a(ke,je),["OrgIdCID","OrgIdPUID","UserObjectId"].includes(e[ke])?a(Me,i):a(Me,X)):(a(ke,Ve),a(Me,X))):e[Pe]||!1===e[Te]||(a(Le,He),a(ke,He),e[Me]&&a(Me,i)),X(e[Pe])||e[Te]!==e[Pe]||(Fe(Pe),n=!1),n}var Ge={};function Ke(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?Ge[e]?(t.ariaTenantToken&&(Ge[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(Ge[e].dnmToken=t.dnmToken)):Ge[e]=t:b(0,0,function(){return"Namespace: ".concat(e)})}function We(e,t){for(var n=e.length;n>0;){var a=e.substr(0,n);if(Ge[a]){var i=Ge[a];return t.ariaTenantToken=i.ariaTenantToken,t.dnmToken=i.dnmToken,!0}n=e.lastIndexOf(".",n-1)}return!1}var qe=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,Qe=/^[a-zA-Z0-9_\.]{1,95}$/;function Ye(e){return Qe.test(e)}function Je(e){e&&e.forEach(function(e){if("string"!=typeof e.name||!Ye(e.name))throw new Error("Invalid dataField name");2===e.dataType&&function(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<-9007199254740991||e>9007199254740991)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)})}function Xe(t){var n={eventName:t.eventName,eventFlags:t.eventFlags||{},telemetryProperties:t.telemetryProperties?(0,e.__assign)({},t.telemetryProperties):{},dataFields:t.dataFields?t.dataFields.slice():[],timestamp:t.timestamp||(new Date).getTime()};return t.eventContract&&(n.eventContract={name:t.eventContract.name,dataFields:t.eventContract.dataFields.slice()}),n}!function(){function a(t,n,a){var i,r,o;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=a||{},t&&(this.telemetrySinks=t.telemetrySinks,(i=this.persistentDataFields).push.apply(i,t.persistentDataFields),this.config=(0,e.__assign)((0,e.__assign)({},t.getConfig()),this.config),(r=this.partAFields).push.apply(r,t.partAFields)),n&&(o=this.persistentDataFields).push.apply(o,n)}a.prototype.addEventContentType=function(e,t){e.push(n("EventContent.Type",2,t,undefined))},a.prototype.sendTelemetryEvent=function(e){var t=Xe(e),n=t.telemetryProperties;n.nexusTenantToken=-1;var a=n.ariaTenantToken;a||We(t.eventName,n)||a?this.sendTelemetryEventInternal(t,1):b(0,0,function(){return"No tenant token: "+e.eventName})},a.prototype.sendNonStandardEvent=function(e,t){var n=Xe(e);this.sendTelemetryEventInternal(n,t)},a.prototype.sendCustomerContent=function(e){var t=Xe(e),n=t.telemetryProperties,a=n.customerContentVersion;return(!a||a>2)&&(n.customerContentVersion=2),n.ariaTenantToken=void 0,n.nexusTenantToken=void 0,n.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},a.prototype.sendDirectNumericEvent=function(e){var t=Xe(e),n=t.telemetryProperties;n.dnmToken||We(t.eventName,n)||n.dnmToken?(this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)):b(0,0,function(){return"No dnm token: "+t.eventName})},a.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):b(1,0,function(){return"No telemetry sinks are attached."}));this.processTelemetryEvent(e,t)}catch(e){return void g(0,"SendTelemetryEvent",e)}this.telemetrySinks.forEach(function(n){try{3===t||2===t?n.sendNonStandardEvent&&n.sendNonStandardEvent(e,t):n.sendTelemetryEvent(e)}catch(e){}})}else b(0,0,function(){return"Customer content"})},a.prototype.processTelemetryEvent=function(e,n){var a,i,r;if(e.dataFields&&(null===(r=e.dataFields)||void 0===r||r.unshift(t("OTelJS.Version","4.20.7")),3!==n&&this.persistentDataFields&&(a=e.dataFields).unshift.apply(a,this.persistentDataFields)),this.partAFields.length>0){var o=e.eventContract||{name:"",dataFields:[]};(i=o.dataFields).push.apply(i,this.partAFields),e.eventContract=o}this.config.disableValidation||function(e){if(!(t=e.eventName)||t.length>98||!qe.test(t))throw new Error("Invalid eventName");var t,n=e.eventContract;if(n){if(n.name&&!Ye(n.name))throw new Error("Invalid eventContract");Je(n.dataFields)}Je(e.dataFields)}(e)},a.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},a.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,n=e;t<n.length;t++){var a=n[t],i=a[0],r=a[1];this.sendTelemetryEventInternal(i,r)}},a.prototype.setTenantToken=function(e,t,n){Ke(e,{ariaTenantToken:t,nexusTenantToken:n})},a.prototype.setDNMToken=function(e,t){Ke(e,{dnmToken:t})},a.prototype.cloneEvent=function(e){return Xe(e)},a.prototype.getConfig=function(){return this.config}}();var Ze,$e,et="undefined",tt="prototype",nt="function",at="_dynClass",it="_unknown_",rt=Object,ot=rt.getPrototypeOf,st=rt.getOwnPropertyNames,ct=(typeof globalThis!==et&&($e=globalThis),$e||typeof self===et||($e=self),$e||typeof window===et||($e=window),$e||typeof c.g===et||($e=c.g),$e||{}),dt=ct.__dynProto$Gbl||(ct.__dynProto$Gbl={o:(Ze={},Ze.setInstFuncs=!0,Ze.useBaseInst=!0,Ze),n:1e3});function lt(e,t){return e&&rt.prototype.hasOwnProperty.call(e,t)}function ut(e){return e&&(e===rt.prototype||e===Array.prototype)}function ft(e){return ut(e)||e===Function.prototype}function pt(e){var t;if(e){if(ot)return ot(e);var n=e.__proto__||e.prototype||(e.constructor?e.constructor.prototype:null);t=e._dyn__proto__||n,lt(e,"_dyn__proto__")||(delete e._dynInstProto,t=e._dyn__proto__=e._dynInstProto||e._dyn__proto__,e._dynInstProto=n)}return t}function mt(e,t){var n=[];if(st)n=st(e);else for(var a in e)"string"==typeof a&&lt(e,a)&&n.push(a);if(n&&n.length>0)for(var i=0;i<n.length;i++)t(n[i])}function _t(e,t,n){return"constructor"!==t&&typeof e[t]===nt&&(n||lt(e,t))}function ht(e){throw new TypeError("DynamicProto: "+e)}function bt(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function gt(e,t,n,a){var i=null;if(e&&lt(n,at)){var r=e._dynInstFuncs||{};if((i=(r[n._dynClass]||{})[t])||ht("Missing ["+t+"] "+nt),!i._dynInstChk&&!1!==r._dynInstChk){for(var o=!lt(e,t),s=pt(e),c=[];o&&s&&!ft(s)&&!bt(c,s);){var d=s[t];if(d){o=d===a;break}c.push(s),s=pt(s)}try{o&&(e[t]=i),i._dynInstChk=1}catch(e){r._dynInstChk=!1}}}return i}function vt(e,t,n){var a=t[e];return a===n&&(a=pt(t)[e]),typeof a!==nt&&ht("["+e+"] is not a "+nt),a}function yt(e,t){return lt(e,tt)?e.name||t||it:((e||{}).constructor||{}).name||t||it}function St(e,t,n,a){lt(e,tt)||ht("theClass is an invalid class definition.");var i=e.prototype;(function(e,t){if(ot){for(var n=[],a=pt(t);a&&!ft(a)&&!bt(n,a);){if(a===e)return!0;n.push(a),a=pt(a)}return!1}return!0})(i,t)||ht("["+yt(e)+"] not in hierarchy of ["+yt(t)+"]");var r=null;lt(i,at)?r=i._dynClass:(r="_dynCls$"+yt(e,"_")+"$"+dt.n,dt.n++,i._dynClass=r);var o=St._dfOpts,s=!!o.useBaseInst;s&&a&&void 0!==a.useBaseInst&&(s=!!a.useBaseInst);var c=function(e){var t={};return mt(e,function(n){!t[n]&&_t(e,n,!1)&&(t[n]=e[n])}),t}(t),d=function(e,t,n,a){function i(e,t,n){var i=t[n];if(i._isDynProxy&&a){var r=e._dynInstFuncs||{};!1!==r._dynInstChk&&(i=(r[t._dynClass]||{})[n]||i)}return function(){return i.apply(e,arguments)}}var r={};mt(n,function(e){r[e]=i(t,n,e)});for(var o=pt(e),s=[];o&&!ft(o)&&!bt(s,o);)mt(o,function(e){!r[e]&&_t(o,e,!ot)&&(r[e]=i(t,o,e))}),s.push(o),o=pt(o);return r}(i,t,c,s);n(t,d);var l=!!ot&&!!o.setInstFuncs;l&&a&&(l=!!a.setInstFuncs),function(e,t,n,a,i){if(!ut(e)){var r=n._dynInstFuncs=n._dynInstFuncs||{},o=r[t]=r[t]||{};!1!==r._dynInstChk&&(r._dynInstChk=!!i),mt(n,function(t){_t(n,t,!1)&&n[t]!==a[t]&&(o[t]=n[t],delete n[t],(!lt(e,t)||e[t]&&!e[t]._isDynProxy)&&(e[t]=function(e,t){var n=function(){return(gt(this,t,e,n)||vt(t,e,n)).apply(this,arguments)};return n._isDynProxy=1,n}(e,t)))})}}(i,r,t,c,!1!==l)}St._dfOpts=dt.o;var Dt="window",It="JSON",xt="XMLHttpRequest",Ct=null,Ot=null,wt=null,Et=null;function At(e,t){var n=!1;if(e){try{if(!(n=t in e)){var a=e.prototype;a&&(n=t in a)}}catch(e){}if(!n)try{n=!J((new e)[t])}catch(e){}}return n}function Lt(e){var t=A();return t&&t[e]?t[e]:e===Dt&&kt()?window:null}function kt(){return Boolean(typeof window===y&&window)}function Mt(){return kt()?window:Lt(Dt)}function Pt(){return Boolean(typeof document===y&&document)?document:Lt("document")}function Tt(){return Boolean(typeof navigator===y&&navigator)}function Ut(){return Tt()?navigator:Lt("navigator")}function Ft(e){return typeof location===y&&location?location:Lt("location")}function Ht(){return Boolean(typeof JSON===y&&JSON||null!==Lt(It))}function Rt(){return Ht()?JSON||Lt(It):null}function Nt(){var e=Ut();return!(!e||!e.product)&&"ReactNative"===e.product}function Bt(){var e=Ut();if(e&&(e.userAgent!==Ot||null===Ct)){var t=((Ot=e.userAgent)||M).toLowerCase();Ct=re(t,"msie")||re(t,"trident/")}return Ct}function jt(e){var t=Object.prototype.toString.call(e),n=M;return"[object Error]"===t?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":Ht()&&(n=Rt().stringify(e)),t+n}function Vt(){return null===Et&&(Et=Tt()&&Boolean(Ut().sendBeacon)),Et}function zt(e){var t=!1;try{t=!!Lt("fetch");var n=Lt("Request");t&&e&&n&&(t=At(n,"keepalive"))}catch(e){}return t}function Gt(){var e=!1;try{e=!!Lt(xt)}catch(e){}return e}var Kt,Wt=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],qt=null;function Qt(e,t){return function(){var n=arguments,a=Yt(t);if(a){var i=a.listener;i&&i[e]&&i[e].apply(i,n)}}}function Yt(e){var t,n=qt;return n||!0===e.disableDbgExt||(n=qt||((t=Lt("Microsoft"))&&(qt=t.ApplicationInsights),qt)),n?n.ChromeDbgExt:null}function Jt(e){if(!Kt){Kt={};for(var t=0;t<Wt.length;t++)Kt[Wt[t]]=Qt(Wt[t],e)}return Kt}function Xt(e){return e?'"'+e.replace(/\"/g,M)+'"':M}function Zt(e,t){var n=typeof console!==S?console:Lt("console");if(n){var a="log";n[e]&&(a=e),te(n[a])&&n[a](t)}}var $t=function(){function e(e,t,n,a){void 0===n&&(n=!1);var i=this;i.messageId=e,i.message=(n?"AI: ":"AI (Internal): ")+e;var r=M;Ht()&&(r=Rt().stringify(a));var o=(t?" message:"+Xt(t):M)+(a?" props:"+Xt(r):M);i.message+=o}return e.dataType="MessageData",e}(),en=function(){function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n,a,i,r,o=0,s={};St(e,this,function(e){function c(t,n){if(!(o>=i)){var r=!0,c="AITR_"+n.messageId;if(s[c]?r=!1:s[c]=!0,r&&(t<=a&&(e.queue.push(n),o++,d(1===t?"error":"warn",n)),o===i)){var l="Internal events throttle limit per PageView reached for this app.",u=new $t(23,l,!1);e.queue.push(u),1===t?e.errorToConsole(l):e.warnToConsole(l)}}}function d(e,n){var a=Yt(t||{});a&&a.diagLog&&a.diagLog(e,n)}!function(e){n=xe(e.loggingLevelConsole,0),a=xe(e.loggingLevelTelemetry,1),i=xe(e.maxMessageLimit,25),r=xe(e.enableDebug,xe(e.enableDebugExceptions,!1))}(t||{}),e.consoleLoggingLevel=function(){return n},e.telemetryLoggingLevel=function(){return a},e.maxInternalMessageLimit=function(){return i},e.enableDebugExceptions=function(){return r},e.throwInternal=function(t,a,i,o,l){void 0===l&&(l=!1);var u=new $t(a,i,l,o);if(r)throw jt(u);var f=1===t?"errorToConsole":"warnToConsole";if(J(u.message))d("throw"+(1===t?"Critical":"Warning"),u);else{if(l){var p=+u.messageId;!s[p]&&n>=t&&(e[f](u.message),s[p]=!0)}else n>=t&&e[f](u.message);c(t,u)}},e.warnToConsole=function(e){Zt("warn",e),d("warning",e)},e.errorToConsole=function(e){Zt("error",e),d("error",e)},e.resetInternalMessageCount=function(){o=0,s={}},e.logInternalMessage=c})}return e.__ieDyn=1,e}();function tn(e){return e||new en}function nn(e,t,n,a,i,r){void 0===r&&(r=!1),tn(e).throwInternal(t,n,a,i,r)}function an(e,t){tn(e).warnToConsole(t)}var rn="toGMTString",on="toUTCString",sn=null,cn=null,dn=null,ln=Pt(),un={},fn={};function pn(e){return!e||e.isEnabled()}function mn(e,t){return!!(t&&e&&oe(e.ignoreCookies))&&-1!==e.ignoreCookies.indexOf(t)}function _n(e,t){var n,a=function(e){var t=e.cookieCfg=e.cookieCfg||{};if(De(t,"domain",e.cookieDomain,Z,X),De(t,"path",e.cookiePath||"/",null,X),X(t.enabled)){var n=void 0;J(e.isCookieUseDisabled)||(n=!e.isCookieUseDisabled),J(e.disableCookiesUsage)||(n=!e.disableCookiesUsage),t.enabled=n}return t}(e||fn),i=a.path||"/",r=a.domain,o=!1!==a.enabled,s=((n={isEnabled:function(){var e=o&&hn(t),n=fn._ckMgr;return e&&n&&s!==n&&(e=pn(n)),e}}).setEnabled=function(e){o=!1!==e},n.set=function(e,t,n,o,c){var d,l=!1;if(pn(s)&&!function(e,t){return!!(t&&e&&oe(e.blockedCookies)&&-1!==e.blockedCookies.indexOf(t))||mn(e,t)}(a,e)){var u={},f=me(t||M),p=f.indexOf(";");if(-1!==p&&(f=me(t.substring(0,p)),u=bn(t.substring(p+1))),De(u,"domain",o||r,Ce,J),!X(n)){var m=Bt();if(J(u.expires)){var _=ye()+1e3*n;if(_>0){var h=new Date;h.setTime(_),De(u,"expires",gn(h,m?rn:on)||gn(h,m?rn:on)||M,Ce)}}m||De(u,"max-age",M+n,null,J)}var b=Ft();b&&"https:"===b.protocol&&(De(u,"secure",null,null,J),null===cn&&(d=(Ut()||{}).userAgent,cn=!(se(d)&&(re(d,"CPU iPhone OS 12")||re(d,"iPad; CPU OS 12")||re(d,"Macintosh; Intel Mac OS X 10_14")&&re(d,"Version/")&&re(d,"Safari")||re(d,"Macintosh; Intel Mac OS X 10_14")&&function(e,t){var n=!1;return e&&!(n=e===t)&&(n=N?e.endsWith(t):function(e,t){var n=!1,a=t.length,i=e?e.length:0;if(a&&i&&i>=a&&!(n=e===t)){for(var r=i-1,o=a-1;o>=0;o--){if(e[r]!=t[o])return!1;r--}n=!0}return n}(e,t)),n}(d,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||re(d,"Chrome/5")||re(d,"Chrome/6")||re(d,"UnrealEngine")&&!re(d,"Chrome")||re(d,"UCBrowser/12")||re(d,"UCBrowser/11")))),cn&&De(u,"SameSite","None",null,J)),De(u,"path",c||i,null,J),(a.setCookie||Sn)(e,vn(f,u)),l=!0}return l},n.get=function(e){var t=M;return pn(s)&&!mn(a,e)&&(t=(a.getCookie||yn)(e)),t},n.del=function(e,t){var n=!1;return pn(s)&&(n=s.purge(e,t)),n},n.purge=function(e,n){var i,r=!1;if(hn(t)){var o=((i={}).path=n||"/",i.expires="Thu, 01 Jan 1970 00:00:01 GMT",i);Bt()||(o["max-age"]="0"),(a.delCookie||Sn)(e,vn(M,o)),r=!0}return r},n);return s._ckMgr=s,s}function hn(e){if(null===sn){sn=!1;try{sn=void 0!==(ln||{}).cookie}catch(t){nn(e,2,68,"Cannot access document.cookie - "+Se(t),{exception:jt(t)})}}return sn}function bn(e){var t={};return e&&e.length&&fe(me(e).split(";"),function(e){if(e=me(e||M)){var n=e.indexOf("=");-1===n?t[e]=null:t[me(e.substring(0,n))]=me(e.substring(n+1))}}),t}function gn(e,t){return te(e[t])?e[t]():null}function vn(e,t){var n=e||M;return ae(t,function(e,t){n+="; "+e+(X(t)?M:"="+t)}),n}function yn(e){var t=M;if(ln){var n=ln.cookie||M;dn!==n&&(un=bn(n),dn=n),t=me(un[e]||M)}return t}function Sn(e,t){ln&&(ln.cookie=e+"="+t)}var Dn=4294967296,In=4294967295,xn=!1,Cn=123456789,On=987654321;function wn(e){var t=0,n=Lt("crypto")||Lt("msCrypto");return n&&n.getRandomValues&&(t=n.getRandomValues(new Uint32Array(1))[0]&In),0===t&&Bt()&&(xn||function(){try{var e=2147483647&ye();(t=(Math.random()*Dn^e)+e)<0&&(t>>>=0),Cn=123456789+t&In,On=987654321-t&In,xn=!0}catch(e){}var t}(),t=function(e){var t=((On=36969*(65535&On)+(On>>16)&In)<<16)+(65535&(Cn=18e3*(65535&Cn)+(Cn>>16)&In))>>>0&In|0;return t>>>=0}()&In),0===t&&(t=Math.floor(Dn*Math.random()|0)),e||(t>>>=0),t}var En=O,An="."+function(e){void 0===e&&(e=22);for(var t=wn()>>>0,n=0,a=M;a.length<e;)n++,a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===n&&(t=(wn()<<2&4294967295|3&t)>>>0,n=0);return a}(6),Ln=0;function kn(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType}function Mn(e,t){return void 0===t&&(t=!1),ne(e+Ln+++(t?".2.8.16":M)+An)}function Pn(e){var t={id:Mn("_aiData-"+(e||M)+".2.8.16"),accept:function(e){return kn(e)},get:function(e,n,a,i){var r=e[t.id];return r?r[ne(n)]:(i&&((r=function(e,t){var n=t[e.id];if(!n){n={};try{kn(t)&&(function(e,t,n){if(En)try{return En(e,t,{value:n,enumerable:!1,configurable:!0}),!0}catch(e){}return!1}(t,e.id,n)||(t[e.id]=n))}catch(e){}}return n}(t,e))[ne(n)]=a),a)},kill:function(e,t){if(e&&e[t])try{delete e[t]}catch(e){}}};return t}var Tn="events",Un="visibilitychange",Fn="pagehide",Hn="pageshow",Rn="unload",Nn="beforeunload",Bn=Mn("aiEvtPageHide"),jn=Mn("aiEvtPageShow"),Vn=/\.[\.]+/g,zn=/[\.]+$/,Gn=1,Kn=Pn("events"),Wn=/^([^.]*)(?:\.(.+)|)/;function qn(e){return e&&e.replace?e.replace(/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,M):e}function Qn(e,t){var n;if(t){var a=M;oe(t)?(a=M,fe(t,function(e){(e=qn(e))&&("."!==e[0]&&(e="."+e),a+=e)})):a=qn(t),a&&("."!==a[0]&&(a="."+a),e=(e||M)+a)}var i=Wn.exec(e||M)||[];return(n={}).type=i[1],n.ns=(i[2]||M).replace(Vn,".").replace(zn,M).split(".").sort().join("."),n}function Yn(e,t,n){void 0===n&&(n=!0);var a=Kn.get(e,Tn,{},n),i=a[t];return i||(i=a[t]=[]),i}function Jn(e,t,n,a){e&&t&&t.type&&(e.removeEventListener?e.removeEventListener(t.type,n,a):e.detachEvent&&e.detachEvent("on"+t.type,n))}function Xn(e,t,n,a){for(var i=t.length;i--;){var r=t[i];r&&(n.ns&&n.ns!==r.evtName.ns||a&&!a(r)||(Jn(e,r.evtName,r.handler,r.capture),t.splice(i,1)))}}function Zn(e,t){return t?Qn("xx",oe(t)?[e].concat(t):[e,t]).ns.split("."):e}function $n(e,t,n,a,i){var r;void 0===i&&(i=!1);var o=!1;if(e)try{var s=Qn(t,a);if(o=function(e,t,n,a){var i=!1;return e&&t&&t.type&&n&&(e.addEventListener?(e.addEventListener(t.type,n,a),i=!0):e.attachEvent&&(e.attachEvent("on"+t.type,n),i=!0)),i}(e,s,n,i),o&&Kn.accept(e)){var c=((r={guid:Gn++,evtName:s}).handler=n,r.capture=i,r);Yn(e,s.type).push(c)}}catch(e){}return o}function ea(e,t,n,a,i){if(void 0===i&&(i=!1),e)try{var r=Qn(t,a),o=!1;!function(e,t,n){if(t.type)Xn(e,Yn(e,t.type),t,n);else{var a=Kn.get(e,Tn,{});ae(a,function(a,i){Xn(e,i,t,n)}),0===be(a).length&&Kn.kill(e,Tn)}}(e,r,function(e){return!((!r.ns||n)&&e.handler!==n||(o=!0,0))}),o||Jn(e,r,n,i)}catch(e){}}function ta(e,t,n,a){var i=!1;return t&&e&&e.length>0&&fe(e,function(e){e&&(n&&-1!==pe(n,e)||(i=function(e,t,n){var a=!1,i=Mt();i&&(a=$n(i,e,t,n),a=$n(i.body,e,t,n)||a);var r=Pt();return r&&(a=$n(r,e,t,n)||a),a}(e,t,a)||i))}),i}function na(e,t,n){e&&oe(e)&&fe(e,function(e){e&&function(e,t,n){var a=Mt();a&&(ea(a,e,t,n),ea(a.body,e,t,n));var i=Pt();i&&ea(i,e,t,n)}(e,t,n)})}function aa(e,t,n){var a=Zn(Bn,n),i=ta([Fn],e,t,a);return t&&-1!==pe(t,Un)||(i=ta([Un],function(t){var n=Pt();e&&n&&"hidden"===n.visibilityState&&e(t)},t,a)||i),!i&&t&&(i=aa(e,null,n)),i}function ia(e,t,n){var a=Zn(jn,n),i=ta([Hn],e,t,a);return!(i=ta([Un],function(t){var n=Pt();e&&n&&"visible"===n.visibilityState&&e(t)},t,a)||i)&&t&&(i=ia(e,null,n)),i}var ra=((A()||{}).Symbol,(A()||{}).Reflect,function(e,t){return ra=D.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},ra(e,t)});function oa(e,t){function n(){this.constructor=e}typeof t!==v&&null!==t&&L("Class extends value "+String(t)+" is not a constructor or null"),ra(e,t),e.prototype=null===t?k(t):(n.prototype=t.prototype,new n)}function sa(e,t){for(var n=0,a=t.length,i=e.length;n<a;n++,i++)e[i]=t[n];return e}var ca=function(){function e(t,n,a){var i,r=this,o=!1;r.start=ye(),r.name=t,r.isAsync=a,r.isChildEvt=function(){return!1},te(n)&&(o=ge(r,"payload",function(){return!i&&te(n)&&(i=n(),n=null),i})),r.getCtx=function(t){return t?t===e.ParentContextKey||t===e.ChildrenContextKey?r[t]:(r.ctx||{})[t]:null},r.setCtx=function(t,n){t&&(t===e.ParentContextKey?(r[t]||(r.isChildEvt=function(){return!0}),r[t]=n):t===e.ChildrenContextKey?r[t]=n:(r.ctx=r.ctx||{})[t]=n)},r.complete=function(){var t=0,a=r.getCtx(e.ChildrenContextKey);if(oe(a))for(var i=0;i<a.length;i++){var s=a[i];s&&(t+=s.time)}r.time=ye()-r.start,r.exTime=r.time-t,r.complete=function(){},!o&&te(n)&&(r.payload=n())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),da=function(){function e(t){this.ctx={},St(e,this,function(e){e.create=function(e,t,n){return new ca(e,t,n)},e.fire=function(e){e&&(e.complete(),t&&te(t.perfEvent)&&t.perfEvent(e))},e.setCtx=function(t,n){t&&((e.ctx=e.ctx||{})[t]=n)},e.getCtx=function(t){return(e.ctx||{})[t]}})}return e.__ieDyn=1,e}(),la="CoreUtils.doPerf";function ua(e,t,n,a,i){if(e){var r=e;if(r.getPerfMgr&&(r=r.getPerfMgr()),r){var o=void 0,s=r.getCtx(la);try{if(o=r.create(t(),a,i)){if(s&&o.setCtx&&(o.setCtx(ca.ParentContextKey,s),s.getCtx&&s.setCtx)){var c=s.getCtx(ca.ChildrenContextKey);c||(c=[],s.setCtx(ca.ChildrenContextKey,c)),c.push(o)}return r.setCtx(la,o),n(o)}}catch(e){o&&o.setCtx&&o.setCtx("exception",e)}finally{o&&r.fire(o),r.setCtx(la,s)}}}return n()}function fa(e,t,n){return!(!e||e.length!==t||e===n||!e.match(/^[\da-f]*$/i))}var pa=Pn("plugin");function ma(e){return pa.get(e,"state",{},!0)}function _a(e,t){for(var n,a=[],i=null,r=e.getNext();r;){var o=r.getPlugin();o&&(i&&te(i.setNextPlugin)&&te(o.processTelemetry)&&i.setNextPlugin(o),(te(o.isInitialized)?o.isInitialized():(n=ma(o)).isInitialized)||a.push(o),i=o,r=r.getNext())}fe(a,function(a){var i=e.core();a.initialize(e.getCfg(),i,t,e.getNext()),n=ma(a),a.core||n.core||(n.core=i),n.isInitialized=!0,delete n.teardown})}function ha(e){return e.sort(function(e,t){var n=0;if(t){var a=te(t.processTelemetry);te(e.processTelemetry)?n=a?e.priority-t.priority:1:a&&(n=-1)}else n=e?1:-1;return n})}var ba=0;function ga(e,t,n,a){var i=null,r=[];null!==a&&(i=a?function(e,t,n){for(;e;){if(e.getPlugin()===n)return e;e=e.getNext()}return Da([n],t.config||{},t)}(e,n,a):e);var o={_next:function(){var e=i;if(i=e?e.getNext():null,!e){var t=r;t&&t.length>0&&(fe(t,function(e){try{e.func.call(e.self,e.args)}catch(e){nn(n.logger,2,73,"Unexpected Exception during onComplete - "+jt(e))}}),r=[])}return e},ctx:{core:function(){return n},diagLog:function(){return function(e,t){return(e||{}).logger||new en(t)}(n,t)},getCfg:function(){return t},getExtCfg:s,getConfig:function(e,n,a){void 0===a&&(a=!1);var i,r=s(e,null);return r&&!X(r[n])?i=r[n]:t&&!X(t[n])&&(i=t[n]),X(i)?a:i},hasNext:function(){return!!i},getNext:function(){return i},setNext:function(e){i=e},iterate:function(e){for(var t;t=o._next();){var n=t.getPlugin();n&&e(n)}},onComplete:function(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];e&&r.push({func:e,self:J(t)?o.ctx:t,args:n})}}};function s(e,n,a){var i;if(void 0===n&&(n={}),void 0===a&&(a=0),t){var r=t.extensionConfig;r&&e&&(i=r[e])}if(i){if(ee(n)&&0!==a){var o=Ae(!0,n,i);t&&2===a&&ae(n,function(e){if(X(o[e])){var n=t[e];X(n)||(o[e]=n)}}),i=o}}else i=n;return i}return o}function va(e,t,n,a){var i=ga(e,t,n,a),r=i.ctx;return r.processNext=function(e){var t=i._next();return t&&t.processTelemetry(e,r),!t},r.createNew=function(e,a){return void 0===e&&(e=null),oe(e)&&(e=Da(e,t,n,a)),va(e||r.getNext(),t,n,a)},r}function ya(e,t,n){var a=t.config||{},i=ga(e,a,t,n),r=i.ctx;return r.processNext=function(e){var t=i._next();return t&&t.unload(r,e),!t},r.createNew=function(e,n){return void 0===e&&(e=null),oe(e)&&(e=Da(e,a,t,n)),ya(e||r.getNext(),t,n)},r}function Sa(e,t,n){var a=t.config||{},i=ga(e,a,t,n).ctx;return i.processNext=function(e){return i.iterate(function(t){te(t.update)&&t.update(i,e)})},i.createNew=function(e,n){return void 0===e&&(e=null),oe(e)&&(e=Da(e,a,t,n)),Sa(e||i.getNext(),t,n)},i}function Da(e,t,n,a){var i=null,r=!a;if(oe(e)&&e.length>0){var o=null;fe(e,function(e){if(r||a!==e||(r=!0),r&&e&&te(e.processTelemetry)){var s=function(e,t,n){var a,i=null,r=te(e.processTelemetry),o=te(e.setNextPlugin),s={getPlugin:function(){return e},getNext:function(){return i},processTelemetry:function(a,d){c(d=d||function(){var a;return e&&te(e._getTelCtx)&&(a=e._getTelCtx()),a||(a=va(s,t,n)),a}(),function(t){if(!e||!r)return!1;var n=ma(e);return!n.teardown&&!n.disabled&&(o&&e.setNextPlugin(i),e.processTelemetry(a,t),!0)},"processTelemetry",function(){return{item:a}},!a.sync)||d.processNext(a)},unload:function(t,n){c(t,function(){var a=!1;if(e){var i=ma(e),r=e.core||i.core;!e||r&&r!==t.core()||i.teardown||(i.core=null,i.teardown=!0,i.isInitialized=!1,e.teardown&&!0===e.teardown(t,n)&&(a=!0))}return a},"unload",function(){},n.isAsync)||t.processNext(n)},update:function(t,n){c(t,function(){var a=!1;if(e){var i=ma(e),r=e.core||i.core;!e||r&&r!==t.core()||i.teardown||e.update&&!0===e.update(t,n)&&(a=!0)}return a},"update",function(){},!1)||t.processNext(n)},_id:a=e?e.identifier+"-"+e.priority+"-"+ba++:"Unknown-0-"+ba++,_setNext:function(e){i=e}};function c(t,n,r,o,s){var c=!1,d=e?e.identifier:"TelemetryPluginChain",l=t._hasRun;return l||(l=t._hasRun={}),t.setNext(i),e&&ua(t.core(),function(){return d+":"+r},function(){l[a]=!0;try{var e=i?i._id:M;e&&(l[e]=!1),c=n(t)}catch(e){var o=!i||l[i._id];o&&(c=!0),i&&o||nn(t.diagLog(),1,73,"Plugin ["+d+"] failed during "+r+" - "+jt(e)+", run flags: "+jt(l))}},o,s),c}return ve(s)}(e,t,n);i||(i=s),o&&o._setNext(s),o=s}})}return a&&!i?Da([a],t,n):i}function Ia(e,t,n){t&&oe(t)&&t.length>0&&(fe(t=t.sort(function(e,t){return e.priority-t.priority}),function(e){e.priority<500&&Oe("Channel has invalid priority - "+e.identifier)}),e.push({queue:ve(t),chain:Da(t,n.config,n)}))}function xa(){var e=[];return{add:function(t){t&&e.push(t)},run:function(t,n){fe(e,function(e){try{e(t,n)}catch(e){nn(t.diagLog(),2,73,"Unexpected error calling unload handler - "+jt(e))}}),e=[]}}}var Ca=function(){function e(){var t,n,a,i,r,o=this;function s(e){void 0===e&&(e=null);var t=e;if(!t){var i=n||va(null,{},o.core);t=a&&a.getPlugin?i.createNew(null,a.getPlugin):i.createNew(null,a)}return t}function c(e,t,i){e&&De(e,P,[],null,X),!i&&t&&(i=t.getProcessTelContext().getNext());var r=a;a&&a.getPlugin&&(r=a.getPlugin()),o.core=t,n=va(i,e,t,r)}function d(){t=!1,o.core=null,n=null,a=null,r=[],i=xa()}d(),St(e,o,function(e){e.initialize=function(e,n,a,i){c(e,n,i),t=!0},e.teardown=function(t,n){var o,s=e.core;if(s&&(!t||s===t.core())){var c,l=!1,u=t||ya(null,s,a&&a.getPlugin?a.getPlugin():a),f=n||((o={reason:0}).isAsync=!1,o);return e._doTeardown&&!0===e._doTeardown(u,f,p)?c=!0:p(),c}function p(){if(!l){l=!0,i.run(u,n);var e=r;r=[],fe(e,function(e){e.rm()}),!0===c&&u.processNext(f),d()}}},e.update=function(t,n){var i=e.core;if(i&&(!t||i===t.core())){var r,o=!1,s=t||Sa(null,i,a&&a.getPlugin?a.getPlugin():a),d=n||{reason:0};return e._doUpdate&&!0===e._doUpdate(s,d,l)?r=!0:l(),r}function l(){o||(o=!0,c(s.getCfg(),s.core(),s.getNext()))}},e._addHook=function(e){e&&(oe(e)?r=r.concat(e):r.push(e))},we(e,"_addUnloadCb",function(){return i},"add")}),o.diagLog=function(e){return s(e).diagLog()},o.isInitialized=function(){return t},o.setInitialized=function(e){t=e},o.setNextPlugin=function(e){a=e},o.processNext=function(e,t){t?t.processNext(e):a&&te(a.processTelemetry)&&a.processTelemetry(e,null)},o._getTelCtx=s}return e.__ieDyn=1,e}(),Oa=function(e){function t(){var n,a,i=e.call(this)||this;function r(){n=0,a=[]}return i.identifier="TelemetryInitializerPlugin",i.priority=199,r(),St(t,i,function(e,t){e.addTelemetryInitializer=function(e){var t={id:n++,fn:e};return a.push(t),{remove:function(){fe(a,function(e,n){if(e.id===t.id)return a.splice(n,1),-1})}}},e.processTelemetry=function(t,n){for(var i=!1,r=a.length,o=0;o<r;++o){var s=a[o];if(s)try{if(!1===s.fn.apply(null,[t])){i=!0;break}}catch(e){nn(n.diagLog(),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+Se(e),{exception:jt(e)},!0)}}i||e.processNext(t,n)},e._doTeardown=function(){r()}}),i}return oa(t,e),t.__ieDyn=1,t}(Ca),wa="Plugins must provide initialize method",Ea="SDK is still unloading...",Aa={loggingLevelConsole:1};function La(e,t){return new da(t)}function ka(e,t){var n=!1;return fe(t,function(t){if(t===e)return n=!0,-1}),n}var Ma=function(){function e(){var t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S=0,D=!1;St(e,this,function(e){function I(n){if(!S&&!D&&(n||e.logger&&e.logger.queue.length>0)){var a=xe(t.diagnosticLogInterval);a&&a>0||(a=1e4),S=setInterval(function(){clearInterval(S),S=0,L()},a)}return S}function x(){n=!1,t=Ae(!0,{},Aa),e.config=t,e.logger=new en(t),e._extensions=[],_=new Oa,a=[],i=null,r=null,o=null,s=null,c=null,l=null,d=[],u=null,f=null,p=null,m=!1,h=null,b=Mn("AIBaseCore",!0),g=xa(),y=null}function C(){var n=va(E(),t,e);return n.onComplete(I),n}function O(n){var a=function(e,t,n){var a,i=[],r={};return fe(n,function(t){(X(t)||X(t.initialize))&&Oe(wa);var n=t.priority,a=t.identifier;t&&n&&(X(r[n])?r[n]=a:an(e,"Two extensions have same priority #"+n+" - "+r[n]+", "+a)),(!n||n<500)&&i.push(t)}),(a={all:n}).core=i,a}(e.logger,0,d);l=a.core,c=null;var i=a.all;if(p=ve(function(e,t,n){var a=[];if(e&&fe(e,function(e){return Ia(a,e,n)}),t){var i=[];fe(t,function(e){e.priority>500&&i.push(e)}),Ia(a,i,n)}return a}(f,i,e)),u){var r=pe(i,u);-1!==r&&i.splice(r,1),-1!==(r=pe(l,u))&&l.splice(r,1),u._setQueue(p)}else u=function(e,t){function n(){return va(null,t.config,t,null)}function a(e,t,n,a){var i=e?e.length+1:1;function r(){0==--i&&(a&&a(),a=null)}i>0&&fe(e,function(e){if(e&&e.queue.length>0){var a=e.chain,o=t.createNew(a);o.onComplete(r),n(o)}else i--}),r()}var i=!1,r={identifier:"ChannelControllerPlugin",priority:500,initialize:function(t,n,a,r){i=!0,fe(e,function(e){e&&e.queue.length>0&&_a(va(e.chain,t,n),a)})},isInitialized:function(){return i},processTelemetry:function(t,i){a(e,i||n(),function(e){e.processNext(t)},function(){i.processNext(t)})},update:function(t,n){var i=n||{reason:0};return a(e,t,function(e){e.processNext(i)},function(){t.processNext(i)}),!0},pause:function(){a(e,n(),function(e){e.iterate(function(e){e.pause&&e.pause()})},null)},resume:function(){a(e,n(),function(e){e.iterate(function(e){e.resume&&e.resume()})},null)},teardown:function(t,n){var r=n||{reason:0,isAsync:!1};return a(e,t,function(e){e.processNext(r)},function(){t.processNext(r),i=!1}),!0},getChannel:function(t){var n=null;return e&&e.length>0&&fe(e,function(e){if(e&&e.queue.length>0&&(fe(e.queue,function(e){if(e.identifier===t)return n=e,-1}),n))return-1}),n},flush:function(t,i,r,o){var s=1,c=!1,d=null;function l(){s--,c&&0===s&&(d&&(clearTimeout(d),d=null),i&&i(c),i=null)}return o=o||5e3,a(e,n(),function(e){e.iterate(function(e){if(e.flush){s++;var n=!1;e.flush(t,function(){n=!0,l()},r)||n||(t&&null==d?d=setTimeout(function(){d=null,l()},o):l())}})},function(){c=!0,l()}),!0},_setQueue:function(t){e=t}};return r}(p,e);i.push(u),l.push(u),e._extensions=ha(i),u.initialize(t,e,i),_a(C(),i),e._extensions=ve(ha(l||[])).slice(),n&&function(t){var n=Sa(E(),e);n.onComplete(I),e._updateHook&&!0===e._updateHook(n,t)||n.processNext(t)}(n)}function w(t){var n,a=null,i=null;return fe(e._extensions,function(e){if(e.identifier===t&&e!==u&&e!==_)return i=e,-1}),!i&&u&&(i=u.getChannel(t)),i&&((n={plugin:i}).setEnabled=function(e){ma(i).disabled=!e},n.isEnabled=function(){var e=ma(i);return!e.teardown&&!e.disabled},n.remove=function(e,t){var n;void 0===e&&(e=!0);var a=[i],r=((n={reason:1}).isAsync=e,n);A(a,r,function(e){e&&O({reason:32,removed:a}),t&&t(e)})},a=n),a}function E(){if(!c){var n=(l||[]).slice();-1===pe(n,_)&&n.push(_),c=Da(ha(n),t,e)}return c}function A(n,a,i){if(n&&n.length>0){var r=ya(Da(n,t,e),e);r.onComplete(function(){var e=!1,t=[];fe(d,function(a,i){ka(a,n)?e=!0:t.push(a)}),d=t;var a=[];f&&(fe(f,function(t,i){var r=[];fe(t,function(t){ka(t,n)?e=!0:r.push(t)}),a.push(r)}),f=a),i&&i(e),I()}),r.processNext(a)}else i(!1)}function L(){if(e.logger&&e.logger.queue){var n=e.logger.queue.slice(0);e.logger.queue.length=0,fe(n,function(n){var a,i=((a={}).name=h||"InternalMessageId: "+n.messageId,a.iKey=xe(t.instrumentationKey),a.time=ue(new Date),a.baseType=$t.dataType,a.baseData={message:n.message},a);e.track(i)})}}function M(e,t,n,a){return u?u.flush(e,t,n||6,a):(t&&t(!1),!0)}function T(t){var n=e.logger;n?(nn(n,2,73,t),I()):Oe(t)}var U,F,H;x(),e.isInitialized=function(){return n},e.initialize=function(a,r,s,c){var l,u;m&&Oe(Ea),e.isInitialized()&&Oe("Core should not be initialized more than once"),t=a||{},e.config=t,X(a.instrumentationKey)&&Oe("Please provide instrumentation key"),i=c,e._notificationManager=c,!0===(u=xe(t.disableDbgExt))&&v&&(i.removeNotificationListener(v),v=null),i&&!v&&!0!==u&&(v=Jt(t),i.addNotificationListener(v)),!(l=xe(t.enablePerfMgr))&&o&&(o=null),l&&Ie(t,"createPerfMgr",La),Ie(t,P,{}).NotificationManager=i,s&&(e.logger=s);var _=Ie(t,"extensions",[]);(d=[]).push.apply(d,sa(sa([],r),_)),f=Ie(t,"channels",[]),O(null),p&&0!==p.length||Oe("No channels available"),n=!0,e.releaseQueue()},e.getTransmissionControls=function(){var e=[];return p&&fe(p,function(t){e.push(t.queue)}),ve(e)},e.track=function(n){n.iKey=n.iKey||t.instrumentationKey,n.time=n.time||ue(new Date),n.ver=n.ver||"4.0",!m&&e.isInitialized()?C().processNext(n):a.push(n)},e.getProcessTelContext=C,e.getNotifyMgr=function(){return i||(i=function(){var e;return k(((e={}).addNotificationListener=function(e){},e.removeNotificationListener=function(e){},e.eventsSent=function(e){},e.eventsDiscarded=function(e,t){},e.eventsSendRequest=function(e,t){},e))}(),e._notificationManager=i),i},e.addNotificationListener=function(e){i&&i.addNotificationListener(e)},e.removeNotificationListener=function(e){i&&i.removeNotificationListener(e)},e.getCookieMgr=function(){return s||(s=_n(t,e.logger)),s},e.setCookieMgr=function(e){s=e},e.getPerfMgr=function(){if(!r&&!o&&xe(t.enablePerfMgr)){var n=xe(t.createPerfMgr);te(n)&&(o=n(e,e.getNotifyMgr()))}return r||o||null},e.setPerfMgr=function(e){r=e},e.eventCnt=function(){return a.length},e.releaseQueue=function(){if(n&&a.length>0){var e=a;a=[],fe(e,function(e){C().processNext(e)})}},e.pollInternalLogs=function(e){return h=e||null,D=!1,S&&(clearInterval(S),S=null),I(!0)},e.stopPollingInternalLogs=function(){D=!0,S&&(clearInterval(S),S=0,L())},F=function(){return _},H=["addTelemetryInitializer"],(U=e)&&F&&ee(U)&&oe(H)&&fe(H,function(e){se(e)&&we(U,e,F,e,undefined)}),e.unload=function(t,a,i){var r;void 0===t&&(t=!0),n||Oe("SDK is not initialized"),m&&Oe(Ea);var o=((r={reason:50}).isAsync=t,r.flushComplete=!1,r),s=ya(E(),e);function c(t){o.flushComplete=t,m=!0,g.run(s,o),e.stopPollingInternalLogs(),s.processNext(o)}s.onComplete(function(){x(),a&&a(o)},e),L(),M(t,c,6,i)||c(!1)},e.getPlugin=w,e.addPlugin=function(e,t,n,a){if(!e)return a&&a(!1),void T(wa);var i=w(e.identifier);if(i&&!t)return a&&a(!1),void T("Plugin ["+e.identifier+"] is already loaded!");var r={reason:16};function o(t){d.push(e),r.added=[e],O(r),a&&a(!0)}if(i){var s=[i.plugin];A(s,{reason:2,isAsync:!!n},function(e){e?(r.removed=s,r.reason|=32,o()):a&&a(!1)})}else o()},e.evtNamespace=function(){return b},e.flush=M,e.getTraceCtx=function(e){var t;return y||(t={},y={getName:function(){return t.name},setName:function(e){t.name=e},getTraceId:function(){return t.traceId},setTraceId:function(e){fa(e,32,"00000000000000000000000000000000")&&(t.traceId=e)},getSpanId:function(){return t.spanId},setSpanId:function(e){fa(e,16,"0000000000000000")&&(t.spanId=e)},getTraceFlags:function(){return t.traceFlags},setTraceFlags:function(e){t.traceFlags=e}}),y},e.setTraceCtx=function(e){y=e||null},we(e,"addUnloadCb",function(){return g},"add")})}return e.__ieDyn=1,e}();function Pa(e,t,n,a){fe(e,function(e){if(e&&e[t])if(n)setTimeout(function(){return a(e)},0);else try{a(e)}catch(e){}})}var Ta,Ua=function(){function e(t){this.listeners=[];var n=!!(t||{}).perfEvtsSendAll;St(e,this,function(e){e.addNotificationListener=function(t){e.listeners.push(t)},e.removeNotificationListener=function(t){for(var n=pe(e.listeners,t);n>-1;)e.listeners.splice(n,1),n=pe(e.listeners,t)},e.eventsSent=function(t){Pa(e.listeners,"eventsSent",!0,function(e){e.eventsSent(t)})},e.eventsDiscarded=function(t,n){Pa(e.listeners,"eventsDiscarded",!0,function(e){e.eventsDiscarded(t,n)})},e.eventsSendRequest=function(t,n){Pa(e.listeners,"eventsSendRequest",n,function(e){e.eventsSendRequest(t,n)})},e.perfEvent=function(t){t&&(!n&&t.isChildEvt()||Pa(e.listeners,"perfEvent",!1,function(e){t.isAsync?setTimeout(function(){return e.perfEvent(t)},0):e.perfEvent(t)}))}})}return e.__ieDyn=1,e}(),Fa=function(e){function t(){var n=e.call(this)||this;return St(t,n,function(e,t){function n(t){var n=e.getNotifyMgr();n&&n.eventsDiscarded([t],2)}e.initialize=function(e,n,a,i){t.initialize(e,n,a||new en(e),i||new Ua(e))},e.track=function(a){ua(e.getPerfMgr(),function(){return"AppInsightsCore:track"},function(){null===a&&(n(a),Oe("Invalid telemetry item")),function(e){X(e.name)&&(n(e),Oe("telemetry name required"))}(a),t.track(a)},function(){return{item:a}},!a.sync)}}),n}return oa(t,e),t.__ieDyn=1,t}(Ma),Ha="1DS-Web-JS-3.2.15",Ra="withCredentials",Na=((Ta={})[0]=0,Ta[2]=6,Ta[1]=1,Ta[3]=7,Ta[4098]=6,Ta[4097]=1,Ta[4099]=7,Ta);function Ba(e){return!(""===e||X(e))}function ja(e,t,n){var a=-1;if(!J(e))if(t>0&&(32===t?a=8192:t<=13&&(a=t<<5)),function(e){return e>=0&&e<=9}(n))-1===a&&(a=0),a|=n;else{var i=Na[Ka(e)]||-1;-1!==a&&-1!==i?a|=i:6===i&&(a=i)}return a}function Va(e,t,n,a,i){var r={},o=!1,s=0,c=arguments.length,d=Object.prototype,l=arguments;for("[object Boolean]"===d.toString.call(l[0])&&(o=l[0],s++);s<c;s++)ae(e=l[s],function(e,t){o&&t&&ee(t)?oe(t)?(r[e]=r[e]||[],fe(t,function(t,n){t&&ee(t)?r[e][n]=Va(!0,r[e][n],t):r[e][n]=t})):r[e]=Va(!0,r[e],t):r[e]=t});return r}Boolean(Pt()),Boolean(Mt());var za=function(){var e=Lt("performance");return e&&e.now?e.now():ye()};function Ga(e,t){var n=e;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[t]=za()}function Ka(e){var t=0;if(null!=e){var n=typeof e;"string"===n?t=1:"number"===n?t=2:"boolean"===n?t=3:n===y&&(t=4,oe(e)?(t=4096,e.length>0&&(t|=Ka(e[0]))):w.call(e,"value")&&(t=8192|Ka(e.value)))}return t}var Wa=function(e){function t(){var n=e.call(this)||this;return n.pluginVersionStringArr=[],St(t,n,function(e,t){e.logger&&e.logger.queue||(e.logger=new en({loggingLevelConsole:1})),e.initialize=function(n,a,i,r){ua(e,function(){return"AppInsightsCore.initialize"},function(){var o=e.pluginVersionStringArr;if(n){n.endpointUrl||(n.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var s=n.propertyStorageOverride;!s||s.getProperty&&s.setProperty||Oe("Invalid property storage override passed."),n.channels&&fe(n.channels,function(e){e&&fe(e,function(e){if(e.identifier&&e.version){var t=e.identifier+"="+e.version;o.push(t)}})})}e.getWParam=function(){return"undefined"!=typeof document||n.enableWParam?0:-1},a&&fe(a,function(e){if(e&&e.identifier&&e.version){var t=e.identifier+"="+e.version;o.push(t)}}),e.pluginVersionString=o.join(";"),e.pluginVersionStringArr=o;try{t.initialize(n,a,i,r),e.pollInternalLogs("InternalLog")}catch(t){var c=e.logger,d=jt(t);-1!==d.indexOf("channels")&&(d+="\n - Channels must be provided through config.channels only!"),nn(c,1,514,"SDK Initialization Failed - no telemetry will be sent: "+d)}},function(){return{config:n,extensions:a,logger:i,notificationManager:r}})},e.track=function(n){ua(e,function(){return"AppInsightsCore.track"},function(){var a,i=n;if(i){i.timings=i.timings||{},i.timings.trackStart=za(),(a=i.latency)&&ce(a)&&a>=1&&a<=4||(i.latency=1);var r=i.ext=i.ext||{};r.sdk=r.sdk||{},r.sdk.ver=Ha;var o=i.baseData=i.baseData||{};o.properties=o.properties||{};var s=o.properties;s.version=s.version||e.pluginVersionString||""}t.track(i)},function(){return{item:n}},!n.sync)}}),n}return oa(t,e),t.__ieDyn=1,t}(Fa);const qa=Wa;var Qa,Ya,Ja=(Ya={},ae({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5},function(e,t){Ya[e]=t,Ya[t]=e}),Qa=Ya,U&&ae(Qa,function(e,t){(oe(t)||ee(t))&&U(t)}),ve(Qa)),Xa="REAL_TIME",Za="",$a="POST",ei="drop",ti="requeue",ni="application/x-json-stream",ai="content-type",ii="client-version",ri="client-id",oi="time-delta-to-apply-millis",si="upload-time",ci="apikey",di="AuthMsaDeviceTicket",li="AuthXToken";function ui(e){var t=(e.ext||{}).intweb;return t&&Ba(t.msfpc)?t.msfpc:null}function fi(e){for(var t=null,n=0;null===t&&n<e.length;n++)t=ui(e[n]);return t}var pi=function(){function e(t,n){var a=n?[].concat(n):[],i=this,r=fi(a);i.iKey=function(){return t},i.Msfpc=function(){return r||Za},i.count=function(){return a.length},i.events=function(){return a},i.addEvent=function(e){return!!e&&(a.push(e),r||(r=ui(e)),!0)},i.split=function(n,i){var o;if(n<a.length){var s=a.length-n;X(i)||(s=i<s?i:s),o=a.splice(n,s),r=fi(a)}return new e(t,o)}}return e.create=function(t,n){return new e(t,n)},e}();const mi=function(){function e(){var t=!0,n=!0,a=!0,i="use-collector-delta",r=!1;St(e,this,function(e){e.allowRequestSending=function(){return t},e.firstRequestSent=function(){a&&(a=!1,r||(t=!1))},e.shouldAddClockSkewHeaders=function(){return n},e.getClockSkewHeaderValue=function(){return i},e.setClockSkew=function(e){r||(e?(i=e,n=!0,r=!0):n=!1,t=!0)}})}return e.__ieDyn=1,e}();var _i=function(){function e(){var t={};St(e,this,function(e){e.setKillSwitchTenants=function(e,n){if(e&&n)try{var a=function(e){var t=[];return e&&fe(e,function(e){t.push(me(e))}),t}(e.split(","));if("this-request-only"===n)return a;for(var i=1e3*parseInt(n,10),r=0;r<a.length;++r)t[a[r]]=ye()+i}catch(e){return[]}return[]},e.isTenantKilled=function(e){var n=t,a=me(e);return void 0!==n[a]&&n[a]>ye()||(delete n[a],!1)}})}return e.__ieDyn=1,e}();const hi=_i;function bi(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*n,Math.min(t,6e5)}var gi,vi=2e6,yi=Math.min(vi,65e3),Si=/\./,Di=function(){function e(t,n,a,i){var r="baseData",o=!!i,s=n,c={};St(e,this,function(e){function n(e,t,i,r,d,l,u){ae(e,function(e,f){var p=null;if(f||Ba(f)){var m=i,_=e,h=d,b=t;if(o&&!r&&Si.test(e)){var g=e.split("."),v=g.length;if(v>1){h&&(h=h.slice());for(var y=0;y<v-1;y++){var S=g[y];b=b[S]=b[S]||{},m+="."+S,h&&h.push(S)}_=g[v-1]}}var D=r&&function(e,t){var n=c[e];return void 0===n&&(e.length>=7&&(n=ie(e,"ext.metadata")||ie(e,"ext.web")),c[e]=n),n}(m);if(p=!D&&s&&s.handleField(m,_)?s.value(m,_,f,a):function(e,t,n){if(!t&&!Ba(t)||"string"!=typeof e)return null;var a,i=typeof t;if("string"===i||"number"===i||"boolean"===i||oe(t))t={value:t};else if("object"!==i||w.call(t,"value")){if(X(t.value)||""===t.value||!se(t.value)&&!ce(t.value)&&!de(t.value)&&!oe(t.value))return null}else t={value:n?JSON.stringify(t):t};if(oe(t.value)&&!(t.value.length>0))return null;if(!X(t.kind)){if(oe(t.value)||!(0===(a=t.kind)||a>0&&a<=13||32===a))return null;t.value=t.value.toString()}return t}(_,f,a)){var I=p.value;if(b[_]=I,l&&l(h,_,p),u&&"object"==typeof I&&!oe(I)){var x=h;x&&(x=x.slice()).push(_),n(f,I,m+"."+_,r,x,l,u)}}}})}e.createPayload=function(e,t,n,a,i,r){return{apiKeys:[],payloadBlob:Za,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:n,isBeacon:a,sendType:r,sendReason:i}},e.appendPayload=function(n,a,i){var r=n&&a&&!n.overflow;return r&&ua(t,function(){return"Serializer:appendPayload"},function(){for(var t=a.events(),r=n.payloadBlob,o=n.numEvents,s=!1,c=[],d=[],l=n.isBeacon,u=l?65e3:3984588,f=l?yi:vi,p=0,m=0;p<t.length;){var _=t[p];if(_){if(o>=i){n.overflow=a.split(p);break}var h=e.getEventBlob(_);if(h&&h.length<=f){var b=h.length;if(r.length+b>u){n.overflow=a.split(p);break}r&&(r+="\n"),r+=h,++m>20&&(r.substr(0,1),m=0),s=!0,o++}else h?c.push(_):d.push(_),t.splice(p,1),p--}p++}if(c&&c.length>0&&n.sizeExceed.push(pi.create(a.iKey(),c)),d&&d.length>0&&n.failedEvts.push(pi.create(a.iKey(),d)),s){n.batches.push(a),n.payloadBlob=r,n.numEvents=o;var g=a.iKey();-1===pe(n.apiKeys,g)&&n.apiKeys.push(g)}},function(){return{payload:n,theBatch:{iKey:a.iKey(),evts:a.events()},max:i}}),r},e.getEventBlob=function(e){try{return ua(t,function(){return"Serializer.getEventBlob"},function(){var t={};t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+function(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return""}(e.iKey);var a={},i=e.ext;i&&(t.ext=a,ae(i,function(e,t){n(t,a[e]={},"ext."+e,!0,null,null,!0)}));var o=t.data={};o.baseType=e.baseType;var s=o.baseData={};return n(e.baseData,s,r,!1,[r],function(e,t,n){Ii(a,e,t,n)},!0),n(e.data,o,"data",!1,[],function(e,t,n){Ii(a,e,t,n)},!0),JSON.stringify(t)},function(){return{item:e}})}catch(e){return null}}})}return e.__ieDyn=1,e}();function Ii(e,t,n,a){if(a&&e){var i=ja(a.value,a.kind,a.propertyType);if(i>-1){var r=e.metadata;r||(r=e.metadata={f:{}});var o=r.f;if(o||(o=r.f={}),t)for(var s=0;s<t.length;s++){var c=t[s];o[c]||(o[c]={f:{}});var d=o[c].f;d||(d=o[c].f={}),o=d}o=o[n]={},oe(a.value)?o.a={t:i}:o.t=i}}}var xi="&NoResponseBody=true",Ci=((gi={})[1]=ti,gi[100]=ti,gi[200]="sent",gi[8004]=ei,gi[8003]=ei,gi),Oi={},wi={};function Ei(e,t,n){Oi[e]=t,!1!==n&&(wi[t]=e)}function Ai(e){try{return e.responseText}catch(e){}return Za}function Li(e,t){var n=!1;if(e&&t){var a=be(e);if(a&&a.length>0)for(var i=t.toLowerCase(),r=0;r<a.length;r++){var o=a[r];if(o&&$(t,o)&&o.toLowerCase()===i){n=!0;break}}}return n}function ki(e,t,n,a){t&&n&&n.length>0&&(a&&Oi[t]?(e.hdrs[Oi[t]]=n,e.useHdrs=!0):e.url+="&"+t+"="+n)}function Mi(e,t){return t&&(ce(t)?e=[t].concat(e):oe(t)&&(e=t.concat(e))),e}Ei(di,di,!1),Ei(ii,ii),Ei(ri,"Client-Id"),Ei(ci,ci),Ei(oi,oi),Ei(si,si),Ei(li,li);var Pi=function(){function e(t,n,a,i,r){this._responseHandlers=[];var o,s,c,d,l,u,f,p,m,_,h="?cors=true&"+ai.toLowerCase()+"="+ni,b=new hi,g=!1,v=new mi,y=!1,D=0,I=!0,x=[],C={},O=[],w=null,E=!1,A=!1,L=!1;St(e,this,function(e){var k=!0;function M(e,t){for(var n=0,a=null,i=0;null==a&&i<e.length;)1===(n=e[i])?(null===wt&&(wt=typeof XDomainRequest!==S)&&Gt()&&(wt=wt&&!At(Lt(xt),"withCredentials")),wt?a=P:Gt()&&(a=U)):2===n&&zt(t)&&(!t||t&&!p)?a=T:y&&3===n&&Vt()&&(a=H),i++;return a?{_transport:n,_isSync:t,sendPOST:a}:null}function P(e,t,n){var a=new XDomainRequest;a.open($a,e.urlString),e.timeout&&(a.timeout=e.timeout),a.onload=function(){var e=Ai(a);F(t,200,{},e),Q(e)},a.onerror=function(){F(t,400,{})},a.ontimeout=function(){F(t,500,{})},a.onprogress=function(){},n?a.send(e.data):r.set(function(){a.send(e.data)},0)}function T(e,t,n){var a,i=e.urlString,o=!1,s=!1,c=((a={body:e.data,method:$a}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,a);n&&(c.keepalive=!0,2===e._sendReason&&(o=!0,_&&(i+=xi))),k&&(c.credentials="include"),e.headers&&be(e.headers).length>0&&(c.headers=e.headers),fetch(i,c).then(function(e){var n={},a=Za,i=e.headers;i&&i.forEach(function(e,t){n[t]=e}),e.body&&e.text().then(function(e){a=e}),s||(s=!0,F(t,e.status,n,a),Q(a))}).catch(function(e){s||(s=!0,F(t,0,{}))}),o&&!s&&(s=!0,F(t,200,{})),!s&&e.timeout>0&&r.set(function(){s||(s=!0,F(t,500,{}))},e.timeout)}function U(e,t,n){var a=e.urlString;function i(e,t,n){if(!e[n]&&t&&t.getResponseHeader){var a=t.getResponseHeader(n);a&&(e[n]=me(a))}return e}function r(e,n){F(t,e.status,function(e){var t,n,a={};return e.getAllResponseHeaders?(t=e.getAllResponseHeaders(),n={},se(t)&&fe(me(t).split(/[\r\n]+/),function(e){if(e){var t=e.indexOf(": ");if(-1!==t){var a=me(e.substring(0,t)).toLowerCase(),i=me(e.substring(t+1));n[a]=i}else n[me(e)]=1}}),a=n):(a=i(a,e,"time-delta-millis"),a=i(a,e,"kill-duration"),a=i(a,e,"kill-duration-seconds")),a}(e),n)}n&&e.disableXhrSync&&(n=!1);var o=function(e,t,n,a,i,r){function o(e,t,n){try{e[t]=n}catch(e){}}void 0===a&&(a=!1),void 0===i&&(i=!1);var s=new XMLHttpRequest;return a&&o(s,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",a),n&&o(s,Ra,n),s.open("POST",t,!i),n&&o(s,Ra,n),!i&&r&&o(s,"timeout",r),s}(0,a,k,!0,n,e.timeout);ae(e.headers,function(e,t){o.setRequestHeader(e,t)}),o.onload=function(){var e=Ai(o);r(o,e),Q(e)},o.onerror=function(){r(o)},o.ontimeout=function(){r(o)},o.send(e.data)}function F(e,t,n,a){try{e(t,n,a)}catch(e){nn(s,2,518,jt(e))}}function H(e,t,n){var a=200,i=e._thePayload,r=e.urlString+(_?xi:Za);try{var o=Ut();if(!o.sendBeacon(r,e.data))if(i){var c=[];fe(i.batches,function(e){if(c&&e&&e.count()>0){for(var t=e.events(),n=0;n<t.length;n++)if(!o.sendBeacon(r,w.getEventBlob(t[n]))){c.push(e.split(n));break}}else c.push(e.split(0))}),Y(c,8003,i.sendType,!0)}else a=0}catch(e){an(s,"Failed to send telemetry using sendBeacon API. Ex:"+jt(e)),a=0}finally{F(t,a,{},Za)}}function R(e){return 2===e||3===e}function N(e){return A&&R(e)&&(e=2),e}function B(){return!g&&D<n}function j(){var e=O;return O=[],e}function V(e,t,n){var a=!1;return e&&e.length>0&&!g&&c[t]&&w&&(a=0!==t||B()&&(n>0||v.allowRequestSending())),a}function z(e){var t={};return e&&fe(e,function(e,n){t[n]={iKey:e.iKey(),evts:e.events()}}),t}function G(e,n,a,i,r){if(e&&0!==e.length)if(g)Y(e,1,i);else{i=N(i);try{var o=e,l=0!==i;ua(d,function(){return"HttpManager:_sendBatches"},function(o){o&&(e=e.slice(0));for(var s=[],d=null,u=za(),f=c[i]||(l?c[1]:c[0]),p=f&&f._transport,_=m&&(A||R(i)||3===p||f._isSync&&2===p);V(e,i,n);){var h=e.shift();h&&h.count()>0&&(b.isTenantKilled(h.iKey())?s.push(h):(d=d||w.createPayload(n,a,l,_,r,i),w.appendPayload(d,h,t)?null!==d.overflow&&(e=[d.overflow].concat(e),d.overflow=null,W(d,u,za(),r),u=za(),d=null):(W(d,u,za(),r),u=za(),e=[h].concat(e),d=null)))}d&&W(d,u,za(),r),e.length>0&&(O=e.concat(O)),Y(s,8004,i)},function(){return{batches:z(o),retryCount:n,isTeardown:a,isSynchronous:l,sendReason:r,useSendBeacon:R(i),sendType:i}},!l)}catch(e){nn(s,2,48,"Unexpected Exception sending batch: "+jt(e))}}}function K(e,t,n){e[t]=e[t]||{},e[t][o.identifier]=n}function W(t,n,i,r){if(t&&t.payloadBlob&&t.payloadBlob.length>0){var l=!!e.sendHook,m=c[t.sendType];!R(t.sendType)&&t.isBeacon&&2===t.sendReason&&(m=c[2]||c[3]||m);var _=L;(t.isBeacon||3===m._transport)&&(_=!1);var g=function(e,t){var n={url:h,hdrs:{},useHdrs:!1};t?(n.hdrs=Va(n.hdrs,C),n.useHdrs=be(n.hdrs).length>0):ae(C,function(e,t){wi[e]?ki(n,wi[e],t,!1):(n.hdrs[e]=t,n.useHdrs=!0)}),ki(n,ri,"NO_AUTH",t),ki(n,ii,Ha,t);var a=Za;fe(e.apiKeys,function(e){a.length>0&&(a+=","),a+=e}),ki(n,ci,a,t),ki(n,si,ye().toString(),t);var i=function(e){for(var t=0;t<e.batches.length;t++){var n=e.batches[t].Msfpc();if(n)return encodeURIComponent(n)}return Za}(e);if(Ba(i)&&(n.url+="&ext.intweb.msfpc="+i),v.shouldAddClockSkewHeaders()&&ki(n,oi,v.getClockSkewHeaderValue(),t),d.getWParam){var r=d.getWParam();r>=0&&(n.url+="&w="+r)}for(var o=0;o<x.length;o++)n.url+="&"+x[o].name+"="+x[o].value;return n}(t,_);_=_||g.useHdrs;var y=za();ua(d,function(){return"HttpManager:_doPayloadSend"},function(){for(var c=0;c<t.batches.length;c++)for(var h=t.batches[c].events(),x=0;x<h.length;x++){var C=h[x];if(E){var O=C.timings=C.timings||{};K(O,"sendEventStart",y),K(O,"serializationStart",n),K(O,"serializationCompleted",i)}C.sendAttempt>0?C.sendAttempt++:C.sendAttempt=1}Y(t.batches,1e3+(r||0),t.sendType,!0);var w={data:t.payloadBlob,urlString:g.url,headers:g.hdrs,_thePayload:t,_sendReason:r,timeout:u,disableXhrSync:f,disableFetchKeepAlive:p};_&&(Li(w.headers,"cache-control")||(w.headers["cache-control"]="no-cache, no-store"),Li(w.headers,ai)||(w.headers["content-type"]=ni));var L=null;m&&(L=function(n){v.firstRequestSent();var i=function(n,i){!function(t,n,i,r){var s,c=9e3,d=null,l=!1,u=!1;try{var f=!0;if(typeof t!==S){if(n){v.setClockSkew(n["time-delta-millis"]);var p=n["kill-duration"]||n["kill-duration-seconds"];fe(b.setKillSwitchTenants(n["kill-tokens"],p),function(e){fe(i.batches,function(t){if(t.iKey()===e){d=d||[];var n=t.split(0);i.numEvents-=n.count(),d.push(n)}})})}if(200==t||204==t)return void(c=200);((s=t)>=300&&s<500&&408!=s&&429!=s||501==s||505==s||i.numEvents<=0)&&(f=!1),c=9e3+t%1e3}if(f){c=100;var m=i.retryCnt;0===i.sendType&&(m<a?(l=!0,q(function(){0===i.sendType&&D--,G(i.batches,m+1,i.isTeardown,A?2:i.sendType,5)},A,bi(m))):(u=!0,A&&(c=8001)))}}finally{l||(v.setClockSkew(),function(t,n,a,i){try{i&&o._backOffTransmission(),200===n&&(i||t.isSync||o._clearBackOff(),function(e){if(E){var t=za();fe(e,function(e){e&&e.count()>0&&function(e,t){E&&fe(e,function(e){K(e.timings=e.timings||{},"sendEventCompleted",t)})}(e.events(),t)})}}(t.batches)),Y(t.batches,n,t.sendType,!0)}finally{0===t.sendType&&(D--,5!==a&&e.sendQueuedRequests(t.sendType,a))}}(i,c,r,u)),Y(d,8004,i.sendType)}}(n,i,t,r)},c=t.isTeardown||t.isSync;try{m.sendPOST(n,i,c),e.sendListener&&e.sendListener(w,n,c,t.isBeacon)}catch(e){an(s,"Unexpected exception sending payload. Ex:"+jt(e)),F(i,0,{})}}),ua(d,function(){return"HttpManager:_doPayloadSend.sender"},function(){if(L)if(0===t.sendType&&D++,l&&!t.isBeacon&&3!==m._transport){var n={data:w.data,urlString:w.urlString,headers:Va({},w.headers),timeout:w.timeout,disableXhrSync:w.disableXhrSync,disableFetchKeepAlive:w.disableFetchKeepAlive},a=!1;ua(d,function(){return"HttpManager:_doPayloadSend.sendHook"},function(){try{e.sendHook(n,function(e){a=!0,I||e._thePayload||(e._thePayload=e._thePayload||w._thePayload,e._sendReason=e._sendReason||w._sendReason),L(e)},t.isSync||t.isTeardown)}catch(e){a||L(w)}})}else L(w)})},function(){return{thePayload:t,serializationStart:n,serializationCompleted:i,sendReason:r}},t.isSync)}t.sizeExceed&&t.sizeExceed.length>0&&Y(t.sizeExceed,8003,t.sendType),t.failedEvts&&t.failedEvts.length>0&&Y(t.failedEvts,8002,t.sendType)}function q(e,t,n){t?e():r.set(e,n)}function Q(t){var n=e._responseHandlers;try{for(var a=0;a<n.length;a++)try{n[a](t)}catch(e){nn(s,1,519,"Response handler failed: "+e)}if(t){var i=JSON.parse(t);Ba(i.webResult)&&Ba(i.webResult.msfpc)&&l.set("MSFPC",i.webResult.msfpc,31536e3)}}catch(e){}}function Y(e,t,n,a){if(e&&e.length>0&&i){var r=i[(c=t,l=Ci[c],Ba(l)||(l="oth",c>=9e3&&c<=9999?l="rspFail":c>=8e3&&c<=8999?l=ei:c>=1e3&&c<=1999&&(l="send")),l)];if(r){var o=0!==n;ua(d,function(){return"HttpManager:_sendBatchesNotification"},function(){q(function(){try{r.call(i,e,t,o,n)}catch(e){nn(s,1,74,"send request notification failed: "+e)}},a||o,0)},function(){return{batches:z(e),reason:t,isSync:o,sendSync:a,sendType:n}},!o)}}var c,l}e.initialize=function(e,t,n,a,i){var r;i||(i={}),h=e+h,L=!!J(i.avoidOptions)||!i.avoidOptions,d=t,l=t.getCookieMgr(),E=!d.config.disableEventTimings;var b=!!d.config.enableCompoundKey;s=(o=n).diagLog();var g=i.valueSanitizer,v=i.stringifyObjects;J(i.enableCompoundKey)||(b=!!i.enableCompoundKey),u=i.xhrTimeout,f=!!i.disableXhrSync,p=!!i.disableFetchKeepAlive,_=!1!==i.addNoResponse,y=!Nt(),w=new Di(d,g,v,b),X(i.useSendBeacon)||(y=!!i.useSendBeacon);var S=a,D=i.alwaysUseXhrOverride?a:null,x=i.alwaysUseXhrOverride?a:null,C=[3,2];if(!a){I=!1;var O=Ft();O&&O.protocol&&"file:"===O.protocol.toLowerCase()&&(k=!1);var A=[];Nt()?(A=[2,1],C=[2,1,3]):A=[1,2,3],(a=M(A=Mi(A,i.transports),!1))||an(s,"No available transport to send events"),S=M(A,!0)}D||(D=M(C=Mi(C,i.unloadTransports),!0)),m=!I&&(y&&Vt()||!p&&zt(!0)),(r={})[0]=a,r[1]=S||M([1,2,3],!0),r[2]=D||S||M([1],!0),r[3]=x||M([2,3],!0)||S||M([1],!0),c=r},e._getDbgPlgTargets=function(){return[c[0],b,w,c]},e.addQueryStringParameter=function(e,t){for(var n=0;n<x.length;n++)if(x[n].name===e)return void(x[n].value=t);x.push({name:e,value:t})},e.addHeader=function(e,t){C[e]=t},e.canSendRequest=function(){return B()&&v.allowRequestSending()},e.sendQueuedRequests=function(e,t){J(e)&&(e=0),A&&(e=N(e),t=2),V(O,e,0)&&G(j(),0,!1,e,t||0)},e.isCompletelyIdle=function(){return!g&&0===D&&0===O.length},e.setUnloading=function(e){A=e},e.addBatch=function(e){if(e&&e.count()>0){if(b.isTenantKilled(e.iKey()))return!1;O.push(e)}return!0},e.teardown=function(){O.length>0&&G(j(),0,!0,2,2)},e.pause=function(){g=!0},e.resume=function(){g=!1,e.sendQueuedRequests(0,4)},e.sendSynchronousBatch=function(e,t,n){e&&e.count()>0&&(X(t)&&(t=1),A&&(t=N(t),n=2),G([e],0,!1,t,n||0))}})}return e.__ieDyn=1,e}();function Ti(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];return setTimeout(e,t,n)}function Ui(e){clearTimeout(e)}function Fi(e,t){return{set:e||Ti,clear:t||Ui}}var Hi="eventsDiscarded";const Ri=function(e){function t(){var n,a=e.call(this)||this;a.identifier="PostChannel",a.priority=1011,a.version="3.2.15";var i,r,o,s,c,d,l,u=!1,f=[],p=null,m=!1,_=0,h=500,b=0,g=1e4,v={},y=Xa,S=null,D=null,I=0,x=0,C={},O=-1,w=!0,E=!1,A=6,L=2;return St(t,a,function(e,t){function a(e){"beforeunload"!==(e||Mt().event).type&&(E=!0,r.setUnloading(E)),N(2,2)}function k(e){E=!1,r.setUnloading(E)}function M(e,t){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=1),e.ext&&e.ext.trace&&delete e.ext.trace,e.ext&&e.ext.user&&e.ext.user.id&&delete e.ext.user.id,w&&(e.ext=Ee(e.ext),e.baseData&&(e.baseData=Ee(e.baseData)),e.data&&(e.data=Ee(e.data))),e.sync)if(I||m)e.latency=3,e.sync=!1;else if(r)return w&&(e=Ee(e)),void r.sendSynchronousBatch(pi.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var n=e.latency,a=b,i=g;4===n&&(a=_,i=h);var o=!1;if(a<i)o=!V(e,t);else{var s=1,c=20;4===n&&(s=4,c=1),o=!0,function(e,t,n,a){for(;n<=t;){var i=B(e,t,!0);if(i&&i.count()>0){var r=i.split(0,a),o=r.count();if(o>0)return 4===n?_-=o:b-=o,X(Hi,[r],Ja.QueueFull),!0}n++}return z(),!1}(e.iKey,e.latency,s,c)&&(o=!V(e,t))}o&&J(Hi,[e],Ja.QueueFull)}function P(e,t,n){var a=G(e,t,n);return r.sendQueuedRequests(t,n),a}function T(){return b>0}function U(){if(O>=0&&G(O,0,c)&&r.sendQueuedRequests(0,c),_>0&&!D&&!m){var e=v[y][2];e>=0&&(D=H(function(){D=null,P(4,0,1),U()},e))}var t=v[y][1];!S&&!p&&t>=0&&!m&&(T()?S=H(function(){S=null,P(0===x?3:1,0,1),x++,x%=2,U()},t):x=0)}function F(){n=null,u=!1,f=[],p=null,m=!1,_=0,h=500,b=0,g=1e4,v={},y=Xa,S=null,D=null,I=0,x=0,i=null,C={},o=void 0,s=0,O=-1,c=null,w=!0,E=!1,A=6,L=2,d=null,l=Fi(),r=new Pi(500,2,1,{requeue:Q,send:Z,sent:$,drop:ee,rspFail:te,oth:ne},l),q(),C[4]={batches:[],iKeyMap:{}},C[3]={batches:[],iKeyMap:{}},C[2]={batches:[],iKeyMap:{}},C[1]={batches:[],iKeyMap:{}},ie()}function H(e,t){0===t&&I&&(t=1);var n=1e3;return I&&(n=bi(I-1)),l.set(e,t*n)}function R(){return null!==S&&(l.clear(S),S=null,x=0,!0)}function N(e,t){R(),p&&(l.clear(p),p=null),m||P(1,e,t)}function B(e,t,n){var a=C[t];a||(a=C[t=1]);var i=a.iKeyMap[e];return!i&&n&&(i=pi.create(e),a.batches.push(i),a.iKeyMap[e]=i),i}function j(t,n){r.canSendRequest()&&!I&&(o>0&&b>o&&(n=!0),n&&null==p&&e.flush(t,null,20))}function V(e,t){w&&(e=Ee(e));var n=e.latency,a=B(e.iKey,n,!0);return!!a.addEvent(e)&&(4!==n?(b++,t&&0===e.sendAttempt&&j(!e.sync,s>0&&a.count()>=s)):_++,!0)}function z(){for(var e=0,t=0,n=function(n){var a=C[n];a&&a.batches&&fe(a.batches,function(a){4===n?e+=a.count():t+=a.count()})},a=1;a<=4;a++)n(a);b=t,_=e}function G(t,n,a){var i=!1,o=0===n;return!o||r.canSendRequest()?ua(e.core,function(){return"PostChannel._queueBatches"},function(){for(var e=[],n=4;n>=t;){var a=C[n];a&&a.batches&&a.batches.length>0&&(fe(a.batches,function(t){r.addBatch(t)?i=i||t&&t.count()>0:e=e.concat(t.events()),4===n?_-=t.count():b-=t.count()}),a.batches=[],a.iKeyMap={}),n--}e.length>0&&J(Hi,e,Ja.KillSwitch),i&&O>=t&&(O=-1,c=0)},function(){return{latency:t,sendType:n,sendReason:a}},!o):(O=O>=0?Math.min(O,t):t,c=Math.max(c,a)),i}function K(e,t){P(1,0,t),z(),W(function(){e&&e(),f.length>0?p=H(function(){p=null,K(f.shift(),t)},0):(p=null,U())})}function W(e){r.isCompletelyIdle()?e():p=H(function(){p=null,W(e)},.25)}function q(){(v={}).REAL_TIME=[2,1,0],v.NEAR_REAL_TIME=[6,3,0],v.BEST_EFFORT=[18,9,0]}function Q(t,n){var a=[],i=A;E&&(i=L),fe(t,function(t){t&&t.count()>0&&fe(t.events(),function(t){t&&(t.sync&&(t.latency=4,t.sync=!1),t.sendAttempt<i?(Ga(t,e.identifier),M(t,!1)):a.push(t))})}),a.length>0&&J(Hi,a,Ja.NonRetryableStatus),E&&N(2,2)}function Y(t,n){var a=e._notificationManager||{},i=a[t];if(i)try{i.apply(a,n)}catch(n){nn(e.diagLog(),1,74,t+" notification failed: "+n)}}function J(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];t&&t.length>0&&Y(e,[t].concat(n))}function X(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];t&&t.length>0&&fe(t,function(t){t&&t.count()>0&&Y(e,[t.events()].concat(n))})}function Z(e,t,n){e&&e.length>0&&Y("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==n])}function $(e,t){X("eventsSent",e,t),U()}function ee(e,t){X(Hi,e,t>=8e3&&t<=8999?t-8e3:Ja.Unknown)}function te(e){X(Hi,e,Ja.NonRetryableStatus),U()}function ne(e,t){X(Hi,e,Ja.Unknown),U()}function ie(){s=n&&n.disableAutoBatchFlushLimit?0:Math.max(1500,g/6)}F(),e._getDbgPlgTargets=function(){return[r]},e.initialize=function(s,c,u){ua(c,function(){return"PostChannel:initialize"},function(){var f,p,m,_,b=c;t.initialize(s,c,u);try{c.addUnloadCb,d=Zn(Mn(e.identifier),c.evtNamespace&&c.evtNamespace());var v=e._getTelCtx();s.extensionConfig[e.identifier]=s.extensionConfig[e.identifier]||{},n=v.getExtCfg(e.identifier),l=Fi(n.setTimeoutOverride,n.clearTimeoutOverride),w=!n.disableOptimizeObj&&!!Lt("chrome"),function(e){var t=e.getWParam;e.getWParam=function(){var e=0;return n.ignoreMc1Ms0CookieProcessing&&(e|=2),e|t()}}(b),n.eventsLimitInMem>0&&(g=n.eventsLimitInMem),n.immediateEventLimit>0&&(h=n.immediateEventLimit),n.autoFlushEventsLimit>0&&(o=n.autoFlushEventsLimit),ce(n.maxEventRetryAttempts)&&(A=n.maxEventRetryAttempts),ce(n.maxUnloadEventRetryAttempts)&&(L=n.maxUnloadEventRetryAttempts),ie(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(i=n.httpXHROverride),Ba(s.anonCookieName)&&r.addQueryStringParameter("anoncknm",s.anonCookieName),r.sendHook=n.payloadPreprocessor,r.sendListener=n.payloadListener;var y=n.overrideEndpointUrl?n.overrideEndpointUrl:s.endpointUrl;e._notificationManager=c.getNotifyMgr(),r.initialize(y,e.core,e,i,n);var S=s.disablePageUnloadEvents||[];f=[Nn,Rn,Fn],m=S,_=d,(p=a)&&f&&oe(f)&&!ta(f,p,m,_)&&m&&m.length>0&&ta(f,p,null,_),aa(a,S,d),ia(k,s.disablePageShowEvents,d)}catch(t){throw e.setInitialized(!1),t}},function(){return{coreConfig:s,core:c,extensions:u}})},e.processTelemetry=function(t,a){Ga(t,e.identifier);var i=(a=e._getTelCtx(a)).getExtCfg(e.identifier),r=!!n.disableTelemetry;i&&(r=r||!!i.disableTelemetry);var o=t;r||u||(n.overrideInstrumentationKey&&(o.iKey=n.overrideInstrumentationKey),i&&i.overrideInstrumentationKey&&(o.iKey=i.overrideInstrumentationKey),M(o,!0),E?N(2,2):U()),e.processNext(o,a)},e._doTeardown=function(e,t){var n;N(2,2),u=!0,r.teardown(),na([Nn,Rn,Fn],null,d),n=Zn(Bn,d),na([Fn],null,n),na([Un],null,n),function(e,t){var n=Zn(jn,t);na([Hn],null,n),na([Un],null,n)}(0,d),F()},e.setEventQueueLimits=function(e,t){g=e>0?e:1e4,o=t>0?t:0,ie();var n=b>e;if(!n&&s>0)for(var a=1;!n&&a<=3;a++){var i=C[a];i&&i.batches&&fe(i.batches,function(e){e&&e.count()>=s&&(n=!0)})}j(!0,n)},e.pause=function(){R(),m=!0,r.pause()},e.resume=function(){m=!1,r.resume(),U()},e.addResponseHandler=function(e){r._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){R(),q(),y=Xa,U(),ae(e,function(e,t){var n=t.length;if(n>=2){var a=n>2?t[2]:0;if(t.splice(0,n-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var i=t[0]/t[1];t[0]=Math.ceil(i)*t[1]}a>=0&&t[1]>=0&&a>t[1]&&(a=t[1]),t.push(a),v[e]=t}})},e.flush=function(e,t,n){if(void 0===e&&(e=!0),!m)if(n=n||1,e)null==p?(R(),G(1,0,n),p=H(function(){p=null,K(t,n)},0)):f.push(t);else{var a=R();P(1,1,n),null!=t&&t(),a&&U()}},e.setMsaAuthTicket=function(e){r.addHeader(di,e)},e.hasEvents=T,e._setTransmitProfile=function(e){y!==e&&void 0!==v[e]&&(R(),y=e,U())},e._backOffTransmission=function(){I<4&&(I++,R(),U())},e._clearBackOff=function(){I&&(I=0,R(),U())},ge(e,"_setTimeoutOverride",function(){return l.set},function(e){l=Fi(e,l.clear)}),ge(e,"_clearTimeoutOverride",function(){return l.clear},function(e){l=Fi(l.set,e)})}),a}return oa(t,e),t.__ieDyn=1,t}(Ca);var Ni,Bi,ji="HttpManager:_sendBatches",Vi="PrivacyGuard:_processTelemetry",zi=function(){function e(e,t,n){this.start=Date.now(),this.name=e,this.isAsync=!0===n,this.payload=t}return e.prototype.isChildEvt=function(){return!1},e.prototype.complete=function(){this.time=Date.now()-this.start,this.exTime=this.time},e}(),Gi=function(){function e(e){this._callbacks=e}return e.prototype.create=function(e,t,n){return e===ji||e===Vi?new zi(e,t,n):null},e.prototype.fire=function(e){if(e&&e.complete(),this._callbacks)switch(e.name){case ji:this.handleSendBatches(e);break;case Vi:this.handlePrivacyGuardNotification(e)}},e.prototype.setCtx=function(e,t){},e.prototype.getCtx=function(e){},e.prototype.handleSendBatches=function(e){if(this._callbacks.requestProcessingStats){var t=0;if(e.payload){var n=e.payload();if(n.batches)for(var a in n.batches)t+=n.batches[a].evts.length}this._callbacks.requestProcessingStats(e.time||0,t)}},e.prototype.handlePrivacyGuardNotification=function(e){this._callbacks.privacyGuardStats&&e.time&&e.time>0&&this._callbacks.privacyGuardStats(e.time)},e}(),Ki=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,e.__extends)(n,t),n.prototype.initialize=function(n,a){this._postChannel=new Ri;var i=null!=a?a:[];n.channels=[[this._postChannel]],n.extensionConfig=n.extensionConfig||[],n.extensionConfig[this._postChannel.identifier]=(0,e.__assign)((0,e.__assign)({},n.channelConfiguration),n.extensionConfig[this._postChannel.identifier]);try{t.prototype.initialize.call(this,n,i)}catch(e){this.logger.warnToConsole("Failed to initialize SDK."+e)}},n.prototype.setUploadFrequency=function(e){if(this._postChannel&&e){var t=e/1e3,n=t/2,a={};a.OTelCustomTransmissionProfile=[t,n],this._postChannel._loadTransmitProfiles(a),this._postChannel._setTransmitProfile("OTelCustomTransmissionProfile")}},n.prototype.flush=function(e){this._postChannel&&this._postChannel.flush(e)},n.prototype.shutdown=function(){this._postChannel&&this._postChannel.teardown()},n}(qa),Wi=function(t){function n(n,a){var i,r=t.call(this,n,a)||this;r.sendTelemetryEvent=function(e){return function(t,n){try{return void((a=r.getOneDSTelemetryEvent(e))&&i&&i.track(a))}catch(e){return void g(1,"1DS Sink",e)}var a}()},r.sendCustomerContent=function(e){},r.sendNonStandardEvent=function(e,t){var n=!1;c.forEach(function(a){a.canHandle(t)&&(a.processEvent(e),n=!0)}),n||b(0,1,function(){return"Missing Handler for "+t+"to process"+e.eventName})},r.flush=function(e){null==i||i.flush(e),c.forEach(function(t){t.flush(e)})},r.shutdown=function(){try{null==i||i.shutdown(),c.forEach(function(e){e.shutdown()})}catch(e){b(0,2,function(){return"An error occurred on shutdown"})}};var o,s,c=a.nonStandardEventHandlers||[];if(i=function(t,n){var a=t.httpXHROverride,i={instrumentationKey:"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",endpointUrl:t.endpointUrl,channelConfiguration:{eventsLimitInMem:t.eventsLimitInMem,httpXHROverride:a,setTimeoutOverride:t.setTimeoutOverride,clearTimeoutOverride:t.clearTimeoutOverride,ignoreMc1Ms0CookieProcessing:!0,disableOptimizeObj:!0},enableWParam:!a,disableCookiesUsage:!0,extensionConfig:(0,e.__assign)({},t.extensionConfig)};t.stats&&t.stats.networkStats&&i.channelConfiguration&&(i.channelConfiguration.payloadListener=function(e,n){var a,i=n||e;i.data&&(null===(a=t.stats)||void 0===a||a.networkStats(i.data.length))});var r=new Ki;return r.initialize(i,t.plugins),r.setUploadFrequency(t.uploadFrequency),t.notificationListener&&r.addNotificationListener(t.notificationListener),t.stats&&r.setPerfMgr(new Gi(t.stats)),r}(a),c.forEach(function(e){e.initialize(r,a)}),!a.endpointUrl)throw new Error("Missing Endpoint Url");return a.disableStatsTracking||(o=r,(s=i)&&s.addNotificationListener({eventsSent:function(e){b(2,2,function(){return"Successfully sent ".concat(e.length," event(s)")}),b(3,2,function(){return"Sent event(s) details : ".concat(JSON.stringify(e,null,2))}),o.eventsSent+=e.length},eventsDiscarded:function(e,t){b(0,2,function(){return"Discarded ".concat(e.length," event(s) because ").concat(t)}),b(3,2,function(){return"Discarded event(s) details : ".concat(JSON.stringify(e,null,2))}),o.eventsDiscarded+=e.length}})),r}return(0,e.__extends)(n,t),n}(function(e,t){var n=this;this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0;var a,r=[],o=!1,c=!0,d={name:"DiagnosticLevel",processEvent:function(e){var t=e.eventFlags.diagnosticLevel;return o||10===t||110===t||120===t}},l={},u=(a=function(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n=M,a=0;a<4;a++)n+=t[15&(e=wn())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var i=t[8+(3&wn())|0];return n.substr(0,8)+n.substr(9,4)+"4"+n.substr(13,3)+i+n.substr(16,3)+n.substr(19,12)}()).substring(0,8)+"-"+a.substring(8,12)+"-"+a.substring(12,16)+"-"+a.substring(16,20)+"-"+a.substring(20);this.init=function(e){return ze(l,!1)},this.begin=function(){return c=c&&ze(l,!0)},this.getOneDSTelemetryEvent=function(e){return f(e,{eventType:1})},this.getOneDSCustomerContent=function(e){var t=e.telemetryProperties.customerContentVersion;if(t&&Math.floor(t)<=2&&1===e.telemetryProperties.customerContentType)return f(e,{eventType:2})};var f=function(e,t){if(c){var a,i=Xe(e);if(function(e,t){for(var n=function(n){var a=t[n];if(!a.processEvent(e))return b(2,1,function(){return"".concat(e.eventName," suppressed by ").concat(a.name)}),{value:!1}},a=0;a<t.length;a++){var i=n(a);if("object"==typeof i)return i.value}return!0}(i,r)){var o=(a=i,a.timestamp?new Date(a.timestamp):new Date).toISOString(),s={"Event.Name":i.eventName,"Event.Source":"OTelJS","Event.Time":{value:o,propertyType:9}};for(var d in n.eventsProcessed++,s["Event.Sequence"]={value:n.eventsProcessed,propertyType:4},s["Event.Id"]=u+"."+n.eventsProcessed,l)s[d]=l[d];if(!Ue(s,i.dataFields,!0,t.eventType))return void b(0,1,function(){return"Dropping Event: "+i.eventName});var f="custom";i.eventContract&&(i.eventContract.name&&(s["Event.Contract"]=i.eventContract.name,f+="."+i.eventContract.name.toLowerCase().replace(/\./g,"_")),Ue(s,i.eventContract.dataFields,!1,t.eventType));var p=function(e,t){return 2===t?"b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121":e.telemetryProperties&&(1!==t||e.telemetryProperties.ariaTenantToken)?1===t?e.telemetryProperties.ariaTenantToken:void 0:void b(0,1,function(){return"Missing Aria Token"})}(i,t.eventType);if(!p)return;return{iKey:p,name:i.eventName,data:s,time:o,baseType:f,ext:{sdk:{seq:n.eventsProcessed}}}}}};this.addPreprocessor=function(e){r.push(e)},this.getOneDSPersistentDataFields=function(){return l},this.getPreprocessors=function(){return r};var _=function(e){Ue(l,e,!1,1)};this.addPersistentDataFields=_,this.setOptionalEventsEnabled=function(e){o=e},this.setFullEventsEnabled=this.setOptionalEventsEnabled,t.enableOptionalEvents&&(o=!0),_(e);var h,g=t.coreFields;if(g){_(p(g.app)),_(s(g.user)),_(m(g.session));var v=g.release;v&&_((i(h=[],"Release","AudienceGroup",v.audienceGroup,1),h))}this.addPreprocessor(d)}),qi=c(676),Qi=c(207),Yi=c(414),Ji=new URL(c(48),c.b).toString(),Xi=new URL(c(679),c.b).toString(),Zi=new URL(c(807),c.b).toString(),$i=c.p+"officebrowserfeedback_0c215b3ea11b4ad6e0e9830d48189cd9/intl/";function er(){return Ni||(Ni=Yi.SPComponentLoader.loadScript(Xi)),Ni}function tr(){return Bi||(Bi=Yi.SPComponentLoader.loadScript(Zi)),Bi}function nr(t){var n=t.featureArea,a=t.legacyPageContext,i=t.pageContext,r=t.version;if(!(null==a?void 0:a.oneDsCollectorUrl))return{sendTelemetryEvent:function(e,t){var a=new Qi._LogEntry("FloodGateTelemetrySinkNoOneDsCollectorUrl","",Qi._LogType.Event,{featureArea:n,version:r});Qi._EngagementLogger.logEventWithLogEntry(a)}};var o=(0,e.__spreadArray)((0,e.__spreadArray)((0,e.__spreadArray)([],s({primaryIdentityHash:(null==i?void 0:i.aadInfo.userId.toString())||a.aadUserId,primaryIdentitySpace:"UserObjectId",tenantId:(null==i?void 0:i.aadInfo.tenantId.toString())||a.aadTenantId,isAnonymous:Boolean((null==i?void 0:i.user.isAnonymousGuestUser)||a.isAnonymousGuestUser)}),!0),p({name:n,platform:navigator.platform,version:r}),!0),m({id:(null==i?void 0:i.site.correlationId.toString())||a.CorrelationId||qi.Guid.newGuid().toString()}),!0);return new Wi(o,{endpointUrl:a.oneDsCollectorUrl})}})(),d})())})();