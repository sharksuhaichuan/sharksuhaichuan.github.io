(()=>{var e=document.currentScript;define("2cdb4565-e56e-4712-b913-b4a8c0e5e76c_0.1.0",["tslib","@microsoft/sp-core-library","@ms/odsp-utilities-bundle","@ms/sp-vinci-telemetry-sdk","@microsoft/sp-http","@microsoft/sp-page-context","@microsoft/sp-http-base","@ms/odsp-core-bundle","@ms/sp-component-utilities","@microsoft/sp-diagnostics"],(t,n,a,i,r,o,s,c,d,l)=>(()=>{"use strict";var u,f,p,m={676:e=>{e.exports=n},207:e=>{e.exports=l},909:e=>{e.exports=r},737:e=>{e.exports=s},408:e=>{e.exports=o},698:e=>{e.exports=c},939:e=>{e.exports=a},773:e=>{e.exports=d},809:e=>{e.exports=i},280:e=>{e.exports=t}},_={};function h(e){var t=_[e];if(void 0!==t)return t.exports;var n=_[e]={exports:{}};return m[e](n,n.exports,h),n.exports}h.m=m,h.d=(e,t)=>{for(var n in t)h.o(t,n)&&!h.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},h.f={},h.e=e=>Promise.all(Object.keys(h.f).reduce((t,n)=>(h.f[n](e,t),t),[])),h.u=e=>"chunk.xlsx_none_e241e071b2c5b6cb4f8f.js",h.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u={},f="2cdb4565-e56e-4712-b913-b4a8c0e5e76c_0.1.0:",h.l=(e,t,n,a)=>{if(u[e])u[e].push(t);else{var i,r;if(void 0!==n)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var c=o[s];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==f+n){i=c;break}}i||(r=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,h.nc&&i.setAttribute("nonce",h.nc),i.setAttribute("data-webpack",f+n),i.src=e,0!==i.src.indexOf(window.location.origin+"/")&&(i.crossOrigin="anonymous")),u[e]=[t];var d=(t,n)=>{i.onerror=i.onload=null,clearTimeout(l);var a=u[e];if(delete u[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach(e=>e(n)),t)return t(n)},l=setTimeout(d.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=d.bind(null,i.onerror),i.onload=d.bind(null,i.onload),r&&document.head.appendChild(i)}},h.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},p=e?e.src:"",h.p=p.slice(0,p.lastIndexOf("/")+1),(()=>{var e={623:0};h.f.j=(t,n)=>{var a=h.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise((n,i)=>a=e[t]=[n,i]);n.push(a[2]=i);var r=h.p+h.u(t),o=new Error;h.l(r,n=>{if(h.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",o.name="ChunkLoadError",o.type=i,o.request=r,a[1](o)}},"chunk-"+t,t)}};var t=(t,n)=>{var a,i,[r,o,s]=n,c=0;if(r.some(t=>0!==e[t])){for(a in o)h.o(o,a)&&(h.m[a]=o[a]);s&&s(h)}for(t&&t(n);c<r.length;c++)i=r[c],h.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self["webpackJsonp_2cdb4565-e56e-4712-b913-b4a8c0e5e76c_0.1.0"]=self["webpackJsonp_2cdb4565-e56e-4712-b913-b4a8c0e5e76c_0.1.0"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var b={};return(()=>{h.r(b),h.d(b,{ApprovalRequestActionType:()=>P,ApprovalRequestPriority:()=>Tt,ApprovalRequestStatus:()=>Mt,ApprovalStatusColumn:()=>Pt,CampaignExceptionErrorType:()=>W,CopyPageDestinationType:()=>e,CopyToErrorType:()=>a,CopyToJobProgress:()=>n,CopyToWarningType:()=>i,ExcelCsvValidationErrorCode:()=>Je,PUBLICATION_STATUS_INTEGER_MAP:()=>U,PUBLICATION_STATUS_MAP:()=>T,PageCopyScenarioID:()=>t,PublicationStatusEnum:()=>kt,PublishingErrorCodes:()=>s,PublishingStatus:()=>M,QosEventHandler:()=>Vt,VivaAmplifyError:()=>Z,VivaEngageDestinationType:()=>c,_EngageDataProvider:()=>We,_HttpClientErrorResponse:()=>J,_QosAwarePromise:()=>Kt,_VinciAnalyticsDataProvider:()=>at,_VinciApprovalsDataProvider:()=>_t,_VinciCampaignMembersDataProvider:()=>Et,_VinciCampaignsDataProvider:()=>Fe,_VinciPublicationsDataProvider:()=>tt,_VinciSecurebrokerAADTokenDataProvider:()=>nt,_VinciTeamsDataProvider:()=>Lt,_VinciZeroTermSuggestionDataProvider:()=>Ot,debounceAsync:()=>Wt,getErrorCodeFromError:()=>Qt,hasApproverPermissions:()=>Ht,hasContributorPermissions:()=>Rt,hasOwnerPermissions:()=>Ft,hasVisitorPermissions:()=>Nt,isEAPFeatureEnabled:()=>qt});var e,t,n,a,i,r,o,s,c,d=h(280),l=h(676),u=h(939),f=h(809),p="SitePages",m="{listRelativeUrl}",_="{query}",g=function(e){return"v2.1/campaign/".concat(e)},v=function(e){return"SP.Directory.DirectorySession/Group('".concat(e,"')/members?$skip=0&$top=-1&$inlinecount=allpages&$select=PrincipalName,Id,DisplayName,UserType,Mail")},y=function(e){return"/v1.0/groups/".concat(e,"/members?$select=id,displayName,jobTitle,mail,userPrincipalName")},S=function(e){return"/v1.0/groups?$filter=mailnickname%20eq%20'".concat(e,"'")},D="web/GetListUsingPath(DecodedUrl=@a1)/RenderListDataAsStream?@a1='".concat(m,"'&TryNewExperienceSingle=TRUE&").concat(_),I=function(e){return"/sitepages/pages/CopyToStatus('".concat(e,"')")},x=function(e){return"v2.1/campaign/".concat(e,"/oneDrive.EnsureCampaignReady")},C=function(e){return"v2.1/campaign/".concat(e,"/oneDrive.SynchronizeCampaignPersonalCache")},O=function(e){return"/web/GetFileByServerRelativeUrl('".concat(e,"')/recycle()")},w=function(e,t){return"/web/lists(guid'".concat(e,"')/Items(").concat(t,")/recycle()")},E=function(e){return"v2.1/campaign/".concat(e,"/oneDrive.RemoveStaleCacheItem")},A=function(e){return"v2.1/campaign/".concat(e)},L=function(e){return"SP.Directory.DirectorySession/Group('".concat(e,"')")},k=function(e){return"v2.1/campaign/".concat(e)};!function(e){e[e.CurrentWeb=0]="CurrentWeb",e[e.UserMySite=1]="UserMySite",e[e.DestinationUrl=2]="DestinationUrl"}(e||(e={})),function(e){e[e.Default=0]="Default",e[e.AmplifyPublish=1]="AmplifyPublish",e[e.PageMove=2]="PageMove",e[e.PageMoveAndPublish=3]="PageMoveAndPublish",e[e.DuplicatePublication=4]="DuplicatePublication"}(t||(t={})),function(e){e[e.Queued=0]="Queued",e[e.CreateAssetsFolderStart=1]="CreateAssetsFolderStart",e[e.CreateAssetsFolderEnd=2]="CreateAssetsFolderEnd",e[e.CopyAssetsStart=3]="CopyAssetsStart",e[e.CopyAssetsEnd=4]="CopyAssetsEnd",e[e.CreatePageStart=5]="CreatePageStart",e[e.CreatePageEnd=6]="CreatePageEnd",e[e.Succeeded=7]="Succeeded",e[e.Deleting=8]="Deleting",e[e.Failed=9]="Failed",e[e.JobNotFound=10]="JobNotFound"}(n||(n={})),function(e){e[e.None=0]="None",e[e.Generic=1]="Generic",e[e.ArgumentError=2]="ArgumentError",e[e.TargetCheckedOutByDifferentUser=3]="TargetCheckedOutByDifferentUser",e[e.TargetNotFound=4]="TargetNotFound",e[e.UnauthorizedOperation=5]="UnauthorizedOperation",e[e.InvalidDestinationWebUrl=6]="InvalidDestinationWebUrl",e[e.PreProcessorError=7]="PreProcessorError",e[e.PostProcessorError=8]="PostProcessorError",e[e.AssetNotFound=9]="AssetNotFound",e[e.AssetNotFile=10]="AssetNotFile",e[e.UserNotFound=11]="UserNotFound",e[e.OnErrorHandlerError=12]="OnErrorHandlerError",e[e.ErrorDeletingNewlyCreatedPage=13]="ErrorDeletingNewlyCreatedPage"}(a||(a={})),function(e){e[e.None=0]="None",e[e.Generic=1]="Generic",e[e.ErrorDeletingSourcePage=2]="ErrorDeletingSourcePage",e[e.ErrorDeletingSourcePageAssets=3]="ErrorDeletingSourcePageAssets"}(i||(i={})),function(e){e[e.NoError=-1]="NoError",e[e.DestinationSharePointSiteNoPermission=1101]="DestinationSharePointSiteNoPermission",e[e.EmailAddressNotValid=1102]="EmailAddressNotValid",e[e.EmailToMissing=1103]="EmailToMissing",e[e.EmailFromMissing=1104]="EmailFromMissing",e[e.DestinationSharePointSiteMissing=1105]="DestinationSharePointSiteMissing",e[e.AutoChangesNotAcknowledged=1106]="AutoChangesNotAcknowledged",e[e.RequiredApprovalMissing=1107]="RequiredApprovalMissing",e[e.PermissionCheckFailed=1109]="PermissionCheckFailed",e[e.DestinationSharePointSiteInvalid=1108]="DestinationSharePointSiteInvalid",e[e.SpSitesSelectedOverLimit=1110]="SpSitesSelectedOverLimit",e[e.EmailRecipientsSelectedOverLimit=1111]="EmailRecipientsSelectedOverLimit",e[e.TeamsChannelsSelectedOverLimit=1112]="TeamsChannelsSelectedOverLimit",e[e.PublicationTitleMissing=1113]="PublicationTitleMissing",e[e.TeamsImagesUploadedAboveLimit=1114]="TeamsImagesUploadedAboveLimit",e[e.TeamsInvalidSelection=1115]="TeamsInvalidSelection",e[e.ClassicPageStoreNotSupported=1116]="ClassicPageStoreNotSupported",e[e.EmailSubjectMissing=1117]="EmailSubjectMissing",e[e.PublishToEmailFailed=1202]="PublishToEmailFailed",e[e.PublishToSharePointCopyAPIFailed=1203]="PublishToSharePointCopyAPIFailed",e[e.PublishToSharePointPublishAPIFailed=1204]="PublishToSharePointPublishAPIFailed",e[e.PublishToSharePointFailedCopyAPIUnauthorizedOperation=1208]="PublishToSharePointFailedCopyAPIUnauthorizedOperation",e[e.TeamsContentEmpty=1250]="TeamsContentEmpty",e[e.TeamsMissingValues=1251]="TeamsMissingValues",e[e.TeamsMissingMetadata=1252]="TeamsMissingMetadata",e[e.TeamsEmptyAudience=1253]="TeamsEmptyAudience",e[e.TeamsSendAsNotValid=1254]="TeamsSendAsNotValid",e[e.TeamsUnsupportedCardType=1255]="TeamsUnsupportedCardType",e[e.TeamsInvalidContent=1256]="TeamsInvalidContent",e[e.TeamsEmptySender=1257]="TeamsEmptySender",e[e.VivaEngagePermissionDenied=1300]="VivaEngagePermissionDenied",e[e.VivaEngageInvalidThread=1301]="VivaEngageInvalidThread",e[e.VivaEngageUnknownError=1302]="VivaEngageUnknownError",e[e.VivaEngageIsContentTruncated=1303]="VivaEngageIsContentTruncated",e[e.VivaEngageNoDestinations=1304]="VivaEngageNoDestinations",e[e.VivaEngageMixOfCommunitiesAndStorylines=1305]="VivaEngageMixOfCommunitiesAndStorylines",e[e.VivaEngageTooManyCommunities=1306]="VivaEngageTooManyCommunities",e[e.VivaEngageCannotPostAnnouncement=1307]="VivaEngageCannotPostAnnouncement",e[e.VivaEngageUnknownCommunity=1308]="VivaEngageUnknownCommunity",e[e.VivaEngageCannotPostToCommunityCurrentUser=1309]="VivaEngageCannotPostToCommunityCurrentUser",e[e.VivaEngageCannotPostToCommunityDelegation=1310]="VivaEngageCannotPostToCommunityDelegation",e[e.VivaEngageStorylineDoesNotMatchSender=1311]="VivaEngageStorylineDoesNotMatchSender",e[e.VivaEngageCannotPostToStorylineCurrentUser=1312]="VivaEngageCannotPostToStorylineCurrentUser",e[e.VivaEngageCannotPostStorylineAnnouncementCurrentUser=1313]="VivaEngageCannotPostStorylineAnnouncementCurrentUser",e[e.VivaEngageCannotPostToStorylineDelegation=1314]="VivaEngageCannotPostToStorylineDelegation",e[e.VivaEngageCannotPostStorylineAnnouncementDelegation=1315]="VivaEngageCannotPostStorylineAnnouncementDelegation",e[e.VivaEngageValidateContentLengthExceeded=1316]="VivaEngageValidateContentLengthExceeded",e[e.VivaEngageValidatePublishingUserViewOnlyMode=1317]="VivaEngageValidatePublishingUserViewOnlyMode",e[e.VivaEngageValidatePublishingUserUserCannotCreateArticles=1318]="VivaEngageValidatePublishingUserUserCannotCreateArticles",e[e.VivaEngageValidateSenderSenderNull=1319]="VivaEngageValidateSenderSenderNull",e[e.VivaEngageValidateSenderNotDelegate=1320]="VivaEngageValidateSenderNotDelegate",e[e.VivaEngagePublishingUserRetrieveUserSettingsFailed=1321]="VivaEngagePublishingUserRetrieveUserSettingsFailed",e[e.VivaEngageSenderRetrieveUserSettingsFailed=1322]="VivaEngageSenderRetrieveUserSettingsFailed",e[e.VivaEngageSenderRetrieveDelegateTeamsFailed=1323]="VivaEngageSenderRetrieveDelegateTeamsFailed",e[e.VivaEngageTooManyImageAttachments=1324]="VivaEngageTooManyImageAttachments",e[e.VivaEngageNoDefaultStoryline=1325]="VivaEngageNoDefaultStoryline",e[e.VivaEngageContentEmpty=1326]="VivaEngageContentEmpty",e[e.VivaEngageMissingTitle=1327]="VivaEngageMissingTitle",e[e.PublishingPreValidationFailure=1500]="PublishingPreValidationFailure",e[e.PublishingPublicationIsPublishing=1501]="PublishingPublicationIsPublishing",e[e.PublishingSourcePublishingFailed=1502]="PublishingSourcePublishingFailed",e[e.PublishingSourceCheckedOutByOtherUser=1503]="PublishingSourceCheckedOutByOtherUser",e[e.PublishingFailedToAddWITimerJob=1504]="PublishingFailedToAddWITimerJob",e[e.NotApproved=1600]="NotApproved",e[e.SimpleVivaEngageNoDestinationPermission=10301]="SimpleVivaEngageNoDestinationPermission",e[e.SimpleVivaEngageNoStorylinePermission=10302]="SimpleVivaEngageNoStorylinePermission"}(s||(s={})),function(e){e[e.Community=1]="Community",e[e.Storyline=2]="Storyline"}(c||(c={}));var M,P,T=((r={})[0]="Draft",r[1]="Publishing",r[2]="Published",r[3]="NeedsAttention",r[4]="PendingApproval",r[5]="Rejected",r[6]="ReadyToPublish",r[7]="Scheduled",r),U=((o={}).Draft=0,o.Publishing=1,o.Published=2,o.NeedsAttention=3,o.PendingApproval=4,o.Rejected=5,o.ReadyToPublish=6,o.Scheduled=7,o);function F(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}!function(e){e[e.None=0]="None",e[e.Publishing=1]="Publishing",e[e.Failed=2]="Failed",e[e.Successful=3]="Successful"}(M||(M={})),function(e){e[e.Unknown=0]="Unknown",e[e.Request=1]="Request",e[e.Approve=2]="Approve",e[e.Reject=3]="Reject",e[e.Cancel=4]="Cancel",e[e.Declined=5]="Declined",e[e.Pending=6]="Pending",e[e.PendingAll=7]="PendingAll",e[e.CustomResponse=8]="CustomResponse",e[e.Signed=9]="Signed",e[e.Reassign=10]="Reassign",e[e.CopySent=11]="CopySent",e[e.Viewed=12]="Viewed",e[e.SignedAsDelegate=13]="SignedAsDelegate",e[e.NoResponse=1e3]="NoResponse"}(P||(P={}));var H=function(){},R=function(e){function t(t){var n=e.call(this)||this;return n.fieldName=t,n}return(0,d.__extends)(t,e),t.prototype.toString=function(){return'<FieldRef Name="'.concat(this.fieldName,'" />')},t}(H),N=function(e){function t(t,n){var a=e.call(this)||this;return a.value=t,a.valueType=n,a}return(0,d.__extends)(t,e),t.prototype.toString=function(){return'<Value Type="'.concat(F(this.valueType),'">').concat(F(this.value.toString()),"</Value>")},t}(H),B=function(e){function t(t,n,a){var i=e.call(this)||this;return i.operand=t,i.left=n,i.right=a,i}return(0,d.__extends)(t,e),t.prototype.toString=function(){return"<".concat(this.operand,">").concat(this.left.toString()).concat(this.right.toString(),"</").concat(this.operand,">")},t}(H);function j(e,t){for(var n=t[0],a=1;a<t.length;a++)n=new B(e,n,t[a]);return n}var V,z=h(909),G=h(408),K="application/json;odata.metadata=none";!function(e){e[e.Api_Failure=1e3]="Api_Failure",e[e.Api_InvalidArgument=1001]="Api_InvalidArgument",e[e.Api_FlightDisabled=1010]="Api_FlightDisabled",e[e.Api_KillSwitchEnabled=1011]="Api_KillSwitchEnabled",e[e.Api_FlightCheckFailed=1012]="Api_FlightCheckFailed",e[e.Api_ValidationFailed=1013]="Api_ValidationFailed",e[e.Provisioning_Failure=2e3]="Provisioning_Failure",e[e.Provisioning_InvalidArgument=2001]="Provisioning_InvalidArgument",e[e.Provisioning_NotPermitted=2002]="Provisioning_NotPermitted",e[e.Provisioning_ModernSitesDisallowed=2003]="Provisioning_ModernSitesDisallowed",e[e.Provisioning_UpstreamBadRequest=2004]="Provisioning_UpstreamBadRequest",e[e.Provisioning_UpstreamUnauthorized=2005]="Provisioning_UpstreamUnauthorized",e[e.Provisioning_UpstreamSensitivityVisibilityIncompatible=2006]="Provisioning_UpstreamSensitivityVisibilityIncompatible",e[e.Provisioning_UpstreamLabelsNotSupported=2007]="Provisioning_UpstreamLabelsNotSupported",e[e.Provisioning_UpstreamGroupCreationDisabled=2008]="Provisioning_UpstreamGroupCreationDisabled",e[e.Provisioning_UpstreamUncategorized=2009]="Provisioning_UpstreamUncategorized",e[e.Provisioning_FailedToCreateGroupSite=2010]="Provisioning_FailedToCreateGroupSite",e[e.Provisioning_GroupSiteStatusNotReady=2011]="Provisioning_GroupSiteStatusNotReady",e[e.Provisioning_GroupSiteAlreadyExists=2012]="Provisioning_GroupSiteAlreadyExists",e[e.Provisioning_FailedToRetrieveGroup=2013]="Provisioning_FailedToRetrieveGroup",e[e.Provisioning_RetryGroupSiteStatusNotReady=2014]="Provisioning_RetryGroupSiteStatusNotReady",e[e.Provisioning_RetryGroupSiteAlreadyExists=2015]="Provisioning_RetryGroupSiteAlreadyExists",e[e.Provisioning_UserWithoutPermission_XGeo=2016]="Provisioning_UserWithoutPermission_XGeo",e[e.Provisioning_NonUnifiedGroupSiteAlreadyExists=2017]="Provisioning_NonUnifiedGroupSiteAlreadyExists",e[e.Provisioning_GroupNameAndAliasValidationFailed=2018]="Provisioning_GroupNameAndAliasValidationFailed",e[e.Provisioning_FailedToGetSiteUrlDuringValidation=2019]="Provisioning_FailedToGetSiteUrlDuringValidation",e[e.Provisioning_SiteUrlIsTooLong=2020]="Provisioning_SiteUrlIsTooLong",e[e.Provisioning_DetectedLanguageIsNotSupportedForTransliteration=2021]="Provisioning_DetectedLanguageIsNotSupportedForTransliteration",e[e.Provisioning_DetectedLanguageIsPresentInSupportedLanguages=2022]="Provisioning_DetectedLanguageIsPresentInSupportedLanguages",e[e.Provisioning_DetectedLanguageIsNotSupportedForTransliterationToLatin=2023]="Provisioning_DetectedLanguageIsNotSupportedForTransliterationToLatin",e[e.Provisioning_CouldNotDetermineSourceScriptForTransliteration=2024]="Provisioning_CouldNotDetermineSourceScriptForTransliteration",e[e.Provisioning_FailedToDetectLanguage=2025]="Provisioning_FailedToDetectLanguage",e[e.Provisioning_FailedToDetectUniqueScript=2026]="Provisioning_FailedToDetectUniqueScript",e[e.Provisioning_CallToTranslatorAPIFailed_Detect=2027]="Provisioning_CallToTranslatorAPIFailed_Detect",e[e.Provisioning_CallToTranslatorAPIFailed_Languages=2028]="Provisioning_CallToTranslatorAPIFailed_Languages",e[e.Provisioning_CallToTranslatorAPIFailed_Transliterate=2029]="Provisioning_CallToTranslatorAPIFailed_Transliterate",e[e.Provisioning_AliasAlreadyInUse=2030]="Provisioning_AliasAlreadyInUse",e[e.Provisioning_CampaignNameSanitizationResultedInEmptyAlias=2031]="Provisioning_CampaignNameSanitizationResultedInEmptyAlias",e[e.Provisioning_GroupNameAndAliasValidationFailed_BlockedWord=2032]="Provisioning_GroupNameAndAliasValidationFailed_BlockedWord",e[e.Provisioning_GroupNameAndAliasValidationFailed_PrefixSuffixRequired=2033]="Provisioning_GroupNameAndAliasValidationFailed_PrefixSuffixRequired",e[e.Provisioning_FailedToCreateTranslatorClient=2034]="Provisioning_FailedToCreateTranslatorClient",e[e.Storage_Failure=3e3]="Storage_Failure",e[e.Storage_InvalidArgument=3001]="Storage_InvalidArgument",e[e.Storage_Unauthorized=3002]="Storage_Unauthorized",e[e.Storage_NoSuchCampaign=3010]="Storage_NoSuchCampaign",e[e.Storage_NoSuchCommunication=3011]="Storage_NoSuchCommunication",e[e.Storage_FeatureActivationFailed=3012]="Storage_FeatureActivationFailed",e[e.Storage_SPWebIdDoesNotMatchCampaignId=3013]="Storage_SPWebIdDoesNotMatchCampaignId",e[e.Storage_ListFailure=3014]="Storage_ListFailure",e[e.Storage_ListItemFailure=3015]="Storage_ListItemFailure",e[e.Storage_FailedToUpdateCampaignMetadata=3016]="Storage_FailedToUpdateCampaignMetadata",e[e.Storage_ApproverGroupManagementFailed=3017]="Storage_ApproverGroupManagementFailed",e[e.Storage_CampaignCreationAlreadyComplete=3018]="Storage_CampaignCreationAlreadyComplete",e[e.Storage_UpdateCampaignMembershipFailed=3019]="Storage_UpdateCampaignMembershipFailed",e[e.Storage_UpdateCampaignListFailed=3020]="Storage_UpdateCampaignListFailed",e[e.Storage_RemoteApiRequestUnexpectedResponseStatus=3021]="Storage_RemoteApiRequestUnexpectedResponseStatus",e[e.Storage_UpdateCampaignSaveConflict=3022]="Storage_UpdateCampaignSaveConflict",e[e.Storage_RemoteApiRequestUnrecognizedFailure=3023]="Storage_RemoteApiRequestUnrecognizedFailure",e[e.PersonalCache_Failure=4e3]="PersonalCache_Failure",e[e.PersonalCache_InvalidArgument=4001]="PersonalCache_InvalidArgument",e[e.PersonalCache_UserInfoNotFound=4011]="PersonalCache_UserInfoNotFound",e[e.PersonalCache_AddWorkItemThrottled=4012]="PersonalCache_AddWorkItemThrottled",e[e.PersonalCache_AddWorkItemFailed=4013]="PersonalCache_AddWorkItemFailed",e[e.PersonalCache_MySiteNotInLocalFarm=4014]="PersonalCache_MySiteNotInLocalFarm",e[e.PersonalCache_PersonalSiteNotFound=4015]="PersonalCache_PersonalSiteNotFound",e[e.PersonalCache_OSRV_FolderNotFound=4100]="PersonalCache_OSRV_FolderNotFound",e[e.PersonalCache_OSRV_PersonalSiteNotFound=4101]="PersonalCache_OSRV_PersonalSiteNotFound",e[e.PersonalCache_OSRV_PersonalCacheListNotFound=4102]="PersonalCache_OSRV_PersonalCacheListNotFound",e[e.PersonalCache_OSRV_PersonalCacheListProvisionFailed=4103]="PersonalCache_OSRV_PersonalCacheListProvisionFailed",e[e.PersonalCache_OSRV_PersonalCacheItemProvisionFailed=4104]="PersonalCache_OSRV_PersonalCacheItemProvisionFailed",e[e.PersonalCache_OSRV_FailedToRetreiveCacheListItems=4105]="PersonalCache_OSRV_FailedToRetreiveCacheListItems",e[e.PersonalCache_OSRV_PersonalCacheItemInvalidListItemId=4106]="PersonalCache_OSRV_PersonalCacheItemInvalidListItemId",e[e.PersonalCache_OSRV_FailedToUpdateCacheListItem=4107]="PersonalCache_OSRV_FailedToUpdateCacheListItem",e[e.PersonalCache_OSRV_ProfileNotFound=4108]="PersonalCache_OSRV_ProfileNotFound",e[e.Permission_Failure=5e3]="Permission_Failure",e[e.Permission_UserAddFailure=5001]="Permission_UserAddFailure",e[e.Permission_UserRemoveFailure=5002]="Permission_UserRemoveFailure",e[e.Permission_NoOwnerSpecified=5003]="Permission_NoOwnerSpecified",e[e.Permission_UserRoleRetrievalFailure=5004]="Permission_UserRoleRetrievalFailure",e[e.AudienceTargeting_FailedToEnableSPAudienceTargeting=6e3]="AudienceTargeting_FailedToEnableSPAudienceTargeting"}(V||(V={}));const W=V;function q(){return l._SPKillSwitch.isActivated("39315ac0-b7a0-4132-807d-3ba754a71ef1")}var Q="HttpClientErrorResponse",Y=function(e){function t(n){var a,i,r,o,s=e.call(this,n.statusText||"statusMessage"in n&&n.statusMessage||"")||this;return s.name=Q,s.httpStatusCode=null!==(a=n.status)&&void 0!==a?a:-1,l._SPKillSwitch.isActivated("5433d34f-9f72-4fe0-b305-dc560e2c5bb1")?s.response=n:(null==n?void 0:n.clone)&&(s.response=n.clone()),!l._SPKillSwitch.isActivated("2979d324-1f22-4a78-a860-4f6b8eed78a1")&&(null==n?void 0:n.clone)&&(s.graphErrorInfo=null===(r=null===(i=null==n?void 0:n.clone())||void 0===i?void 0:i.json())||void 0===r?void 0:r.then(function(e){var t,n,a,i,r,o,s;return{message:null!==(n=null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)&&void 0!==n?n:"",code:null!==(i=null===(a=null==e?void 0:e.error)||void 0===a?void 0:a.code)&&void 0!==i?i:"",clientRequestId:null!==(s=null===(o=null===(r=null==e?void 0:e.error)||void 0===r?void 0:r.innerError)||void 0===o?void 0:o["client-request-id"])&&void 0!==s?s:""}}).catch(function(){})),s.campaignErrorInfo=null===(o=null==n?void 0:n.json())||void 0===o?void 0:o.then(function(e){var n,a,i,r,o;if(null===(i=null===(a=null===(n=null==e?void 0:e.error)||void 0===n?void 0:n.message)||void 0===a?void 0:a.toLowerCase())||void 0===i?void 0:i.includes("the call to update the mailbox returned forbidden"))return{errorCode:403,errorDescription:"The call to update the mailbox returned forbidden",errorType:"SubstrateForbiddenErrorType"};var c=null===(r=null==e?void 0:e.error)||void 0===r?void 0:r["@error.campaignErrorType"];switch(c){case void 0:break;case W.Api_FlightDisabled:case W.Api_KillSwitchEnabled:return{errorCode:c,errorDescription:t._buildErrorDescription(c),errorType:"TransientCampaignErrorType"};case W.Storage_CampaignCreationAlreadyComplete:return{errorCode:c,errorDescription:t._buildErrorDescription(c),errorType:"CampaignAlreadyCreatedErrorType"};default:return{errorCode:c,errorDescription:t._buildErrorDescription(c),errorType:"PermanentCampaignErrorType"}}var d=null===(o=null==e?void 0:e.error)||void 0===o?void 0:o["@error.VivaAmplifyErrorType"];return void 0!==d?{errorCode:s.httpStatusCode,errorDescription:d}:void 0}).catch(function(){}),s}return(0,d.__extends)(t,e),t.is=function(e){return"object"==typeof e&&null!==e&&"name"in e&&e.name===Q},t._buildErrorDescription=function(e){var t;return null!==(t=W[e])&&void 0!==t?t:"UncategorizedError_".concat(e)},t}(Error);const J=Y;var X="VivaAmplifyError";const Z=function(e){function t(t,n){var a=e.call(this,null!=n?n:t)||this;return a.name=X,a.errorType=t,a}return(0,d.__extends)(t,e),t.is=function(e){return"object"==typeof e&&null!==e&&"name"in e&&e.name===X},t}(Error);var $=function(){function e(e){this._componentAlias=e,this._amplifyLogger=f._AmplifyLogger.getAmplifyLogger()}return e.prototype.createEvent=function(e){var t,n,a=this,i=l.Guid.newGuid().toString(),r={alias:null!==(n=null!==(t=e.componentAlias)&&void 0!==t?t:this._componentAlias)&&void 0!==n?n:"",spResponseGuid:i},o=this._amplifyLogger.createQosEvent(e.qosEventName,r);return{spResponseGuid:i,logSuccess:function(){return o.logSuccess(r)},logExpectedFailure:function(e){return o.logExpectedFailure(a._getErrorCode(e),e,r)},logUnexpectedFailure:function(e){return o.logUnexpectedFailure(a._getErrorCode(e),e,r)}}},e.prototype._getErrorCode=function(e){return!l._SPKillSwitch.isActivated("43692b16-075b-47e3-9cfc-42a10a7ceae8")&&J.is(e)?[null==e?void 0:e.httpStatusCode,null==e?void 0:e.message].filter(function(e){return!!e}).join(" - "):"".concat(null==e?void 0:e.message)},e}();const ee=$;function te(){return l._SPKillSwitch.isActivated("9a570e8c-a838-413f-a382-ed52b36ffd94")}var ne=function(){function e(e){var t=this;l.Validate.isNotNullOrUndefined(e,"serviceScope"),e.whenFinished(function(){t._spHttpClient=e.consume(z.SPHttpClient.serviceKey),t._pageContext=e.consume(G.PageContext.serviceKey)}),this._logger=new ee}return Object.defineProperty(e.prototype,"absoluteUrl",{get:function(){var e,t;return null===(t=null===(e=this._pageContext)||void 0===e?void 0:e.web)||void 0===t?void 0:t.absoluteUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverRelativeUrl",{get:function(){var e,t;return null===(t=null===(e=this._pageContext)||void 0===e?void 0:e.web)||void 0===t?void 0:t.serverRelativeUrl},enumerable:!1,configurable:!0}),e.prototype.get=function(e,t){var n=e.relativeUrl,a=e.baseUrl,i=e.telemetry,r=(0,d.__rest)(e,["relativeUrl","baseUrl","telemetry"]),o=this._logger.createEvent(i),s=this._spHttpClient.get(this._generateUrl(n,a),z.SPHttpClient.configurations.v1,(0,d.__assign)((0,d.__assign)({},te()?{}:r),{headers:(0,d.__assign)({SPResponseGuid:o.spResponseGuid,accept:K},t)}));return this._handleResponse(s,o)},e.prototype.post=function(e,t){var n=e.relativeUrl,a=e.baseUrl,i=e.telemetry,r=e.body,o=(0,d.__rest)(e,["relativeUrl","baseUrl","telemetry","body"]),s=this._logger.createEvent(i),c=this._spHttpClient.post(this._generateUrl(n,a),z.SPHttpClient.configurations.v1,(0,d.__assign)((0,d.__assign)({body:null!=r?r:""},te()?{}:o),{headers:(0,d.__assign)({accept:K,SPResponseGuid:s.spResponseGuid},t)}));return this._handleResponse(c,s)},e.prototype.patch=function(e,t){var n=e.relativeUrl,a=e.baseUrl,i=e.telemetry,r=e.body,o=(0,d.__rest)(e,["relativeUrl","baseUrl","telemetry","body"]),s=this._logger.createEvent(i),c=this._spHttpClient.fetch(this._generateUrl(n,a),z.SPHttpClient.configurations.v1,(0,d.__assign)((0,d.__assign)({},te()?{}:o),{body:null!=r?r:"",headers:(0,d.__assign)({accept:K,SPResponseGuid:s.spResponseGuid},t),method:"PATCH"}));return this._handleResponse(c,s)},e.prototype.delete=function(e,t){var n=e.relativeUrl,a=e.baseUrl,i=e.telemetry,r=e.body,o=(0,d.__rest)(e,["relativeUrl","baseUrl","telemetry","body"]),s=this._logger.createEvent(i),c=this._spHttpClient.fetch(this._generateUrl(n,a),z.SPHttpClient.configurations.v1,(0,d.__assign)((0,d.__assign)({},te()?{}:o),{body:null!=r?r:"",headers:(0,d.__assign)({accept:K,SPResponseGuid:s.spResponseGuid},t),method:"delete"}));return this._handleResponse(c,s)},e.prototype._handleResponse=function(e,t){return e.then(function(e){if(!e.ok)throw new J(e);return t.logSuccess(),e}).then(function(e){var t;return 204!==e.status&&(null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.startsWith("application/json"))?e.json():void 0}).catch(function(e){throw t.logUnexpectedFailure(e),e})},e.prototype._generateUrl=function(e,t){return u.Uri.concatenate(null!=t?t:this.absoluteUrl,"_api",e)},e.serviceKey=l.ServiceKey.create("sp-vinci-data-provider:VinciDataProvider",e),e}();const ae=ne;var ie="{pageId}",re="{siteCount}",oe="{correlationId}",se="{queryText}",ce="{teamId}",de="{channelId}",le="{listUrl}",ue="{formId}",fe="".concat("/Web/Lists/GetByTitle('Site%20Pages')","/EnableModeration"),pe="/web/GetList(@a1)/Items(@a2)/ValidateUpdateListItem()?@a1='".concat(le,"'&@a2='").concat(ue,"'"),me="/sitepages/pages(".concat(ie,")"),_e="/_api/v2.1/insights/recentSites?%24top=".concat(re),he="https://graph.microsoft.com",be="https://substrate.office.com",ge="/search/api/v1/suggestions?query=".concat(se,"&cvid=").concat(oe,"&scenario=PublishToTeams&entityTypes=Channel,Team"),ve="/web/Features/GetById(guid'".concat("F59E18C0-B7E6-4230-A099-A5E70259D368","')"),ye="https://outlook.office365.com/search",Se="/teams/".concat(ce,"/channels/").concat(de),De="/v1.0/".concat(Se),Ie="/v1.0/teams/".concat(ce),xe="/v1.0/$batch",Ce=h(737),Oe=function(){function e(e){var t=this;l.Validate.isNotNullOrUndefined(e,"serviceScope"),e.whenFinished(function(){t._aadHttpClient=e.consume(Ce.AadHttpClientFactory.serviceKey)._getStandardClient(he),t._pageContext=e.consume(G.PageContext.serviceKey)}),this._logger=new ee}return Object.defineProperty(e.prototype,"absoluteUrl",{get:function(){var e,t;return null===(t=null===(e=this._pageContext)||void 0===e?void 0:e.web)||void 0===t?void 0:t.absoluteUrl},enumerable:!1,configurable:!0}),e.prototype.get=function(e){var t=this._generateUrl(e.relativeUrl,e.baseUrl),n=this._logger.createEvent(e.telemetry),a=this._aadHttpClient.then(function(e){return e.get(t,z.AadHttpClient.configurations.v1)});return this._handleResponse(a,n)},e.prototype.post=function(e){var t=this._generateUrl(e.relativeUrl,e.baseUrl),n=this._logger.createEvent(e.telemetry),a=this._aadHttpClient.then(function(n){return n.post(t,z.AadHttpClient.configurations.v1,{body:e.body})});return this._handleResponse(a,n)},e.prototype.batchCall=function(e){var t=this._generateUrl(xe,e.baseUrl),n=this._logger.createEvent(e.telemetry),a=this._aadHttpClient.then(function(n){var a;return n.post(t,z.AadHttpClient.configurations.v1,{body:JSON.stringify((0,d.__assign)({requests:e.batchRequests},JSON.parse(null!==(a=null==e?void 0:e.body)&&void 0!==a?a:"{}"))),headers:{"Content-Type":"application/json"}})});return this._handleResponse(a,n)},e.prototype._handleResponse=function(e,t){return e.then(function(e){if(!e.ok){var n=new J(e);throw t.logUnexpectedFailure(n),n}return t.logSuccess(),e}).then(function(e){var t;return 204!==e.status&&(null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.startsWith("application/json"))?e.json():void 0}).catch(function(e){throw t.logUnexpectedFailure(e),e})},e.prototype._generateUrl=function(e,t){return u.Uri.concatenate(null!=t?t:he,e)},e.serviceKey=l.ServiceKey.create("sp-vinci-data-provider:VinciGraphDataProvider",e),e}();const we=Oe;var Ee={alias:f._AUTHORING_TEAMS_DRAFT_CONTEXT},Ae={channels:[],chats:[],people:[]},Le={teams:Ae,sharepoint:[]};function ke(e,t,n){var a=f._AmplifyLogger.getAmplifyLogger().createQosEvent("CampaignManagement.ParsePublicationField.Event");try{t[n]=e(t[n]),a.logSuccess()}catch(e){a.logUnexpectedFailure("Failed to deserialize ".concat(n),e),t[n]=void 0}}var Me=JSON.parse,Pe=JSON.parse;function Te(e){ke(Me,e,"_AmplifyCampaignMetadata"),ke(Me,e,"_AmplifyCampaignEndpointSharePoint"),ke(Me,e,"_AmplifyCampaignEndpointEmail"),ke(Me,e,"_AmplifyCampaignEndpointTeams"),ke(Me,e,"_AmplifyCampaignEndpointVivaEngage"),ke(Pe,e,"_AmplifyCampaignPublicationStatus")}var Ue=function(){function e(e){var t=this;l.Validate.isNotNullOrUndefined(e,"serviceScope"),e.whenFinished(function(){t._vinciDataProvider=e.consume(ae.serviceKey),t._vinciGraphDataProvider=e.consume(we.serviceKey),t._pageContext=e.consume(G.PageContext.serviceKey)})}return Object.defineProperty(e.prototype,"_groupId",{get:function(){if(!this._pageContext.site.group)throw new Error("Page Context Site Group is null or undefined.");return this._pageContext.site.group.id.toString()},enumerable:!1,configurable:!0}),e.prototype.generateCampaignUrl=function(e,t){return this._vinciDataProvider.post({relativeUrl:"v2.1/campaign/oneDrive.GenerateCampaignUrl",body:JSON.stringify({name:e}),telemetry:{componentAlias:null==t?void 0:t.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.GenerateCampaignUrl.Api"}}).then(function(e){return e.value})},e.prototype.getValidSiteUrlFromAlias=function(e,t){return this._vinciDataProvider.get({relativeUrl:(n=u.UriEncoding.encodeRestUriStringToken(e),"GroupSiteManager/GetValidSiteUrlFromAlias?alias='".concat(n,"'&isTeamSite=true")),telemetry:{componentAlias:null==t?void 0:t.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.GetValidSiteUrlFromAlias.Api"}}).then(function(e){return e.value});var n},e.prototype.getGroupByAlias=function(e,t){return this._vinciGraphDataProvider.get({relativeUrl:S(u.UriEncoding.encodeRestUriStringToken(e)),telemetry:{componentAlias:null==t?void 0:t.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.GetGroupByAlias.Api"}}).then(function(e){return e.value.length?e.value[0]:void 0})},e.prototype.validateGroupName=function(e,t,n){return this._vinciDataProvider.post({relativeUrl:"SP.Directory.DirectorySession/ValidateGroupName",body:JSON.stringify({displayName:e,alias:t}),telemetry:{componentAlias:null==n?void 0:n.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.ValidateGroupName.Api"}},l._SPKillSwitch.isActivated("f47e21ea-19c5-41f8-a3ba-a1b706555c8b")?void 0:{"X-ClientType":"VinciCampaignsDataProvider_ValidateGroupName"})},e.prototype.getInstalledLanguages=function(e){return this._vinciDataProvider.get({relativeUrl:"web/regionalsettings/installedlanguages",telemetry:{componentAlias:null==e?void 0:e.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.GetInstalledLanguages.Api"}}).then(function(e){return e.Items})},e.prototype.getCampaignSiteId=function(e,t){return this._vinciDataProvider.get({relativeUrl:"Site/Id",baseUrl:e,telemetry:{componentAlias:null==t?void 0:t.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.GetCampaignSiteId.Api"}}).then(function(e){return e.value})},e.prototype.createCampaign=function(e,t){return this._vinciDataProvider.post({relativeUrl:"v2.1/campaign",body:JSON.stringify(e),telemetry:{componentAlias:null==t?void 0:t.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.CreateCampaign.Api"}})},e.prototype.createCampaignWithRetryBackoff=function(e,t,n,a){return this._createCampaignWithRetryBackoffInternal(e,t,t,n,a)},e.prototype.updateCampaign=function(e,t,n){return this._vinciDataProvider.patch({relativeUrl:A(e),body:JSON.stringify(t),telemetry:{componentAlias:null==n?void 0:n.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.UpdateCampaign.Api"}})},e.prototype.getCampaign=function(e,t){return this._vinciDataProvider.get({relativeUrl:g(e),telemetry:{componentAlias:null==t?void 0:t.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.GetCampaign.Api"}})},e.prototype.deleteCampaign=function(e,t,n){return this._vinciDataProvider.delete({relativeUrl:k(t),telemetry:{componentAlias:null==n?void 0:n.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.DeleteCampaign.Api"}})},e.prototype.removeStaleCacheItem=function(e,t){return this._vinciDataProvider.post({relativeUrl:E(e),telemetry:{componentAlias:null==t?void 0:t.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.RemoveStaleCacheItem.Api"}})},e.prototype.createPage=function(e,t){return this._vinciDataProvider.post({relativeUrl:"sitepages/pages/publications",body:JSON.stringify(e),telemetry:{componentAlias:null==t?void 0:t.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.CreatePage.Api"}})},e.prototype.deletePage=function(e,t,n){return this._vinciDataProvider.post({relativeUrl:(a=e.PageId,"/sitepages/pages(".concat(a,")/DeletePublication")),telemetry:{componentAlias:null==t?void 0:t.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.DeletePage.Api"}},n).then(function(e){return e.value});var a},e.prototype.undeletePublications=function(e,t){return this._vinciDataProvider.post({relativeUrl:l._SPKillSwitch.isActivated("0e4815f4-e498-4845-80da-237d0e54f961")?"site/RecycleBin/RestoreByIds":"web/RecycleBin/RestoreByIds",body:JSON.stringify(e),telemetry:{componentAlias:null==t?void 0:t.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.UndeletePublications.Api"}})},e.prototype.copyTo=function(e,t,n){return this._vinciDataProvider.post({relativeUrl:(a=e,"/sitepages/pages(".concat(a,")/CopyTo")),body:JSON.stringify({copyToParams:t}),telemetry:{componentAlias:null==n?void 0:n.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.CopyTo.Api"}});var a},e.prototype.copyToStatus=function(e,t){return this._vinciDataProvider.get({relativeUrl:I(e),telemetry:{componentAlias:null==t?void 0:t.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.CopyToStatus.Api"}})},e.prototype.ensureCampaignReady=function(e,t,n){return this._vinciDataProvider.post({relativeUrl:x(e),body:JSON.stringify({value:t}),telemetry:{componentAlias:null==n?void 0:n.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.EnsureCampaignReady.Api"}})},e.prototype.synchronizeCampaignPersonalCache=function(e,t,n){return this._vinciDataProvider.post({relativeUrl:C(e),body:JSON.stringify({items:t}),telemetry:{componentAlias:null==n?void 0:n.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.SynchronizeCampaignPersonalCache.Api"}})},e.prototype.getGroupCreationContext=function(e){return this._vinciDataProvider.get({relativeUrl:"GroupSiteManager/GetGroupCreationContext",telemetry:{componentAlias:null==e?void 0:e.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.GetGroupCreationContext.Api"}})},e.prototype.syncGroupProperties=function(e){return this._vinciDataProvider.post({relativeUrl:"GroupService/SyncGroupProperties",telemetry:{componentAlias:null==e?void 0:e.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.SyncGroupProperties.Api"}})},e.prototype.updateGroupSensitivityLabelId=function(e,t,n){return this._vinciDataProvider.patch({relativeUrl:L(e),body:JSON.stringify(t),telemetry:{componentAlias:null==n?void 0:n.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.UpdateGroupSensitivityLabelId.Api"}})},e.prototype.getPublicationById=function(e,t){var n=u.Uri.concatenate(this._vinciDataProvider.serverRelativeUrl,p);return this._renderListDataAsStream({relativeUrl:n,query:"",requestBody:this._buildRequestBodyForGetPublications(this._getPublicationByIdViewXml(e)),telemetry:{componentAlias:null==t?void 0:t.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.GetPublicationById.Api"}}).then(function(e){if(0!==e.length){var t=e[0];return Te(t),t}})},e.prototype.getPublicationByUniqueId=function(e,t){var n=u.Uri.concatenate(this._vinciDataProvider.serverRelativeUrl,p);return this._renderListDataAsStream({relativeUrl:n,query:"",requestBody:this._buildRequestBodyForGetPublications(this._getPublicationByUniqueIdViewXml(e)),telemetry:{componentAlias:null==t?void 0:t.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.GetPublicationByUniqueId.Api"}}).then(function(e){if(0!==e.length){var t=e[0];return Te(t),t}})},e.prototype.getPublications=function(e,t){var n=this,a=u.Uri.concatenate(this._vinciDataProvider.serverRelativeUrl,p),i=void 0===e.pageSize?"":"OverrideRowLimit=".concat(e.pageSize),r=this._getPublicationsViewXml(e.filter,e.sortBy,e.sortAscending);return this._renderListDataAsStream({relativeUrl:a,query:i,requestBody:this._buildRequestBodyForGetPublications(r),telemetry:{componentAlias:null==t?void 0:t.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.GetPublications.Api"}}).then(function(a){var i,o=[];(o=e.isTemplate?a.filter(function(e){return"Template"===e._SPSitePageFlags[0]}):a.filter(function(e){return"Template"!==e._SPSitePageFlags[0]})).forEach(Te);var s={results:o,page:1,pageSize:null!==(i=e.pageSize)&&void 0!==i?i:a.length,sortBy:e.sortBy,sortAscending:e.sortAscending,viewXml:r};return a.length===e.pageSize&&(s.nextPage=function(){return n._getPublicationsNextPage(s,t)}),s})},e.prototype.getCampaignCollection=function(e){return this._vinciDataProvider.get({relativeUrl:"v2.1/campaign/oneDrive.GetCampaignCollection",telemetry:{componentAlias:null==e?void 0:e.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.GetCampaignCollection.Api"}})},e.prototype.getAllUsers=function(e,t){return this._vinciDataProvider.get({relativeUrl:v(e.toString()),telemetry:{componentAlias:null==t?void 0:t.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.GetAllUsers.Api"}}).then(function(e){return e.value})},e.prototype.getSiteUsers=function(e){return this._vinciDataProvider.get({relativeUrl:"/web/siteusers?$select=Id,Title,Email,LoginName,UserPrincipalName",telemetry:{componentAlias:null==e?void 0:e.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.GetSiteUsers.Api"}}).then(function(e){return e.value})},e.prototype.getPublishedAudiences=function(e){var t={filter:{publicationStatuses:["Published"],authors:[this._pageContext.user.displayName],distributionChannels:["SharePoint","Teams"],publicationId:""},sortBy:"_AmplifyCampaignPublicationStatus",sortAscending:!1};return this.getPublications(t,e).then(function(e){var t={teams:Ae,sharepoint:[]};return e.results.forEach(function(e){var n,a,i,r,o,s,c,l,u,p,m,_,h,b,g,v,y=e._AmplifyCampaignEndpointTeams;y&&(t.teams={channels:(0,d.__spreadArray)((0,d.__spreadArray)([],null!==(a=null===(n=t.teams)||void 0===n?void 0:n.channels)&&void 0!==a?a:[],!0),null!==(r=null===(i=null==y?void 0:y.selectedItems)||void 0===i?void 0:i.channels.filter(function(e){var n,a;return!(null===(a=null===(n=null==t?void 0:t.teams)||void 0===n?void 0:n.channels)||void 0===a?void 0:a.some(function(t){return t.threadId===e.threadId}))}))&&void 0!==r?r:[],!0),chats:(0,d.__spreadArray)((0,d.__spreadArray)([],null!==(s=null===(o=t.teams)||void 0===o?void 0:o.chats)&&void 0!==s?s:[],!0),null!==(l=null===(c=null==y?void 0:y.selectedItems)||void 0===c?void 0:c.chats.filter(function(e){var n,a;return!(null===(a=null===(n=null==t?void 0:t.teams)||void 0===n?void 0:n.chats)||void 0===a?void 0:a.some(function(t){return t.threadId===e.threadId}))}))&&void 0!==l?l:[],!0),people:(0,d.__spreadArray)((0,d.__spreadArray)([],null!==(p=null===(u=t.teams)||void 0===u?void 0:u.people)&&void 0!==p?p:[],!0),null!==(_=null===(m=null==y?void 0:y.selectedItems)||void 0===m?void 0:m.people.filter(function(e){var n,a;return!(null===(a=null===(n=null==t?void 0:t.teams)||void 0===n?void 0:n.people)||void 0===a?void 0:a.some(function(t){return t.id===e.id}))}))&&void 0!==_?_:[],!0)});var S=e._AmplifyCampaignEndpointSharePoint;if(S){var D=Array.isArray(t.sharepoint)?t.sharepoint:null===(h=t.sharepoint)||void 0===h?void 0:h.sites;if(t.sharepoint={sites:(0,d.__spreadArray)((0,d.__spreadArray)([],null!=D?D:[],!0),null!==(g=null===(b=null==S?void 0:S.sites)||void 0===b?void 0:b.filter(function(e){return!(null==D?void 0:D.some(function(t){return t.siteId===e.siteId}))}))&&void 0!==g?g:[],!0)},!q()){var I=(null!==(v=null==S?void 0:S.sites)&&void 0!==v?v:[]).filter(function(e){return null===e.webId});I.length>0&&f._AmplifyLogger.getAmplifyLogger().createQosEvent("VivaAmplify.VinciPublicationsDataProvider.GetPublishedAudienceReturnsNullWebId.Api").logUnexpectedFailure("SharePoint audience has sites with missing webId",new Error("Found sites with missing webId: ".concat(I.map(function(e){return e.siteId}).join(", "))))}}}),t})},e.prototype.getAuthors=function(e,t){var n=u.Uri.concatenate(this._vinciDataProvider.serverRelativeUrl,p),a=this._getAuthorsViewXml(e);return this._renderListDataAsStream({relativeUrl:n,query:"",requestBody:this._buildRequestBodyForGetPublications(a),telemetry:{componentAlias:null==t?void 0:t.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.GetAuthors.Api"}}).then(function(e){return e.flatMap(function(e){return e.Author})})},e.prototype.getPublicationStatuses=function(e,t){var n=u.Uri.concatenate(this._vinciDataProvider.serverRelativeUrl,p),a=this._getPublicationStatuses(e);return this._renderListDataAsStream({relativeUrl:n,query:"",requestBody:this._buildRequestBodyForGetPublications(a),telemetry:{componentAlias:null==t?void 0:t.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.GetPublicationStatuses.Api"}}).then(function(e){return e.flatMap(function(e){return e._AmplifyCampaignPublicationStatus}).filter(function(e){return!!e}).map(function(e){return T[e]})})},e.prototype.getDistributionChannels=function(e,t,n){var a=this,i=u.Uri.concatenate(this._vinciDataProvider.serverRelativeUrl,p),r=e?["VivaEngage","Outlook","SharePoint","Teams"]:["Outlook","SharePoint","Teams"];return Promise.allSettled(r.map(function(e){return function(e){return a._renderListDataAsStream({relativeUrl:i,query:"",requestBody:a._buildRequestBodyForGetPublications(a._getDistributionChannel(t,e)),telemetry:{componentAlias:null==n?void 0:n.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.GetDistributionChannels.Api"}}).then(function(t){return t.length>0?e:void 0})}(e)})).then(function(e){return e.map(function(e){return"fulfilled"===e.status?e.value:void 0}).filter(function(e){return!!e})})},e.prototype.getCanUserCreateGroup=function(e){return this._vinciDataProvider.get({relativeUrl:"GroupSiteManager/CanUserCreateGroup",telemetry:{componentAlias:null==e?void 0:e.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.GetCanUserCreateGroup.Api"}}).then(function(e){return e.value})},e.prototype.getMyOneDriveInfo=function(e){return this._vinciGraphDataProvider.get({relativeUrl:"v1.0/me/drive",telemetry:{componentAlias:null==e?void 0:e.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.GetMyOneDriveInfo.Api"}})},e.prototype.deleteTemplate=function(e,t,n,a,i){return this._vinciDataProvider.post({relativeUrl:n&&a?w(n,a):O(t),body:e,telemetry:{componentAlias:null==i?void 0:i.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.DeleteTemplate.Api"}}).then(function(){return!0})},e.prototype.getCampaignUsers=function(e){return this._vinciGraphDataProvider.get({relativeUrl:y(this._groupId),baseUrl:he,telemetry:{componentAlias:f._CAMPAIGN_LANDING_PAGE_COMPONENT_NAME,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.GetCampaignUsers.Api"}}).then(function(t){var n,a,i,r,o=[],s=new Map;return null===(n=e.owners)||void 0===n||n.forEach(function(e){return s.set(e.email,"Owner")}),null===(a=e.approvers)||void 0===a||a.forEach(function(e){return s.set(e.email,"Approver")}),null===(i=e.contributors)||void 0===i||i.forEach(function(e){return s.set(e.email,"Contributor")}),null===(r=e.visitors)||void 0===r||r.forEach(function(e){return s.set(e.email,"Visitor")}),t.value.forEach(function(e){var t,n,a,i,r,c,d;o.push({objectId:null!==(t=e.id)&&void 0!==t?t:"",id:null!==(n=e.id)&&void 0!==n?n:"",userPrincipalName:null!==(a=e.userPrincipalName)&&void 0!==a?a:"",email:null!==(i=e.mail)&&void 0!==i?i:"",name:null!==(r=e.displayName)&&void 0!==r?r:"",role:null!==(d=s.get(null!==(c=e.mail)&&void 0!==c?c:""))&&void 0!==d?d:"Unknown"})}),o})},e.prototype._getPublicationByIdViewXml=function(e){var t=new B("Eq",new R("ID"),new N(e,"String"));return'<View Scope="RecursiveAll">\n      <Query>\n        <Where>\n          '.concat(t.toString(),"\n        </Where>\n      </Query>\n    </View>")},e.prototype._getPublicationByUniqueIdViewXml=function(e){var t=new B("Eq",new R("UniqueId"),new N(e,"String"));return'<View Scope="RecursiveAll">\n      <Query>\n        <Where>\n          '.concat(t.toString(),"\n        </Where>\n      </Query>\n    </View>")},e.prototype._getPublicationsViewXml=function(e,t,n){return'<View Scope="RecursiveAll">\n      <Query>\n        <Where>\n          '.concat(this._buildTopLevelPredicate(e).toString(),'\n        </Where>\n        <OrderBy>\n          <FieldRef Name="').concat(t,'" Ascending="').concat(n,'" />\n          <FieldRef Name="ID" Ascending="').concat(n,'" />\n        </OrderBy>\n      </Query>\n    </View>')},e.prototype._getAuthorsViewXml=function(e){return'<View Scope="RecursiveAll">\n      <Query>\n        <Where>\n          '.concat(this._buildTopLevelPredicate(e?(0,d.__assign)((0,d.__assign)({},e),{authors:[]}):void 0).toString(),'\n        </Where>\n        <GroupBy Collapse = "TRUE">\n          <FieldRef Name = "Author"/>\n        </GroupBy>\n        <ViewFields>\n          <FieldRef Name="Author" />\n        </ViewFields>\n      </Query>\n    </View>')},e.prototype._getPublicationStatuses=function(e){return'<View Scope="RecursiveAll">\n      <Query>\n        <Where>\n          '.concat(this._buildTopLevelPredicate(e?(0,d.__assign)((0,d.__assign)({},e),{publicationStatuses:[]}):void 0).toString(),'\n        </Where>\n        <GroupBy Collapse = "TRUE">\n          <FieldRef Name = "_AmplifyCampaignPublicationStatus"/>\n        </GroupBy>\n        <ViewFields>\n          <FieldRef Name="_AmplifyCampaignPublicationStatus" />\n        </ViewFields>\n      </Query>\n    </View>')},e.prototype._getDistributionChannel=function(e,t){return'<View Scope="RecursiveAll">\n      <Query>\n        <Where>\n          '.concat(this._buildTopLevelPredicate(e?(0,d.__assign)((0,d.__assign)({},e),{distributionChannels:[t]}):void 0).toString(),"\n        </Where>\n        <ViewFields>\n        </ViewFields>\n      </Query>\n    </View>")},e.prototype._buildTopLevelPredicate=function(e){var t=new B("BeginsWith",new R("ContentTypeId"),new N("0x0101009D1CB255DA76424F860D91F20E6C41180027ECB870B042465FAB4303F0D3CC2792","String"));if((null==e?void 0:e.authors.length)&&(t=new B("And",t,j("Or",e.authors.map(function(e){return new B("Eq",new R("Author"),new N(e,"User"))})))),(null==e?void 0:e.publicationStatuses.length)&&(t=new B("And",t,j("Or",e.publicationStatuses.map(function(e){return new B("Eq",new R("_AmplifyCampaignPublicationStatus"),new N(U[e],"Integer"))})))),null==e?void 0:e.distributionChannels.length){var n=[];(null==e?void 0:e.distributionChannels.includes("Outlook"))&&n.push(new B("Contains",new R("_AmplifyCampaignEndpointEmail"),new N('enabled":true,',"String"))),(null==e?void 0:e.distributionChannels.includes("SharePoint"))&&n.push(new B("Contains",new R("_AmplifyCampaignEndpointSharePoint"),new N('enabled":true,',"String"))),(null==e?void 0:e.distributionChannels.includes("Teams"))&&n.push(new B("Contains",new R("_AmplifyCampaignEndpointTeams"),new N('enabled":true,',"String"))),(null==e?void 0:e.distributionChannels.includes("VivaEngage"))&&n.push(new B("Contains",new R("_AmplifyCampaignEndpointVivaEngage"),new N('enabled":true,',"String"))),""!==(null==e?void 0:e.publicationId)&&n.push(new B("Contains",new R("UniqueId"),new N(null==e?void 0:e.publicationId.toUpperCase(),"String"))),n.length&&(t=new B("And",t,j("Or",n)))}return(null==e?void 0:e.publicationId.length)&&(t=new B("And",t,new B("Contains",new R("UniqueId"),new N(e.publicationId.toUpperCase(),"String")))),t},e.prototype._getPublicationsNextPage=function(e,t){var n=this,a=u.Uri.concatenate(this._vinciDataProvider.serverRelativeUrl,p),i=e.results[e.results.length-1];return this._renderListDataAsStream({relativeUrl:a,query:"OverrideRowLimit=".concat(e.pageSize,"&PAGED=TRUE&p_ID=").concat(i.ID,"&p_").concat(e.sortBy,"=").concat(i[e.sortBy]),requestBody:this._buildRequestBodyForGetPublications(e.viewXml),telemetry:{componentAlias:null==t?void 0:t.alias,qosEventName:"VivaAmplify.VinciCampaignsDataProvider.GetPublicationsNextPage.Api"}}).then(function(a){var i={results:a.filter(function(e){return"Template"!==e._SPSitePageFlags[0]}),page:e.page+1,pageSize:e.pageSize,sortBy:e.sortBy,sortAscending:e.sortAscending,viewXml:e.viewXml};return i.results.forEach(Te),i.previousPage=function(){return new Promise(function(t){return t(e)})},a.length===e.pageSize&&(i.nextPage=function(){return n._getPublicationsNextPage(i,t)}),i})},e.prototype._buildRequestBodyForGetPublications=function(e){return{parameters:{RenderOptions:4119,ViewXml:e,AllowMultipleValueFilterForTaxonomyFields:!0,AddRequiredFields:!0}}},e.prototype._renderListDataAsStream=function(e){var t=D.replace(m,u.UriEncoding.encodeRestUriStringToken(e.relativeUrl)).replace(_,e.query||"");return this._vinciDataProvider.post({relativeUrl:t,body:JSON.stringify(e.requestBody||""),telemetry:{componentAlias:e.telemetry.componentAlias,qosEventName:e.telemetry.qosEventName}}).then(function(e){var t,n;return null!==(n=null===(t=null==e?void 0:e.ListData)||void 0===t?void 0:t.Row)&&void 0!==n?n:[]})},e.prototype._delayMs=function(e){return new Promise(function(t){return setTimeout(t,e)})},e.prototype._createCampaignErrorIsRetryable=function(e){var t=[W.Api_FlightDisabled,W.Api_KillSwitchEnabled,W.Api_ValidationFailed,W.Storage_CampaignCreationAlreadyComplete,W.Provisioning_GroupSiteAlreadyExists,W.Provisioning_RetryGroupSiteAlreadyExists,W.Provisioning_NonUnifiedGroupSiteAlreadyExists,W.Provisioning_UserWithoutPermission_XGeo,W.Provisioning_UpstreamSensitivityVisibilityIncompatible,W.Provisioning_UpstreamLabelsNotSupported,W.Provisioning_UpstreamGroupCreationDisabled,W.Provisioning_ModernSitesDisallowed];return!(null==e?void 0:e.errorCode)||!t.includes(e.errorCode)},e.prototype._createCampaignWithRetryBackoffInternal=function(e,t,n,a,i){var r=this,o={maxAttempts:n,attemptsLeft:t,alias:f._CREATE_CAMPAIGN_MODAL},s=f._AmplifyLogger.getAmplifyLogger().createQosEvent("CampaignManagement.CreateCampaignWithRetry.Api"),c=a*(n-t+1);return new Promise(function(d,l){r.createCampaign(e,i).then(function(e){s.logSuccess(o),d(e)}).catch(function(u){var f;(null!==(f=null==u?void 0:u.campaignErrorInfo)&&void 0!==f?f:Promise.resolve(void 0)).then(function(f){r._createCampaignErrorIsRetryable(f)?(s.logUnexpectedFailure(null==u?void 0:u.message,u,o),1===t?l(u):r._delayMs(c).then(function(){r._createCampaignWithRetryBackoffInternal(e,t-1,n,a,i).then(d,l)}).catch(l)):(s.logExpectedFailure(null==u?void 0:u.message,u,o),l(u))})})})},e.serviceKey=l.ServiceKey.create("sp-vinci-data-provider:VinciCampaignsDataProvider",e),e}();const Fe=Ue;function He(){return l._SPFlight.isEnabled(61060)}var Re=function(){function e(e){var t=this;l.Validate.isNotNullOrUndefined(e,"serviceScope"),e.whenFinished(function(){t._httpClient=e.consume(z.HttpClient.serviceKey)}),this._logger=new ee}return e.prototype.get=function(e){var t=this,n=Ce._AadTokenProviders.configurable,a=this._logger.createEvent(e.telemetry),i=n._getTokenInternal(ye,Ce._AadTokenProviders.preAuthorizedConfiguration).then(function(n){var a=new z.HttpClientConfiguration(z.HttpClient.configurations.v1),i=new Headers;i.set("Authorization","Bearer "+n),i.set("Content-Type","application/json"),i.set("Accept","application/json");var r=u.Uri.concatenate(e.baseUrl||be,e.relativeUrl),o={credentials:"same-origin",headers:i};return t._httpClient.get(r,a,o)});return this._handleResponse(i,a)},e.prototype.post=function(e){var t=this,n=Ce._AadTokenProviders.configurable,a=this._logger.createEvent(e.telemetry),i=n._getTokenInternal(ye,Ce._AadTokenProviders.preAuthorizedConfiguration).then(function(n){var a=new z.HttpClientConfiguration(z.HttpClient.configurations.v1),i=new Headers;i.set("Authorization","Bearer "+n),i.set("Content-Type","application/json"),i.set("Accept","application/json");var r=u.Uri.concatenate(e.baseUrl||be,e.relativeUrl),o={credentials:"same-origin",headers:i,body:e.body};return t._httpClient.post(r,a,o)});return this._handleResponse(i,a)},e.prototype._handleResponse=function(e,t){return e.then(function(e){if(!e.ok){var n=new J(e);throw t.logUnexpectedFailure(n),n}return t.logSuccess(),e}).then(function(e){var t;return 204!==e.status&&(null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.startsWith("application/json"))?e.json():void 0}).catch(function(e){throw t.logUnexpectedFailure(e),e})},e.serviceKey=l.ServiceKey.create("sp-vinci-data-provider:VinciSubstrateDataProvider",e),e}();const Ne=Re;var Be=function(){function e(e){var t=this;l.Validate.isNotNullOrUndefined(e,"serviceScope"),e.whenFinished(function(){t._httpClient=e.consume(z.HttpClient.serviceKey)}),this._logger=new ee}return e._getHeaderHeader=function(){return{headers:{ACCEPT:"application/json;odata=verbose",Caller:"ODSPSitePicker","X-HTTP-Method":"GET"}}},e.prototype.get=function(t){var n=this,a=Ce._AadTokenProviders.configurable,i=this._logger.createEvent(t.telemetry),r=a._getTokenInternal(ye,Ce._AadTokenProviders.preAuthorizedConfiguration).then(function(a){var i,r=new z.HttpClientConfiguration(z.HttpClient.configurations.v1),o=new Headers;o.set("Authorization","Bearer "+a),o.set("Content-Type","application/json"),o.set("Accept","application/json");var s=u.Uri.concatenate(t.baseUrl||be,t.relativeUrl),c=e._getHeaderHeader();return null===(i=t.headers)||void 0===i||i.forEach(function(e,t){c.headers[t]=e}),n._httpClient.get(s,r,c)});return this._handleResponse(r,i)},e.prototype._handleResponse=function(e,t){return e.then(function(e){if(!e.ok){var n=new J(e);throw t.logUnexpectedFailure(n),n}return t.logSuccess(),e}).then(function(e){var t;return 204!==e.status&&(null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.startsWith("application/json"))?e.json():void 0}).catch(function(e){throw t.logUnexpectedFailure(e),e})},e.serviceKey=l.ServiceKey.create("sp-vinci-data-provider:VinciSharePointDataProvider",e),e}();const je=Be;var Ve="https://api.engage.cloud.microsoft/",ze=400;function Ge(e,t){var n=new URL(e);return Object.keys(t).forEach(function(e){var a=t[e];void 0!==a&&n.searchParams.set(e,a.toString())}),n.toString()}var Ke,We=function(){function e(e){var t=this;this._logger=new ee("EngageDataProvider"),this._resolvedCommunities={},e.whenFinished(function(){t._aadHttpClient=e.consume(Ce.AadHttpClientFactory.serviceKey)._getStandardClient("https://www.yammer.com/")})}return e.prototype.searchCommunities=function(e){return(0,d.__awaiter)(this,void 0,void 0,function(){var t,n,a=this;return(0,d.__generator)(this,function(i){return t=Ge(Ve+"private/v1/communities/autocomplete",e),n=function(e){return a._get((0,d.__assign)({url:t,qosEventName:"EngageDataProvider.SearchCommunities.Api"},e)).then(function(e){var t;return(0,d.__assign)((0,d.__assign)({},e),{items:null===(t=e.items)||void 0===t?void 0:t.filter(a._validateCommunity)})})},e.query&&""!==e.query.trim()?[2,n()]:[2,this._communityZeroTermResponse||(this._communityZeroTermResponse=n({retryDelayMs:ze,retryCount:4}).catch(function(e){throw a._communityZeroTermResponse=void 0,e}))]})})},e.prototype.resolveCommunity=function(e){var t;return(0,d.__awaiter)(this,void 0,void 0,function(){var n=this;return(0,d.__generator)(this,function(a){return[2,((t=this._resolvedCommunities)[e]||(t[e]=this._get({url:Ve+"private/v1/communities/{id}".replace("{id}",e),qosEventName:"EngageDataProvider.ResolveCommunity.Api",retryDelayMs:100,retryCount:4}))).then(function(e){if(!n._validateCommunity(e))throw new Error("Invalid community response");return e}).catch(function(t){throw delete n._resolvedCommunities[e],t})]})})},e.prototype.searchUsers=function(e){return(0,d.__awaiter)(this,void 0,void 0,function(){var t,n,a=this;return(0,d.__generator)(this,function(i){return t=Ge(Ve+"private/v1/users/autocomplete",e),n=function(e){return a._get((0,d.__assign)({url:t,qosEventName:"EngageDataProvider.SearchUsers.Api"},e)).then(function(e){return(0,d.__assign)((0,d.__assign)({},e),{items:e.items.filter(a._validateUser)})})},e.query&&""!==e.query.trim()?[2,n()]:[2,this._userZeroTermResponse||(this._userZeroTermResponse=n({retryDelayMs:ze,retryCount:4}).catch(function(e){throw a._userZeroTermResponse=void 0,e}))]})})},e.prototype.getCurrentUserInfo=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var e=this;return(0,d.__generator)(this,function(t){return[2,this._get({url:Ve+"private/v1/users/current",qosEventName:"EngageDataProvider.GetCurrentUserInfo.Api"}).then(function(t){if(e._validateUser(t.viewer))throw new Error("Invalid user response");return t})]})})},e.prototype.getDelegateTeamInfo=function(e){return(0,d.__awaiter)(this,void 0,void 0,function(){var t,n=this;return(0,d.__generator)(this,function(a){return t=Ge(Ve+"private/v1/delegateTeams/viewer",e),[2,this._get({url:t,qosEventName:"EngageDataProvider.GetDelegateTeamInfo.Api",retryDelayMs:ze,retryCount:4}).then(function(e){return(0,d.__assign)((0,d.__assign)({},e),{items:e.items.filter(function(e){var t=e.owner;return!!n._validateUser(t)})})})]})})},e.prototype.getAudiences=function(e){return(0,d.__awaiter)(this,void 0,void 0,function(){var t;return(0,d.__generator)(this,function(n){return t=Ve+"odata/v1/users('{id}')/employeeExperience/storyline/audiences".replace("{id}",e),[2,this._get({url:t,qosEventName:"EngageDataProvider.GetAudiences.Api",retryDelayMs:ze,retryCount:4}).then(function(e){return e.value||[]})]})})},e.prototype.getAllDelegateTeams=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var e=this;return(0,d.__generator)(this,function(t){return[2,this._delegateTeamPromise||(this._delegateTeamPromise=this._getAllDelegateTeams().catch(function(t){throw e._delegateTeamPromise=void 0,t}))]})})},e.prototype._getAllDelegateTeams=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var e,t,n;return(0,d.__generator)(this,function(a){switch(a.label){case 0:e=[],t=void 0,a.label=1;case 1:return[4,this.getDelegateTeamInfo({first:20,skipToken:t})];case 2:n=a.sent(),e.push.apply(e,n.items),t=n.nextPageSkipToken,a.label=3;case 3:if(t)return[3,1];a.label=4;case 4:return[2,e]}})})},e.prototype._get=function(e){var t=e.url,n=e.qosEventName,a=e.componentAlias,i=e.retryCount,r=void 0===i?0:i,o=e.retryDelayMs,s=void 0===o?100:o,c=e._currentRetry,l=void 0===c?0:c;return(0,d.__awaiter)(this,void 0,void 0,function(){var e,i,o,c,u;return(0,d.__generator)(this,function(d){switch(d.label){case 0:e=this._logger.createEvent({qosEventName:n,componentAlias:a}),d.label=1;case 1:return d.trys.push([1,5,,8]),[4,this._aadHttpClient];case 2:return[4,d.sent().get(t,z.AadHttpClient.configurations.v1,{headers:{accept:"application/json"}})];case 3:if(!(i=d.sent()).ok)throw new J(i);return[4,i.json()];case 4:return o=d.sent(),e.logSuccess(),[2,o];case 5:return c=d.sent(),this._shouldRetry(c)&&l<r?[4,new Promise(function(e){return setTimeout(e,s)})]:[3,7];case 6:return d.sent(),[2,this._get({url:t,qosEventName:n,componentAlias:a,retryCount:r,_currentRetry:l+1})];case 7:throw u=J.is(c)||c.message?c:new Error(c),e.logUnexpectedFailure(u),c;case 8:return[2]}})})},e.prototype._validateUser=function(e){if(function(e){return void 0!==e.id&&void 0!==e.displayName}(e))return e;var t=(e.id?!e.displayName&&"MissingDisplayName":"MissingId")||"Unknown";f._AmplifyLogger.getAmplifyLogger().createQosEvent("EngageDataProvider.InvalidUserResponse").logUnexpectedFailure(t,new Error(t))},e.prototype._validateCommunity=function(e){if(void 0!==(t=e).id&&void 0!==t.groupId&&void 0!==t.displayName)return e;var t,n=(e.id?!e.displayName&&"MissingDisplayName":"MissingId")||"Unknown";f._AmplifyLogger.getAmplifyLogger().createQosEvent("EngageDataProvider.InvalidCommunityResponse").logUnexpectedFailure(n,new Error(n))},e.prototype._shouldRetry=function(e){var t;return(null===(t=null==e?void 0:e.message)||void 0===t?void 0:t.toLowerCase().indexOf("failed to fetch"))>-1||J.is(e)&&(429===e.httpStatusCode||e.httpStatusCode>=500&&e.httpStatusCode<600)},e.serviceKey=l.ServiceKey.create("sp-vinci-data-provider:EngageDataProvider",e),e}(),qe=h(698),Qe=new RegExp(/(\%[0-9][A-F])|(\%[A-F][0-9])|(\%[A-F][A-F])/g),Ye=new RegExp(/(\%[0-9][a-f])|(\%[a-f][0-9])|(\%[a-f][a-f])/g);!function(e){e[e.absolute=0]="absolute",e[e.relative=1]="relative",e[e.serverRelative=2]="serverRelative"}(Ke||(Ke={}));var Je,Xe=function(){function e(e,t){void 0===e&&(e=""),t&&("/"===e[e.length-1]&&"/"===t[0]?e+=t.slice(1):"/"!==e[e.length-1]&&"/"!==t[0]?e=e+"/"+t:e+=t);var n=e.indexOf("//"),a=e.indexOf("/"),i=e.indexOf("?"),r=n>-1&&n<=a?n+"//".length:-1,o=function(e,t){if(t>-1){var n=e.indexOf("/",t);return n>-1?e.slice(0,n):e}return""}(e,r),s=o&&o.slice(r),c=s&&s.split(":")[0],d=i>0?e.slice(o.length,i):e.slice(o.length),l=o?Ke.absolute:"/"===d[0]?Ke.serverRelative:Ke.relative,u=d.split("/");this._originalSearchString=i>0?e.slice(i):"",this.searchParams=new URLSearchParams(this._originalSearchString),this.authority=o,this.domain=s,this.host=c,this.format=l,this.path=d,this.segments=u,this.value=e}return e._getTenantInfoFromPageContext=function(e){var t,n=null!==(t=null==e?void 0:e.legacyPageContext)&&void 0!==t?t:e,a=!qe.KillSwitch.isActivated("78469d39-5abf-45a7-8609-c4f00dab856b");return e?{isMultiGeo:a?n.isMultiGeoTenant:e.legacyPageContext.isMultiGeoTenant,multiGeoInfo:a?n.multiGeoInfo:e.legacyPageContext.multiGeoInfo,singleTenant:a?n.vanityUrls:e.legacyPageContext.vanityUrls}:void 0},e._getHostFromUrl=function(t){return t?new e(t).domain:t},e._getMySiteAndPortalDomain=function(){var e="-my",t="-admin",n="".concat(window.location.protocol,"//").concat(window.location.hostname),a=window.location.hostname.substr(0,window.location.hostname.indexOf("."));if(qe.KillSwitch.isActivated("751b021d-5b05-45f0-b649-d8fd0dab3170")||-1===a.indexOf(t))return-1===a.indexOf(e,a.length-e.length)?[n.toString().replace(a,a+e),n]:(i=n.toString().replace(a,a.substring(0,a.length-e.length)),[n,i]);var i,r=a.substring(0,a.length-t.length);return[n.toString().replace(a,r+e),i=n.toString().replace(a,r)]},e.prototype.toString=function(){return this.authority+this.path+this.searchParamString},e.prototype.equals=function(e){return e&&this.toString()===e.toString()},e.prototype.isInternalResource=function(t){var n=this,a=e._getTenantInfoFromPageContext(t);try{if((null==a?void 0:a.isMultiGeo)&&(null==a?void 0:a.multiGeoInfo))return a.multiGeoInfo.some(function(e){return n._isSameHost(e.PortalUrl)||n._isSameHost(e.MySiteHostUrl)||n._isSameHosts(e.AdditionalUrls)});var i=e._getMySiteAndPortalDomain();if(this._isSameHosts(i))return!0;if((null==a?void 0:a.singleTenant)&&(null==a?void 0:a.singleTenant.SingleTenant_AdditionalVanityUrls)&&-1!==a.singleTenant.SingleTenant_AdditionalVanityUrls.split(";").indexOf(this.domain))return!0;if((null==a?void 0:a.singleTenant)&&this._isInternalResourceOfSingleTenant(a.singleTenant))return!0}catch(e){return!1}return!1},e.prototype.setSearchParam=function(e,t){t?this.searchParams.set(e,decodeURIComponent(t.replace(/\+/g," "))):this.searchParams.set(e,t)},Object.defineProperty(e.prototype,"searchParamString",{get:function(){var e,t=null===(e=this.searchParams.toString())||void 0===e?void 0:e.replace(/\+/g,"%20");return t&&this._originalSearchString.match(Ye)&&(t=t.replace(Qe,function(e){return null==e?void 0:e.toLowerCase()})),t?"?"+t:t},enumerable:!1,configurable:!0}),e.prototype.getQueryParameter=function(e){var t;return null===(t=this.searchParams)||void 0===t?void 0:t.get(e)},e.prototype.removeQueryParameter=function(e){var t;null===(t=this.searchParams)||void 0===t||t.delete(e)},e.prototype._isInternalResourceOfSingleTenant=function(e){return e.SingleTenant_OneDriveUrl===this.domain||e.SingleTenant_PortalUrl===this.domain||e.SingleTenant_TeamSitesUrl===this.domain},e.prototype._isSameHost=function(t){return this.domain.toLowerCase()===e._getHostFromUrl(t).toLowerCase()},e.prototype._isSameHosts=function(e){var t=this;return!!(null==e?void 0:e.some(function(e){return t._isSameHost(e)}))},e}();!function(e){e.FILE_SIZE_EXCEEDED="FILE_SIZE_EXCEEDED",e.INVALID_FILE_TYPE="INVALID_FILE_TYPE",e.FILE_EMPTY="FILE_EMPTY",e.INVALID_CSV_STRUCTURE="INVALID_CSV_STRUCTURE",e.ENCRYPTED_OR_CORRUPTED_FILE="ENCRYPTED_OR_CORRUPTED_FILE",e.UNSUPPORTED_FORMAT="UNSUPPORTED_FORMAT",e.RECIPIENTS_EXCEED="RECIPIENTS_EXCEED",e.PASSWORD_PROTECTED="PASSWORD_PROTECTED",e.UNKNOWN_ERROR="UNKNOWN_ERROR",e.UNABLE_TO_FIND_EMAIL_COLUMN="UNABLE_TO_FIND_EMAIL_COLUMN",e.INVALID_DELIMITER="INVALID_DELIMITER"}(Je||(Je={}));var Ze=function(){function e(e){var t=this;this._ExcelExtensionsVariants=new Set(["xls","xlsx","xlb","xlc","xlsb","xlsm","xlt","xltx","xltm","xlm","xla","xll","xlam","xlw","excel","odc","ods","csv"]),this._MAX_FILE_SIZE_IN_BYTES=5242880,this._ALLOWED_EXTENSIONS=new Set((0,d.__spreadArray)(["csv","txt"],Array.from(this._ExcelExtensionsVariants),!0)),this._validationErrors=new Set,e.whenFinished(function(){t._tokenProvider=Ce._AadTokenProviders.configurable,t._httpsClient=e.consume(Ce.HttpClient.serviceKey),t._vinciDataProvider=e.consume(ae.serviceKey)})}return e.prototype.fetchFileContentWithVersion=function(e,t,n,a,i){return(0,d.__awaiter)(this,void 0,void 0,function(){var r,o,s,c,l,u,p,m;return(0,d.__generator)(this,function(d){switch(d.label){case 0:this._validationErrors=new Set,r=f._AmplifyLogger.getAmplifyLogger().createQosEvent("AudienceFileUpload.GetFileContentWithVersion.Api"),d.label=1;case 1:return d.trys.push([1,6,,7]),[4,this._tokenProvider._getTokenInternal(he,Ce._AadTokenProviders.preAuthorizedConfiguration,!0)];case 2:return o=d.sent(),s={Authorization:"Bearer ".concat(o),"Content-Type":"application/json",Accept:"application/json"},[4,this._fetchDriveItemVersions(e,t,n,a)];case 3:return c=d.sent(),[4,this._fetchDriveItem(e,t,n,a)];case 4:return l=d.sent(),u="".concat(he,"/v1.0/drives/").concat(l.parentReference.driveId,"/items/").concat(n,"/content"),c.value[0].id!==i&&(u="".concat(he,"/v1.0/drives/").concat(l.parentReference.driveId,"/items/").concat(n,"/versions/").concat(i,"/content")),[4,this._fetchFileBlobAndContent(u,s)];case 5:return p=d.sent(),r.logSuccess(),[2,{content:p,extension:l.name.split(".").pop()||a.split(".").pop(),currentVersion:i,isValidationPassed:0===this._validationErrors.size,errors:Array.from(this._validationErrors)}];case 6:return m=d.sent(),r.logUnexpectedFailure(m.message,m,{siteId:e,webId:t,uniqueId:n,serverAbsoluteUrl:a,versionId:i}),[2,{isValidationPassed:!1,errors:Array.from(this._validationErrors)}];case 7:return[2]}})})},e.prototype.processLocalFileContent=function(e,t){return(0,d.__awaiter)(this,void 0,void 0,function(){var n,a,i,r;return(0,d.__generator)(this,function(o){switch(o.label){case 0:n=f._AmplifyLogger.getAmplifyLogger().createQosEvent("AudienceFileUpload.GetFileLocalFileContent"),o.label=1;case 1:return o.trys.push([1,3,,4]),this._validationErrors=new Set,a=new Blob([e],{type:e.type}),this._performFileSizeAndExtensionValidation(e.size,e.name.split(".").pop()),this._validationErrors.size>0?[2,{isValidationPassed:!1,errors:Array.from(this._validationErrors)}]:[4,this._processFileBlob(a)];case 2:return(i=o.sent()).length>t&&this._validationErrors.add(Je.RECIPIENTS_EXCEED),n.logSuccess(),[2,{content:i,extension:e.name.split(".").pop()||"",currentVersion:"",isValidationPassed:0===this._validationErrors.size,errors:Array.from(this._validationErrors)}];case 3:return r=o.sent(),this._processError(r),n.logUnexpectedFailure(r.message,r),[2,{isValidationPassed:!1,errors:Array.from(this._validationErrors)}];case 4:return[2]}})})},e.prototype.fetchFileContent=function(e,t){return(0,d.__awaiter)(this,void 0,void 0,function(){var n,a,i,r,o,s,c,l,u;return(0,d.__generator)(this,function(d){switch(d.label){case 0:this._validationErrors=new Set,n=f._AmplifyLogger.getAmplifyLogger().createQosEvent("AudienceFileUpload.GetFileContent.Api"),d.label=1;case 1:return d.trys.push([1,5,,6]),a=new Xe(e.ServerAbsoluteUrl),[4,this._fetchDriveItem(e.SiteId,e.WebId,e.UniqueId,e.ServerAbsoluteUrl)];case 2:return i=d.sent(),r=e.Extension||i.name.split(".").pop(),this._performFileSizeAndExtensionValidation(i.size,r),this._validationErrors.size>0?[2,{isValidationPassed:!1,errors:Array.from(this._validationErrors)}]:[4,this._fetchDriveItemVersions(e.SiteId,e.WebId,e.UniqueId,e.ServerAbsoluteUrl)];case 3:return o=d.sent(),s=o.value[0].id,c=i["@content.downloadUrlNoAuth"],[4,this._extractFileContent(a,c,r)];case 4:return(l=d.sent()).length>t&&this._validationErrors.add(Je.RECIPIENTS_EXCEED),n.logSuccess(),[2,{content:l,extension:r,currentVersion:s,isValidationPassed:0===this._validationErrors.size,errors:Array.from(this._validationErrors)}];case 5:return u=d.sent(),n.logUnexpectedFailure(u.message,u,{siteId:e.SiteId,webId:e.WebId,uniqueId:e.UniqueId,serverAbsoluteUrl:e.ServerAbsoluteUrl||e.Link}),this._processError(u),[2,{isValidationPassed:!1,errors:Array.from(this._validationErrors)}];case 6:return[2]}})})},e.prototype._processError=function(e){e.message.includes("File is password-protected")&&this._validationErrors.add(Je.PASSWORD_PROTECTED),e.message.includes("Encrypted file missing")&&this._validationErrors.add(Je.ENCRYPTED_OR_CORRUPTED_FILE),0===this._validationErrors.size&&this._validationErrors.add(Je.UNKNOWN_ERROR)},e.prototype._fetchDriveItem=function(e,t,n,a){return(0,d.__awaiter)(this,void 0,void 0,function(){var i,r,o;return(0,d.__generator)(this,function(s){switch(s.label){case 0:return i=new Xe(a),[4,this._tokenProvider._getTokenInternal(i.authority,Ce._AadTokenProviders.preAuthorizedConfiguration,!0)];case 1:return r=s.sent(),o={Authorization:"Bearer "+r,"Content-Type":"application/json",Accept:"application/json"},[4,this._vinciDataProvider.get({relativeUrl:"v2.0/sites/".concat(e,",").concat(t,"/items/").concat(n,"/driveItem"),baseUrl:i.authority,telemetry:{qosEventName:"VivaAmplify.VinciPublicationsDataProvider.GetDriveItemResponse.Api"}},o)];case 2:return[2,s.sent()]}})})},e.prototype._fetchDriveItemVersions=function(e,t,n,a){return(0,d.__awaiter)(this,void 0,void 0,function(){var i,r,o;return(0,d.__generator)(this,function(s){switch(s.label){case 0:return i=new Xe(a),[4,this._tokenProvider._getTokenInternal(i.authority,Ce._AadTokenProviders.preAuthorizedConfiguration,!0)];case 1:return r=s.sent(),o={Authorization:"Bearer "+r,"Content-Type":"application/json",Accept:"application/json"},[4,this._vinciDataProvider.get({relativeUrl:"v2.0/sites/".concat(e,",").concat(t,"/items/").concat(n,"/versions"),baseUrl:i.authority,telemetry:{qosEventName:"VivaAmplify.VinciPublicationsDataProvider.GetDriveItemVersionsResponse.Api"}},o)];case 2:return[2,s.sent()]}})})},e.prototype._performFileSizeAndExtensionValidation=function(e,t){0===e&&this._validationErrors.add(Je.FILE_EMPTY),e>this._MAX_FILE_SIZE_IN_BYTES&&this._validationErrors.add(Je.FILE_SIZE_EXCEEDED),t&&this._ALLOWED_EXTENSIONS.has(t)||this._validationErrors.add(Je.INVALID_FILE_TYPE)},e.prototype._extractFileContent=function(e,t,n){return(0,d.__awaiter)(this,void 0,void 0,function(){var a,i,r,o,s,c;return(0,d.__generator)(this,function(d){switch(d.label){case 0:return a=new Ce.HttpClientConfiguration(Ce.HttpClient.configurations.v1),[4,this._tokenProvider._getTokenInternal(e.authority,Ce._AadTokenProviders.preAuthorizedConfiguration,!0)];case 1:return i=d.sent(),r=!!n&&this._ExcelExtensionsVariants.has(n),o={Authorization:"Bearer ".concat(i)},r?[2,this._fetchFileBlobAndContent(t,o)]:[4,this._httpsClient.fetch(t,a,{method:"GET",headers:o})];case 2:if(!(s=d.sent()).ok)throw new Error("Failed to fetch file content. Status: ".concat(s.status));return[4,s.text()];case 3:return c=d.sent(),[2,this._parseCsvOrTxtFile(c)]}})})},e.prototype._downloadFileBlobContent=function(e,t){return(0,d.__awaiter)(this,void 0,void 0,function(){var n=this;return(0,d.__generator)(this,function(a){return[2,new Promise(function(a,i){var r=new XMLHttpRequest;for(var o in r.open("GET",e),t)t.hasOwnProperty(o)&&r.setRequestHeader(o,t[o]);r.responseType="blob",r.onload=function(){if(r.status>=200&&r.status<300&&r.response)return a(r);var e=r.getResponseHeader("location");e&&r.status>=300&&r.status<400?n._downloadFileBlobContent(e).then(a).catch(i):i({httpRequest:r,statusCode:r.status,error:"Request for excel file blob Failed"})},r.onerror=function(){return i({httpRequest:r,statusCode:void 0,error:"Network Failed"})},r.send()})]})})},e.prototype._fetchFileBlobAndContent=function(e,t){return(0,d.__awaiter)(this,void 0,void 0,function(){var n;return(0,d.__generator)(this,function(a){switch(a.label){case 0:return[4,this._downloadFileBlobContent(e,t)];case 1:return[4,a.sent().response];case 2:return n=a.sent(),[2,this._processFileBlob(n)]}})})},e.prototype._processFileBlob=function(e){return(0,d.__awaiter)(this,void 0,void 0,function(){var t,n,a,i,r,o,s;return(0,d.__generator)(this,function(c){switch(c.label){case 0:return[4,new Response(e).arrayBuffer()];case 1:return t=c.sent(),[4,Promise.resolve(h.e(102).then(h.bind(h,5)))];case 2:if(n=c.sent(),a=n.read(new Uint8Array(t),{type:"array"}),i=a.Sheets[a.SheetNames[0]],1===(r=n.utils.sheet_to_json(i,{header:1})).length)return[2,this._filterDuplicates(r[0])];for(o=[],s=0;s<r.length;s++)r[s][0]&&o.push(r[s][0]);return[2,this._filterDuplicates(o)]}})})},e.prototype._filterDuplicates=function(e){var t=new Set;return e.filter(function(e){return!t.has(e)&&(t.add(e),!0)})},e.prototype._parseCsvOrTxtFile=function(e){var t=/[,;\r\n\t]/;if(!t.test(e))return this._validationErrors.add(Je.INVALID_DELIMITER),[];var n=e.trim().split(t);return this._filterDuplicates(n)},e.serviceKey=l.ServiceKey.create("sp-vinci-data-provider:ExcelCsvHandler",e),e}();const $e=Ze;var et=function(){function e(e){var t=this;this._graphEndpoint="",this.getRecentSites=function(e){var n=new Headers;return l._SPFlight.isEnabled(61868)&&n.set("Prefer","showEditedSites"),t._vinciSharePointDataProvider.get({relativeUrl:_e.replace(re,20..toString()),baseUrl:t._pageContext.site.absoluteUrl,telemetry:{componentAlias:null==e?void 0:e.alias,qosEventName:"VivaAmplify.VinciPublicationsDataProvider.GetPublication.Api"},headers:n}).then(function(e){var t;if(!q()){var n=e.value&&(null===(t=e.value)||void 0===t?void 0:t.filter(function(e){var t;return null===(null===(t=e.sharepointIds)||void 0===t?void 0:t.webId)}))||[];n.length>0&&f._AmplifyLogger.getAmplifyLogger().createQosEvent("VivaAmplify.VinciPublicationsDataProvider.GetRecentSitesReturnsNullWebId.Api").logUnexpectedFailure("GetRecentSites response has sites with missing webId",new Error("Found sites with missing webId: ".concat(n.map(function(e){return e.siteId}).join(", "))))}return e}).catch(function(e){throw e})},this.resetEndpoint=function(e,n){var a=t._getListItemId(),i=JSON.stringify({requestParam:(0,d.__assign)({},e)});return t._vinciDataProvider.post({relativeUrl:u.Uri.concatenate(me.replace(ie,null==a?void 0:a.toString()),"ResetEndpoint"),body:i,telemetry:{componentAlias:null==n?void 0:n.alias,qosEventName:"VivaAmplify.VinciPublicationsDataProvider.ResetEndpoint.Api"}})},this.loadMailDraft=function(e,n){var a=t._getListItemId(),i=JSON.stringify({requestParam:{IsPreview:e}});return t._vinciDataProvider.post({relativeUrl:u.Uri.concatenate(me.replace(ie,null==a?void 0:a.toString()),"LoadMailDraft"),body:i,telemetry:{componentAlias:null==n?void 0:n.alias,qosEventName:"VivaAmplify.VinciPublicationsDataProvider.LoadMailDraft.Api"}})},this.saveMailDraft=function(e,n){var a=t._getListItemId(),i=JSON.stringify({requestParam:{IsOpxContentModified:e}});return t._vinciDataProvider.post({relativeUrl:u.Uri.concatenate(me.replace(ie,null==a?void 0:a.toString()),"SaveMailDraft"),body:i,telemetry:{componentAlias:null==n?void 0:n.alias,qosEventName:"VivaAmplify.VinciPublicationsDataProvider.SaveMailDraft.Api"}})},this.batchPermissionCheckForTeams=function(e,n){var a,i=[];return(l._SPKillSwitch.isActivated("3c013441-54f1-4dd7-b8af-3d0abeb1600d")?e.channels:null!==(a=null==e?void 0:e.channels)&&void 0!==a?a:[]).forEach(function(e){var t,n;i.push((t=e.groupId,n=e.threadId,{id:"".concat(n),method:"GET",url:"".concat(Se.replace(ce,t).replace(de,n),"?select=displayName")}))}),t._vinciGraphDataProvider.batchCall({batchRequests:i,relativeUrl:xe,baseUrl:t._graphEndpoint,telemetry:{componentAlias:null==n?void 0:n.alias,qosEventName:"VivaAmplify.VinciPublicationsDataProvider.CheckIfUserHasPermissionToPostToChannel.Api"}}).then(function(e){var t={};return e.responses.forEach(function(e){var n,a,i,r;if(null===(n=e.body)||void 0===n?void 0:n.error){var o=(null===(a=e.body)||void 0===a?void 0:a.error).message,s=null===(r=null===(i=e.body)||void 0===i?void 0:i.error)||void 0===r?void 0:r.code;t[e.id]="Forbidden"===s||"InsufficientPrivileges"===o?"Forbidden":"NotFound"===s||"NotFound"===o||"Not Found"===o?"NotFound":"HasAccess"}else t[e.id]="HasAccess"}),t}).catch(function(e){throw e})},this.getAudience=function(e){return new RegExp(/^https:\/\/teams\.microsoft\.com\/l\/channel\/(.*)\/(.*)\?groupId=([a-fA-F0-9\-]+)&tenantId=([a-fA-F0-9\-]+)$/).test(e)?t._getAudienceChannelURLSearch(e):t.getAudienceQuerySearch(e)},this.getAudienceQuerySearch=function(e,n){var a=l.Guid.newGuid().toString(),i=ge.replace(oe,a).replace(se,e),r=l._SPKillSwitch.isActivated("ed60d8c4-25d1-4495-8731-9fd2304e445f")?t._vinciGraphDataProvider:t._vinciSubstrateDataProvider;return(l._SPKillSwitch.isActivated("525b4cc9-91e2-44a4-9f3b-08a23cd7e798")?r.get({relativeUrl:i,baseUrl:be,telemetry:{qosEventName:"VivaAmplify.VinciPublicationsDataProvider.GetAudienceQuerySearch.Api"}}):r.post({relativeUrl:"/search/api/v1/suggestions",baseUrl:be,telemetry:{qosEventName:"VivaAmplify.VinciPublicationsDataProvider.GetAudienceQuerySearch.Api",componentAlias:null==n?void 0:n.alias},body:JSON.stringify(t._build3SSuggestionQuery(e))})).then(function(e){return e.Groups}).then(function(e){return t="3SAPI",n={channels:[],chats:[],people:[]},e.forEach(function(e){switch(e.Type){case"Channel":var a=e.Suggestions.map(function(e){var n=e;return{groupId:n.GroupId,name:n.Name,teamName:n.TeamName,threadId:n.ThreadId,source:t}}),i=f._AmplifyLogger.getAmplifyLogger().createQosEvent("Authoring.GetAudience.ZeroChannelResponse");0===a.length?i.logExpectedFailure("zeroResponse",new Error("Empty Channel Response"),Ee):i.logSuccess(Ee),n.channels=(0,d.__spreadArray)((0,d.__spreadArray)([],n.channels,!0),a,!0);break;case"Chat":n.chats=e.Suggestions.map(function(e){var n,a,i,r=e;return{chatMembers:null!==(a=null===(n=null==r?void 0:r.ChatMembers)||void 0===n?void 0:n.map(function(e){return{displayName:e.DisplayName,mri:null==e?void 0:e.MRI,givenName:e.GivenName,surname:e.Surname}}))&&void 0!==a?a:[],name:null!==(i=r.Name)&&void 0!==i?i:"",threadId:r.ThreadId,threadType:r.ThreadType,totalChatMembersCount:r.TotalChatMembersCount,source:t}});var r=f._AmplifyLogger.getAmplifyLogger().createQosEvent("Authoring.GetAudience.ZeroChatResponse");0===n.chats.length?r.logExpectedFailure("zeroResponse",new Error("Empty Chat Response"),Ee):r.logSuccess(Ee);break;case"People":n.people=e.Suggestions.map(function(e){var n=e;return{displayName:n.DisplayName,emailAddresses:n.EmailAddresses,id:n.Id,mri:n.Mri,imAddress:n.ImAddress,userPrincipalName:n.UserPrincipalName,source:t}});var o=f._AmplifyLogger.getAmplifyLogger().createQosEvent("Authoring.GetAudience.ZeroPeopleResponse");0===n.people.length?o.logExpectedFailure("zeroResponse",new Error("Empty People Response"),Ee):o.logSuccess(Ee);break;case"Team":var s=e.Suggestions.map(function(e){var n=e;return{groupId:n.GroupId,name:"General",teamName:n.Name,threadId:n.ThreadId,source:t}}),c=f._AmplifyLogger.getAmplifyLogger().createQosEvent("Authoring.GetAudience.ZeroTeamsResponse");0===s.length?c.logExpectedFailure("zeroResponse",new Error("Empty Teams Response"),Ee):c.logSuccess(Ee),n.channels=(0,d.__spreadArray)((0,d.__spreadArray)([],n.channels,!0),s,!0)}}),n;var t,n}).catch(function(e){throw e})},this._getTeamDetailedResponse=function(e){return t._vinciGraphDataProvider.get({relativeUrl:e,baseUrl:he,telemetry:{qosEventName:"VivaAmplify.VinciPublicationsDataProvider.GetTeamDetailedResponse.Api"}})},this._getTeamsChannel=function(e){return t._vinciGraphDataProvider.get({relativeUrl:e,baseUrl:he,telemetry:{qosEventName:"VivaAmplify.VinciPublicationsDataProvider.GetTeamsChannel.Api"}})},this._getAudienceChannelURLSearch=function(e){var n=new u.Uri(decodeURI(e)),a=n.getQueryAsObject(),i=n.getPathSegments();if(!(a&&(null==a?void 0:a.groupId)&&i&&4===i.length&&RegExp(/^19:(.*)@thread\.(.*)$/).test(i[2])))return Promise.resolve(Ae);var r=De.replace(ce,null==a?void 0:a.groupId).replace(de,i[2]),o=Ie.replace(ce,null==a?void 0:a.groupId);return Promise.allSettled([t._getTeamDetailedResponse(o),t._getTeamsChannel(r)]).then(function(e){var t,n;if(2!==e.length)throw new Error("Something went wrong while fetching the channel details by URL");var i=e[0],r=e[1];if("fulfilled"!==r.status)throw new Error("Something went wrong while fetching the channel details by URL");var o=r.value,s="fulfilled"===i.status?i.value:void 0;return{channels:[{groupId:null==a?void 0:a.groupId,name:null!==(t=o.displayName)&&void 0!==t?t:"",teamName:null!==(n=null==s?void 0:s.displayName)&&void 0!==n?n:"",threadId:o.id,source:"GraphAPI"}],chats:[],people:[]}})},l.Validate.isNotNullOrUndefined(e,"serviceScope"),e.whenFinished(function(){var n,a;t._pageContext=e.consume(G.PageContext.serviceKey),t._vinciDataProvider=e.consume(ae.serviceKey),t._vinciGraphDataProvider=e.consume(we.serviceKey),t._vinciSubstrateDataProvider=e.consume(Ne.serviceKey),t._graphEndpoint=null===(a=null===(n=t._pageContext.legacyPageContext)||void 0===n?void 0:n.farmSettings)||void 0===a?void 0:a.ExternalService_sppagesmsgraphendpoint,t._vinciSharePointDataProvider=e.consume(je.serviceKey),t.engageDataProvider=e.consume(We.serviceKey),t._excelCsvHandler=e.consume($e.serviceKey)})}return e.prototype.getPublication=function(e){var t=e||this._getListItemId();return this._vinciDataProvider.get({relativeUrl:me.replace(ie,t.toString()),telemetry:{qosEventName:"VivaAmplify.VinciPublicationsDataProvider.GetPublication.Api"}}).then(this._parsePublicationValues).catch(function(e){throw e})},e.prototype.getPrePublishValidationStatus=function(e){var t=null!=e?e:this._getListItemId();return this._vinciDataProvider.get({relativeUrl:u.Uri.concatenate(me.replace(ie,null==t?void 0:t.toString()),"GetPrePublishValidationStatus"),telemetry:{qosEventName:"VivaAmplify.VinciPublicationsDataProvider.GetPrePublishValidationStatus.Api"}}).catch(function(e){throw e})},e.prototype.validatePublication=function(e){var t=null!=e?e:this._getListItemId();return this._vinciDataProvider.post({relativeUrl:u.Uri.concatenate(me.replace(ie,t.toString()),"Validate"),telemetry:{qosEventName:"VivaAmplify.VinciPublicationsDataProvider.ValidatePublication.Api"}})},e.prototype.getIsPublicationShareLockActiveAsync=function(e){return this._vinciDataProvider.get({relativeUrl:u.Uri.concatenate("/sitepages/pages({pageId})?$select=CoAuthState".replace(ie,e.toString())),telemetry:{qosEventName:"VivaAmplify.VinciPublicationsDataProvider.GetIsPublicationShareLockActiveAsync.Api"}}).then(function(e){var t,n;return!!(null===(n=null===(t=e.CoAuthState)||void 0===t?void 0:t.SharedLockId)||void 0===n?void 0:n.length)}).catch(function(e){throw e})},e.prototype.updateAudience=function(e){var t=this._getListItemId(),n=this._pageContext.web.serverRelativeUrl.replace(/\/+$/,"")+"/SitePages",a=pe.replace(le,n).replace(ue,t.toString()),i=e.map(function(e){return{Key:e}}),r={bNewDocumentUpdate:!1,checkInComment:null,formValues:(i.length>0?[{FieldName:"_ModernAudienceTargetUserField",FieldValue:JSON.stringify(i)}]:[]).map(function(e){return(0,d.__assign)((0,d.__assign)({},e),{ErrorMessage:null,HasException:!1})})};return this._vinciDataProvider.post({relativeUrl:a,body:JSON.stringify(r),telemetry:{qosEventName:"VivaAmplify.VinciPublicationsDataProvider.UpdatePublication.Api"}},{"X-HTTP-Method":"POST","OData-Version":"3.0","If-Match":"*"})},e.prototype.fetchAudienceTargetingField=function(e,t,n){return this._vinciDataProvider.get({relativeUrl:"/web/lists/GetByTitle('Site%20Pages')/fields('7F759147-C861-4CD6-A11F-5AA3037D9634')",baseUrl:t,telemetry:{qosEventName:"VivaAmplify.VinciPublicationsDataProvider.GetPublication.Api"}}).then(function(t){var a;return(null===(a=t.EntityPropertyName)||void 0===a?void 0:a.includes(n))?e:""}).catch(function(e){return""})},e.prototype.getIsContentModerationEnabledForSitePagesLibrary=function(e){return this._vinciDataProvider.get({relativeUrl:fe,baseUrl:e,telemetry:{qosEventName:"VivaAmplify.VinciPublicationsDataProvider.GetIsContentModerationEnabledForSitePagesLibrary.Api"}}).then(function(e){return e.value})},e.prototype.getSharePointAudience=function(e){var t=this,n=JSON.stringify({queryParams:{AllowEmailAddresses:!1,MaximumEntitySuggestions:30,PrincipalType:13,PrincipalSource:15,QueryString:e,UseSubstrateSearch:!0,SharePointGroupID:0}});return this._vinciDataProvider.post({relativeUrl:"/SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerSearchUser",telemetry:{qosEventName:"VivaAmplify.VinciPublicationsDataProvider.GetPublication.Api"},body:n}).then(function(e){return t.parseUserData(e)}).catch(function(e){throw e})},e.prototype.parseUserData=function(e){for(var t=[],n=0,a=JSON.parse(e.value);n<a.length;n++){var i=a[n];"User"!==i.EntityType&&t.push({userId:this.extractGuidFromString(i.Key),email:i.EntityData.Email,name:i.DisplayText})}return t},e.prototype.extractGuidFromString=function(e){var t=e.match(/(?:[a-z0-9]+-){4}[a-z0-9]+/i);return t?t[0]:e},e.prototype.getPublishingStatus=function(){var e=this._getListItemId();return this._vinciDataProvider.get({relativeUrl:"/sitepages/pages({pageId})/GetPublishingStatus".replace(ie,e.toString()),telemetry:{qosEventName:"VivaAmplify.VinciPublicationsDataProvider.GetPublishingStatus.Api"}}).then(function(e){return e}).catch(function(e){throw e})},e.prototype.updatePublication=function(e){var t=this._getListItemId(),n=this._stringifyPublicationValues(e);return this._vinciDataProvider.post({relativeUrl:me.replace(ie,null==t?void 0:t.toString()),body:JSON.stringify(n),telemetry:{qosEventName:"VivaAmplify.VinciPublicationsDataProvider.UpdatePublication.Api"}},{"x-http-method":"MERGE"})},e.prototype.publishPublication=function(){var e=this._getListItemId();return this._vinciDataProvider.post({relativeUrl:u.Uri.concatenate(me.replace(ie,null==e?void 0:e.toString()),"Publish"),telemetry:{qosEventName:"VivaAmplify.VinciPublicationsDataProvider.PublishPublication.Api"}})},e.prototype.sendTestEmail=function(e){var t=this._getListItemId(),n=JSON.stringify(e);return this._vinciDataProvider.post({relativeUrl:u.Uri.concatenate(me.replace(ie,null==t?void 0:t.toString()),"SendTestEmail"),body:n,telemetry:{qosEventName:"VivaAmplify.VinciPublicationsDataProvider.SendTestEmail.Api"}})},e.prototype.getPrimaryTeamsChannelForCampaign=function(){var e;return this._vinciGraphDataProvider.get({relativeUrl:this._getTeamChannelGraphApiUrl(null===(e=this._pageContext.site.group)||void 0===e?void 0:e.id.toString()),baseUrl:he,telemetry:{qosEventName:"VivaAmplify.VinciPublicationsDataProvider.GetPrimaryTeamsChannelForCampaign.Api"}})},e.prototype.postTestTeamsMessage=function(e){var t=this,n=this._getListItemId(),a="";return this.getPrimaryTeamsChannelForCampaign().then(function(i){var r;a=null!==(r=null==i?void 0:i.id)&&void 0!==r?r:"";var o=JSON.stringify((0,d.__assign)({audienceId:a},e));return t._vinciDataProvider.post({relativeUrl:u.Uri.concatenate(me.replace(ie,null==n?void 0:n.toString()),"SendTestTeamsMessage"),body:o,telemetry:{qosEventName:"VivaAmplify.VinciPublicationsDataProvider.PostTestTeamsMessage.Api"}}).then(function(e){return(0,d.__assign)((0,d.__assign)({},e),{PrimaryChannelId:a})})})},e.prototype.getIsAmplifySite=function(e){var t=te()?void 0:AbortSignal.timeout(4e3);return this._vinciDataProvider.get({relativeUrl:ve,baseUrl:e,telemetry:{qosEventName:"VivaAmplify.VinciPublicationsDataProvider.GetIsAmplifySite.Api"},signal:t}).then(function(e){return!!e.DefinitionId}).catch(function(e){throw e})},e.prototype.schedulePublication=function(e,t,n){return this._vinciDataProvider.post({relativeUrl:(a=n||this._getListItemId(),"/sitepages/pages(".concat(a,")/SchedulePublication")),body:JSON.stringify(e),telemetry:{componentAlias:null==t?void 0:t.alias,qosEventName:"VivaAmplify.VinciPublicationsDataProvider.SchedulePublication.Api"}}).then(function(e){return(0,d.__assign)((0,d.__assign)({},e),{publicationStatus:T[e.publicationStatus]})});var a},e.prototype.cancelSchedulePublication=function(e,t){return this._vinciDataProvider.post({relativeUrl:(n=t||this._getListItemId(),"/sitepages/pages(".concat(n,")/CancelSchedulePublication")),telemetry:{componentAlias:null==e?void 0:e.alias,qosEventName:"VivaAmplify.VinciPublicationsDataProvider.CancelSchedulePublication.Api"}}).then(function(e){return(0,d.__assign)((0,d.__assign)({},e),{publicationStatus:T[e.publicationStatus]})});var n},e.prototype.validateSitePermission=function(e){var t,n={siteUrl:e};return this._vinciDataProvider.post({relativeUrl:(t=this._getListItemId(),"/sitepages/pages(".concat(t,")/SPSiteValidator")),body:JSON.stringify(n),telemetry:{qosEventName:"VivaAmplify.VinciPublicationsDataProvider.ValidateSitePermission.Api"}}).then(function(e){return e.value}).catch(function(e){throw e})},e.prototype.fetchFileContent=function(e,t){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(n){return[2,this._excelCsvHandler.fetchFileContent(e,t)]})})},e.prototype.processLocalFileUpload=function(e,t){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(n){return[2,this._excelCsvHandler.processLocalFileContent(e,t)]})})},e.prototype.fetchFileContentWithVersion=function(e,t,n,a,i){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(r){return[2,this._excelCsvHandler.fetchFileContentWithVersion(e,t,n,a,i)]})})},e.prototype.processLocalFile=function(e,t){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(n){return[2,this._excelCsvHandler.processLocalFileContent(e,t)]})})},e.prototype.getAudienceSizeEstimateAnalyticsReport=function(e,t){return this._vinciDataProvider.post({relativeUrl:"v2.1/campaign/oneDrive.GetAudienceSizeEstimate",body:JSON.stringify(e),telemetry:{componentAlias:null==t?void 0:t.alias,qosEventName:"VivaAmplify.VinciPublicationsDataProvider.GetAudienceSizeEstimateAnalyticsReport.Api"}}).then(function(e){return e}).catch(function(e){throw e})},e.prototype.saveStreams=function(e,t,n,a){var i=n||this._getListItemId(),r=JSON.stringify(e);return this._vinciDataProvider.post({relativeUrl:u.Uri.concatenate(me.replace(ie,null==i?void 0:i.toString()),"/SaveStreams",l._SPFlight.isEnabled(61555)&&!l._SPKillSwitch.isActivated("010fcee8-682a-4e07-a409-6081776af191")&&a?"(sharedLockId='".concat(a,")'"):""),body:r,telemetry:{qosEventName:"VivaAmplify.VinciPublicationsDataProvider.SaveStreams.Api"}})},e.prototype._getListItemId=function(){var e=this._pageContext.listItem;if(!e)throw new Error("list item is not defined");return e.id},e.prototype._parsePublicationValues=function(e){return(0,d.__assign)((0,d.__assign)({},e),{PublicationStatus:e.PublicationStatus,EmailEndpoint:JSON.parse(e.EmailEndpoint),SharePointEndpoint:JSON.parse(e.SharePointEndpoint),PublicationMetadata:JSON.parse(e.PublicationMetadata),TeamsEndpoint:JSON.parse(e.TeamsEndpoint),VivaEngageEndpoint:l._SPKillSwitch.isActivated("226bd28a-333d-413e-ace2-6ce27f675a63")||e.VivaEngageEndpoint?JSON.parse(e.VivaEngageEndpoint):{}})},e.prototype._stringifyPublicationValues=function(e){return{EmailEndpoint:JSON.stringify(e.EmailEndpoint),SharePointEndpoint:JSON.stringify(e.SharePointEndpoint),PublicationMetadata:JSON.stringify(e.PublicationMetadata),TeamsEndpoint:JSON.stringify(e.TeamsEndpoint),VivaEngageEndpoint:JSON.stringify(e.VivaEngageEndpoint)}},e.prototype._getTeamChannelGraphApiUrl=function(e){return"/v1.0/teams/".concat(e||this._pageContext.site.id,"/primaryChannel")},e.prototype._build3SSuggestionQuery=function(e){var t={EntityRequests:[{EntityType:"Channel",Query:{QueryString:e},Filter:{Or:[{Term:{ChannelType:"Shared"}},{Term:{ChannelType:"Standard"}},{Term:{ChannelType:"Private"}}]},Size:10},{EntityType:"Team",Query:{QueryString:e},Size:10}],Cvid:l.Guid.newGuid().toString(),LogicalId:l.Guid.newGuid().toString(),AppName:"Viva Amplify",Scenario:{Name:"PublishToTeams"}};return l._SPFlight.isEnabled(61366)&&(t.EntityRequests.push({EntityType:"Chat",Query:{QueryString:e},Size:10}),t.EntityRequests.push({EntityType:"People",Query:{QueryString:e},Fields:["Id","MRI","DisplayName","EmailAddresses","ImAddress","UserPrincipalName"],Filter:{And:[{Or:[{Term:{PeopleType:"Person"}}]},{Or:[{Term:{PeopleSubtype:"OrganizationUser"}},{Term:{PeopleSubtype:"PendingOrgContact"}},{Term:{PeopleSubtype:"OrgContact"}},{Term:{PeopleSubtype:"MTOUser"}},{Term:{PeopleSubtype:"Guest"}}]}]},Provenances:["Mailbox","Directory","SecurityGroups","ExtendedDirectory"],Size:10})),t},e.serviceKey=l.ServiceKey.create("sp-vinci-data-provider:VinciPublicationsDataProvider",e),e}();const tt=et,nt=function(){function e(){}return e.prototype.getAccessToken=function(e,t){var n=f._AmplifyLogger.getAmplifyLogger().createQosEvent("VinciSecureBroker.AADTokenThroughMSAL.Event"),a=t||"VinciSecurebrokerAADTokenDataProvider.getAccessToken";return Ce._AadTokenProviders.configurable._getTokenInternal(e,Ce._AadTokenProviders.preAuthorizedConfiguration).then(function(e){return n.logSuccess({alias:a}),e}).catch(function(e){throw n.logUnexpectedFailure(null==e?void 0:e.message,e,{alias:a}),e})},e.serviceKey=l.ServiceKey.create("sp-vinci-data-provider:VinciSecurebrokerAADTokenDataProvider",e),e}(),at=function(){function e(e){var t=this;l.Validate.isNotNullOrUndefined(e,"serviceScope"),e.whenFinished(function(){t._vinciDataProvider=e.consume(ae.serviceKey)})}return e.prototype.getCampaignPreaggregatedAnalyticsReport=function(e,t){return this._vinciDataProvider.post({relativeUrl:"v2.1/campaign/oneDrive.GetCampaignPreaggregatedAnalyticsReport",body:JSON.stringify(e),telemetry:{componentAlias:null==t?void 0:t.alias,qosEventName:"VivaAmplify.VinciAnalyticsDataProvider.GetCampaignPreaggregatedAnalyticsReport.Api"}}).then(function(e){return e.value})},e.prototype.getPublicationPreaggregatedAnalyticsReport=function(e,t){return this._vinciDataProvider.post({relativeUrl:"v2.1/campaign/oneDrive.GetPublicationPreaggregatedAnalyticsReport",body:JSON.stringify(e),telemetry:{componentAlias:null==t?void 0:t.alias,qosEventName:"VivaAmplify.VinciAnalyticsDataProvider.GetPublicationPreaggregatedAnalyticsReport.Api"}}).then(function(e){return e.value})},e.serviceKey=l.ServiceKey.create("sp-vinci-data-provider:VinciAnalyticsDataProvider",e),e}();var it=function(e){return"/SitePages/pages(".concat(e,")/CreateApprovalRequest")},rt=function(e){return"/SitePages/pages(".concat(e,")/CheckoutPage")},ot=function(e){return"/SitePages/pages(".concat(e,")/ApproveApprovalRequest")},st=function(e){return"/SitePages/pages(".concat(e,")/RejectApprovalRequest")},ct=function(e){return"/SitePages/pages(".concat(e,")/CancelApprovalRequest")},dt=function(e){return"/SitePages/pages(".concat(e,")/SyncApprovalRequest")},lt=function(e){return e?"".concat(e[0].toLowerCase()).concat(e.substring(1)):""};function ut(e){var t=Object.entries(e);return Object.fromEntries(t.map(function(e){var t=e[0],n=e[1];return[lt(t),n]}))}function ft(e){return"i:0#.f|membership|".concat(e)}var pt=new Set(["Approvals_InvalidPublicationStatus","Approvals_CheckedOutByAnotherUser","Approvals_InvalidApprover","Approvals_RequestNotFound"]),mt=function(){function e(e){var t=this;l.Validate.isNotNullOrUndefined(e,"serviceScope"),e.whenFinished(function(){t._vinciDataProvider=e.consume(ae.serviceKey)})}return e.resolveQosAndAshaFromError=function(e){var t=e.error,n=e.qosEvent,a=e.customerPromiseEvent,i=e.customerPromiseVeto;return Promise.resolve().then(function(){return J.is(t)?t.campaignErrorInfo:void 0}).catch(function(){}).then(function(e){var r,o;(null==e?void 0:e.errorDescription)&&pt.has(null==e?void 0:e.errorDescription)?(null==n||n.logExpectedFailure(e.errorDescription,t),null==a||a.endEvent(t,!0)):(null==n||n.logUnexpectedFailure(null!==(r=null==e?void 0:e.errorDescription)&&void 0!==r?r:null==t?void 0:t.message,t),null==a||a.endEvent(t,!1,null!==(o=null==e?void 0:e.errorDescription)&&void 0!==o?o:"API failed",i))})},e.prototype.createApprovalRequest=function(e,t,n){var a=this;return this._vinciDataProvider.post({relativeUrl:it(e),body:JSON.stringify({creationInfo:this._toApprovalRequestCreationInfoRaw(t)}),telemetry:{componentAlias:null==n?void 0:n.alias,qosEventName:"VivaAmplify.VinciApprovalsDataProvider.CreateApprovalRequest.Api"}}).then(function(e){return a._toApprovalState(e)})},e.prototype.checkoutAndCreateApprovalRequest=function(e,t,n){var a=this;return this._vinciDataProvider.post({relativeUrl:rt(e),body:JSON.stringify(""),telemetry:{componentAlias:null==n?void 0:n.alias,qosEventName:"VivaAmplify.VinciApprovalsDataProvider.CheckoutAndCreateApprovalRequest.Api"}}).then(function(i){return a.createApprovalRequest(e,t,n)})},e.prototype.approveApprovalRequest=function(e,t,n){var a=this;return this._vinciDataProvider.post({relativeUrl:ot(e),body:JSON.stringify({comment:t}),telemetry:{componentAlias:null==n?void 0:n.alias,qosEventName:"VivaAmplify.VinciApprovalsDataProvider.ApproveApprovalRequest.Api"}}).then(function(e){return a._toApprovalState(e)})},e.prototype.rejectApprovalRequest=function(e,t,n){var a=this;return this._vinciDataProvider.post({relativeUrl:st(e),body:JSON.stringify({comment:t}),telemetry:{componentAlias:null==n?void 0:n.alias,qosEventName:"VivaAmplify.VinciApprovalsDataProvider.RejectApprovalRequest.Api"}}).then(function(e){return a._toApprovalState(e)})},e.prototype.cancelApprovalRequest=function(e,t){var n=this;return this._vinciDataProvider.post({relativeUrl:ct(e),body:JSON.stringify({}),telemetry:{componentAlias:null==t?void 0:t.alias,qosEventName:"VivaAmplify.VinciApprovalsDataProvider.CancelApprovalRequest.Api"}}).then(function(e){return n._toApprovalState(e)})},e.prototype.syncApprovalRequest=function(e,t){var n=this;return this._vinciDataProvider.post({relativeUrl:dt(e),body:JSON.stringify({}),telemetry:{componentAlias:null==t?void 0:t.alias,qosEventName:"VivaAmplify.VinciApprovalsDataProvider.SyncApprovalRequest.Api"}}).then(function(e){return n._toSyncApprovalRequestResponse(e)})},e.prototype._toApprovalRequestCreationInfoRaw=function(e){return{Approvers:e.approvers.map(ft),AwaitAll:e.awaitAll,Important:e.important,Message:e.message,DistributionChannel:e.distributionChannels,PublishOption:void 0===e.publishingOption?void 0:this._toTeamsPublishOption(e.publishingOption),SchedulePublishDate:e.schedulePublishDate}},e.prototype._toSyncApprovalRequestResponse=function(e){return{approvalRequest:this._toApprovalRequest(JSON.parse(e.ApprovalRequest)),publicationStatus:T[e.PublicationStatus]}},e.prototype._toApprovalRequest=function(e){var t=this;return(0,d.__assign)((0,d.__assign)({},ut(e)),{partnerMetadata:this._toApprovalRequestPartnerMetadata(e.PartnerMetadata),actions:e.Actions.map(function(e){return t._toApprovalRequestAction(e)}),approvers:e.Approvers.map(function(e){return t._toApprovalRequestUserPrincipal(e)}),responses:e.Responses.map(function(e){return t._toApprovalRequestUserPrincipal(e)})})},e.prototype._toApprovalState=function(e){return{publicationStatus:T[e.PublicationStatus],approvalStatus:e.ApprovalStatus}},e.prototype._toApprovalRequestAction=function(e){var t,n=this;return(0,d.__assign)((0,d.__assign)({},ut(e)),{users:e.Users.map(function(e){return n._toApprovalRequestUserPrincipal(e)}),comments:null!==(t=e.Comments)&&void 0!==t?t:void 0,timestamp:e.Timestamp?new Date(e.Timestamp):void 0})},e.prototype._toApprovalRequestUserPrincipal=function(e){var t;return(0,d.__assign)((0,d.__assign)({},ut(e)),{thumbnailPhoto:null!==(t=e.ThumbnailPhoto)&&void 0!==t?t:void 0})},e.prototype._toApprovalRequestPartnerMetadata=function(e){return{vivaAmplifyAdditionalDetails:e.VivaAmplifyAdditionalDetails?this._toApprovalRequestVivaAmplifyAdditionalDetails(e.VivaAmplifyAdditionalDetails):void 0}},e.prototype._toApprovalRequestVivaAmplifyAdditionalDetails=function(e){var t,n=this;return(0,d.__assign)((0,d.__assign)({},e),{distributionChannels:null===(t=e.distributionChannel)||void 0===t?void 0:t.map(function(e){return n._toDistributionChannel(e)}),publishOption:e.publishOption?this._toPublishingOption(lt(e.publishOption)):void 0,scheduledPublishDate:e.scheduledPublishDate?new Date(e.scheduledPublishDate):void 0})},e.prototype._toDistributionChannel=function(e){switch(e){case"outlook":return"Outlook";case"sharepoint":return"SharePoint";case"teams":return"Teams";case"yammer":return"VivaEngage"}},e.prototype._toPublishingOption=function(e){switch(e){case"scheduledFor":return"Schedule";case"publishOnceApproved":return"Automatic";case"reviewBeforePublish":return"Manual"}},e.prototype._toTeamsPublishOption=function(e){switch(e){case"Schedule":return"scheduledFor";case"Automatic":return"publishOnceApproved";case"Manual":return"reviewBeforePublish"}},e.serviceKey=l.ServiceKey.create("sp-vinci-data-provider:VinciApprovalsDataProvider",e),e.processError=function(e,t){var n;J.is(e)&&e.campaignErrorInfo?null===(n=e.campaignErrorInfo)||void 0===n||n.then(function(n){void 0!==(null==n?void 0:n.errorDescription)?pt.has(n.errorDescription)?t.logExpectedFailure(n.errorDescription,e):t.logUnexpectedFailure(n.errorDescription,e):t.logUnexpectedFailure(null==e?void 0:e.message,e)}).catch(function(){t.logUnexpectedFailure(null==e?void 0:e.message,e)}):t.logUnexpectedFailure(null==e?void 0:e.message,e)},e}();const _t=mt;function ht(e,t,n){var a=new Set(e.map(function(e){return e[n]})),i=t.filter(function(e){return!a.has(e[n])}),r=(0,d.__spreadArray)((0,d.__spreadArray)([],e.slice(0,3),!0),i.slice(0,2),!0),o=(0,d.__spreadArray)((0,d.__spreadArray)([],e.slice(3),!0),i.slice(2),!0);return(0,d.__spreadArray)((0,d.__spreadArray)([],r,!0),o,!0)}var bt=h(773),gt=h(207),vt=function(){function e(){}return e.applyCacheAndNetwork=function(t,n,a,i){var r=new gt._QosMonitor("".concat(a.qosMonitorLabel,".getProcessedResponseInSmartRace")),o=t.serverResponse.then(function(e){return a.parseHttpClientResponse(e,n,r)}).then(function(t){var n=a.isEmptyResponse(t);return e._executeIfDefined(a,a.onServerResponseResolved,n),t}).catch(function(t){throw e._executeIfDefined(a,a.onServerResponseFailed,t),t}),s=new gt._QosMonitor("".concat(a.qosMonitorLabel,".getProcessedCachedResponseInSmartRace")),c=[{raceablePromise:e.processResponseRawData(t.cachedResponse,a.isRawData,a.processRawData,n,s).then(function(t){var n=a.isEmptyResponse(t);return e._executeIfDefined(a,a.onCacheResponseResolved,n),t}).catch(function(t){throw s.writeUnexpectedFailure("ParseCacheResultsFailed",t),e._executeIfDefined(a,a.onCacheResponseFailed,t),t}),raceId:e._cachedDataPromiseId},{raceablePromise:o,raceId:e._serverDataPromiseId}];return bt.SmartRace.race(c).then(function(t){return t.raceId===e._cachedDataPromiseId&&o.then(function(t){e._executeIfDefined(a,a.onServerResponseResolvedWithCache,t)}).catch(function(){}),i.writeSuccess({cacheStatus:t.raceId===e._cachedDataPromiseId?"WonRace":"LostRace"}),t.raceablePromise}).catch(function(e){throw i.writeUnexpectedFailure("SmartRaceFailed",e),e})},e.applyCacheThenNetwork=function(t,n,a,i){var r,o=t.cachedResponse?e.processResponseRawData(t.cachedResponse,a.isRawData,a.processRawData,n,i):void 0,s=new gt._QosMonitor("".concat(a.qosMonitorLabel,".getProcessedResponse")),c=null===(r=t.serverResponse)||void 0===r?void 0:r.then(function(e){return a.parseHttpClientResponse(e,n,s)}).then(function(t){var n=a.isEmptyResponse(t);return e._executeIfDefined(a,a.onServerResponseResolved,n),t}).catch(function(t){throw e._executeIfDefined(a,a.onServerResponseFailed,t),t});return o?(o.then(function(t){var n=a.isEmptyResponse(t);e._executeIfDefined(a,a.onCacheResponseResolved,n),c?(e._executeIfDefined(a,a.onCacheThenNetworkServerDataReturned,c,!0,n),c.then(function(t){e._executeIfDefined(a,a.onServerResponseResolvedWithCache,t)}).catch(function(){})):e._executeIfDefined(a,a.onCacheThenNetworkServerDataNotReturned,!0,n)}).catch(function(t){e._executeIfDefined(a,a.onCacheResponseFailed,t)}),o):(i.writeSuccess(),e._executeIfDefined(a,a.onCacheThenNetworkServerDataReturned,c,!1,!0),c)},e.executeCacheStrategy=function(t,n,a){var i=new gt._QosMonitor("".concat(t.qosMonitorLabel,".getData"));return n(a).then(function(n){if(n instanceof Response||(null==n?void 0:n.nativeResponse)instanceof Response)return t.parseHttpClientResponse(n,a,i).then(function(n){var a=t.isEmptyResponse(n);return e._executeIfDefined(t,t.onServerResponseResolved,a),n}).catch(function(n){throw e._executeIfDefined(t,t.onServerResponseFailed,n),n});var r=n;return r.serverResponse&&r.cachedResponse?e.applyCacheAndNetwork(r,a,t,i):r.cachedResponse||r.serverResponse?e.applyCacheThenNetwork(r,a,t,i):e.processResponseRawData(Promise.resolve(n),t.isRawData,t.processRawData,a).then(function(n){return i.writeSuccess(),e._executeIfDefined(t,t.onCacheResponseResolved,!!n),n}).catch(function(n){throw i.writeUnexpectedFailure("Error Processing cached data",n),e._executeIfDefined(t,t.onCacheResponseFailed,n),n})}).catch(function(e){throw i.hasEnded||i.writeUnexpectedFailure("Excecute Request failed",e),e})},e.processResponseRawData=function(e,t,n){for(var a=[],i=3;i<arguments.length;i++)a[i-3]=arguments[i];return e.then(function(e){return t(e)?n.apply(void 0,(0,d.__spreadArray)([e],a,!1)):e})},e.useStalePropName="useStale",e.enableDataPrefetch="enableDataPrefetch",e.dataPrefetchKey="dataPrefetchKey",e.parentKeyOverride="parentKeyOverride",e.onlyIndexedDB="onlyIndexedDB",e.onlyMySiteCache="onlyMySiteCache",e.cacheKeyOverride="cacheKeyOverride",e.mySiteCacheConfiguration="mySiteCacheConfiguration",e.defaultWebPartCachePath="WebPartCache",e.prefetchUpdateOptions="prefetchUpdateOptions",e._cachedDataPromiseId=l.Guid.parse("9b794e3a-a041-4fb4-870d-a1121ca57ca7"),e._serverDataPromiseId=l.Guid.parse("4d757517-a42f-4546-a76a-8d0da7dd2a07"),e._executeIfDefined=function(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];if(t)return t.apply(e,n)},e}();const yt=vt;function St(e){return"undefined"!=typeof window&&"function"==typeof window.TextEncoder?(new window.TextEncoder).encode(e):self&&"function"==typeof self.TextEncoder?(new self.TextEncoder).encode(e):new Uint8Array(function(e){for(var t=[],n=0;n<e.length;n++){var a=e.charCodeAt(n);a<128?t.push(a):a<2048?t.push(192|a>>6,128|63&a):a<55296||a>=57344?t.push(224|a>>12,128|a>>6&63,128|63&a):(n++,a=65536+((1023&a)<<10|1023&e.charCodeAt(n)),t.push(240|a>>18,128|a>>12&63,128|a>>6&63,128|63&a))}return t}(e))}function Dt(e){return"undefined"!=typeof window?!window.crypto&&window.msCrypto?function(e){var t=window.msCrypto,n=St(e);return new Promise(function(e,a){var i=t.subtle.digest("SHA-256",n);i.oncomplete=function(t){var n=Array.from(new Uint8Array(t.target.result)).map(function(e){return e.toString(16).padStart(2,"0")}).join("");e(n)},i.onerror=function(e){!function(e,t){t({message:e.message})}(e,a)}})}(e):function(e){return function(e){return(0,d.__awaiter)(this,void 0,void 0,function(){var t;return(0,d.__generator)(this,function(n){switch(n.label){case 0:return t=St(e),[4,window.crypto.subtle.digest("SHA-256",t)];case 1:return[2,n.sent()]}})})}(e).then(function(e){return Array.from(new Uint8Array(e)).map(function(e){return e.toString(16).padStart(2,"0")}).join("")})}(e):Promise.reject()}var It="TieredCacheHelper";const xt=function(){function e(){}return e.getAppCacheDataProvider=function(e){return e.consume((0,Ce._getCacheDataProviderServiceKey)())._provider},e.getPrefetchDataProvider=function(e){return e.consume((0,Ce._getPrefetchDataProviderServiceKey)())._provider},e.generateCacheKey=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var a=[];return t.forEach(function(t){"string"==typeof t?a.push(t.toUpperCase()):a.push(e._serializeMap(t))}),Dt(a.sort().join(","))},e.getItem=function(e,t,n,a){var i=new gt._QosMonitor("".concat(It,".").concat(t,".getItem"));return n.getData(e,a).then(function(e){return i.writeSuccess(),Promise.resolve(e.data)}).catch(function(e){return i.writeUnexpectedFailure("GetTieredCacheFailed",e),Promise.reject(e)})},e.getItemVerbose=function(e,t,n,a){var i=new gt._QosMonitor("".concat(It,".").concat(t,".getItemVerbose"));return n.getData(e,a).then(function(e){return i.writeSuccess(),Promise.resolve(e)}).catch(function(e){return i.writeUnexpectedFailure("GetTieredCacheFailed",e),Promise.reject(e)})},e.setItem=function(e,t,n,a,i){var r=new gt._QosMonitor("".concat(It,".").concat(n,".setItem"));return a.setData(e,t,i).then(function(){return r.writeSuccess(),Promise.resolve()}).catch(function(e){return r.writeUnexpectedFailure("SetItemFailed",e),Promise.reject(e)})},e.getWebPartDefaultCachePath=function(t){return"/".concat(e.defaultWebPartCachePath,"/").concat(t)},e._serializeMap=function(t){var n=t instanceof Array;return Object.keys(t).map(function(a){var i=n?"":a.toUpperCase();return t[a]instanceof Object?i+e._serializeMap(t[a]):i+"".concat(t[a]).toUpperCase()}).sort().reduce(function(e,t){return e+t},"")},e.useStalePropName="useStale",e.enableDataPrefetch="enableDataPrefetch",e.dataPrefetchKey="dataPrefetchKey",e.parentKeyOverride="parentKeyOverride",e.onlyIndexedDB="onlyIndexedDB",e.onlyMySiteCache="onlyMySiteCache",e.cacheKeyOverride="cacheKeyOverride",e.mySiteCacheConfiguration="mySiteCacheConfiguration",e.defaultWebPartCachePath="WebPartCache",e.prefetchUpdateOptions="prefetchUpdateOptions",e}();var Ct=function(e){function t(n){var a=e.call(this,n,t._cacheKey)||this;return a.qosMonitorLabel="VivaAmplify.Cache.Suggestions",a.getSmartAudienceSelector=function(){return a.getData(a._audienceSearch,void 0,"VivaAmplify.Cache.SmartAudienceSelector")},a.parseHttpClientResponse=function(e){return e.json().then(function(e){return a.processRawData(e)})},a.isRawData=function(e){return null!==e&&"object"==typeof e},a.isEmptyResponse=function(e){var t,n,a,i,r,o,s,c,d,l=(null==e?void 0:e.sharepoint).sites;return!e||0===(null!==(a=null===(n=null===(t=e.teams)||void 0===t?void 0:t.channels)||void 0===n?void 0:n.length)&&void 0!==a?a:0)&&0===(null!==(o=null===(r=null===(i=e.teams)||void 0===i?void 0:i.chats)||void 0===r?void 0:r.length)&&void 0!==o?o:0)&&0===(null!==(d=null===(c=null===(s=e.teams)||void 0===s?void 0:s.people)||void 0===c?void 0:c.length)&&void 0!==d?d:0)&&0===(null==l?void 0:l.length)},a.processRawData=function(e){return e},a.formatRawSiteData=function(e){return e.reduce(function(e,t){var n=(0,d.__assign)({siteId:t.ItemReference.SiteId,siteName:t.Title,siteUrl:t.Url},l._SPFlight.isEnabled(62191)?{webId:t.ItemReference.WebId}:{});return He()&&(n.imageUrl=t.BannerImageUrl,n.isAudienceTargetingEnabled=t.IsAudienceTargetingEnabled),e.push(n),e},[])},a._audienceSearch=function(){return(0,d.__awaiter)(a,void 0,void 0,function(){var e,t,n,a=this;return(0,d.__generator)(this,function(i){switch(i.label){case 0:return e=this._zeroTermLogger.createEvent({qosEventName:"VivaAmplify.VinciZeroTermSuggestionDataProvider.SmartAudience.Api",componentAlias:"VinciZeroTermSuggestionDataProvider"}),[4,Promise.allSettled([this._vinciPublicationsDataProvider.getAudienceQuerySearch("",{alias:"SmartAudienceSelector"}),this._vinciCampaignsDataProvider.getPublishedAudiences({alias:"SmartAudienceSelector"}),this._vinciPublicationsDataProvider.getRecentSites({alias:"SmartAudienceSelector"})]).then(function(t){var n,i,r,o,s,c,d;if(3!==t.length)throw new Error("Invalid number of responses");var u={teams:Ae,sharepoint:[]},f=t[0],p=t[1];if("fulfilled"===p.status?u=p.value:e.logUnexpectedFailure(p.reason),"fulfilled"===f.status){var m=f.value;u.teams={channels:ht(null!==(i=null===(n=u.teams)||void 0===n?void 0:n.channels)&&void 0!==i?i:[],m.channels,"threadId"),chats:ht(null!==(o=null===(r=u.teams)||void 0===r?void 0:r.chats)&&void 0!==o?o:[],m.chats,"threadId"),people:ht(null!==(c=null===(s=u.teams)||void 0===s?void 0:s.people)&&void 0!==c?c:[],m.people,"id")},u.teams.channels.forEach(function(e){e.source="Cache"}),u.teams.chats.forEach(function(e){e.source="Cache"}),u.teams.people.forEach(function(e){e.source="Cache"}),e.logSuccess()}else e.logUnexpectedFailure(f.reason);var _=t[2],h=u.sharepoint.sites;return"fulfilled"===_.status?(l._SPKillSwitch.isActivated("9045ebe9-dfa4-483d-a5a1-38d3ffc01684")||a._removeCurrentSiteFromSharepointSearchSuggestions(_.value),u.sharepoint={sites:ht(null!=h?h:[],null!==(d=a.formatRawSiteData(a._retrieveVroomItems(_.value)))&&void 0!==d?d:[],"siteId")}):e.logUnexpectedFailure(_.reason),u}).catch(function(t){return e.logUnexpectedFailure(t),Le})];case 1:return t=i.sent(),n=new Response(JSON.stringify(t),{status:200,statusText:"OK"}),[2,Promise.resolve(n)]}})})},l.Validate.isNotNullOrUndefined(n,"serviceScope"),n.whenFinished(function(){a._vinciCampaignsDataProvider=n.consume(Fe.serviceKey),a._vinciPublicationsDataProvider=n.consume(tt.serviceKey),a._zeroTermLogger=new ee}),a}return(0,d.__extends)(t,e),t.prototype._retrieveVroomItems=function(e){var t=[];return e&&(null==e?void 0:e.value)&&e.value.map(function(e){var n,a,i=e.groupId&&"00000000-0000-0000-0000-000000000000"!==e.groupId;if("APP"!==(null===(n=e.template)||void 0===n?void 0:n.name)&&(l._SPKillSwitch.isActivated("6a848899-9020-4227-9a62-01df28c4c869")||"STS"!==(null===(a=e.template)||void 0===a?void 0:a.name))){var r={Acronym:e.resourceVisualization.acronym,BannerColor:e.resourceVisualization.color,BannerImageUrl:e.resourceVisualization.previewImageUrl,DepartmentId:e.sharepointIds.hubSiteId,ItemReference:(0,d.__assign)((0,d.__assign)({},i?{GroupId:e.groupId}:{}),{WebId:e.sharepointIds.webId,IndexId:parseInt(e.exchangeIds.documentId,10)||0,SiteId:e.sharepointIds.siteId,Type:i?"GroupReference":"SiteReference"}),Url:e.webUrl,Type:i?"Group":"Site",Title:e.title};He()&&(r.IsAudienceTargetingEnabled=!1),t.push(r)}}),t},t.prototype._removeCurrentSiteFromSharepointSearchSuggestions=function(e){e&&e.value&&(e.value=e.value.filter(function(e){return!window.location.href.includes(e.webUrl)}))},t.serviceKey=l.ServiceKey.create("sp-vinci-data-provider:VinciSubstrateDataProvider",t),t._cacheKey="Suggestions",t}(function(){function e(e,t){var n=this;this._cacheAlias="VivaAmplify_Data",this._prefetchKey="_spVivaAmplifyPublicationPrefetchData",this._serviceScope=e,this._cacheKey=t;var a=new Map;e.whenFinished(function(){n._tieredCache=n._initializeTieredCache(),n._pageContext=e.consume(G.PageContext.serviceKey),n._logger=new ee;var t={folderPath:"".concat(n._cacheAlias,"/CampaignCache/").concat(n._pageContext.site.id.toString())};a.set(xt.mySiteCacheConfiguration,t),n._cacheOptions={alias:n._cacheAlias,id:n._pageContext.site.id.toString(),expirationDuration:6e3,cacheStrategy:Ce._CacheStrategy.NetworkOnly,extraProps:a}})}return e.prototype.getData=function(e,t,n){var a={parseHttpClientResponse:this.parseHttpClientResponse,isRawData:this.isRawData,isEmptyResponse:this.isEmptyResponse,processRawData:this.processRawData,qosMonitorLabel:n},i={apiRequest:e,args:t};return yt.executeCacheStrategy(a,this._execute.bind(this),i)},e.prototype._execute=function(e){var t=this;try{return this._getFlushedData(e.args).then(function(n){return setTimeout(function(){return Ce._CacheManager.fetchAndCache({key:t._cacheKey},t._tieredCache,t._cacheOptions,function(){return e.apiRequest.apply(e,e.args)})},0),n})}catch(t){return Ce._CacheManager.fetchAndCache({key:this._cacheKey},this._tieredCache,this._cacheOptions,function(){return e.apiRequest.apply(e,e.args)})}},e.prototype._initializeTieredCache=function(){return xt.getAppCacheDataProvider(this._serviceScope)},e.prototype._getFlushedData=function(e){var t=window[this._prefetchKey],n=this._logger.createEvent({qosEventName:"VivaAmplify.VinciCacheDataProvider.ParsePrefetchData.Api",componentAlias:"VinciCacheDataProvider"});try{if(t&&t.Items&&t.Items[this._cacheKey]){var a=t.Items[this._cacheKey];if(a&&a.Value){var i=JSON.parse(a.Value),r=this.processRawData(i,e);return n.logSuccess(),Promise.resolve(r)}throw new Error("Parsing Error Cache item does not contain data")}throw new Error("No flushed data found")}catch(e){throw n.logUnexpectedFailure(e),e}},e}());const Ot=Ct;var wt=function(){function e(e){var t=this;l.Validate.isNotNullOrUndefined(e,"serviceScope"),e.whenFinished(function(){t._pageContext=e.consume(G.PageContext.serviceKey),t._vinciGraphDataProvider=e.consume(we.serviceKey)})}return Object.defineProperty(e.prototype,"_groupId",{get:function(){var e,t;return null!==(t=null===(e=this._pageContext.site.group)||void 0===e?void 0:e.id.toString())&&void 0!==t?t:""},enumerable:!1,configurable:!0}),e.prototype.getCampaignGroupMembers=function(){return this._vinciGraphDataProvider.get({relativeUrl:y(this._groupId),baseUrl:he,telemetry:{componentAlias:"getCampaignGroupMembers",qosEventName:"VivaAmplify.VinciCampaignMembersDataProvider.GetCampaignGroupMembers.Api"}}).then(function(e){return e.value})},e.serviceKey=l.ServiceKey.create("sp-vinci-data-provider:VinciPublicationsDataProvider",e),e}();const Et=wt;var At=function(){function e(e){var t=this;l.Validate.isNotNullOrUndefined(e,"serviceScope"),e.whenFinished(function(){t._pageContext=e.consume(G.PageContext.serviceKey),t._vinciDataProvider=e.consume(ae.serviceKey),t._vinciGraphDataProvider=e.consume(we.serviceKey)})}return e.prototype.ensureTeam=function(e){return this._vinciDataProvider.post({relativeUrl:"GroupSiteManager/EnsureTeamForGroupEx",telemetry:{componentAlias:null==e?void 0:e.alias,qosEventName:"VivaAmplify.VinciTeamsDataProvider.EnsureTeam.Api"}})},e.prototype.installApp=function(e,t){return l.Validate.isNonemptyString(e,"teamsAppId"),this._vinciGraphDataProvider.post({relativeUrl:(n=this._getGroupId(),"v1.0/teams/".concat(n,"/installedApps")),body:JSON.stringify({"teamsApp@odata.bind":e}),telemetry:{componentAlias:null==t?void 0:t.alias,qosEventName:"VivaAmplify.VinciTeamsDataProvider.InstallApp.Api"}});var n},e.prototype.getInstalledApps=function(e){return this._vinciGraphDataProvider.get({relativeUrl:(t=this._getGroupId(),"v1.0/teams/".concat(t,"/installedApps?$expand=teamsAppDefinition")),telemetry:{componentAlias:null==e?void 0:e.alias,qosEventName:"VivaAmplify.VinciTeamsDataProvider.GetInstalledApps.Api"}}).then(function(e){return e.value});var t},e.prototype.getPrimaryChannel=function(e){return this._vinciGraphDataProvider.get({relativeUrl:(t=this._getGroupId(),"v1.0/teams/".concat(t,"/primaryChannel")),telemetry:{componentAlias:null==e?void 0:e.alias,qosEventName:"VivaAmplify.VinciTeamsDataProvider.GetPrimaryChannel.Api"}});var t},e.prototype._getGroupId=function(){var e,t=null===(e=this._pageContext.site.group)||void 0===e?void 0:e.id.toString();if(!t)throw new Error("Unable to find ID of group in page context.");return t},e.serviceKey=l.ServiceKey.create("sp-vinci-data-provider:VinciTeamsDataProvider",e),e}();const Lt=At;var kt,Mt,Pt,Tt;!function(e){e[e.Draft=0]="Draft",e[e.Publishing=1]="Publishing",e[e.Published=2]="Published",e[e.NeedsAttention=3]="NeedsAttention",e[e.PendingApproval=4]="PendingApproval",e[e.Rejected=5]="Rejected",e[e.ReadyToPublish=6]="ReadyToPublish",e[e.Scheduled=7]="Scheduled"}(kt||(kt={})),function(e){e[e.Active=0]="Active",e[e.Canceled=1]="Canceled",e[e.Rejected=2]="Rejected",e[e.Approved=3]="Approved"}(Mt||(Mt={})),function(e){e[e.NotSubmitted=0]="NotSubmitted",e[e.Pending=1]="Pending",e[e.Rejected=2]="Rejected",e[e.Approved=3]="Approved"}(Pt||(Pt={})),function(e){e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.Important=2]="Important"}(Tt||(Tt={}));var Ut,Ft=function(e){return"Owner"===e},Ht=function(e){return"Approver"===e||Ft(e)},Rt=function(e){return"Contributor"===e||Ht(e)},Nt=function(e){return"Visitor"===e||Rt(e)},Bt="unknown-error",jt="QosEventHandler",Vt=function(){function e(e,t){this.name=jt,this._endLogged=!1,this.qosEvent=e,this.logData=t}return e.is=function(e){return"object"==typeof e&&null!==e&&"name"in e&&e.name===jt},Object.defineProperty(e.prototype,"endLogged",{get:function(){return this._endLogged},enumerable:!1,configurable:!0}),e.prototype.mergeLogData=function(e){this.logData=(0,d.__assign)((0,d.__assign)({},this.logData),e)},e.prototype.logSuccess=function(e){this.endLogged||(this.qosEvent.logSuccess((0,d.__assign)((0,d.__assign)({},this.logData),e)),this._endLogged=!0)},e.prototype.logExpectedFailure=function(e,t,n){this.endLogged||(this.qosEvent.logExpectedFailure(e,t,(0,d.__assign)((0,d.__assign)({},this.logData),n)),this._endLogged=!0)},e.prototype.logUnexpectedFailure=function(e,t,n){this.endLogged||(this.qosEvent.logUnexpectedFailure(e,t,(0,d.__assign)((0,d.__assign)({},this.logData),n)),this._endLogged=!0)},e}();function zt(e){e()}var Gt=function(){function e(e,t,n){this[Ut]="Promise",this._innerPromise=new Promise(e),Vt.is(t)?(this.qosEventHandler=t,(null==n?void 0:n.alias)&&this.qosEventHandler.mergeLogData({alias:n.alias})):this.qosEventHandler=t&&new Vt(t,void 0!==(null==n?void 0:n.alias)?{alias:n.alias}:void 0),this.qosHandlingOptions=n}return e.startQosEvent=function(t){return new e(zt,"qosEventName"in t?f._AmplifyLogger.getAmplifyLogger().createQosEvent(t.qosEventName):t.qosEvent,t)},e.startWithoutQosEvent=function(){return new e(zt)},Object.defineProperty(e.prototype,"qosEvent",{get:function(){var e;return null===(e=this.qosEventHandler)||void 0===e?void 0:e.qosEvent},enumerable:!1,configurable:!0}),e.prototype.then=function(t,n){var a=this;return new e(function(e,i){a._innerPromise.then(t&&function(e){return t(e,a.qosEventHandler)},n&&function(e){return n(e,a.qosEventHandler)}).then(e,i)},this.qosEventHandler,this.qosHandlingOptions)},e.prototype.catch=function(t){var n=this;return new e(function(e,a){n._innerPromise.catch(t&&function(e){return t(e,n.qosEventHandler)}).then(e,a)},this.qosEventHandler,this.qosHandlingOptions)},e.prototype.finally=function(t){var n=this;return new e(function(e,a){n._innerPromise.finally(t&&function(){return t(n.qosEventHandler)}).then(e,a)},this.qosEventHandler,this.qosHandlingOptions)},e.prototype.withErrorHandling=function(e){var t=this;return this.then(function(e){return t._logSuccessForResolve(),e}).catch(function(n,a){var i={error:n};return t._deriveErrorContextInformation(i).then(function(){return t._getErrorHandler(i,e)}).then(function(e){return Promise.resolve().then(function(){return e(i.error,i.campaignErrorInfo,a)}).catch(function(e){throw t._updateContextForHandlerError(i,e),e})}).then(function(e){return t._logExpectedFailureForHandledError(i.errorType,n),e}).catch(function(r){var o;return t._logUnexpectedFailureForFallback(null!==(o=i.errorType)&&void 0!==o?o:Bt,n,(0,d.__assign)((0,d.__assign)({},i.logData),{__internalError:null==r?void 0:r.message})),e.fallback(n,i.campaignErrorInfo,a)})})},e.prototype.withErrorLogging=function(e){var t=this;return this.then(function(e){return t._logSuccessForResolve(),e}).catch(function(n,a){var i={error:n};return t._deriveErrorContextInformation(i).then(function(){if(!i.errorType||!(null==e?void 0:e.includes(i.errorType)))throw new Error("Given error type is not expected.");t._logExpectedFailureForHandledError(i.errorType,n)}).catch(function(e){var a;t._logUnexpectedFailureForFallback(null!==(a=i.errorType)&&void 0!==a?a:Bt,n,(0,d.__assign)((0,d.__assign)({},i.logData),{__internalError:null==e?void 0:e.message}))}).finally(function(){throw n})})},e.prototype.thenWithRetries=function(e,t,n){var a=this;return t<=0?this.then(e):this.then(e).catch(function(i){if(n){var r={error:i};return a._deriveErrorContextInformation(r).catch(function(){throw i}).then(function(){if(r.errorType&&n.includes(r.errorType))return a.thenWithRetries(e,t-1,n);throw i})}return a.thenWithRetries(e,t-1,n)})},e.prototype._deriveErrorContextInformation=function(e){return J.is(e.error)&&e.error.campaignErrorInfo?e.error.campaignErrorInfo.then(function(t){if(e.campaignErrorInfo=t,e.errorType=null==t?void 0:t.errorDescription,!e.errorType)throw e.errorType="null-error-code",new Error("Error type was null")}):Z.is(e.error)?(e.errorType=e.error.errorType,Promise.resolve()):Promise.reject(new Error("Error was not of type HttpClientErrorResponse or campaignErrorInfo was falsy."))},e.prototype._getErrorHandler=function(e,t){var n=t[e.errorType];if(n)return n;throw new Error("No error handler")},e.prototype._logSuccessForResolve=function(e){var t,n;(null===(t=this.qosHandlingOptions)||void 0===t?void 0:t.shouldNotLogSuccess)||null===(n=this.qosEventHandler)||void 0===n||n.logSuccess(e)},e.prototype._updateContextForHandlerError=function(e,t){e.logData=(0,d.__assign)((0,d.__assign)({},e.logData),{__failingHandler:e.errorType}),e.errorType="error-handler-threw-error"},e.prototype._logExpectedFailureForHandledError=function(e,t,n){var a,i;(null===(a=this.qosHandlingOptions)||void 0===a?void 0:a.shouldNotLogExpectedFailure)||null===(i=this.qosEventHandler)||void 0===i||i.logExpectedFailure(e,t,n)},e.prototype._logUnexpectedFailureForFallback=function(e,t,n){var a,i;(null===(a=this.qosHandlingOptions)||void 0===a?void 0:a.shouldNotLogUnexpectedFailure)||null===(i=this.qosEventHandler)||void 0===i||i.logUnexpectedFailure(e,t,n)},e}();Ut=Symbol.toStringTag;const Kt=Gt;function Wt(e){return new Promise(function(t){var n=l.Guid.newGuid();e.context.instanceId=n,setTimeout(function(){e.context.instanceId&&n.equals(e.context.instanceId)&&t()},e.delay)})}function qt(e,t,n){return l._SPFlight.isEnabled(e)||l._SPFlight.isEnabled(t)&&n}var Qt=function(e,t){var n,a=null!==(n=t.message)&&void 0!==n?n:"Network Request Failed";if(t.httpStatusCode)switch(t.httpStatusCode){case 401:a="Unauthorized";break;case 403:a="Forbidden";break;case 404:a="Not Found";break;case 500:a="Internal Server Error";break;default:a="Unknown Error: ".concat(t.httpStatusCode)}return"".concat(e," - ").concat(a)}})(),b})())})();