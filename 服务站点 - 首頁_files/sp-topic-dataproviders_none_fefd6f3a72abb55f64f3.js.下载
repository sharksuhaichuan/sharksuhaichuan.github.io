define("69ea40d8-80e5-4ed2-8e45-f5c904e94161_0.1.0",["tslib","@microsoft/sp-page-context","@ms/sp-component-utilities","@microsoft/sp-core-library","@microsoft/sp-diagnostics","@microsoft/sp-http","@microsoft/sp-lodash-subset","@ms/sp-telemetry","@ms/sp-topic-sdk","@microsoft/sp-http-base"],(e,t,n,a,i,r,o,s,c,d)=>(()=>{"use strict";var l={676:e=>{e.exports=a},207:e=>{e.exports=i},909:e=>{e.exports=r},737:e=>{e.exports=d},529:e=>{e.exports=o},408:e=>{e.exports=t},773:e=>{e.exports=n},27:e=>{e.exports=s},305:e=>{e.exports=c},280:t=>{t.exports=e}},u={};function f(e){var t=u[e];if(void 0!==t)return t.exports;var n=u[e]={exports:{}};return l[e](n,n.exports,f),n.exports}f.d=(e,t)=>{for(var n in t)f.o(t,n)&&!f.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},f.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),f.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var p={};return(()=>{var e;f.r(p),f.d(p,{OCPSPolicyDataProvider:()=>I,TopicMultilingualDataProvider:()=>x,TopicPageDataProvider:()=>y}),function(e){e[e.NotPromoted=0]="NotPromoted",e[e.PromoteOnPublish=1]="PromoteOnPublish",e[e.Promoted=2]="Promoted"}(e||(e={}));var t,n=f(280),a=f(408),i=f(773),r=f(676),o=f(207),s=f(909),c=f(529),d=f(27),l=f(305);!function(e){e[e.BadRequest=400]="BadRequest",e[e.Conflict=409]="Conflict",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.NotAcceptable=406]="NotAcceptable",e[e.ServerError=500]="ServerError",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.NotImplemented=501]="NotImplemented"}(t||(t={}));const u=t,m=function(e){function t(n,a,i,r){void 0===n&&(n="unknown"),void 0===a&&(a=200),void 0===r&&(r=!1);var o=e.call(this,n)||this;return"unknown"===n&&(o.isUnknown=!0),o.__proto__=t.prototype,o.status=a,o.code=i,o.isExpected=r,o}return(0,n.__extends)(t,e),t}(Error);function _(e){var t=e.headers.get("sprequestguid")||"",n=e.headers.get("microsoftsharepointteamservices")||"";return"[HTTP]:".concat(e.status," - ").concat(e.statusText," [CorrelationId]:").concat(t," [Version]:").concat(n)}function h(){return r._SPKillSwitch.isActivated("9c8c4dbb-309c-473c-8e35-e420d68f34f7")}var b=function(){function e(e){this.serviceScope=e,this._spHttpClient=e.consume(s.SPHttpClient.serviceKey)}return e._getOdataRestApiError=function(e,t){void 0===t&&(t=u.ServerError);var n=e["odata.error"];return(null==n?void 0:n.message)?new m("Message: ".concat(n.message.value),t,n.code):void 0},e.prototype.fetchJson=function(t,n,a,i){var r=new d._QosMonitor("".concat(this.qosPrefixName,".fetchDataFailed")),c={body:i,headers:n};return o._TraceLogger.logVerbose(o._LogSource.create(this.qosPrefixName),a),this._spHttpClient.post(t,s.SPHttpClient.configurations.v1,c).then(function(t){if(h()&&!t.ok)throw new m(_(t),t.status);return t.json().then(function(n){var a=e._getOdataRestApiError(n,null==t?void 0:t.status);if(a)throw a;return n}).catch(function(e){throw h()||e instanceof m?e:new m(_(t),t.status)})}).catch(function(e){throw e.status===u.Forbidden?r.writeExpectedFailure("FailedResponseForbidden",e):r.writeUnexpectedFailure("FailedResponseStatus",e),e})},e.prototype.getRestTopicsEndPointUrl=function(){return this.getRestSitePagesEndPointUrl().then(function(e){return"".concat(e,"/topics")})},e.prototype.getRestSitePagesEndPointUrl=function(){return this.getKnowledgeCenterRelativeUrl().then(function(e){return"".concat(e,"/_api/sitepages/pages")})},e.prototype.getKnowledgeCenterRelativeUrl=function(){var e=this;if(this._knowledgeCenterUrl)return Promise.resolve(this._knowledgeCenterUrl);var t=this.serviceScope.consume(a.PageContext.serviceKey);return(0,i.isSiteKnowledgeCenter)(t.legacyPageContext)?(this._knowledgeCenterUrl=r.UrlUtilities.removeEndSlash(t.legacyPageContext.webServerRelativeUrl),Promise.resolve(this._knowledgeCenterUrl)):(0,l.getTopicsSdk)(this.serviceScope).then(function(t){if(!t.getKnowledgeCenterInfo())throw new Error("Can not get valid knowledge center info");var n=t.getKnowledgeCenterInfo().url;return e._knowledgeCenterUrl=n,n})},e}(),g=function(e){this["OData-Version"]="3.0",this["If-Match"]="*",this["X-HTTP-Method"]=e},v=function(){function e(e){this.__metadata={type:"SP.Publishing.TopicSitePage"},e&&(0,c.assign)(this,e)}return e.prototype.toString=function(){return JSON.stringify(this)},e}(),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.createTopicPage=function(e){var t=this,a=e.topic,o=e.canvasContent1,s=e.layoutWebpartsContent,c=e.language;return this.getRestTopicsEndPointUrl().then(function(e){var d=new v((0,n.__assign)((0,n.__assign)((0,n.__assign)({Title:a.Name,EntityId:a.Id!==i.NULL_TOPIC_ENTITY.Id?a.Id:"",EntityType:"",EntityRelations:i.EntityRelationsService.getRelationsAsString(t.serviceScope)},r._SPFlight.isEnabled(1601)?{VerifiedTopicAllowedEditors:i.VerifiedTopicAllowedEditorsService.getEditorsAsString(t.serviceScope)}:void 0),r._SPFlight.isEnabled(60475)&&c&&{Language:c}),{LayoutWebpartsContent:s,CanvasContent1:JSON.stringify(o),TopicHeader:"Topic",BannerImageUrl:"/_layouts/15/images/sitepagethumbnail.png",PageLayoutType:"Topic"}));return t.fetchJson(e,new g("POST"),"createTopicPage",JSON.stringify(d))}).catch(function(e){throw e.name=function(e){var t,n,a,i,r,o;return-1!==(null===(t=e.code)||void 0===t?void 0:t.indexOf("-2146233086"))&&-1!==(null===(n=e.code)||void 0===n?void 0:n.indexOf("LanguageCodes"))?"UnsupportedLanguage":-1!==(null===(a=e.code)||void 0===a?void 0:a.indexOf("-2146232832"))&&-1!==(null===(i=e.code)||void 0===i?void 0:i.indexOf("Microsoft.SharePoint.SPException"))?"SourcePageCheckedOutByOtherUser":-1!==(null===(r=e.code)||void 0===r?void 0:r.indexOf("-2146232832"))&&-1===(null===(o=e.code)||void 0===o?void 0:o.indexOf("SPDuplicateValuesFoundException"))?"DuplicatePage":"UnknownError"}(e),e})},t.prototype.checkoutTopicPage=function(e,t){var n=this;return void 0===t&&(t=this.serviceScope.consume(a.PageContext.serviceKey).web.languageName),this.getRestTopicsEndPointUrl().then(function(a){return n.fetchJson("".concat(a,"/GetByEntityIdAndCulture(id='").concat(e.join(";"),"',culture='").concat(t,"')/checkoutpage"),new g("POST"),"CheckoutTopicPageByTopicId")})},t.prototype.checkoutPage=function(e){var t=this;return this.getRestSitePagesEndPointUrl().then(function(n){return t.fetchJson("".concat(n,"/GetByUrl('").concat(new URL(e).pathname,"')/checkoutpage"),new g("POST"),"CheckoutPageByUrl")})},t.prototype.publishTopicPage=function(e){var t=this;return this.getRestSitePagesEndPointUrl().then(function(n){var a="".concat(n,"(").concat(e,")/publish");return t.fetchJson(a,new g("POST"),"publishTopicPage")})},t.prototype.getTopicPageByEntityId=function(e,t){var n=this;return t?this.getRestTopicsEndPointUrl().then(function(a){return n.fetchJson("".concat(a,"/GetByEntityIdAndCulture(id='").concat(e.join(";"),"',culture='").concat(t,"')"),new g("GET"),"getTopicPageByEntityId")}):this.getDefaultTopicPageByEntityId(e)},t.prototype.getDefaultTopicPageByEntityId=function(e){var t=this;return this.getRestTopicsEndPointUrl().then(function(n){var i=t.serviceScope.consume(a.PageContext.serviceKey).web.languageName;return t.fetchJson("".concat(n,"/GetByEntityIdAndCulture(id='").concat(e.join(";"),"',culture='").concat(i,"')"),new g("GET"),"getDefaultTopicPageByEntityId")})},t.prototype.getSourcePageByEntityId=function(e,t){var n=this;if(0===e.length)throw new Error("Empty entityIds provided");return this.getRestTopicsEndPointUrl().then(function(a){var i="";(null==t?void 0:t.length)&&t.length>0&&(i="?$select=".concat(t.join(",")));var r="".concat(a,"/GetByEntityId('").concat(e.join(";"),"')").concat(i);return n.fetchJson(r,new g("GET"),"getSourcePageByEntityId")})},t.prototype.getTopicPagesByEntityId=function(e,t){var n=this;return 0===e.length?Promise.reject("Empty entityIds provided"):this.getRestTopicsEndPointUrl().then(function(a){var i="";(null==t?void 0:t.length)&&t.length>0&&(i="?$select=".concat(t.join(",")));var r="".concat(a,"/GetPagesByEntityId('").concat(e.join(";"),"')").concat(i);return n.fetchJson(r,new g("GET"),"getTopicPagesByEntityId").then(function(e){return e.value||[]})})},Object.defineProperty(t.prototype,"qosPrefixName",{get:function(){return"CSIKM.TopicPageDataProvider"},enumerable:!1,configurable:!0}),t}(b),S=f(737),D="https://clients.config.office.net",I=function(){function e(e){this._serviceScope=e,this._tokenProvider=S._AadTokenProviders.configurable}return e.prototype.getPolicies=function(){var e=this,t=new o._QosMonitor("".concat("CSIKM",".OCSPPolicy.").concat("DP",".getPolicies"));return this._tokenProvider._getTokenInternal(D,S._AadTokenProviders.preAuthorizedConfiguration).then(function(t){return e._serviceScope.consume(s.HttpClient.serviceKey).get(e._policiesEndPoint,s.AadHttpClient.configurations.v1,e._getRequestOptions(t)).then(function(e){return 204===e.status?{}:e.json()})}).catch(function(e){return t.writeUnexpectedFailure("FailedToOCPSPolicies",e),Promise.reject(e)})},e.prototype._getRequestOptions=function(e){var t={headers:{}};return t.headers["Content-Type"]="application/json",t.headers.Authorization="Bearer ".concat(e),t.headers["x-Cid"]="00000003-0000-0ff1-ce00-000000000000",t},Object.defineProperty(e.prototype,"_policiesEndPoint",{get:function(){return"".concat(D).concat("/user/v1.0/web/policies")},enumerable:!1,configurable:!0}),e}(),x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.getDefaultPageUrlBySourceId=function(e){var t=this,n=new o._QosMonitor("".concat(this.qosPrefixName,".getDefaultPageUrlBySourceId")),a=!1;return this.getRestSitePagesEndPointUrl().then(function(i){var r="".concat(i,"/GetByUniqueId('").concat(e,"')?$select=AbsoluteUrl");return t.fetchJson(r,new g("GET"),"getDefaultPageUrlBySourceId").then(function(e){return a=!0,e.AbsoluteUrl?(n.writeSuccess(),e.AbsoluteUrl):Promise.reject(new Error("Response have no AbsoluteUrl returned for the default language page."))})}).catch(function(e){n.writeUnexpectedFailure(a?"SuccessResponseButWrongData":"FailedToGetDefaultUrl",e)})},t.prototype.getSourcePageByUniqueId=function(e,t){var n=this,a=new o._QosMonitor("".concat(this.qosPrefixName,".getDefaultPageBySourceId"));return this.getRestSitePagesEndPointUrl().then(function(i){var r="".concat(i,"/GetByUniqueId('").concat(e,"')").concat(function(e){var t="";return(null==e?void 0:e.length)&&e.length>0&&(t="?$select=".concat(e.join(","))),t}(t));return n.fetchJson(r,new g("GET"),"getDefaultPageBySourceId").then(function(e){return a.writeSuccess(),e})}).catch(function(e){a.writeUnexpectedFailure("FailedToGetSourcePage",e)})},Object.defineProperty(t.prototype,"qosPrefixName",{get:function(){return"CSIKM.TopicMultilingualDataProvider"},enumerable:!1,configurable:!0}),t}(b)})(),p})());