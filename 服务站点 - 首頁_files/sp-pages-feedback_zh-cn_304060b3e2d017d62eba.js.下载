define("24b18d90-5b12-4227-8414-5ef7c776350b_0.1.0",["tslib","@ms/odsp-core-bundle","@microsoft/sp-core-library","@microsoft/sp-page-context","@ms/sp-telemetry","@microsoft/sp-diagnostics","@microsoft/sp-http","@microsoft/sp-http-base","@ms/office-ui-fabric-react-bundle"],(e,t,n,a,i,r,o,s,c)=>(()=>{var d={748:(e,t,n)=>{var a=n(698);e.exports=a.OdspErrorHelper}
,35:(e,t,n)=>{"use strict";var a=n(698);n.o(a,"Qos")&&n.d(t,{Qos:function(){return a.Qos}}),n.o(a,"ResultTypeEnum")&&n.d(t,{ResultTypeEnum:function(){return a.ResultTypeEnum}})}
,629:(e,t,n)=>{}
,557:(e,t,n)=>{"use strict";var a=n(698);n.o(a,"Qos")&&n.d(t,{Qos:function(){return a.Qos}}),n.o(a,"ResultTypeEnum")&&n.d(t,{ResultTypeEnum:function(){return a.ResultTypeEnum}})}
,770:(e,t,n)=>{"use strict";var a;!function(e){e.outOfBox="outOfBox",e.custom="custom",e.Unknown="Unknown"}(a||(a={}))}
,856:(e,t,n)=>{var a=n(698);e.exports=a.PairedEventBase}
,771:(e,t,n)=>{var a=n(698);e.exports=a.SingleEventBase}
,285:(e,t,n)=>{"use strict";var a=n(698);n.o(a,"Qos")&&n.d(t,{Qos:function(){return a.Qos}}),n.o(a,"ResultTypeEnum")&&n.d(t,{ResultTypeEnum:function(){return a.ResultTypeEnum}})}
,809:(e,t,n)=>{"use strict";var a=n(698);n.o(a,"Qos")&&n.d(t,{Qos:function(){return a.Qos}}),n.o(a,"ResultTypeEnum")&&n.d(t,{ResultTypeEnum:function(){return a.ResultTypeEnum}})}
,240:(e,t,n)=>{"use strict";var a=n(698);n.o(a,"Qos")&&n.d(t,{Qos:function(){return a.Qos}}),n.o(a,"ResultTypeEnum")&&n.d(t,{ResultTypeEnum:function(){return a.ResultTypeEnum}})}
,26:(e,t,n)=>{"use strict";var a=n(748);n.o(a,"Qos")&&n.d(t,{Qos:function(){return a.Qos}}),n.o(a,"ResultTypeEnum")&&n.d(t,{ResultTypeEnum:function(){return a.ResultTypeEnum}});var i=n(35);n.o(i,"Qos")&&n.d(t,{Qos:function(){return i.Qos}}),n.o(i,"ResultTypeEnum")&&n.d(t,{ResultTypeEnum:function(){return i.ResultTypeEnum}});var r=n(285);n.o(r,"Qos")&&n.d(t,{Qos:function(){return r.Qos}}),n.o(r,"ResultTypeEnum")&&n.d(t,{ResultTypeEnum:function(){return r.ResultTypeEnum}});var o=n(809);n.o(o,"Qos")&&n.d(t,{Qos:function(){return o.Qos}}),n.o(o,"ResultTypeEnum")&&n.d(t,{ResultTypeEnum:function(){return o.ResultTypeEnum}});var s=n(240);n.o(s,"Qos")&&n.d(t,{Qos:function(){return s.Qos}}),n.o(s,"ResultTypeEnum")&&n.d(t,{ResultTypeEnum:function(){return s.ResultTypeEnum}}),n(629);var c=n(557);n.o(c,"Qos")&&n.d(t,{Qos:function(){return c.Qos}}),n.o(c,"ResultTypeEnum")&&n.d(t,{ResultTypeEnum:function(){return c.ResultTypeEnum}}),n(770);var d=n(856);n.o(d,"Qos")&&n.d(t,{Qos:function(){return d.Qos}}),n.o(d,"ResultTypeEnum")&&n.d(t,{ResultTypeEnum:function(){return d.ResultTypeEnum}});var l=n(771);n.o(l,"Qos")&&n.d(t,{Qos:function(){return l.Qos}}),n.o(l,"ResultTypeEnum")&&n.d(t,{ResultTypeEnum:function(){return l.ResultTypeEnum}}),n(124),n(76),n(60)}
,60:(e,t,n)=>{"use strict";n(280),n(809),n(124)}
,124:(e,t,n)=>{"use strict";n(280),n(809)}
,76:(e,t,n)=>{"use strict";n(280)}
,676:e=>{"use strict";e.exports=n},207:e=>{"use strict";e.exports=r},909:e=>{"use strict";e.exports=o},737:e=>{"use strict";e.exports=s},408:e=>{"use strict";e.exports=a},698:e=>{"use strict";e.exports=t},141:e=>{"use strict";e.exports=c},27:e=>{"use strict";e.exports=i},280:t=>{"use strict";t.exports=e},40:e=>{"use strict";e.exports=JSON.parse('{"name":"@ms/centro-hvc-loader","version":"3.2.2","description":"Project Centro high value component loader","license":"UNLICENSED","devDependencies":{"@types/webpack-env":"1.15.1","typescript":"4.2.3-gauri-patch-3"},"homepage":"https://office.visualstudio.com/OC/_git/M365AdminUX?path=%2Fmodules%2Fhvc-loader","bugs":{"url":"https://office.visualstudio.com/OC/_workitems/edit/2364251","email":"centroinfo@microsoft.com"},"author":"MAC Platform Team <macplat@microsoft.com>","main":"./dist/hvc-loader/index.js","module":"./dist/hvc-loader/index.js","typings":"./dist/hvc-loader/index.d.ts","scripts":{"build":"tsc -p ./tsconfig.json"},"dependencies":{"tslib":"^2.1.0"}}')}
},l={};function u(e){var t=l[e];if(void 0!==t)return t.exports;var n=l[e]={exports:{}};return d[e](n,n.exports,u),n.exports}u.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return u.d(t,{a:t}),t},u.d=(e,t)=>{for(var n in t)u.o(t,n)&&!u.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var f={};return(()=>{"use strict";u.r(f),u.d(f,{PagesCopilotFeedback:()=>Ee,launchUserInitiatedFeedback:()=>Oe});var e,t,n,a=u(280);function i(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}function r(e,t){return(0,a.__awaiter)(this,void 0,void 0,function(){return(0,a.__generator)(this,function(n){return[2,new Promise(function(n,a){var r=document.createElement("script");(null==t?void 0:t.createScriptURL)?r.src=t.createScriptURL(e.content):r.src=e.content,r.onload=function(){n()},r.onerror=function(){a(new Error("Dynamically loading script "+e.content+" failed"))},i(r,e.attributes),document.body.appendChild(r)})]})})}function o(e){return(0,a.__awaiter)(this,void 0,void 0,function(){return(0,a.__generator)(this,function(t){return[2,new Promise(function(t){var n=document.createElement("script"),a=document.createTextNode(e.content);n.appendChild(a),i(n,e.attributes),document.body.appendChild(n),t()})]})})}function s(e){return(0,a.__awaiter)(this,void 0,void 0,function(){return(0,a.__generator)(this,function(t){return[2,new Promise(function(t,n){var a=document.createElement("link");a.rel="stylesheet",a.type="text/css",a.href=e.content,a.onload=function(){t()},a.onerror=function(){n(new Error("Dynamically loading style "+e.content+" failed"))},i(a,e.attributes),document.head.appendChild(a)})]})})}function c(e){return(0,a.__awaiter)(this,void 0,void 0,function(){return(0,a.__generator)(this,function(t){return[2,new Promise(function(t){var n=document.createElement("link");n.rel="stylesheet",n.type="text/css";var a=document.createTextNode(e.content);n.appendChild(a),i(n,e.attributes),document.head.appendChild(n),t()})]})})}function d(e,t){return(0,a.__awaiter)(this,void 0,void 0,function(){var n,i,l,u,f,p,m;return(0,a.__generator)(this,function(_){switch(_.label){case 0:switch(e.type){case"parallel":return[3,1];case"sequential":return[3,5];case"scriptUrl":return[3,16];case"script":return[3,18];case"styleUrl":return[3,20];case"style":return[3,22]}return[3,24];case 1:return _.trys.push([1,3,,4]),[4,Promise.all(e.children.map(function(e){return d(e,t)}))];case 2:return _.sent(),[3,4];case 3:if(n=_.sent(),!e.optional)throw n;return console.log("Dynamic loading of optional script failed",n),[3,4];case 4:return[2];case 5:_.trys.push([5,14,,15]),_.label=6;case 6:_.trys.push([6,11,12,13]),i=(0,a.__values)(e.children),l=i.next(),_.label=7;case 7:return l.done?[3,10]:[4,d(l.value,t)];case 8:_.sent(),_.label=9;case 9:return l=i.next(),[3,7];case 10:return[3,13];case 11:return u=_.sent(),p={error:u},[3,13];case 12:try{l&&!l.done&&(m=i.return)&&m.call(i)}finally{if(p)throw p.error}return[7];case 13:return[3,15];case 14:if(f=_.sent(),!e.optional)throw f;return console.log("Dynamic loading of optional script failed",f),[3,15];case 15:return[2];case 16:return[4,r(e,t)];case 17:return _.sent(),[2];case 18:return[4,o(e)];case 19:return _.sent(),[2];case 20:return[4,s(e)];case 21:return _.sent(),[2];case 22:return[4,c(e)];case 23:return _.sent(),[2];case 24:throw new Error("Invalid script loader object "+JSON.stringify(e))}})})}!function(e){e.Info="Info",e.Error="Error",e.Analytics="Analytics",e.Performance="Performance",e.Interface="Interface",e.Availability="Availability",e.Reliability="Reliability"}(e||(e={})),function(e){e.ClientInfo="ClientInfo",e.ClientError="ClientError",e.ClientAnalytics="ClientAnalytics",e.ClientPerformance="ClientPerformance",e.ClientAvailability="ClientAvailability",e.ClientReliability="ClientReliability"}(t||(t={})),function(e){e.Microsoft365AdminCenter="@ms/mac"}(n||(n={}));var l=new Map;function p(e,t){if(l.has(e))throw new Error("Logger "+e+" already exists");l.set(e,t)}function m(n,a){a.forEach(function(i,r){try{i.logger(n)}catch(n){var o=new Map(a);o.delete(r),m({id:"500294",type:e.Error,logCategory:t.ClientError,message:"Failure in logger: "+r,error:n},o)}})}var _,h,b,g,v=function(e){m(e,l)};(b=_||(_={})).M365AdminPortal="M365AdminPortal",b.SPOAdminPortal="SPOAdminPortal",b.SPOPortal="SPOPortal",b.EXOAdminPortal="EXOAdminPortal",b.TeamsAdminPortal="TeamsAdminPortal",b.SecurityPortal="SecurityPortal",b.CompliancePortal="CompliancePortal",b.M365SCCPortal="M365SCCPortal",b.SupportCentral="SupportCentral",b.IbizaMTMPortal="IbizaMTMPortal",b.CloudCostManagementPortal="CloudCostManagementPortal",b.Rave="Rave",b.DynamicsPortal="DynamicsPortal",b.TeamsApp="TeamsApp",b.M365DefenderSMB="M365DefenderSMB",b.Windows365Portal="Windows365Portal",b.PPACAdminPortal="PPACAdminPortal",b.VivaGoals="VivaGoals",b.VivaPulse="VivaPulse",b.FireSurveysHost="FireSurveysHost",b.AEM="AEM",b.ExcelPythonAddon="ExcelPythonAddon",b.AdminAppMetaOSTeams="AdminAppMetaOSTeams",b.AdminAppMetaOSOffice="AdminAppMetaOSOffice",b.Project="Project",b.Planner="Planner",b.Visio="Visio",b.Clipchamp="Clipchamp",function(e){e.Static="centro.runtime.static",e.Error="centro.hvc.error"}(h||(h={})),function(e){e[e.Trace=0]="Trace",e[e.Info=1]="Info",e[e.Comment=2]="Comment",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical"}(g||(g={}));var y=!0,S=function(e){var t,n,a=window;if(null===(t=null==a?void 0:a.trustedTypes)||void 0===t?void 0:t.createPolicy)try{n=a.trustedTypes.createPolicy("@centro/hvc-loader",{createScriptURL:function(e){var t;try{t=new URL(e)}catch(t){throw new Error("Invalid script url "+e)}if("https:"!==(null==t?void 0:t.protocol))throw new Error("Only https protocol is allowed for script url "+e);return e},createScript:void 0,createHTML:void 0})}catch(e){console.error("Failed to create trusted type policy",e)}return n}();function D(t,n){if(!t){var a=new Error(n);throw v({type:e.Error,message:n,id:"508371",error:a}),a}}function I(t){return void 0===window?(v({type:e.Info,message:"window is undefined",id:"512105"}),!1):void 0===window.m365_admin_features?(v({type:e.Info,message:"window.m365_admin_features is undefined",id:"512108"}),!1):void 0!==window.m365_admin_features.initializers&&void 0!==window.m365_admin_features.initializers[t]}function x(e){var t,n;return!!(null===(n=null===(t=window.m365_admin_features)||void 0===t?void 0:t.locDbg)||void 0===n?void 0:n[e])}var C,O,w,E,A=void 0,L=void 0,k=!1,M=!1,P=void 0,T=!1,U=new Map,F=void 0,H=void 0;function R(t){return void 0===t&&(t=""),(0,a.__awaiter)(this,void 0,void 0,function(){var n,i;return(0,a.__generator)(this,function(a){switch(a.label){case 0:if(void 0===H)throw n=new Error("attempting to getUxVersionData before preConfig were provided"),v({type:e.Error,message:n.message,error:n,id:"508373"}),n;return i=A+"/admin/api/uxversion"+t,T&&(i=""===t?i+"?locale="+H.locale+"&hostingapp="+H.hostName:i+"&locale="+H.locale+"&hostingapp="+H.hostName),[4,new Promise(function(e,t){var n=new XMLHttpRequest;n.open("GET",i,!0),T||(n.setRequestHeader("x-ms-mac-locale",H.locale),n.setRequestHeader("x-ms-mac-hostingapp",H.hostName)),n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE){var a=n.getResponseHeader("x-ms-correlation-id");if(200!==n.status){var r="Request to "+i+" failed, server responseCode: "+n.status+" body: "+n.response+" correlationId: "+a,o=new Error(r);return void t(o)}e(function(e){if(void 0!==e&&e.hasOwnProperty("__hostApp_config"))for(var t in e)t.startsWith("__")||(e[t.toLowerCase()]=e[t],t.toLowerCase()!==t&&delete e[t]);return JSON.stringify(e)}(JSON.parse(n.response)))}},n.send()})];case 1:return[2,a.sent()]}})})}function N(){return(0,a.__awaiter)(this,void 0,void 0,function(){var e,t;return(0,a.__generator)(this,function(n){switch(n.label){case 0:return P?[2]:(t=(e=JSON).parse,[4,R("?locdbg=true")]);case 1:return P=t.apply(e,[n.sent()]),[2]}})})}let B;!function(e){e.GET="GET",e.PUT="PUT",e.POST="POST",e.DELETE="DELETE",e.PATCH="PATCH"}(C||(C={})),function(e){e.M365AdminCenter="MAC",e.Mover="Mover",e.ExchangeAdminCenter="EAC",e.SharepointAdminCenter="SPO",e.TeamsAdminCenter="TAC",e.ComplianceAdminCenter="CAC",e.SecurityAdminCenter="SAC",e.ProductivityAdminCenter="PAC",e.GraphApi="Graph",e.VRoomApi="VRoom",e.DeviceCareApi="DeviceCare",e.RecommendationApi="Reco",e.M365AoboApi="M365Aobo",e.Assist="Assist",e.BusinessApplicationPlatform="PPACBap",e.PowerPlatformAPITenantLevel="ppapi-tenant-level",e.GovernancePPACAPI="GovPPACAPI",e.LicensingAPI="LicAPI",e.PPApiTenantLevel="PPApiTenantLevel",e.Fusion="Fusion",e.VivaPulse="VivaPulse",e.CloudPolicyServiceApi="OCPS",e.ECS="ECS",e.O365ShellServices="O365Shell",e.ProfileService="ProfileService",e.VsbHub="VsbHub",e.Augloop="Augloop"}(O||(O={})),function(e){e.Centro="Centro",e.Hvc="Hvc",e.Consumer="Consumer"}(w||(w={})),function(e){e.Request="Request",e.History="History",e.DataSources="DataSources",e.SetTitleImpl="SetTitleImpl"}(E||(E={}));const j=(()=>{const e={},t=[];return{register:n=>(n&&t.push(n),e),unregister:e=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},updateFeedbackObject:n=>{const a=Object.assign(Object.assign({},e),n);Object.assign(e,a),t.forEach(e=>e(a))},clear:()=>{Object.keys(e).forEach(t=>{delete e[t]}),t.forEach(e=>e({}))}}})();function V(n){return(0,a.__awaiter)(this,void 0,void 0,function*(){yield function(n){return(0,a.__awaiter)(this,void 0,void 0,function*(){const{hostName:i,language:r,appId:o,inAppFeedbackRef:s}=n,c="ocv-inapp-feedback",l={centroEnvironmentBaseUrl:"https://admin.microsoft.com",preConfig:{appId:o,hostName:i,locale:r,perfPrefix:`OcvFeedback${i}`},centroHvcData:"",forHostVersion:"v2",hvcVersion:""};yield function(n){return(0,a.__awaiter)(this,void 0,void 0,function(){var i,r,o,s,c,d,l,f,m,_,h,b;return(0,a.__generator)(this,function(S){switch(S.label){case 0:i=n.centroEnvironmentBaseUrl,r=n.preConfig,o=n.centroHvcData,s=n.enableUxVersionQueryParam,D(!!i,"centroEnvironmentBaseUrl is missing"),D(!!r,"preConfig is missing"),(H=r).appId||(H.appId="10000000-1000-4000-8000-100000000000".replace(/[018]/g,function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})),c=H.appId,d=H.hostName,S.label=1;case 1:return S.trys.push([1,5,,6]),k?(v({type:e.Info,message:"initialize() is called but loader is already previously initialized",id:"508375"}),[2]):(A="/"===i.substring(i.length-1)?i.substring(0,i.length-1):i,l=u(40),F=l.version,f=A+"/api/instrument/logclient",M||(p("hvcLoaderKustoLogger",function(n,i,r,o){var s=[],c=Promise.resolve(),d=0,l=n,u=i,f=r,p=o,m=function(){setTimeout(function(){_().catch(function(){})},1e3)},_=function(){return 0===s.length||y?(m(),Promise.resolve()):(c=new Promise(function(e,t){var n=new XMLHttpRequest;n.open("POST",u,!0),n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("x-ms-mac-hostingapp",f),n.setRequestHeader("x-ms-mac-appid",l),n.setRequestHeader("x-ms-mac-version",p),n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE){if(204!==n.status){var a=new Error("Request to /api/instrument/logclient failed, server responseCode: "+n.status+" body: "+n.response);return console.log(a),void t(a)}e()}};var a=s.splice(0,s.length);n.send(JSON.stringify(a))})).then(m)};m();var h=function(e){s.push(e)};return{logger:function(n){if(n.type!==e.Analytics&&n.type!==e.Performance){d+=1;var a=parseInt(n.id,10),i=n.message||"",r="",o="";try{if(null!==(r=function(){throw new Error("History object has not been set")}().location.pathname)&&-1!==r.indexOf(":")){var s=r.split(":");r=s[0],o=s[1]}}catch(e){r="",o=""}if(h({TagId:a,LogLevel:g.Info,LogCategory:n.logCategory||t.ClientInfo,Message:i,Adhoc0:l,Adhoc1:d.toString(),Adhoc2:JSON.stringify({data:n.data}),Adhoc5:o,PageName:r}),n.type===e.Error){var c=n.error.stack||"";h({TagId:500781,LogLevel:g.Error,LogCategory:n.logCategory||t.ClientError,Message:"UI Exception: "+(n.error.message||""),Adhoc0:l,Adhoc1:d.toString(),Adhoc2:JSON.stringify({version:p,stack:c}),Adhoc3:a.toString(),Adhoc5:o,PageName:r})}}},flush:function(){return(0,a.__awaiter)(this,void 0,void 0,function(){return(0,a.__generator)(this,function(e){return[2,Promise.all([c,_()]).then(function(){})]})})}}}(c,f,d,l.name+"_"+l.version)),y=!1,void 0!==H.additionalLoggers&&Object.keys(H.additionalLoggers).forEach(function(e){p(e,{logger:H.additionalLoggers[e]})}),M=!0),m=performance.now(),o?(v({type:e.Info,message:"uxVersion Data is provided thru parameter",id:"508372",data:o}),L=JSON.parse(o),[3,4]):[3,2]);case 2:if(n.forHostVersion&&n.hvcVersion)throw new Error("cannot specify both forHostVersion and hvcVersion");return T=!!s,_="",n.forHostVersion?_="?bldVer="+encodeURIComponent(n.forHostVersion):n.hvcVersion&&(_="?pkgver="+encodeURIComponent(n.hvcVersion)),[4,R(_)];case 3:h=S.sent(),v({type:e.Info,message:"uxVersion Data is provided thru parameter",id:"508372",data:h}),L=JSON.parse(h),S.label=4;case 4:return k=!0,v({type:e.Info,message:"hvcloader initialze() step has succeeded",id:"513574",data:{eventName:"hvcLoader_Initialize_step",fromStart:performance.now()-m,UA:navigator.userAgent,enableQueryParam:T}}),[3,6];case 5:throw b=S.sent(),v({type:e.Error,message:"hvcloader initialze() step has failed "+b.message,id:"508376",error:b}),b;case 6:return[2]}})})}(l);const f={dataSources:e=>{e("centro.hvc.feedback.initOptions",j)}};yield function(t){return(0,a.__awaiter)(this,void 0,void 0,function(){var n,i,r,o,s,c;return(0,a.__generator)(this,function(a){switch(a.label){case 0:n=L,a.label=1;case 1:if(a.trys.push([1,7,,8]),!k)throw new Error("initialize() needs to be invoked before calling preloadFeature()");return i=performance.now(),!t.localMode||{NODE_ENV:"production"}.CENTRO_HVC_DATA?[3,3]:[4,N()];case 2:a.sent(),n=P,a.label=3;case 3:if(!n)throw new Error("uxVersionData is not populated");return r=t.featureName.toLowerCase(),n[r]?I(r)&&x(r)===!!t.localMode?(v({type:e.Info,message:"preloadFeature() feature "+r+" already loaded previously",id:"508465",data:{hvc:r}}),[3,6]):[3,4]:(v({type:e.Info,message:"HVC "+r+" is not enabled for this host",id:"508419"}),[2,[!1,void 0]]);case 4:return[4,d(n[r].loaderSpec,S)];case 5:if(a.sent(),!I(r))throw new Error("preloadFeature(): global is not populated after loading for "+r);void 0===window.m365_admin_features.locDbg&&(window.m365_admin_features.locDbg={}),window.m365_admin_features.locDbg[r]=!!t.localMode,a.label=6;case 6:t.adapters&&U.set(r,t.adapters),o=void 0;try{o=window.m365_admin_features.staticAdditionalObjects[r]}catch(t){throw s=window.m365_admin_features.foreignEnvMainVersion,v({type:e.Error,message:s?"using v3 Hvc "+r+", error when trying to retrieve staticAdditionalObjects, error: "+t.message:"using v2 Hvc "+r+", staticAdditionalObjects is not supported, error: "+t.message,id:"521848",error:t}),t}return v({type:e.Info,message:"preloadFeatures() step has succeeded",id:"513585",data:{hvc:r,uxdata:JSON.stringify(n),eventName:"preloadFeature_step",fromStart:performance.now()-i,UA:navigator.userAgent}}),[2,[!0,o]];case 7:throw c=a.sent(),v({type:e.Error,message:"error in preloadFeatures() step "+c.message,id:"508417",data:{uxdata:JSON.stringify(n)},error:c}),c;case 8:return[2]}})})}({featureName:c,adapters:f});const m=yield function(t){return(0,a.__awaiter)(this,void 0,void 0,function(){var n,i,r,o,s,c,d,l;return(0,a.__generator)(this,function(a){switch(a.label){case 0:if(a.trys.push([0,7,,8]),!k)throw new Error("initialize() needs to be invoked before calling bootstrapFeature()");if(n=performance.now(),i=L,x(r=t.featureName.toLowerCase())&&!{NODE_ENV:"production"}.CENTRO_HVC_DATA&&(i=P),!i)throw new Error("uxVersionData is not populated");if(!I(r))return[3,5];o={centroBaseUrl:A,cdnUrl:i[r].cdnUrl,ariaLoggerId:i.__hostApp_config.ariaLoggerId,targetAppUrls:i.__hostApp_config.hostingAppUrls,versionInfo:F},s=void 0,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,window.m365_admin_features.initializers[r](U.get(r),o,H)];case 2:return s=a.sent(),v({type:e.Info,message:"bootstrapFeature() step has succeeded",id:"513586",data:{hvc:r,eventName:"bootstrapFeature_step",fromStart:performance.now()-n,UA:navigator.userAgent}}),[3,4];case 3:throw c=a.sent(),d=window.m365_admin_features.foreignEnvMainVersion,v({type:e.Error,message:d?"using v3 Hvc "+r+", error when running foreignFeatureInitializeRuntime, error: "+c.message:"using v2 Hvc "+r+" is not supported, error: "+c.message,id:"521851",error:c}),c;case 4:return[2,s];case 5:throw new Error("bootstrapFeature(): preloadFeature() was not called before bootstraping "+r);case 6:return[3,8];case 7:throw l=a.sent(),v({type:e.Error,message:"error in bootstrapFeature() step "+l.message,id:"508481",error:l}),l;case 8:return[2]}})})}({featureName:c});return B=yield m.main(function(e){let t=null;return e&&(t=document.getElementById(e)),t||(t=document.createElement("div"),t.id=null!=e?e:"inapp-feedback-ref",document.body.appendChild(t)),t}(s)),B})}(n)})}const z=j.updateFeedbackObject;var G,K,W,q,Q,Y,J,X,Z,$,ee,te,ne;j.clear,function(e){e.Smile="Smile",e.Frown="Frown",e.Idea="Idea",e.Unclassified="Unclassified"}(G||(G={})),function(e){e.Undefined="Undefined",e.MinorWithoutParentalConsent="MinorWithoutParentalConsent",e.MinorWithParentalConsent="MinorWithParentalConsent",e.NotAdult="NotAdult",e.Adult="Adult",e.MinorNoParentalConsentRequired="MinorNoParentalConsentRequired"}(K||(K={})),function(e){e.DropDown="DropDown",e.MultiSelect="MultiSelect",e.Rating="Rating",e.SingleSelect="SingleSelect"}(W||(W={})),function(e){e.FeatureArea="FeatureArea",e.ResponsibleAI="ResponsibleAI",e.ChildFeedback="ChildFeedback",e.Experience="Experience",e.ProductSatisfaction="ProductSatisfaction",e.CrashImpact="CrashImpact",e.Custom="Custom",e.AIThumbsDown="AIThumbsDown",e.AIThumbsUp="AIThumbsUp"}(q||(q={})),function(e){e.QuestionNotRequired="QuestionNotRequired",e.CommentNotRequired="CommentNotRequired",e.CommentRequiredWithLastOption="CommentRequiredWithLastOption"}(Q||(Q={})),function(e){e.MSA="MSA",e.AAD="AAD",e.Unauthenticated="Unauthenticated"}(Y||(Y={})),(te=J||(J={})).Enabled="Enabled",te.Disabled="Disabled",te.NotConfigured="Not Configured",function(e){e.JPEG="jpeg",e.PNG="png"}(X||(X={})),function(e){e.AutoCapture="AutoCapture",e.AutoCaptureWithHtml2Canvas="AutoCaptureWithHtml2Canvas",e.ProvidedAtInitialization="ProvidedAtInitialization",e.DynamicallyProvided="DynamicallyProvided"}(Z||(Z={})),function(e){e.SidePane="SidePane",e.Modal="Modal",e.NoSurface="NoSurface",e.CallOut="CallOut",e.NoSurfaceWithoutTitle="NoSurfaceWithoutTitle"}($||($={})),function(e){e.Windows="Windows",e.IOS="iOS",e.Android="Android",e.WacTaskPane="WacTaskPane",e.MacOS="MacOS",e.Web="Web"}(ee||(ee={})),function(e){e.Worldwide="Worldwide",e.China="China",e.EUDB="EUDB",e.GccMod="GccMod",e.UsGov="UsGov",e.UsGovDod="UsGovDod",e.UsNat="UsNat",e.UsSec="UsSec"}(ne||(ne={}));const ae=JSON.parse('{"Y":"SharePoint 工程"}');function ie({ageGroup:e,appId:t,authenticationType:n,clientName:a,complianceChecks:i,appData:r,email:o,userId:s,tenantId:c,callbackFunctions:d,featureArea:l,isProduction:u,officeUILang:f,environment:p,telemetry:m}){return{ageGroup:null!=e?e:K.Adult,authenticationType:null!=n?n:Y.AAD,feedbackConfig:{appData:r,email:o,complianceChecks:i,feedbackUiType:$.Modal,hostPlatform:ee.Web,isDisplayed:!1,isEmailCollectionEnabled:!0,isFeedbackForumEnabled:!0,isFileUploadEnabled:!0,isMyFeedbackEnabled:!0,isScreenshotEnabled:!0,isScreenRecordingEnabled:!0,isShareContextDataEnabled:!0,isThankYouPageDisabled:!1,msInternalTitleTarget:re(p),screenshotInfo:{providedScreenshotType:Z.AutoCapture}},telemetry:Object.assign(Object.assign({},m),{audienceGroup:p,deviceType:navigator.userAgent,officeUILang:f,platform:navigator.platform,featureArea:l}),isProduction:u,themeOptions:{baseTheme:"WindowsLight"},appId:t,clientName:a,userId:s,tenantId:c,callbackFunctions:d}}function re(e){return"Dogfood"===e?ae.Y:void 0}var oe=u(698);!function(){function e(e,t){var n=this._pageContext=t.pageContext,i=t.tokenProvider,r=t.noRedirect,o=t.normalizeErrors,s=t.dataRequestorType,c=void 0===s?function(e){function t(t){return e.call(this,t,{pageContext:n,tokenProvider:i,noRedirect:r})||this}return(0,a.__extends)(t,e),t}(oe.DataRequestor):s,d=e.dataSourceName,l=void 0===d?"DataSource":d;this.dataRequestor=new c({qosName:l,normalizeErrors:o})}e.prototype.getDataSourceName=function(){return this.dataSourceName},e.prototype.needsRequestDigest=function(e){return!0},e.prototype.getData=function(e,t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h){void 0===i&&(i="POST");var b=e(),g=a&&a(),v=this.needsRequestDigest(b);return this.dataRequestor.getData({url:b,parseResponse:t,qosName:n,additionalPostData:g,method:i,additionalHeaders:r,contentType:o,maxRetries:s,noRedirect:c,crossSiteCollectionCall:d,telemetryHandler:l,qosExtraData:u,needsRequestDigest:v,authToken:f,webAbsoluteUrl:p,useExactAuthToken:m,skipSyncClient:_,customerPromise:h})}}(),u(26);var se=u(676),ce=u(408),de=u(27),le=u(141),ue=u(207),fe=u(909),pe=u(737),me="https://clients.config.office.net",_e=function(){function e(e){this._serviceScope=e,this._tokenProvider=pe._AadTokenProviders.configurable}return e.prototype.getPolicies=function(){var e=this,t=new ue._QosMonitor("".concat("CSIKM",".OCSPPolicy.").concat("DP",".getPolicies"));return this._tokenProvider._getTokenInternal(me,pe._AadTokenProviders.preAuthorizedConfiguration).then(function(t){return e._serviceScope.consume(fe.HttpClient.serviceKey).get(e._policiesEndPoint,fe.AadHttpClient.configurations.v1,e._getRequestOptions(t)).then(function(e){return 204===e.status?{}:e.json()})}).catch(function(e){return t.writeUnexpectedFailure("FailedToOCPSPolicies",e),Promise.reject(e)})},e.prototype._getRequestOptions=function(e){var t={headers:{}};return t.headers["Content-Type"]="application/json",t.headers.Authorization="Bearer ".concat(e),t.headers["x-Cid"]="00000003-0000-0ff1-ce00-000000000000",t},Object.defineProperty(e.prototype,"_policiesEndPoint",{get:function(){return"".concat(me).concat("/user/v1.0/web/policies")},enumerable:!1,configurable:!0}),e}();const he={connectedExperiences:J.Enabled,policyAllowFeedback:J.Enabled,policyAllowSurvey:J.Enabled,policyAllowScreenshot:J.Disabled,policyAllowContact:J.Disabled,policyAllowContent:J.Disabled,policyScreenshotDefault:J.Disabled,policyEmailCollectionDefault:J.Disabled,policyContentSamplesDefault:J.Disabled};function be(e){return"1"===e.value?J.Enabled:J.Disabled}function ge(e){const t=e=>{try{return new Date(e)}catch(e){return new Date}},{context:n,data:a,endTime:i,eventName:r,eventType:o,id:s,shortEventName:c,startTime:d}=e;return ve({context:n,data:a,endTime:t(i),eventName:r,eventType:o,id:s,shortEventName:c,startTime:t(d)})}function ve(e){try{return JSON.stringify(e,void 0,4)}catch(e){return""}}function ye(e){const t=[];return e.events.forEach(e=>{t.push(ve(e))}),t}const Se="SharePoint";function De(e){switch(e.toLowerCase()){case"devbox":case"edog":case"prodbubble":case"spdf":return"Dogfood";default:return"Production"}}function Ie(){let e="Default";return se._BrowserUtilities.isTeamsWebViewHosted()||se._BrowserUtilities.isTeamsBrowserHosted()||se._BrowserUtilities.isEmbeddedInSite()?e="TeamsNonMobile":(se._BrowserUtilities.isTeamsAndroidHosted()||se._BrowserUtilities.isTeamsIOSHosted())&&(e="TeamsMobile"),e}function xe(){const e=de._Telemetry.buildNumber,t=/[0-9]{1,4}-?[0-9]{1,2}-?[0-9]{1,2}\.[0-9]{1,9}/;let n;if(t.test(e)){const a=e.match(t);n=a?a[0].replace(/-/g,""):""}else n="0";return n}let Ce;function Oe(e,t){return(0,a.__awaiter)(this,void 0,void 0,function*(){return yield function(e){if(!Ce){const t=e.consume(ce.PageContext.serviceKey),{legacyPageContext:n}=t;Ce=V({appId:String(2144),hostName:Se,language:n.currentUICultureName})}return Ce}(e),new Promise((n,i)=>{(function(e,t,n,i){var r,o;return(0,a.__awaiter)(this,void 0,void 0,function*(){const a=new ue._AutoAlertableQosMonitor("PagesFeedback.getOCVUserFeedbackInitOptions",ue._AutoAlertableMonitorType.StaticReliabilityQos95Sev4),{featureArea:s,enableCustomContextData:c,disableFileUpload:d,disablePerfettoEntry:l}=t,u=e.consume(ce.PageContext.serviceKey),{legacyPageContext:f}=u,p=null===(r=f.aadTenantId)||void 0===r?void 0:r.toString(),m=`a:${null===(o=f.aadUserId)||void 0===o?void 0:o.toString()}`,_=yield function(e){return new _e(e).getPolicies().then(e=>{if(e.value&&e.value.length>0){const{policiesPayload:t}=e.value[0];if(t)return function(e=[]){const t=Object.assign({},he);return e.forEach(e=>{if("common\\feedback"===e.key&&"Web"===e.platform)switch(e.settingId){case"office16;L_SendFeedback":t.policyAllowFeedback=be(e);break;case"office16;L_SendSurvey":t.policyAllowSurvey=be(e);break;case"office16;L_Screenshot":t.policyAllowScreenshot=be(e);break;case"office16;L_EmailCollection":t.policyAllowContact=be(e);break;case"office16;L_LogCollection":t.policyAllowContent=be(e);break;case"office16;L_FeedbackOptionsDefaults;L_FeedbackOptionsDefaultsScreenshot":t.policyScreenshotDefault=be(e);break;case"office16;L_FeedbackOptionsDefaults;L_FeedbackOptionsDefaultsContentSamples":t.policyContentSamplesDefault=be(e);break;case"office16;L_FeedbackOptionsDefaults;L_FeedbackOptionsDefaultsEmail":t.policyEmailCollectionDefault=be(e)}}),t}(t)}return he})}(e),h=u.legacyPageContext&&u.legacyPageContext.cloudType||"",b=De(h),g=!se._SPKillSwitch.isActivated("ec9f2a59-bc3c-47da-ac4d-dd9ad6f1ad1b");let v;if(c){const e="spdf"===h;v={isShareContextDataEnabled:(null==_?void 0:_.policyContentSamplesDefault)===J.Enabled,isDiagnosticsIncluded:!0,diagnosticsUploadId:"",diagnosticsEndPoint:"",getContextData:()=>function(e,t,n){const a=new Map,i=[],r=new ue._AutoAlertableQosMonitor("PagesFeedback.collectCustomContextData",ue._AutoAlertableMonitorType.StaticReliabilityQos95Sev4,!1);try{if(n){a.set("SPBrowserPerformance.json",[de._PerformanceLogger.capturePerfettoTraceData()]);let e=ye(ue._TraceLogger._logManager);t&&(e=e.concat(ye(ue._TraceLogger._verboseLogManager)));const n=window.ODSP_TELEMETRY_MANAGER||{_buffer:null},i=n._buffer?n._buffer.getAll():[];a.set("SystemTemeletryLogs.json",e.concat(i.map(ge)))}const o=new CustomEvent(function(e){return`${e}_CustomContextData`}(e),{detail:{isSPDF:t,addLogs:(e,n)=>{if(!n)return;if(!t&&"Authoring Diagnostic.txt"===e)return;let i=a.get(e)||[];n&&(i=i.concat(n)),a.set(e,i)}}});document.dispatchEvent(o),a.forEach((e,t)=>{const n=new File([e.join("\n")],t,{type:"text/plain"});i.push(n)}),r.writeSuccess()}catch(e){return ue._TraceLogger.logError(ue._LogSource.create("PagesFeedbackCustomContext"),e),r.writeUnexpectedFailure("CatchAll",e),Promise.reject(e)}return Promise.resolve(i)}(s,e,!l),waitForDiagnosticsUpload:!0}}return{ageGroup:K.Adult,appId:2144,clientName:Se,feedbackConfig:{isDisplayed:!0,appData:JSON.stringify({UiHost:Ie(),build:xe(),entryPoint:g?"Pages CoAuth Feedback Button":void 0}),feedbackUiType:$.SidePane,isThankYouPageDisabled:!1,isEmailCollectionEnabled:_&&_.policyAllowContact===J.Enabled,isScreenshotEnabled:_&&_.policyAllowScreenshot===J.Enabled,isFileUploadEnabled:!d,isScreenRecordingEnabled:_&&_.policyAllowScreenshot===J.Enabled,complianceChecks:_,diagnosticsConfig:v,screenshotInfo:{providedScreenshotType:Z.AutoCapture},hostPlatform:ee.Web,msInternalTitleTarget:re(b),email:u.user.email},telemetry:{audienceGroup:b,deviceType:navigator.userAgent,officeUILang:f.currentLanguage,platform:navigator.platform,featureArea:s,sourcePageURI:g?window.location.href:void 0},callbackFunctions:{onError:e=>{a.writeUnexpectedFailure(e||"UnknownError"),i(e)},initializationComplete:n,onDismiss:e=>{de._EngagementLogger.logEvent("PagesFeedback."+(e?"Submitted":"Dismissed")),a.hasEnded||a.writeSuccess({isFeedbackSent:e})},onSuccess:e=>{a.writeSuccess({isFeedbackSent:!0,clientFeedbackId:e})}},authenticationType:Y.AAD,isProduction:se.Environment.type===se.EnvironmentType.SharePoint,tenantId:p,themeOptions:{baseTheme:(0,le.getTheme)()},userId:m}})})(e,t,n,e=>i(new Error(e))).then(z).catch(e=>i(e))})})}function we(){return se._SPKillSwitch.isActivated("9001cc94-821b-4686-a2f1-fc4a449a1794")}class Ee{static getInstance(e,t){return Ee._instance||(Ee._instance=new Ee(e,t))}constructor(e,t){this.componentId="9cce2710-26ff-4b84-a0b3-9a24a2d453f1",this.instanceId=se.Guid.newGuid().toString(),this.logUserFeedbackOcvCore=(e,t)=>{const{positive:n,message:a}=e;n?this.logThumbUpFeedback(a,t):this.logThumbDownFeedback(a,t)},this._setupCompliancePolicies=()=>(0,a.__awaiter)(this,void 0,void 0,function*(){const e=yield new _e(this._serviceScope).getPolicies();if(e.value&&e.value.length>0){const{policiesPayload:t}=e.value[0];t&&(t.forEach(e=>{"common\\feedback"===e.key&&"Web"===e.platform&&("office16;L_SendFeedback"===e.settingId?this._complianceChecks.policyAllowFeedback="1"===e.value?J.Enabled:J.Disabled:"office16;L_SendCopilotFeedback"===e.settingId?this._complianceChecks.policyAllowCopilotFeedback="1"===e.value?J.Enabled:J.Disabled:"office16;L_SendSurvey"===e.settingId?this._complianceChecks.policyAllowSurvey="1"===e.value?J.Enabled:J.Disabled:"office16;L_Screenshot"===e.settingId?this._complianceChecks.policyAllowScreenshot="1"===e.value?J.Enabled:J.Disabled:"office16;L_EmailCollection"===e.settingId?this._complianceChecks.policyAllowContact="1"===e.value?J.Enabled:J.Disabled:"office16;L_LogCollection"===e.settingId?this._complianceChecks.policyAllowContent="1"===e.value?J.Enabled:J.Disabled:"office16; L_ConnectedOfficeExperiences"===e.settingId&&(this._complianceChecks.connectedExperiences="1"===e.value?J.Enabled:J.Disabled))}),(this._complianceChecks.policyAllowCopilotFeedback===J.Enabled||this._complianceChecks.policyAllowCopilotFeedback===J.NotConfigured&&this._complianceChecks.policyAllowFeedback!==J.Disabled)&&(this._complianceChecks.policyAllowFeedback=J.Enabled))}}),this._serviceScope=e,this._diagnosticAppData=new Map([["sessionId",t]]),this._complianceChecks={policyAllowCopilotFeedback:J.NotConfigured,policyAllowFeedback:J.NotConfigured,policyAllowSurvey:J.NotConfigured,policyAllowScreenshot:J.NotConfigured,policyAllowContact:J.NotConfigured,policyAllowContent:J.NotConfigured},e.whenFinished(()=>{this._pageContext=e.consume(ce.PageContext.serviceKey)}),ue._TraceLogger.logVerbose(Ee._logSource,`RTE copilot feedback initialized AugLoop SessionId: ${t}`)}get _appId(){return 2144}get _clientName(){return"SharePoint"}get _featureArea(){return"Modern Pages Copilot"}get _language(){return this._pageContext.cultureInfo.currentUICultureName||"en-us"}get _appData(){return JSON.stringify(this._diagnosticAppData)}logThumbUpFeedback(e,t){return(0,a.__awaiter)(this,void 0,void 0,function*(){yield this._ensureInitialized();const n=function(e){const t=ie(e);return t.feedbackConfig.initialFeedbackType=G.Smile,t.feedbackConfig.isScreenshotEnabled=!1,t.feedbackConfig.isScreenRecordingEnabled=!1,t.feedbackConfig.isEmailCollectionEnabled=!1,t.feedbackConfig.isFeedbackForumEnabled=!1,t.feedbackConfig.isFileUploadEnabled=!1,t.feedbackConfig.isShareContextDataEnabled=!1,t.feedbackConfig.scenarioConfig={isScenarioEnabled:!0,scenarioType:q.AIThumbsUp},t}(this._feedbackParams);this._setTheme(n),!we()&&t&&(n.callbackFunctions=t),n.feedbackConfig=Object.assign(Object.assign({},n.feedbackConfig),{isDisplayed:!0,diagnosticsConfig:{isShareContextDataEnabled:!1,getContextData:()=>this._getContextData(e)}}),z(n)})}logThumbDownFeedback(e,t){return(0,a.__awaiter)(this,void 0,void 0,function*(){yield this._ensureInitialized();const n=function(e){const t=ie(e);return t.feedbackConfig.initialFeedbackType=G.Frown,t.feedbackConfig.isScreenshotEnabled=!1,t.feedbackConfig.isScreenRecordingEnabled=!1,t.feedbackConfig.isEmailCollectionEnabled=!1,t.feedbackConfig.isFeedbackForumEnabled=!1,t.feedbackConfig.isFileUploadEnabled=!1,t.feedbackConfig.isShareContextDataEnabled=!0,t.feedbackConfig.scenarioConfig={isScenarioEnabled:!0,scenarioType:q.AIThumbsDown},t}(this._feedbackParams);this._setTheme(n),!we()&&t&&(n.callbackFunctions=t),n.feedbackConfig=Object.assign(Object.assign({},n.feedbackConfig),{isDisplayed:!0,diagnosticsConfig:{isShareContextDataEnabled:!0,getContextData:()=>this._getContextData(e)}}),z(n)})}_ensureInitialized(){return(0,a.__awaiter)(this,void 0,void 0,function*(){this._initPromise||(this._initPromise=V({appId:`${this._appId}`,hostName:this._clientName,language:this._language}).then(()=>this._setupCompliancePolicies())),yield this._initPromise})}get _environment(){const{legacyPageContext:e}=this._pageContext;return De(e&&e.cloudType||"")}get _feedbackParams(){var e,t;const{legacyPageContext:n}=this._pageContext;return{appId:this._appId,clientName:this._clientName,complianceChecks:this._complianceChecks,appData:this._appData,featureArea:this._featureArea,isProduction:se.Environment.type===se.EnvironmentType.SharePoint,userId:`a:${null===(e=null==n?void 0:n.aadUserId)||void 0===e?void 0:e.toString()}`,tenantId:null===(t=null==n?void 0:n.aadTenantId)||void 0===t?void 0:t.toString(),officeUILang:n.currentLanguage,environment:this._environment}}_getContextData(e){const t={};this._diagnosticAppData.forEach((e,n)=>{t[n]=e});const n=JSON.stringify(Object.assign({promptId:se._SPKillSwitch.isActivated("b3b0f7d9-0a0e-4b7b-8a1f-6c1a6c4e1e9d")?"":e.id,prompt:e.prompt,responseMessage:e.plainText},t)),a=new File([n],"contextData.txt",{type:"text/plain"});return new Promise(e=>{e([a])})}_setTheme(e){e.themeOptions.baseTheme=(0,le.getTheme)()}}Ee._logSource=ue._LogSource.create("PagesCopilotFeedback")})(),f})());