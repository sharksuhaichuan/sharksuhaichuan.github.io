(()=>{var e=document.currentScript;define("b2eb623f-c8a3-4c1c-824a-0eb66535bd15_0.1.0",["@microsoft/sp-core-library","@microsoft/sp-diagnostics","@microsoft/sp-image-helper","@microsoft/sp-page-context","@ms/odsp-utilities-bundle","@ms/odsp-core-bundle","@ms/sp-component-utilities","@ms/sp-dataproviders","@microsoft/sp-lodash-subset","tslib","@microsoft/sp-http-base","@microsoft/sp-http","@ms/sp-telemetry"],(t,n,a,i,r,o,s,c,d,l,u,f,p)=>(()=>{var m,_={556:(e,t,n)=>{var a=n(698);e.exports=a.SPAlternativeUrls}
,676:e=>{"use strict";e.exports=t},207:e=>{"use strict";e.exports=n},909:e=>{"use strict";e.exports=f},737:e=>{"use strict";e.exports=u},949:e=>{"use strict";e.exports=a},529:e=>{"use strict";e.exports=d},408:e=>{"use strict";e.exports=i},698:e=>{"use strict";e.exports=o},939:e=>{"use strict";e.exports=r},773:e=>{"use strict";e.exports=s},493:e=>{"use strict";e.exports=c},27:e=>{"use strict";e.exports=p},280:e=>{"use strict";e.exports=l}},h={};function b(e){var t=h[e];if(void 0!==t)return t.exports;var n=h[e]={exports:{}};return _[e](n,n.exports,b),n.exports}b.d=(e,t)=>{for(var n in t)b.o(t,n)&&!b.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},b.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),b.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},m=e?e.src:"",b.p=m.slice(0,m.lastIndexOf("/")+1);var g={};return(()=>{"use strict";b.r(g),b.d(g,{HubNewsDataProvider:()=>Se,MicroServiceNewsDataProvider:()=>fe,MultiSiteNewsDataProvider:()=>Ee,MyNewsDataProvider:()=>ke,NewsDataProvider:()=>De,NewsDataSource:()=>s,NewsDigestDataProvider:()=>Ie,NewsDigestUtilities:()=>xe,NewsEmptyStateType:()=>I,NewsSearchDataProvider:()=>Ce,NewsUtilities:()=>H,ServerError:()=>ie,VroomViewCountsDataProvider:()=>Me,_appendAudienceFilteringQueryParam:()=>d,_appendLanguageOverrideQueryParam:()=>l,_getExtraDataForLogging:()=>u,_getHubSiteNewsUrl:()=>Q,_getMultiSiteNewsUrl:()=>q,_getMyNewsUrl:()=>Y,_getNewsDataProviderId:()=>$,_getSerializedFilterQuery:()=>J,_getSiteNewsUrl:()=>W,_isHubNews:()=>X,_isMicroserviceSupported:()=>Z,currentViewCounts:()=>B,hubNews:()=>j,multiSiteNews:()=>z,myNews:()=>G,news:()=>R,newsDataSourceProp:()=>c,newsDigest:()=>V,staleViewCounts:()=>K,tryGetAuthoritativeSiteDetails:()=>x,viewCounts:()=>N});var e=b(676),t=b(207),n=b(949),a=b(408),i=b(939),r=b(556),o=b(773),s={CurrentSite:1,Hub:2,ChooseSites:3,MyNews:4},c="newsDataSourceProp";function d(e){return e.audienceTargetingEnabled?"&".concat("filterByAudience","=true"):""}function l(e,t){void 0===t&&(t=!1);var n=e.languageOverride;return n?t?"&languageOverride='".concat(n,"'"):"&languageOverride=".concat(n):""}function u(e,t){var n="noFilter";e.serializedFilterQuery?n="filterCAMLQueryAdded":e.filterKQLQuery&&(n="filterKQLQueryAdded");var a={audienceTargetingEnabled:(!!e.audienceTargetingEnabled).toString(),isOnSeeAllPage:H.isOnSeeAllPage.toString(),isAdvanceMode:(!!e.languageOverride).toString(),alias:n};return t&&t.legacyPageContext&&t.legacyPageContext.isHubSite&&(a.service="HubSite"),a}const f=JSON.parse('{"eB":"让团队随时跟进团队网站上的新闻","J6":"在网站主页上，可快速创作新的资讯帖(如状态更新、出差报告)，甚至只是推荐一篇文档，向团队提供一些额外的背景知识。","t7":"https://go.microsoft.com/fwlink/p/?linkid=827920","Kl":"什么是团队网站?","Sl":"SharePoint 团队网站让你和你的团队可随时获取每天依赖的内容、信息和应用。例如，你可以使用团队网站来存储和协作处理文件，或创建和管理信息列表。在团队网站主页，你可以查看重要团队文件、应用和网页的链接，也可以在活动源中查看最近的网站活动。","R8":"https://go.microsoft.com/fwlink/p/?linkid=827918","Rh":"向网站添加页面","R7":"使用页面是使用图像、Excel 文档、Word 文档、PowerPoint 文档以及视频等来分享创意的一种好方法。你可以快速轻松地创建和发布页面，这些页面在任何设备上看起来都精致优美。创建页面时，可以使用编辑窗格中现有的工具箱添加和自定义 Web 部件。此外，只需一键单击即可发布页面。","K0":"https://go.microsoft.com/fwlink/p/?linkid=827919","Gp":"欢迎使用新的团队网站","mA":"在新的团队网站主页上快速创作新的新闻帖子、状态更新或旅行报告。","Bz":"SharePoint","$g":"新闻","ZK":"中心新闻","l":"我的新闻","Nb":"多网站新闻","CG":"创建新闻文章","VO":"当前未提供任何新闻文章","CY":"共享最近更新以持续吸引受众。","VI":"请稍后返回查看最近新闻。","Ub":"新闻文章标题","NT":"显示文章前几行的预览。","eo":"作者姓名","no":"几秒钟前","jm":"自动","ZJ":"构建成功的门户","KG":"新式 SharePoint 品牌","Rn":"SharePoint 新闻触及到了更多用户"}'),p=b.p+"helpitemimg1_1aeb636db63f73c25dec.png",m=b.p+"helpitemimg1-2x_0a4540e2c1f1fc063747.png",_=b.p+"helpitemimg2_4c6efb6966d516555041.png",h=b.p+"helpitemimg2-2x_0d758ed33f7cdfd340c2.png",v=b.p+"helpitemimg3_31dc53efb814689e75d8.png",y=b.p+"helpitemimg3-2x_d763961267f4b3793027.png",S=b.p+"odm_Modernize_News_91963e8e.svg";var D=function(){function e(){}return e.getIconUrl=function(t){t!==e._modernizedImageKey||e._assetIconsMap[this._modernizedImageKey]||(e._assetIconsMap[this._modernizedImageKey]=[S,S]);var n=e._assetIconsMap[t];return n[window.devicePixelRatio>=2&&n.length>=2?1:0]},e._assetIconsMap={HelpImg1:[p,m],HelpImg2:[_,h],HelpImg3:[v,y]},e._modernizedImageKey="HelpImgModern",e}(),I={None:0,TeamSite:1,CommSite:2,Carousel:3};function x(t,n,a){if(t&&n&&a.legacyPageContext&&a.legacyPageContext.organizationNewsSiteReference){var i=e.Guid.tryParse(t),r=e.Guid.tryParse(n);if(i&&r&&a.legacyPageContext.organizationNewsSiteReference)for(var o=0,s=a.legacyPageContext.organizationNewsSiteReference;o<s.length;o++){var c=s[o];if(C(i,r,c))return c}}}function C(t,n,a){var i=e.Guid.tryParse(a.SiteId),r=e.Guid.tryParse(a.WebId);return!!(i&&r&&t.equals(i)&&n.equals(r))}function O(){return e._SPKillSwitch.isActivated("b35f5ad6-6538-41ec-bbfa-14c8109a4b44")}function w(){return e._SPKillSwitch.isActivated("f6d6f28c-002c-42c8-8825-59c0be23c8a4")}function E(){return e._SPKillSwitch.isActivated("ac52d2d0-e041-4af4-9eaa-addeba264ba3")}function A(){return e._SPKillSwitch.isActivated("c79f7700-2b1c-4929-b255-ac927bb6a5fc")}function L(){return e._SPKillSwitch.isActivated("94562ec4-f74a-4ab7-b561-bae3074207b3")}var k=b(493),M=b(529),P="newsProcessBannerImageUrl",T="",U={filterType:k.FilterType.TitleContaining,value:"",values:[]},F=function(e){this["OData-Version"]="3.0",this["If-Match"]="*",this["X-HTTP-Method"]=e},H=function(){function c(){}return c._isPPSShadowcallsKillSwitchActivated=function(){return e._SPKillSwitch.isActivated("612dd0c0-cbf8-4314-802a-a8896fc00709")},c.isCallToActionEnabled=function(){return e._SPFlight.isEnabled(60497)},c.isCallToActionForVroomKillSwitchActivated=function(){return e._SPKillSwitch.isActivated("18fdd747-7cfd-4114-8fbf-f18a1f15c875")},c.cacheViewCountsValue=function(e,t,n){var a=c.viewCountsDictionary[e+"/"+t];(void 0===a||a<n)&&(c.viewCountsDictionary[e+"/"+t]=n)},c._internalGetTeamSiteHelpItems=function(e,t){var n=void 0!==e&&e<=3?e:3,i=[],r=!1;t&&t.whenFinished(function(){var e=t.consume(a.PageContext.serviceKey);r=e.legacyPageContext.IsHomepageModernized});for(var o=[{description:r?f.mA:f.J6,title:r?f.Gp:f.eB,url:r?c._mdrnHelpUrl:f.t7},{description:f.Sl,title:f.Kl,url:f.R8},{description:f.R7,title:f.Rh,url:f.K0}],s=0;s<n;s++){var d="f7752afa-9c69-49c8-bc62-5b5b35d01775",l=r&&0===s?"Modern":"".concat(s+1);i.push({author:f.Bz,authorInitial:"SP",authorAccountName:"",description:o[s].description,email:"",image:D.getIconUrl("HelpImg"+l),publishedOn:new Date,publishedOnRelativeTime:"",title:o[s].title,url:o[s].url,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:d,siteId:d,webId:d})}return i},c.isValidNewsSource=function(e){return e===s.CurrentSite||e===s.Hub||e===s.ChooseSites||e===s.MyNews},c.getEmptyStateItems=function(e,t,n,a){switch(e){case I.CommSite:return c.getCommSiteHelpArticles(n);case I.TeamSite:return c._internalGetTeamSiteHelpItems(n,t);case I.Carousel:return c.getEmptyCarouselItems(n,a);default:return[]}},c.getCommSiteHelpArticles=function(t){for(var n=void 0!==t&&t<=3?t:3,a=[],i=0;i<n;i++){var r=e.Guid.newGuid().toString();a.push({author:f.eo,authorAccountName:"",description:f.NT,email:"",image:"",publishedOn:void 0,publishedOnRelativeTime:f.no,title:f.Ub,url:void 0,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:r,siteId:r,webId:r})}return a},c.getEmptyCarouselItems=function(t,a){for(var i=void 0!==t&&t<=3?t:3,r=[],s=[f.ZJ,f.KG,f.Rn],c=0;c<i;c++){var d=e.Guid.newGuid().toString(),l=o.DefaultImageHelper.getDefaultNewsCarouselImageById(c);l=n._ThumbnailUrlGenerator.getThumbnailUrl({absoluteUrl:l,spResource:l,width:a,callerId:"EmptyCarouselItems"}),r.push({author:"",authorAccountName:"",description:"",email:"",image:l,publishedOn:void 0,publishedOnRelativeTime:"",title:s[c],url:void 0,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:d,siteId:d,webId:d})}return r},Object.defineProperty(c,"autofillItem",{get:function(){var t=e.Guid.newGuid().toString();return{author:"",authorAccountName:"",description:"",image:"",publishedOn:void 0,publishedOnRelativeTime:f.no,title:f.jm,url:void 0,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:t,siteId:t,webId:t}},enumerable:!1,configurable:!0}),c.getTipActionNewsItem=function(t,n){var a=e.Guid.newGuid().toString();return{author:"",authorAccountName:"",description:t?f.CY:f.VI,image:"",isContributorActionCard:t,publishedOn:void 0,publishedOnRelativeTime:"",title:t?f.CG:f.VO,url:t?i.Uri.concatenate(n,"/_layouts/15/CreateSitePage.aspx?source=")+i.UriEncoding.encodeURIComponent(window.location.pathname)+"&promotedState=1":f.t7,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:a,siteId:a,webId:a}},c.extractNewsItemsFromSearch=function(t,n){return t.map(function(t){var a=t.SiteID?e.Guid.parse(t.SiteID).toString():void 0,i=t.WebId?e.Guid.parse(t.WebId).toString():void 0,r=t.ListId?e.Guid.parse(t.ListId).toString():void 0,s=t.UniqueID?e.Guid.parse(t.UniqueID).toString():void 0,d=t.ViewCountLifetime,l="number"==typeof d?d:void 0,u=x(a,i,n),f=t.SPWebUrl,p=c._handleDefaultBanner(t.PictureThumbnailURL);return{author:c._getUserDisplayNameFromSearch(t.CreatedBy),authorAccountName:t.AuthorOWSUSER,description:t.Description||"",email:c._getAuthorEmail(t.AuthorOWSUSER),isAuthoritative:!!u,image:p||T,publishedOn:new Date(t.FirstPublishedDate),publishedOnRelativeTime:"",title:t.Title||t.FileName,url:w()?c.encodeSegments(t.Path):o.UrlUtility.encodeSegments(t.Path),listItemId:t.ListItemId,originalSourceItemId:void 0,originalSourceUrl:w()?c.encodeSegments(t.OriginalPath):o.UrlUtility.encodeSegments(t.OriginalPath),path:t.Path,siteTitle:c._getSiteTitle(t,a,i,n),siteUrl:f,viewCounts:l,isHelpArticle:!1,uniqueId:s,siteId:a,webId:i,listId:r}})},c.extractNewsItems=function(t,n){var a=this;return t.map(function(t){var r,s,d,l,u,f=function(t){return e.Guid.parse(t).toString()},p=t.SiteID?f(t.SiteID):n.site.id.toString(),m=t.WebId?f(t.WebId):n.web.id.toString(),_=t.ListId?f(t.ListId):null===(s=null===(r=n.list)||void 0===r?void 0:r.id)||void 0===s?void 0:s.toString(),h=t.UniqueId?f(t.UniqueId):null===(l=null===(d=n.listItem)||void 0===d?void 0:d.id)||void 0===l?void 0:l.toString(),b=x(p,m,n),g=t.BannerImageUrl,v=t.BannerThumbnailUrl;u=e._SPFlight.isEnabled(1047)&&g&&g.toUpperCase().indexOf("/_LAYOUTS/IMAGES/")>-1?c._handleDefaultBanner(g):c._handleDefaultBanner(v||g);var y=!a._isUseRedirectPageUrlKillSwitchActivated()&&n.web&&n.web.absoluteUrl&&t.Path&&t.Path.DecodedUrl?i.Uri.concatenate(n.web.absoluteUrl,"/",t.Path.DecodedUrl):t.AbsoluteUrl;return{author:t.CreatedBy.Name,authorAccountName:t.CreatedBy.AccountName,callToAction:a.isCallToActionEnabled()?t.CallToAction:void 0,description:t.Description?t.Description:"",email:c._getAuthorEmail(t.CreatedBy.AccountName),isAuthoritative:!!b,image:u||T,publishedOn:new Date(t.FirstPublished),publishedOnRelativeTime:"",title:t.Title||t.FileName,url:w()?c.encodeSegments(y):o.UrlUtility.encodeSegments(y),listItemId:t.Id,originalSourceItemId:t.OriginalSourceItemId,originalSourceUrl:w()?c.encodeSegments(t.OriginalSourceUrl):o.UrlUtility.encodeSegments(t.OriginalSourceUrl),path:t.Path&&t.Path.DecodedUrl,siteTitle:b?c._getSiteTitle(t,p,m,n):void 0,siteUrl:n.web.absoluteUrl,viewCounts:void 0,isHelpArticle:!1,uniqueId:h,siteId:p,webId:m,listId:_}})},c.extractMicroserviceNewsItems=function(t,n,a){return t.map(function(t){var i=t.Site&&t.Site.ItemReference,r=t.Library,s=e.Guid.tryParse(i&&i.SiteId),d=(null==s?void 0:s.toString())||(a?n.site.id.toString():void 0),l=e.Guid.tryParse(i&&i.WebId),u=(null==l?void 0:l.toString())||(a?n.web.id.toString():void 0),f=e.Guid.tryParse(r&&r.ListId),p=f&&f.toString(),m=t.UniqueId?e.Guid.parse(t.UniqueId).toString():void 0,_=x(d,u,n),h=t.Site&&t.Site.Url?t.Site.Url:t.SiteUrl||n.site.absoluteUrl,b=c._handleDefaultBanner(t.ImageUrl);return{author:t.Author&&t.Author.Title?t.Author.Title:"",authorAccountName:t.Author&&t.Author.AccountName?t.Author.AccountName:"",description:t.Description,email:c._getAuthorEmail(t.Author&&t.Author.AccountName?t.Author.AccountName:""),isAuthoritative:t.IsAuthoritativeNews||!!_,image:b||T,publishedOn:new Date(t.FirstPublishedDate),publishedOnRelativeTime:"",title:t.Title,url:w()?c.encodeSegments(t.Url):o.UrlUtility.encodeSegments(t.Url),viewCounts:void 0,isHelpArticle:!1,siteTitle:c._getSiteTitle(t,d,u,n),siteUrl:h,listItemId:t.ListItemId,originalSourceItemId:t.OriginalSourceItemId,originalSourceUrl:w()?c.encodeSegments(t.OriginalSourceurl):o.UrlUtility.encodeSegments(t.OriginalSourceUrl),path:t.Path&&t.Path.DecodedUrl,uniqueId:m,siteId:d,webId:u,listId:p}})},c.extractVroomNewsItems=function(e,t){var n=this;return e.map(function(e){var a,i,r,s,d,l,u,f,p,m,_,h,b,g,v,y,S,D,I,C=(null===(a=e.sharepointIds)||void 0===a?void 0:a.siteUrl)||t.site.absoluteUrl,O=(null===(i=e.sharepointIds)||void 0===i?void 0:i.siteId)||t.site.id.toString(),E=(null===(r=e.sharepointIds)||void 0===r?void 0:r.webId)||t.web.id.toString(),A=x(O,E,t),L=e.thumbnails?e.thumbnails[0]:void 0,k=L?c._handleDefaultBanner(L.source.url):void 0,M=null!==(d=null===(s=null==e?void 0:e.news)||void 0===s?void 0:s.isBoosted)&&void 0!==d&&d;return{author:(null===(u=null===(l=e.createdBy)||void 0===l?void 0:l.user)||void 0===u?void 0:u.displayName)||"",authorAccountName:"",callToAction:n.isCallToActionEnabled()&&!n.isCallToActionForVroomKillSwitchActivated()?e.callToAction:void 0,description:e.description,email:null===(p=null===(f=e.createdBy)||void 0===f?void 0:f.user)||void 0===p?void 0:p.email,isAuthoritative:!!A,isBoostedNews:M,image:k||T,publishedOn:new Date(e.firstPublishedDate),publishedOnRelativeTime:"",title:e.title,url:w()?c.encodeSegments(e.webUrl):o.UrlUtility.encodeSegments(e.webUrl),viewCounts:null===(h=null===(_=null===(m=e.analytics)||void 0===m?void 0:m.allTime)||void 0===_?void 0:_.access)||void 0===h?void 0:h.actionCount,isHelpArticle:!1,siteTitle:(null===(b=e.parentReference)||void 0===b?void 0:b.siteTitle)||c._getSiteTitle(e,O,E,t),siteUrl:C,listItemId:null===(g=e.sharepointIds)||void 0===g?void 0:g.listItemId,originalSourceItemId:null===(v=e.originalSourceIds)||void 0===v?void 0:v.listItemUniqueId,originalSourceUrl:w()?c.encodeSegments(null===(y=e.originalSourceIds)||void 0===y?void 0:y.url):o.UrlUtility.encodeSegments(null===(S=e.originalSourceIds)||void 0===S?void 0:S.url),uniqueId:null===(D=e.sharepointIds)||void 0===D?void 0:D.listItemUniqueId,siteId:O,webId:E,listId:null===(I=e.sharepointIds)||void 0===I?void 0:I.listId}})},c.processBannerImageUrlPart=function(e,n,a,i,r,o,s){try{return c._processBannerImageUrlPartCore(e,n,a,i,r,o,s)}catch(e){var d={defaultUniqueId:n,imageWidth:i};return r&&(d.siteId=r),o&&(d.webId=r),new t._QosMonitor("News.processBannerImageUrlPart").writeExpectedFailure("UrlError",e,d),""}},c.getResourceFromPrivateCDNUrl=function(e){if(n._ThumbnailUrlGenerator.getThumbnailProvider(e)===n._ThumbnailProviderType.PrivateCDN){var t=new n._SPResourcePath(e);e=(e="https:/".concat(t.path)).split("?")[0]}return e},c.extractParamFromUrl=function(e,t){var n=new RegExp("[?&]".concat(e,"=([^?&]+)(&|$)")).exec(t);return n?decodeURIComponent(n[1]):void 0},c.isNewsItemInList=function(e,t){return!(!e||!t)&&e.some(function(e,n){return e&&c.getNewsItemKey(e,"".concat(n))===c.getNewsItemKey(t,"".concat(n))})},c.getPaddingCount=function(e,t){var n=0;return e.emptyItemType&&(n=e.count-t,n=e.emptyItemsCount?Math.min(e.emptyItemsCount,n):n),n},c.hasSameSetOfPosts=function(e,t){if(!e||!t||e.length!==t.length)return!1;var n=!0;return e.every(function(e){return n=n&&t.some(function(t){return e.url===t.url})}),n},c.hasSameOrderOfPosts=function(e,t){if(!e||!t||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},c.removeQueryParam=function(e,t){if(e&&t){var n=new i.Uri(e);return n.removeQueryParameter(t),n.toString()}return e},c.didRenderedPropertiesChange=function(e,t){return e&&t&&(e.description!==t.description||e.image!==t.image||e.title!==t.title)},c.trackPrefetchDataUpdated=function(e,t){var n=k.TieredCacheHelperOnDemand.getPrefetchDataProvider(e),a="_spNewsWebPartData",i={alias:"FirstParty_NewsWebPart_News",prefetchUpdateOptions:t};null==n||n.trackPrefetchDataUpdated(a,i,"".concat(a,"Loaded"))},c.getNewsItemKey=function(e,t){return e.isHelpArticle?t:"".concat(e.siteId,"-").concat(e.webId,"-").concat(e.listId,"-").concat(e.uniqueId)},Object.defineProperty(c,"isOnSeeAllPage",{get:function(){var e=new i.Uri(window.location.href);return i.StringHelper.doesStringEndWith(e.getPath(!0).toLowerCase(),"/_layouts/15/news.aspx")},enumerable:!1,configurable:!0}),c.getFilterQueryBody=function(e){return void 0===e&&(e=""),JSON.stringify(e)},c.encodeSegments=function(e){if(!e)return e;var t="/"===e.substring(e.length-1)?"/":"",a=new n._SPResourcePath(e);if(!a.authority&&!a.domain)return e;var r=new RegExp(".+.aspx"),o=new RegExp("^(?:[^%]|%[0-9A-Fa-f]{2})+$"),s=a.segments.filter(function(e){return!!e}).map(function(e){try{var t=r.exec(o.test(e)?decodeURIComponent(e):e);if(t){var n=t[0];return e.replace(r,encodeURIComponent(n))}return e}catch(t){return e}});return i.Uri.concatenate.apply(i.Uri,[a.authority].concat(s))+t+a.searchParamString},c.getDefaultFilter=function(){return JSON.stringify([(0,M.cloneDeep)(U)])},c._shouldDeprecateDocViz=function(){return n._ThumbnailUrlGenerator.isVROOMThumbnailEnabled()},c._getSiteTitle=function(t,n,a,i){var r=t.SiteTitle;if(!r){var o=e.Guid.tryParse(n),s=e.Guid.tryParse(a);(null==o?void 0:o.equals(i.site.id))&&(null==s?void 0:s.equals(i.web.id))&&(r=i.web.title)}return r},c._getUserDisplayNameFromSearch=function(e){var t=e,n=null==e?void 0:e.split("|");return n&&n.length>1&&(t=n[1]),t||""},c._handleDefaultBanner=function(e){return c._isDefaultBannerImage(e)?T:e},c._extractImageFromBanner=function(e){var t=e.split(", ");return t[t.length>1?1:0].trim()},c._isDefaultBannerImage=function(e){return!e||i.StringHelper.doesStringEndWith(c._extractImageFromBanner(e),"/images/sitepagethumbnail.png")},c._isUseRedirectPageUrlKillSwitchActivated=function(){return e._SPKillSwitch.isActivated("5a9dc530-5eb2-4032-b8b9-b6d4222ad8ad")},c._processBannerImageUrlPartCore=function(e,a,s,d,l,u,f){var p=c._extractImageFromBanner(e),m=f||s.web.absoluteUrl,_="".concat(P,":"),h=c._tryGetExternalBanner(s,p,_);if(h)return h;if(c._isDefaultBannerImage(p))return"";var b=n._ThumbnailUrlGenerator.getThumbnailProvider(p);if(b===n._ThumbnailProviderType.PrivateCDN&&!(0,r.isAlterantiveUrlFresh)(p)){var g=new n._SPResourcePath(p);p=(p="https:/".concat(g.path)).split("?")[0],b=n._ThumbnailProviderType.Original}var v=new n._SPResourcePath(p),y=v.path.toLowerCase();if(b===n._ThumbnailProviderType.Stock)return p;if(b===n._ThumbnailProviderType.VROOMMeTACache||b===n._ThumbnailProviderType.PrivateCDN||b===n._ThumbnailProviderType.PublicCDN||b===n._ThumbnailProviderType.AFDPublicCDN||b===n._ThumbnailProviderType.MeTA)return n._ThumbnailUrlGenerator.updateThumbnailWidth(p,d);if(b===n._ThumbnailProviderType.DocViz){if(t._TraceLogger.logVerbose(c._logSource,"".concat(_," already from GetPreview")),c._shouldDeprecateDocViz()){var S=n._ThumbnailUrlGenerator.fromGetPreview(p,P,d);if(S)return S}var D=n._PreviewUtility.normalizeWidthToResolution(d),I=new i.Uri(p);return I.setQueryParameter(n._PreviewHelper.RESOLUTION,D.toString()),I.toString()}var x=b!==n._ThumbnailProviderType.SharePointHost&&b!==n._ThumbnailProviderType.MySite;if(b!==n._ThumbnailProviderType.Unknown&&x)return n._ThumbnailUrlGenerator.updateThumbnailWidth(p,d);var C={absoluteUrl:v.authority||m,fileType:n._PreviewUtility.getFileExtension(v),spResource:y,width:d,callerId:P};return n._ThumbnailUrlGenerator.getThumbnailUrl(C,o.DefaultImageHelper.getDefaultImage(v))},c._tryGetExternalBanner=function(e,a,i){var r=new n._SPResourcePath(a),s=T;if(r&&(s=r.authority),s&&!o.UrlUtility.isInternalResource(a,e))return t._TraceLogger.logVerbose(c._logSource,"".concat(i," external host")),a},c._getAuthorEmail=function(e){var t;if(e){var n=e.split("|");t=n[n.length-1]}return t},c.aliasPrefix="FirstParty_NewsWebPart_",c.viewCountsDictionary={},c._logSource=t._LogSource.create("NewsUtilities"),c._mdrnHelpUrl=" https://go.microsoft.com/fwlink/?linkid=2103711",c}(),R="news",N="viewCounts",B="currentViewCounts",j="hubNews",V="newsDigest",z="multiSiteNews",G="myNews",K="staleViewCounts";function W(t,n,a,r){var o=i.UriEncoding.escapeUrlForCallback(t),s="/_api/sitepages/pages/"+(n?"FeedTargeted":"feed")+"?promotedstate=2&published=true",c="&$skip="+(r?r.toString():"0"),d="&$top="+(a>0?a.toString():""),l="&$select=Description,BannerImageUrl,BannerThumbnailUrl,AbsoluteUrl,FirstPublished,Title,FileName,Id,UniqueId,ListId,OriginalSourceItemId,OriginalSourceUrl,Path";return e._SPFlight.isEnabled(60497)&&(l+=",CallToAction"),o+s+"&$filter=not startswith(ContentTypeId ,'0x0101009D1CB255DA76424F860D91F20E6C4118002A50BFCFB7614729B56886FADA02339B00873E381CC9DD4F2E808A377A72C311BB')"+c+d+"&$expand=CreatedBy"+l}function q(e,t,n,a){var r=i.UriEncoding.escapeUrlForCallback(e),o="?$expand=analytics($expand=allTime),thumbnails&$top=".concat(t);return n&&a?a:r+"/_api/v2.1/getMultiSiteNews"+o}function Q(e,t,n,a){var r=i.UriEncoding.escapeUrlForCallback(e),o="?$expand=analytics($expand=allTime),thumbnails&$top=".concat(t);return n&&a?a:r+"/_api/v2.1/getMultiHubNews"+o}function Y(t,n,a,r,o){var s=i.UriEncoding.escapeUrlForCallback(t),c="section=SharePointNewsFeedTargeted&$expand=analytics($expand=allTime),thumbnails&$top=".concat(n);if(a&&o)return o;var d=new i.Uri(i.Uri.concatenate(s,"/_api/v2.1/getNewsFeed"));return d.setQuery(c),!e._SPKillSwitch.isActivated("c79f7700-2b1c-4929-b255-ac927bb6a5fc")&&r&&d.setQueryParameter("preferredLanguage",r),d.toString()}function J(t,n,a,i){return e._SPKillSwitch.isActivated("f7ad101d-0b71-4da9-95a4-d2879f3541ae")||1!==n||function(e){return void 0!==e&&e.some(function(e){return 6===e.filterType&&void 0===e.fieldInfo})}(a)?t:k.CAMLQueryBuilder.generateCAMLFilter({filters:a,fieldDictionary:i})}function X(e,t){return 2===e&&function(e){return e.legacyPageContext.isHubSite}(t)}function Z(e){var t,n;return Boolean(Number(null===(n=null===(t=e.legacyPageContext)||void 0===t?void 0:t.farmSettings)||void 0===n?void 0:n.ExternalService_issphomemicroservicesupported))}function $(e,t,n){return X(e,t)&&Z(t)?"hubNews":function(e){return 3===e}(e)?"multiSiteNews":function(e){return 4===e}(e)?"myNews":n?"newsDigest":"news"}var ee=b(280),te=b(737),ne=b(909),ae=b(27);const ie=function(e){function t(t,n){var a=e.call(this,n)||this;return a.errorCode=t,a}return(0,ee.__extends)(t,e),t}(Error);var re="EmptyResponse",oe="_Response_Parse_Error",se="Cache",ce="Server",de="UnexpectedError",le="UnexpectedRetryableError",ue="MicroServiceNews";const fe=function(){function n(e){var t=this;this._maxRetryCount=3,this.parsedResponseCount=0,this.canCompare=!1,this._extraData={},this._retryCount=0,this._processMicroserviceServiceResponse=function(e,n,a,i){return e.json().then(function(i){var r=u(n,t._pageContext);return r.retryCount=t._retryCount,t._processMicroserviceServiceResponseCore(i,n,r,a,e)})},this._onCacheThenNetworkServerDataNotReturned=function(e,n){t._onCacheThenNetworkServerDataReturned(Promise.resolve([]),e,n)},this._onCacheThenNetworkServerDataReturned=function(e,n,a){var i=n&&a,r=i?se:"";e.then(function(e){var a=t._isEmptyResponse(e);if(a||i){var o=a?ce:"";t._writeToEmptyResultsMonitor(t._extraData,n,"".concat(r).concat(o).concat(re))}}).catch(function(e){t._writeToEmptyResultsMonitor(t._extraData,n,"".concat(r).concat(ce).concat(oe),e)})},this._isEmptyResponse=function(e){var t=e&&e.filter(function(e){return!(null==e?void 0:e.isHelpArticle)});return!(null==t?void 0:t.length)},this._isRawData=function(e){return void 0!==(null==e?void 0:e.Items)},this._parseHttpClientResponse=function(e,n,a){var i=u(n);i.responseStatus=e.status.toString();var r=(0,k.hasResponseMSCV)(i.MSCV,i.URL),o=(0,k.getMicroServiceErrorCode)(e.status,r);return e.ok?e.json().then(function(e){var r=t._processRawData(e,n,a);return a.writeSuccess(i),r}).catch(function(e){throw a.writeUnexpectedFailure(o,e,i),e}):(a.writeUnexpectedFailure(o,new Error(de),i),Promise.reject())},this._processRawData=function(e,n,a){var i=H.getPaddingCount(n,e.Items?e.Items.length:0),r=!e.Items||0===e.Items.length;t._logEmptyResultToQos(t._extraData,r,e);var o=r?[]:t.extractMicroserviceNewsItems(e.Items);return o=o.concat(H.getEmptyStateItems(n.emptyItemType,t.options.serviceScope,i,n.webpartWidth)),a.writeSuccess(t._extraData),o},this.options=e,this.options.serviceScope.whenFinished(function(){t._pageContext=t.options.serviceScope.consume(a.PageContext.serviceKey),t._sphomeHttpClient=t.options.serviceScope.consume(k.SPHomeHttpClient.serviceKey),t._spHttpClient=t.options.serviceScope.consume(ne.SPHttpClient.serviceKey)})}return Object.defineProperty(n.prototype,"isMicroserviceUnavailable",{get:function(){return this._sphomeHttpClient.isServiceAvailable},enumerable:!1,configurable:!0}),n.prototype.requestData=function(e){var t=this;this._retryCount=0;var a=n._requestCount++;return this._addPageUsageStartData(a),this._requestData(e).then(function(e){return t._addPageUsageEndData(a),e}).catch(function(n){if(++t._retryCount<t._maxRetryCount&&t.shouldRetryDataFetch(n))return t._requestData(e).then(function(e){return t._addPageUsageEndData(a),e});throw t._addPageUsageEndData(a,!0),n})},n.prototype.extractMicroserviceNewsItems=function(e){return H.extractMicroserviceNewsItems(e,this._pageContext)},n.prototype.shouldRetryDataFetch=function(e){return e.message===le},n.prototype._processHttpClientResponsePromise=function(e,t,n,a,i){var r,o=this;return e.then(function(e){return(r=e).json()}).then(function(e){return o._processMicroserviceServiceResponseCore(e,t,n,a,r)})},n.prototype._applyCacheAndNetwork=function(n,a,i,r){var s=this;if(n.serverResponse&&n.cachedResponse){var c=new t._QosMonitor("".concat(this.qosMonitorLabel,".getNewsItemsInSmartRace")),d=this._processHttpClientResponsePromise(n.serverResponse,a,i,c).then(function(e){var t=s._isEmptyResponse(e);return a.onServerResponseResolved(t),e}).catch(function(e){throw a.onServerResponseFailed(e),e}),l=new t._QosMonitor("".concat(this.qosMonitorLabel,".getCachedNewsItemsInSmartRace")),u=k.TieredCacheHelper.processResponseRawData(n.cachedResponse,this._isRawData,this._processRawData,a,l).then(function(e){var t=s._isEmptyResponse(e);return a.onCacheResponseResolved(t),e||[]}).catch(function(e){throw l.writeUnexpectedFailure("ParseCacheResultsFailed",e),a.onCacheResponseFailed(e),e}),f=e.Guid.parse("9b794e3a-a041-4fb4-870d-a1121ca57ca7"),p=e.Guid.parse("4d757517-a42f-4546-a76a-8d0da7dd2a07"),m=[{raceablePromise:u,raceId:f},{raceablePromise:d,raceId:p}];return o.SmartRace.race(m).then(function(e){return e.raceId===f&&d.then(function(e){a.onServerResponseResolvedWithCache(e)}).catch(function(){}),r.writeSuccess({cacheStatus:e.raceId===f?"WonRace":"LostRace"}),e.raceablePromise}).catch(function(e){throw r.writeUnexpectedFailure("SmartRaceFailed",e),e})}},n.prototype._addPageUsageStartData=function(e){var t=ae._PageUsageAdapter.getInstance(),n=t.elapsedTime();t.markFeature("".concat(ue,"-").concat(this.qosMonitorLabel,"-").concat("StartTime","-").concat(e),n.toFixed(2))},n.prototype._addPageUsageEndData=function(e,t){var n=ae._PageUsageAdapter.getInstance(),a=n.elapsedTime();n.markFeature("".concat(ue,"-").concat(this.qosMonitorLabel,"-").concat("EndTime","-").concat(e,"-").concat(this._retryCount),a.toFixed(2)),t&&n.markFeature("".concat(ue,"-").concat(this.qosMonitorLabel,"-")+"".concat(e,"-").concat(this._retryCount,"-").concat("Failure"))},n.prototype._addMoreAdditionalFields=function(e,t){t.spHomeServer=e.headers.get("sphome-server");var n=e.headers.get("sphome-sharepointid");n&&(t.spHomeSharepointId=n)},n.prototype._addCacheAndServerEmptyStateLogs=function(e,t,n,a,i){var r=this,o=n&&a,s=o?se:"";return e.then(function(e){var a=r._isEmptyResponse(e);if(i.onServerResponseResolved(a),a||o){var c=a?ce:"";r._writeToEmptyResultsMonitor(t,n,"".concat(s).concat(c).concat(re))}return e}).catch(function(e){throw r._writeToEmptyResultsMonitor(t,n,"".concat(s).concat(ce).concat(oe),e),i.onServerResponseFailed(e),e})},n.prototype._getIsExpectedError=function(e){return e>=400&&e<500&&!(0,k.isThrottledResponse)(e)},n.prototype._getIsUnExpectedRetryableError=function(e){return e>=500&&e<600&&!(0,k.isThrottledResponse)(e)},n.prototype._logEmptyResultToQos=function(e,n,a){var i=new t._QosMonitor("".concat(this.qosMonitorLabel,".getNewsItems.EmptyResults"));n?i.writeUnexpectedFailure(re,new Error("200 ".concat(a.Items?"0 Items":"No Items")),e):i.writeSuccess(e)},n.prototype._logThrottledResultToQos=function(e,n){if((0,k.isThrottledResponse)(n)){var a=new t._QosMonitor("GetNewsItems.ThrottledResult");e.dataProvider=this.qosMonitorLabel,a.writeSuccess(e)}},n.prototype._parseClientCachableResponse=function(e,t,n,a){var i=this,r=e.cachedResponse?k.TieredCacheHelper.processResponseRawData(e.cachedResponse,this._isRawData,this._processRawData,t,a):void 0,o=e.serverResponse?this._processHttpClientResponsePromise(e.serverResponse,t,n,a):void 0;return r?(r.then(function(e){var a=i._isEmptyResponse(e);if(t.onCacheResponseResolved(a),o)i._addCacheAndServerEmptyStateLogs(o,n,!0,a,t).then(function(e){t.onServerResponseResolvedWithCache(e)}).catch(function(){});else{var r=a?se:"";a&&i._writeToEmptyResultsMonitor(n,!0,"".concat(r).concat(re))}}).catch(function(e){t.onCacheResponseFailed(e)}),r):(a.writeSuccess(n),this._addCacheAndServerEmptyStateLogs(o,n,!1,!0,t))},n.prototype._processMicroserviceServiceResponseCore=function(e,t,n,a,i){n.URL=H.removeQueryParam(i.url,"mainSiteUrl"),n.MSCV=i.headers.get("MS-CV"),this._extraData=n,this._addMoreAdditionalFields(i,n);var r=(0,k.hasResponseMSCV)(n.MSCV,n.URL);if(i.ok&&r)return this._processRawData(e,t,a);var o=i.status,s=(0,k.getMicroServiceErrorCode)(o,r);n.statusCode=o.toString(),n.responseStatus=i.statusText;var c=void 0,d=e;throw this._getIsExpectedError(o)?(c=new ie(i.status,"ExpectedError"),n.id=d.ErrorLabel,a.writeExpectedFailure(s,c,n)):(this._getIsUnExpectedRetryableError(o)?c=new ie(i.status,le):(c=new ie(i.status,de),this._logThrottledResultToQos(n,o)),n.id=d.ErrorLabel,a.writeUnexpectedFailure(s,c,n)),c},n.prototype._requestData=function(e){var n=this;if(!E()){var a={parseHttpClientResponse:this._processMicroserviceServiceResponse,isEmptyResponse:this._isEmptyResponse,isRawData:this._isRawData,processRawData:this._processRawData,qosMonitorLabel:this.qosMonitorLabel,onServerResponseResolvedWithCache:e.onServerResponseResolvedWithCache,onServerResponseResolved:e.onServerResponseResolved,onServerResponseFailed:e.onServerResponseFailed,onCacheResponseResolved:e.onCacheResponseResolved,onCacheResponseFailed:e.onCacheResponseFailed,onCacheThenNetworkServerDataReturned:this._onCacheThenNetworkServerDataReturned,onCacheThenNetworkServerDataNotReturned:this._onCacheThenNetworkServerDataNotReturned};return k.TieredCacheHelper.executeCacheStrategy(a,this.executeRequest,e)}var i=new t._QosMonitor("".concat(this.qosMonitorLabel,".getNewsItems")),r=u(e,this._pageContext);return r.retryCount=this._retryCount,this.executeRequest(e).then(function(t){if(t instanceof ne.HttpClientResponse)return n._parseHttpClientResponse(t,e,i);var a=t,o=n._applyCacheAndNetwork(a,e,r,i);if(o)return o;var s=t;return n._parseClientCachableResponse(s,e,r,i)}).catch(function(e){if(!i.hasEnded&&0===r.retryCount)if(e instanceof k.SPHomeMicroserviceNotAvailableError)i.writeUnexpectedFailure("TokenNotAvailable",e,r);else{var t=e.message;e=new Error(de),i.writeUnexpectedFailure(t,e,r)}throw e})},n.prototype._writeToEmptyResultsMonitor=function(e,n,a,i){var r=new t._QosMonitor("GetNewsItems.ZeroResult");e.mySiteCacheHit=n,e.dataProvider=this.qosMonitorLabel,e.source=a,i?r.writeUnexpectedFailure(a,i,e):n&&a==="".concat(se).concat(ce).concat(re)?r.writeExpectedFailure(a,new Error("Expected Cache and Server Empty Result"),e):r.writeSuccess(e)},n._requestCount=0,n}();var pe=b(698);function me(e){var t,n=e.webAbsoluteUrl,a=e.multiGeoInfo;if(n&&a&&a.length)try{var i=new pe.Uri(n).getHost();return null===(t=a.filter(function(e){return new pe.Uri(e.RootSiteUrl).getHost()===i})[0])||void 0===t?void 0:t.InstanceId}catch(e){return}}var _e="EmptyResponse",he="Cache",be="Server";const ge=function(e){function t(t){var n=e.call(this,t)||this;return n.paginationCompleted=!1,n.getRawItems=function(e){return e["@odata.nextLink"]?n.nextLink=e["@odata.nextLink"]:n.paginationCompleted=!0,e.value},n.isRawData=function(e){return!!e.value},n.isPaginationRequest=function(e){return!!e.isPaginationRequest&&!!n.nextLink},n.extractNewsItemsCallback=function(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];return H.extractVroomNewsItems(e,t)},n.options.serviceScope.whenFinished(function(){n.httpClient=n.options.serviceScope.consume(ne.SPHttpClient.serviceKey)}),n}return(0,ee.__extends)(t,e),Object.defineProperty(t.prototype,"cacheKeyOverrideEnabled",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"httpMethod",{get:function(){return"POST"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rootUrl",{get:function(){return i.UriEncoding.escapeUrlForCallback(this._pageContext.web.absoluteUrl.replace(this._pageContext.web.serverRelativeUrl,""))},enumerable:!1,configurable:!0}),t.prototype.getKeyOverride=function(t){return(0,ee.__assign)((0,ee.__assign)({},e.prototype.getKeyOverride.call(this,t)),this.getRequestBody(t))},t}(function(){function n(n){var i=this;this._extraData={},this.requestData=function(e){return i._requestData(e)},this.executeRequest=function(t){var n=void 0;return e._SPKillSwitch.isActivated("381ce7de-c105-43a5-973d-3fa81c146c46")?"POST"===i.httpMethod&&(n={body:JSON.stringify(i.getRequestBody(t)),headers:new F("POST"),method:"POST"}):i._getHeaders(t)&&(n={headers:i._getHeaders(t),method:i.httpMethod},"POST"===i.httpMethod&&(n.body=JSON.stringify(i.getRequestBody(t)))),O()?i.httpClient instanceof ne.HttpClient?i.httpClient.fetch(i.getAPIPath(t),ne.HttpClient.configurations.v1,n,i.getRequestCacheOptions(t)):i.httpClient.fetch(i.getAPIPath(t),ne.SPHttpClient.configurations.v1,n,i.getRequestCacheOptions(t)):i.getRequestCacheOptionsAsync(t).then(function(a){var r,o;if(i.httpClient instanceof ne.HttpClient)return i.httpClient.fetch(i.getAPIPath(t),ne.HttpClient.configurations.v1,n,a);var s=i.getAPIPath(t);if(!e._SPKillSwitch.isActivated("3f998f08-0e11-4e0d-9b71-815df7e0f769")){var c=null===(r=window.__webpartPrefetch)||void 0===r?void 0:r.get(t.webpartId);if(c){var d=new URL(s.toLowerCase()),l=c.qos,u=c.query1BodyLower===(null===(o=null==n?void 0:n.body)||void 0===o?void 0:o.toString().toLowerCase()),f=c.query1UrlLower.toString()===d.toString(),p=(0,k.compareHeaders)(c.headers,new Headers(null==n?void 0:n.headers));if(u&&f&&p){if(l&&l.writeSuccess(),c.query1)return c.query1}else l&&l.writeUnexpectedFailure(void 0,void 0,{bodyMatch:u,urlMatch:f,headersMatch:p})}}return i.httpClient.fetch(s,ne.SPHttpClient.configurations.v1,n,a)})},this.getCacheProps=function(e){return{parseHttpClientResponse:i.parseHttpClientResponse,isEmptyResponse:i._isEmptyResponse,isRawData:i.isRawData,processRawData:i.processRawData,qosMonitorLabel:i.qosMonitorLabel,onServerResponseResolvedWithCache:e.onServerResponseResolvedWithCache,onServerResponseResolved:e.onServerResponseResolved,onServerResponseFailed:e.onServerResponseFailed,onCacheResponseResolved:e.onCacheResponseResolved,onCacheResponseFailed:e.onCacheResponseFailed,onCacheThenNetworkServerDataReturned:i._onCacheThenNetworkServerDataReturned,onCacheThenNetworkServerDataNotReturned:function(t,n){return i._onCacheThenNetworkServerDataNotReturned(t,n,e)}}},this.getExtraHeaders=function(e){},this.getRequestBody=function(e){return{}},this.getRequestCacheOptions=function(e){var t=new Map;t.set(k.TieredCacheHelper.useStalePropName,!0);var n={alias:H.aliasPrefix+i.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:te._CacheStrategy.CacheAndNetwork,extraProps:t};return e.canCacheRequest&&!i.isPaginationRequest(e)||(n.cacheStrategy=te._CacheStrategy.NetworkOnly),n},this.getRequestCacheOptionsAsync=function(e){var t=i._getCacheKeyOverrideAsync(e);return t?t.then(function(t){var n=new Map;n.set(k.TieredCacheHelper.useStalePropName,!0),t&&n.set(k.TieredCacheHelper.cacheKeyOverride,t);var a={alias:H.aliasPrefix+i.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:te._CacheStrategy.CacheAndNetwork,extraProps:n};return e.canCacheRequest&&!i.isPaginationRequest(e)||(a.cacheStrategy=te._CacheStrategy.NetworkOnly),a}):Promise.resolve(i.getRequestCacheOptions(e))},this.parseHttpClientResponse=function(e,t,n){i._extraData=u(t),i._extraData.responseStatus="".concat(e.status);var a="".concat(e.correlationId),r="".concat(e.statusMessage),o="".concat(e.statusText);if(i._extraData.correlationId=a,i._extraData.message=r,i._extraData.statusText=o,e.ok)return e.json().then(function(e){return i.processRawData(e,t,n)}).catch(function(e){throw n.writeUnexpectedFailure("Unexpected",e,i._extraData),e});var s=new Error(r||o);return n.writeUnexpectedFailure("Unexpected",s,i._extraData),Promise.reject(new ie(e.status,s.message))},this.processRawData=function(e,t,n){var a=i.getRawItems(e),r=H.getPaddingCount(t,a?a.length:0),o=!a||0===a.length;i._logEmptyResultToQos(o,e);var s=o?[]:i._extractNewsItems(a);return s=s.concat(H.getEmptyStateItems(t.emptyItemType,i.options.serviceScope,r,t.webpartWidth)),n.writeSuccess(i._extraData),s},this._extractNewsItems=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return i.extractNewsItemsCallback(e,i._pageContext,t)},this._getBaseCacheKey=function(n){var a,r={userId:null===(a=i._pageContext.aadInfo)||void 0===a?void 0:a.userId.toString(),source:i.id,count:n.count};if(e._SPKillSwitch.isActivated("2dd92e7a-2f47-4ce7-b680-630d2dbf8afd"))r=(0,ee.__assign)((0,ee.__assign)({},r),{rootUrl:i.rootUrl});else{r=(0,ee.__assign)((0,ee.__assign)({},r),{spInstanceId:me(i._pageContext.legacyPageContext)});var o=new t._QosMonitor("".concat(i.qosMonitorLabel,".SPInstanceId.Availability"));r.spInstanceId?o.writeSuccess():o.writeUnexpectedFailure("SPInstanceIdNotAvailable")}return r},this._getCacheKeyOverrideAsync=function(e){if(i.cacheKeyOverrideEnabled)return k.TieredCacheHelperOnDemand.generateCacheKey(i.getKeyOverride(e))},this._getHeaders=function(t){var n=i.getExtraHeaders(t);if(e._SPKillSwitch.isActivated("a3571ffd-77f7-4329-b518-6f9038ef21d4")||(n||(n=new Map),e._SPKillSwitch.isActivated("cb7ada7b-46f9-4dc0-b833-b7da78c63ded")?n.set("Caller","PagesWeb"):n.set("Caller",t.callerHeader)),"POST"===i.httpMethod||n){var a=new F(i.httpMethod);return null==n||n.forEach(function(e,t){a[t]=e}),a}},this._onCacheThenNetworkServerDataNotReturned=function(e,t,n){var a;null===(a=n.onCacheThenNetworkServerDataNotReturned)||void 0===a||a.call(n,e,t),i._onCacheThenNetworkServerDataReturned(Promise.resolve([]),e,t)},this._onCacheThenNetworkServerDataReturned=function(e,t,n){var a=t&&n,r=a?he:"";e.then(function(e){var n=i._isEmptyResponse(e);if(n||a){var o=n?be:"";i._writeToEmptyResultsMonitor(t,"".concat(r).concat(o).concat(_e))}}).catch(function(e){i._writeToEmptyResultsMonitor(t,"".concat(r).concat(be).concat("_Response_Parse_Error"),e)})},this._isEmptyResponse=function(e){var t=e&&e.filter(function(e){return!(null==e?void 0:e.isHelpArticle)});return!(null==t?void 0:t.length)},this._logEmptyResultToQos=function(e,n){var a=new t._QosMonitor("".concat(i.qosMonitorLabel,".getNewsItems.EmptyResults"));e?a.writeUnexpectedFailure(_e,new Error("200 ".concat(i.getRawItems(n)?"0 Items":"No Items")),i._extraData):a.writeSuccess(i._extraData)},this._requestData=function(e){return k.TieredCacheHelper.executeCacheStrategy(i.getCacheProps(e),i.executeRequest,e)},this._writeToEmptyResultsMonitor=function(e,n,a){var r=new t._QosMonitor("GetNewsItems.ZeroResult");i._extraData.mySiteCacheHit=e,i._extraData.dataProvider=i.qosMonitorLabel,i._extraData.source=n,a?r.writeUnexpectedFailure(n,a,i._extraData):e&&n==="".concat(he).concat(be).concat(_e)?r.writeExpectedFailure(n,new Error("Expected Cache and Server Empty Result"),i._extraData):r.writeSuccess(i._extraData)},this.options=n,this.options.serviceScope.whenFinished(function(){i._pageContext=i.options.serviceScope.consume(a.PageContext.serviceKey)})}return n.prototype.getKeyOverride=function(e){return this._getBaseCacheKey(e)},n}());var ve=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.id="hubNews",n.title=f.ZK,n.getRequestBody=function(e){var t=!!e.filterKQLQuery&&""!==e.filterKQLQuery,n={hubs:["".concat(e.hubId)],filterByAudience:!!e.audienceTargetingEnabled};return t&&(n.filterQuery=e.filterKQLQuery),(O()||e.languageOverride)&&(n.preferredLanguage=e.languageOverride),n},n.getAPIPath=function(t){if(e._SPKillSwitch.isActivated("288d9962-ca40-4f1b-b448-21c5b1974cc3")){var a=i.UriEncoding.escapeUrlForCallback(n._pageContext.web.absoluteUrl),r="?$expand=analytics($expand=allTime),thumbnails&$top=".concat(t.count);return n.isPaginationRequest(t)?n.nextLink:a+"/_api/v2.1/getMultiHubNews"+r}return Q(n._pageContext.web.absoluteUrl,t.count,n.isPaginationRequest(t),n.nextLink)},n}return(0,ee.__extends)(n,t),Object.defineProperty(n.prototype,"qosMonitorLabel",{get:function(){return"VroomHubNewsDataProvider"},enumerable:!1,configurable:!0}),n}(ge),ye=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="hubNews",t.title=f.ZK,t.executeRequest=function(e){var n={alias:H.aliasPrefix+t.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:te._CacheStrategy.CacheAndNetwork,extraProps:new Map([[k.TieredCacheHelper.useStalePropName,!0]])};return e.canCacheRequest||(n.cacheStrategy=te._CacheStrategy.NetworkOnly),t._sphomeHttpClient.post(t.getMicroservicePath(e),H.getFilterQueryBody(e.filterKQLQuery),void 0,void 0,n)},t}return(0,ee.__extends)(t,e),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"HubNewsDataSource"},enumerable:!1,configurable:!0}),t.prototype.extractMicroserviceNewsItems=function(e){return H.extractMicroserviceNewsItems(e,this._pageContext,!0)},t.prototype.getMicroservicePath=function(e){var t="departmentId=".concat(e.hubId,"&start=").concat(e.skip,"&count=").concat(e.count);return t+=d(e),t+=l(e),"".concat("news/hub/filtered","?").concat(t)},t}(fe);const Se=function(){function e(e){return this.id="hubNews",this.title=f.ZK,e.shouldUseMicroservice?this._instance=new ye(e):this._instance=new ve(e),this._instance}return Object.defineProperty(e.prototype,"qosMonitorLabel",{get:function(){return"HubNewsDataProvider"},enumerable:!1,configurable:!0}),e.prototype.requestData=function(e){return this._instance.requestData(e)},e}(),De=function(){function t(t){var n=this;return this.id="News",this.title=f.$g,this._qosMonitorLabel="NewsreelDataSource",this._executeRequest=function(t){var a,i,r={metadataFilter:t.serializedFilterQuery,languageOverride:t.languageOverride},o={body:JSON.stringify(r),headers:new F("POST"),method:"POST"},s={alias:H.aliasPrefix+n.id,id:t.webpartId,expirationDuration:6e5,cacheStrategy:te._CacheStrategy.CacheAndNetwork,extraProps:new Map([[k.TieredCacheHelper.useStalePropName,!0]])};t.canCacheRequest||(s.cacheStrategy=te._CacheStrategy.NetworkOnly);var c=W(n._absoluteUrl,t.audienceTargetingEnabled,t.count,t.skip);if(!e._SPKillSwitch.isActivated("3fab51ae-728c-4dd6-a12c-c7beaf047b15")){var d=null===(a=window.__webpartPrefetch)||void 0===a?void 0:a.get(t.webpartId);if(d){var l=new URL(c.toLowerCase()),u=d.qos,f=d.query1BodyLower===(null===(i=null==o?void 0:o.body)||void 0===i?void 0:i.toString().toLowerCase()),p=d.query1UrlLower.toString()===l.toString(),m=(0,k.compareHeaders)(d.headers,new Headers(o.headers));if(f&&p&&m){if(u&&u.writeSuccess(),d.query1)return d.query1}else u&&u.writeUnexpectedFailure(void 0,void 0,{bodyMatch:f,urlMatch:p,headersMatch:m})}}return e._SPKillSwitch.isActivated("cf1609be-90ce-4804-a8a7-06ac3c181dda")&&(c=n._getNewsItemsUrl(t)),n._spHttpClient.fetch(c,ne.SPHttpClient.configurations.v1,o,s)},this._isEmptyResponse=function(e){var t=null==e?void 0:e.filter(function(e){return!(null==e?void 0:e.isHelpArticle)});return!(null==t?void 0:t.length)},this._isRawData=function(e){return null==e?void 0:e.value},this._parseSPHttpClientResponse=function(e,t,a){var i=u(t),r=n._isInSmartRace?"NewsreelDataSource.getNewsItemsInSmartRace":"NewsreelDataSource.getNewsItems",o=a||new ae._QosMonitor(r);if(i.correlationId="".concat(e.correlationId),i.responseStatus="".concat(e.status),i.message=e.statusMessage,e.ok)return e.json().then(function(e){var a=n._processRawData(e,t);return o.writeSuccess(i),a}).catch(function(t){throw o.writeUnexpectedFailure("Unexpected",t,i),new ie(e.status,t.message)});var s=new Error(e.statusMessage);return o.writeUnexpectedFailure("Unexpected",s,i),Promise.reject(new ie(e.status,s.message))},this._processRawData=function(e,t){var a=H.getPaddingCount(t,e.value?e.value.length:0);return(e.value&&e.value.length>0?H.extractNewsItems(e.value,n._pageContext):[]).concat(H.getEmptyStateItems(t.emptyItemType,n.options.serviceScope,a,t.webpartWidth))},this.options=t,this.options.serviceScope.whenFinished(function(){var e;n._spHttpClient=n.options.serviceScope.consume(ne.SPHttpClient.serviceKey),n._pageContext=n.options.serviceScope.consume(a.PageContext.serviceKey),n._absoluteUrl=null===(e=n._pageContext)||void 0===e?void 0:e.web.absoluteUrl}),i.Locale.language||(i.Locale.language="en-us"),this}return t.prototype.requestData=function(e){var t=this;if(!E()){var n={parseHttpClientResponse:this._parseSPHttpClientResponse,isEmptyResponse:this._isEmptyResponse,isRawData:this._isRawData,processRawData:this._processRawData,qosMonitorLabel:this._qosMonitorLabel,onServerResponseResolvedWithCache:e.onServerResponseResolvedWithCache,onServerResponseResolved:e.onServerResponseResolved,onServerResponseFailed:e.onServerResponseFailed,onCacheResponseResolved:e.onCacheResponseResolved,onCacheResponseFailed:e.onCacheResponseFailed};return k.TieredCacheHelper.executeCacheStrategy(n,this._executeRequest,e)}return this._executeRequest(e).then(function(n){if(n instanceof ne.SPHttpClientResponse)return t._parseSPHttpClientResponse(n,e);var a=n;return t._applyCacheAndNetwork(a,e)||t._parseClientCachableResponse(n,e)})},t.prototype._applyCacheAndNetwork=function(t,n){var a=this;if(t.serverResponse&&t.cachedResponse){this._isInSmartRace=!0;var i=t.serverResponse.then(function(e){return a._parseSPHttpClientResponse(e,n)}).then(function(e){var t=a._isEmptyResponse(e);return n.onServerResponseResolved(t),e}).catch(function(e){throw n.onServerResponseFailed(e),e}),r=k.TieredCacheHelper.processResponseRawData(t.cachedResponse,this._isRawData,this._processRawData.bind(this),n).then(function(e){var t=a._isEmptyResponse(e);return n.onCacheResponseResolved(t),e||[]}).catch(function(e){throw n.onCacheResponseFailed(e),e}),s=e.Guid.parse("9b794e3a-a041-4fb4-870d-a1121ca57ca7"),c=e.Guid.parse("4d757517-a42f-4546-a76a-8d0da7dd2a07"),d=[{raceablePromise:r,raceId:s},{raceablePromise:i,raceId:c}];return o.SmartRace.race(d).then(function(e){return e.raceId===s&&i.then(function(e){n.onServerResponseResolvedWithCache(e)}).catch(function(){}),e.raceablePromise})}},t.prototype._getNewsItemsUrl=function(e){var t=i.UriEncoding.escapeUrlForCallback(this._absoluteUrl),n="/_api/sitepages/pages/"+(e.audienceTargetingEnabled?"FeedTargeted":"feed")+"?promotedstate=2&published=true",a="&$skip="+(e.skip?e.skip.toString():"0"),r="&$top="+(e.count>0?e.count.toString():""),o="&$select=Description,BannerImageUrl,BannerThumbnailUrl,AbsoluteUrl,FirstPublished,Title,FileName,Id,UniqueId,ListId,OriginalSourceItemId,OriginalSourceUrl,Path";return H.isCallToActionEnabled()&&(o+=",CallToAction"),t+n+"&$filter=not startswith(ContentTypeId ,'0x0101009D1CB255DA76424F860D91F20E6C4118002A50BFCFB7614729B56886FADA02339B00873E381CC9DD4F2E808A377A72C311BB')"+a+r+"&$expand=CreatedBy"+o},t.prototype._parseClientCachableResponse=function(e,t){var n,a=this,i=null===(n=e.serverResponse)||void 0===n?void 0:n.then(function(e){return a._parseSPHttpClientResponse(e,t)}).then(function(e){var n=a._isEmptyResponse(e);return t.onServerResponseResolved(n),e}).catch(function(e){throw t.onServerResponseFailed(e),e});return e.cachedResponse?(i&&i.then(function(e){t.onServerResponseResolvedWithCache(e)}).catch(function(){}),k.TieredCacheHelper.processResponseRawData(e.cachedResponse,this._isRawData,this._processRawData.bind(this),t).then(function(e){var n=a._isEmptyResponse(e);return t.onCacheResponseResolved(n),e||[]}).catch(function(e){throw t.onCacheResponseFailed(e),e})):i},t}(),Ie=function(){function e(e){this.id=V,this.title="NewsDigest",this.options=e}return e.prototype.requestData=function(e){var t=this.options.newsItems||[];return Promise.resolve(t)},e}();var xe=function(){function n(t,n,a){return e.Validate.isNotNullOrUndefined(t,"pageContext"),this._pageContext=t,this._spHttpClient=n,this._newsDigestBubbleType=a,this._absoluteUrl=this._pageContext.web.absoluteUrl,this}return Object.defineProperty(n.prototype,"_newsDigestFirstExperienceBitRestApiUrl",{get:function(){var e,t,n;return L()?this._absoluteUrl+"/_api/SP.Directory.DirectorySession/GetGraphUser(principalName='"+i.UriEncoding.encodeURIComponent(this._pageContext.user.loginName)+"')":this._absoluteUrl+"/_api/SP.Directory.DirectorySession/User(id='"+i.UriEncoding.encodeURIComponent(null!==(n=null===(t=null===(e=this._pageContext.aadInfo)||void 0===e?void 0:e.userId)||void 0===t?void 0:t.toString())&&void 0!==n?n:"")+"')"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_newsDigestFirstExperienceBitRestUrl",{get:function(){return this._newsDigestFirstExperienceBitRestApiUrl+"?$select="+this._newsDigestBubbleType},enumerable:!1,configurable:!0}),n.readCachedFirstRunExperience=function(e){var t=window.localStorage.getItem(e);if(t)return"true"===t},n.prototype.writeCachedFirstRunExperience=function(e){var a=this._newsDigestBubbleType,i=window.localStorage.getItem(a),r=String(e);if(i!==r)try{window.localStorage.setItem(a,r)}catch(e){t._TraceLogger.logError(n._logSource,e)}},n.prototype.showFirstRun=function(){if(!e._SPKillSwitch.isActivated("9f4c266b-806e-4aaf-af81-d4e4b2b7dc7a"))return Promise.resolve(!1);var a=n.readCachedFirstRunExperience(this._newsDigestBubbleType);return!0===a?(t._TraceLogger.logVerbose(n._logSource,this._newsDigestBubbleType+" is true in the local storage"),Promise.resolve(!1)):!1===a?(t._TraceLogger.logVerbose(n._logSource,this._newsDigestBubbleType+" is false in the local storage"),Promise.resolve(!0)):this._getFirstRunBitApi()},n.prototype.setFirstRunSeen=function(e){var a=this,i=new ae._QosMonitor("SetNewsDigestFirstRunExperienceAPI"),r={};r[this._newsDigestBubbleType]=Boolean(e);var o="application/json; odata=minimalmetadata",s=new Headers;return s.append("Accept","*/*, ".concat(o)),s.append("Content-Type",o),s.append("X-HTTP-Method","PATCH"),s.append("X-ClientType","NewsDigest_SetFirstRunBit"),L()||s.append("X-SessionOptions","SkipResolveInPrincipalAdapter"),this._spHttpClient.post(this._newsDigestFirstExperienceBitRestApiUrl,ne.SPHttpClient.configurations.v1,{body:JSON.stringify(r),headers:s}).then(function(r){t._TraceLogger.logVerbose(n._logSource,"Set news digest first run bit to API: ".concat(e)),i.writeSuccess(),a.writeCachedFirstRunExperience(e)}).catch(function(e){throw t._TraceLogger.logError(n._logSource,e),i.writeUnexpectedFailure("SetNewsDigestFirstRunExperienceAPI",e),e})},n.prototype._getFirstRunBitApi=function(){var e,a=this,i=new ae._QosMonitor("GetNewsDigestFirstRunExperienceAPI"),r=new Headers;if(r.append("X-ClientType","NewsDigest_GetFirstRunBit"),!L()){r.append("X-SessionOptions","SkipResolveInPrincipalAdapter");var o=null===(e=this._pageContext.aadInfo)||void 0===e?void 0:e.userId;if(!o||o===pe.Guid.Empty)return t._TraceLogger.logVerbose(n._logSource,"AAD UserId is null or empty: ".concat(o)),Promise.resolve(!1)}return this._spHttpClient.get(this._newsDigestFirstExperienceBitRestUrl,ne.SPHttpClient.configurations.v1,{headers:r}).then(function(e){return e.json()}).then(function(e){var r=e[a._newsDigestBubbleType];return t._TraceLogger.logVerbose(n._logSource,"Get news digest first run bit from API, status: ".concat(r)),i.writeSuccess(),a.writeCachedFirstRunExperience(r),!r}).catch(function(e){return t._TraceLogger.logError(n._logSource,e),i.writeUnexpectedFailure("FailedToGetNewsDigestFirstExperienceError",e),!1})},n._logSource=t._LogSource.create("NewsDigestFirstRunDataProvider"),n}(),Ce=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._mapResponse=function(e){var n=H.extractNewsItemsFromSearch(e.rows,t._pageContext);return Promise.resolve(n)},t}return(0,ee.__extends)(t,e),t._requestNewsData=function(e){var n="ContentTypeId:".concat("0x0101009D1CB255DA76424F860D91F20E6C4118","* AND PromotedState:2 AND (NOT ContentTypeId:").concat("0x0101009D1CB255DA76424F860D91F20E6C4118002A50BFCFB7614729B56886FADA02339B00873E381CC9DD4F2E808A377A72C311BB","*)"),a=[];return e.uniqueIdGuids?(a.push("".concat(n," AND (")),e.uniqueIdGuids.forEach(function(e,t){0===t?a.push("UniqueID:".concat(e.toString())):a.push(" OR UniqueID:".concat(e.toString())),a.push(" OR UniqueID:{".concat(e.toString(),"}"))}),a.push(")")):a.push("{searchterms} ".concat(n)),t._request(e,a.join(""))},t._request=function(e,n){return new t({serviceScope:e.serviceScope}).requestData({searchOptions:{query:{contentLocation:e.contentLocation}},searchAPIQueryOptions:{Properties:[{Name:"EnableDynamicGroups",Value:{BoolVal:!0,QueryPropertyValueTypeIndex:3}},{Name:"EnableMultiGeoSearch",Value:{BoolVal:!0,QueryPropertyValueTypeIndex:3}}],Querytext:e.searchText||"",QueryTemplate:n,RowLimit:e.rowLimit,SelectProperties:["CreatedBy","AuthorOWSUSER","Description","PictureThumbnailURL","FirstPublishedDate","Title","FileName","ListItemId","OriginalPath","Path","SiteTitle","SPSiteURL","SPWebUrl","ViewCountLifetime","UniqueID","SiteID","WebId","ListId"],SortList:[{Property:"LastModifiedTime",Direction:k.SearchAPISortDirection.descending}],StartRow:e.startRow,TrimDuplicates:!0}})},t}(k.SearchDataProvider),Oe=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.id="MultiSiteNews",n.title=f.Nb,n.getRequestBody=function(e){var t=[];e.siteList.forEach(function(e){t.push("".concat(e.ItemReference.SiteId,",").concat(e.ItemReference.WebId))});var n=!!e.filterKQLQuery&&""!==e.filterKQLQuery,a={sites:t,filterByAudience:!!e.audienceTargetingEnabled};return n&&(a.filterQuery=e.filterKQLQuery),(O()||e.languageOverride)&&(a.preferredLanguage=e.languageOverride),a},n.getAPIPath=function(t){if(e._SPKillSwitch.isActivated("288d9962-ca40-4f1b-b448-21c5b1974cc3")){var a=i.UriEncoding.escapeUrlForCallback(n._pageContext.web.absoluteUrl),r="?$expand=analytics($expand=allTime),thumbnails&$top=".concat(t.count);return n.isPaginationRequest(t)?n.nextLink:a+"/_api/v2.1/getMultiSiteNews"+r}return q(n._pageContext.web.absoluteUrl,t.count,n.isPaginationRequest(t),n.nextLink)},n}return(0,ee.__extends)(n,t),Object.defineProperty(n.prototype,"qosMonitorLabel",{get:function(){return"VroomMultiSiteNewsDataProvider"},enumerable:!1,configurable:!0}),n}(ge),we=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="MultiSiteNews",t.title=f.Nb,t.executeRequest=function(e){var n={alias:H.aliasPrefix+t.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:te._CacheStrategy.CacheAndNetwork,extraProps:new Map([[k.TieredCacheHelper.useStalePropName,!0]])};return e.canCacheRequest||(n.cacheStrategy=te._CacheStrategy.NetworkOnly),t._sphomeHttpClient.post(t.getMicroservicePath(e),t._getSiteListAndFilterBody(e.siteList,e.filterKQLQuery),void 0,void 0,n)},t}return(0,ee.__extends)(t,e),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"MultiSiteNewsDataSource"},enumerable:!1,configurable:!0}),t.prototype.requestData=function(t){var n;return(null===(n=t.siteList)||void 0===n?void 0:n.length)?e.prototype.requestData.call(this,t):Promise.resolve(this._getNewsItemsWithPadding(t,0))},t.prototype.extractMicroserviceNewsItems=function(e){return H.extractMicroserviceNewsItems(e,this._pageContext,!0)},t.prototype.getMicroservicePath=function(e){var t="mainSiteUrl=".concat(this._pageContext.site.absoluteUrl,"&"),n="start=".concat(e.skip,"&count=").concat(e.count);n+=d(e),n+=l(e);var a=this._shouldQueryCurrentSite(e.siteList||[]);return"".concat("news/sites/filtered","?").concat(a?t:"").concat(n)},t.prototype._getNewsItemsWithPadding=function(e,t){var n=H.getPaddingCount(e,t);return H.getEmptyStateItems(e.emptyItemType,this.options.serviceScope,n,e.webpartWidth)},t.prototype._shouldQueryCurrentSite=function(e){var t=this._pageContext.site.id.toString(),n=this._pageContext.web.id.toString();return M.findIndex(e,function(e){return e.ItemReference.SiteId===t&&e.ItemReference.WebId===n})>-1},t.prototype._getSiteListAndFilterBody=function(e,t){return JSON.stringify({ReferenceList:this._getSiteListBody(e),FilterQuery:t})},t.prototype._getSiteListBody=function(e){return e.map(function(e){return{Type:"SiteReference",SiteId:e.ItemReference.SiteId,WebId:e.ItemReference.WebId}})},t}(fe);const Ee=function(){function e(e){return this.id="MultiSiteNews",this.title=f.Nb,e.shouldUseMicroservice?this._instance=new we(e):this._instance=new Oe(e),this._instance}return Object.defineProperty(e.prototype,"qosMonitorLabel",{get:function(){return"MultiSiteNewsDataProvider"},enumerable:!1,configurable:!0}),e.prototype.requestData=function(e){return this._instance.requestData(e)},e}();var Ae=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.id="myNews",n.title=f.l,n.getAPIPath=function(t){if(e._SPKillSwitch.isActivated("6e06dcbf-8ab2-4c5f-aa22-1b2a80fcadb5")){var a=i.UriEncoding.escapeUrlForCallback(n._pageContext.web.absoluteUrl),r="section=SharePointNewsFeedTargeted&$expand=analytics($expand=allTime),thumbnails&$top=".concat(t.count);if(n.isPaginationRequest(t))return n.nextLink;var o=new i.Uri(i.Uri.concatenate(a,"/_api/v2.1/getNewsFeed"));return o.setQuery(r),!A()&&t.languageOverride&&o.setQueryParameter("preferredLanguage",t.languageOverride),o.toString()}return Y(n._pageContext.web.absoluteUrl,t.count,n.isPaginationRequest(t),t.languageOverride,n.nextLink)},n.getExtraHeaders=function(e){var t=new Map;return t.set("scenario","SPNewsWebpart"),t},n}return(0,ee.__extends)(n,t),Object.defineProperty(n.prototype,"httpMethod",{get:function(){return"GET"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"qosMonitorLabel",{get:function(){return"VroomMyNewsDataSource"},enumerable:!1,configurable:!0}),n}(ge),Le=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="myNews",t.title=f.l,t.executeRequest=function(e){var n={alias:H.aliasPrefix+t.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:te._CacheStrategy.CacheAndNetwork,extraProps:new Map([[k.TieredCacheHelper.useStalePropName,!0]])};return e.canCacheRequest||(n.cacheStrategy=te._CacheStrategy.NetworkOnly),t._sphomeHttpClient.post(t.getMicroservicePath(e),H.getFilterQueryBody(e.filterKQLQuery),void 0,void 0,n)},t}return(0,ee.__extends)(t,e),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"MyNewsDataSource"},enumerable:!1,configurable:!0}),t.prototype.getMicroservicePath=function(e){var t="start=".concat(e.skip,"&count=").concat(e.count);return t+=d(e),t+=l(e),"".concat("news/filtered","?").concat(t)},t}(fe);const ke=function(){function e(e){return this.id="myNews",this.title=f.l,e.shouldUseMicroservice?this._instance=new Le(e):this._instance=new Ae(e),this._instance}return Object.defineProperty(e.prototype,"qosMonitorLabel",{get:function(){return"MyNewsDataSource"},enumerable:!1,configurable:!0}),e.prototype.requestData=function(e){return this._instance.requestData(e)},e}(),Me=function(){function t(e){var t=this;this.id="VroomViewCountsDataProvider",this.title="",this._getAPIPath=function(){return i.UriEncoding.escapeUrlForCallback(t._pageContext.web.absoluteUrl)+"/_api/v2.1/getItems?$expand=analytics($expand=allTime)"},this.options=e,this.options.serviceScope.whenFinished(function(){t._pageContext=t.options.serviceScope.consume(a.PageContext.serviceKey),t._spHttpClient=e.serviceScope.consume(ne.SPHttpClient.serviceKey)})}return t.prototype.requestData=function(e){return this._createRequestForItems(e)},t.prototype._getVroomOptions=function(e){return{headers:{Caller:"PagesWeb",method:"POST","Content-Type":"application/json"},body:JSON.stringify({items:this._getPayload(e)})}},t.prototype._getPayload=function(e){return 0===e.length?[]:e.map(function(e){var t;return{id:e.uniqueId,listId:null!==(t=e.listId)&&void 0!==t?t:"00000000-0000-0000-0000-000000000000",siteId:"".concat(e.siteId,",").concat(e.webId)}})},t.prototype._createRequestForItems=function(e){var n=this,a=new ae._QosMonitor(this.id),i=this._getVroomOptions(e),r={};return 0===e.length?Promise.resolve([]):this._spHttpClient.post(this._getAPIPath(),t._spHttpClientConfig,i).then(function(t){var i="".concat(t.correlationId),o="".concat(t.statusMessage),s="".concat(t.statusText);if(r.responseStatus="".concat(t.status),r.correlationId=i,r.message=o,r.statusText=s,t.ok)return t.json().then(function(t){return e=n._addViewCountsToItems(e,t.value),a.writeSuccess(r),e}).catch(function(e){throw a.writeUnexpectedFailure("Unexpected",e,r),e});var c=new Error(o||s);return a.writeUnexpectedFailure("Unexpected",c,r),e}).catch(function(t){return a.hasEnded||a.writeUnexpectedFailure("Unexpected",t,r),e})},t.prototype._addViewCountsToItems=function(t,n){return t.map(function(t){var a=n.filter(function(n){return e._SPKillSwitch.isActivated("ea037a63-de6d-4dfb-a286-ae8b0e5873a8")?n.sharepointIds.listItemUniqueId===t.uniqueId||n.sharepointIds.siteId===t.siteId&&n.sharepointIds.webId===t.webId&&n.sharepointIds.listItemId===t.listItemId:n.sharepointIds.webId===t.webId&&n.sharepointIds.siteId===t.siteId&&n.sharepointIds.listId===t.listId&&n.sharepointIds.listItemUniqueId===t.uniqueId})[0];return t.viewCounts=void 0!==a?Number(a.analytics.allTime.access.actionCount):void 0,t})},t._spHttpClientConfig=new ne.SPHttpClientConfiguration(ne.SPHttpClient.configurations.v1,{requestDigest:!0,defaultSameOriginCredentials:!0}),t}()})(),g})())})();