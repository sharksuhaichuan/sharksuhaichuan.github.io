/*! For license information please see sp-transpile-components_en-us_90e004c326000881cb39.js.LICENSE.txt */
(()=>{var e=document.currentScript;define("562e7236-4406-4276-a3dc-49a0f5f64ae9_0.1.0",["@microsoft/sp-lodash-subset","@microsoft/sp-core-library","@microsoft/sp-image-helper","@ms/sp-component-utilities","@microsoft/sp-diagnostics","@ms/odsp-core-bundle","tslib","@ms/odsp-utilities-bundle","@ms/sp-renderable-components-base"],(t,n,a,i,r,o,s,c,d)=>(()=>{var l,u={205:function(e){e.exports=function(){"use strict";const{entries:e,setPrototypeOf:t,isFrozen:n,getPrototypeOf:a,getOwnPropertyDescriptor:i}=Object;let{freeze:r,seal:o,create:s}=Object,{apply:c,construct:d}="undefined"!=typeof Reflect&&Reflect;r||(r=function(e){return e}),o||(o=function(e){return e}),c||(c=function(e,t,n){return e.apply(t,n)}),d||(d=function(e,t){return new e(...t)});const l=x(Array.prototype.forEach),u=x(Array.prototype.pop),f=x(Array.prototype.push),p=x(String.prototype.toLowerCase),m=x(String.prototype.toString),_=x(String.prototype.match),h=x(String.prototype.replace),b=x(String.prototype.indexOf),g=x(String.prototype.trim),v=x(Object.prototype.hasOwnProperty),y=x(RegExp.prototype.test),S=(D=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return d(D,t)});var D;function I(e){return"number"==typeof e&&isNaN(e)}function x(e){return function(t){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];return c(e,t,a)}}function C(e,a){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p;t&&t(e,null);let r=a.length;for(;r--;){let t=a[r];if("string"==typeof t){const e=i(t);e!==t&&(n(a)||(a[r]=e),t=e)}e[t]=!0}return e}function O(e){for(let t=0;t<e.length;t++)v(e,t)||(e[t]=null);return e}function w(t){const n=s(null);for(const[a,i]of e(t))v(t,a)&&(Array.isArray(i)?n[a]=O(i):i&&"object"==typeof i&&i.constructor===Object?n[a]=w(i):n[a]=i);return n}function E(e,t){for(;null!==e;){const n=i(e,t);if(n){if(n.get)return x(n.get);if("function"==typeof n.value)return x(n.value)}e=a(e)}return function(){return null}}const A=r(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),L=r(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),k=r(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),M=r(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),P=r(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),T=r(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),U=r(["#text"]),F=r(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),H=r(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),R=r(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),N=r(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),B=o(/\{\{[\w\W]*|[\w\W]*\}\}/gm),j=o(/<%[\w\W]*|[\w\W]*%>/gm),V=o(/\${[\w\W]*}/gm),z=o(/^data-[\-\w.\u00B7-\uFFFF]/),G=o(/^aria-[\-\w]+$/),K=o(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),W=o(/^(?:\w+script|data):/i),q=o(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Q=o(/^html$/i),Y=o(/^[a-z][.\w]*(-[.\w]+)+$/i);var J=Object.freeze({__proto__:null,MUSTACHE_EXPR:B,ERB_EXPR:j,TMPLIT_EXPR:V,DATA_ATTR:z,ARIA_ATTR:G,IS_ALLOWED_URI:K,IS_SCRIPT_OR_DATA:W,ATTR_WHITESPACE:q,DOCTYPE_NAME:Q,CUSTOM_ELEMENT:Y});const X=function(){return"undefined"==typeof window?null:window},Z=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let n=null;const a="data-tt-policy-suffix";t&&t.hasAttribute(a)&&(n=t.getAttribute(a));const i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML:e=>e,createScriptURL:e=>e})}catch(e){return console.warn("TrustedTypes policy "+i+" could not be created."),null}};return function t(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X();const a=e=>t(e);if(a.version="3.1.4",a.removed=[],!n||!n.document||9!==n.document.nodeType)return a.isSupported=!1,a;let{document:i}=n;const o=i,c=o.currentScript,{DocumentFragment:d,HTMLTemplateElement:D,Node:x,Element:O,NodeFilter:B,NamedNodeMap:j=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:V,DOMParser:z,trustedTypes:G}=n,W=O.prototype,q=E(W,"cloneNode"),Y=E(W,"nextSibling"),$=E(W,"childNodes"),ee=E(W,"parentNode");if("function"==typeof D){const e=i.createElement("template");e.content&&e.content.ownerDocument&&(i=e.content.ownerDocument)}let te,ne="";const{implementation:ae,createNodeIterator:ie,createDocumentFragment:re,getElementsByTagName:oe}=i,{importNode:se}=o;let ce={};a.isSupported="function"==typeof e&&"function"==typeof ee&&ae&&void 0!==ae.createHTMLDocument;const{MUSTACHE_EXPR:de,ERB_EXPR:le,TMPLIT_EXPR:ue,DATA_ATTR:fe,ARIA_ATTR:pe,IS_SCRIPT_OR_DATA:me,ATTR_WHITESPACE:_e,CUSTOM_ELEMENT:he}=J;let{IS_ALLOWED_URI:be}=J,ge=null;const ve=C({},[...A,...L,...k,...P,...U]);let ye=null;const Se=C({},[...F,...H,...R,...N]);let De=Object.seal(s(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ie=null,xe=null,Ce=!0,Oe=!0,we=!1,Ee=!0,Ae=!1,Le=!0,ke=!1,Me=!1,Pe=!1,Te=!1,Ue=!1,Fe=!1,He=!0,Re=!1;const Ne="user-content-";let Be=!0,je=!1,Ve={},ze=null;const Ge=C({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ke=null;const We=C({},["audio","video","img","source","image","track"]);let qe=null;const Qe=C({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ye="http://www.w3.org/1998/Math/MathML",Je="http://www.w3.org/2000/svg",Xe="http://www.w3.org/1999/xhtml";let Ze=Xe,$e=!1,et=null;const tt=C({},[Ye,Je,Xe],m);let nt=null;const at=["application/xhtml+xml","text/html"],it="text/html";let rt=null,ot=null;const st=255,ct=i.createElement("form"),dt=function(e){return e instanceof RegExp||e instanceof Function},lt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!ot||ot!==e){if(e&&"object"==typeof e||(e={}),e=w(e),nt=-1===at.indexOf(e.PARSER_MEDIA_TYPE)?it:e.PARSER_MEDIA_TYPE,rt="application/xhtml+xml"===nt?m:p,ge=v(e,"ALLOWED_TAGS")?C({},e.ALLOWED_TAGS,rt):ve,ye=v(e,"ALLOWED_ATTR")?C({},e.ALLOWED_ATTR,rt):Se,et=v(e,"ALLOWED_NAMESPACES")?C({},e.ALLOWED_NAMESPACES,m):tt,qe=v(e,"ADD_URI_SAFE_ATTR")?C(w(Qe),e.ADD_URI_SAFE_ATTR,rt):Qe,Ke=v(e,"ADD_DATA_URI_TAGS")?C(w(We),e.ADD_DATA_URI_TAGS,rt):We,ze=v(e,"FORBID_CONTENTS")?C({},e.FORBID_CONTENTS,rt):Ge,Ie=v(e,"FORBID_TAGS")?C({},e.FORBID_TAGS,rt):{},xe=v(e,"FORBID_ATTR")?C({},e.FORBID_ATTR,rt):{},Ve=!!v(e,"USE_PROFILES")&&e.USE_PROFILES,Ce=!1!==e.ALLOW_ARIA_ATTR,Oe=!1!==e.ALLOW_DATA_ATTR,we=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Ee=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Ae=e.SAFE_FOR_TEMPLATES||!1,Le=!1!==e.SAFE_FOR_XML,ke=e.WHOLE_DOCUMENT||!1,Te=e.RETURN_DOM||!1,Ue=e.RETURN_DOM_FRAGMENT||!1,Fe=e.RETURN_TRUSTED_TYPE||!1,Pe=e.FORCE_BODY||!1,He=!1!==e.SANITIZE_DOM,Re=e.SANITIZE_NAMED_PROPS||!1,Be=!1!==e.KEEP_CONTENT,je=e.IN_PLACE||!1,be=e.ALLOWED_URI_REGEXP||K,Ze=e.NAMESPACE||Xe,De=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&dt(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(De.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&dt(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(De.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(De.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ae&&(Oe=!1),Ue&&(Te=!0),Ve&&(ge=C({},U),ye=[],!0===Ve.html&&(C(ge,A),C(ye,F)),!0===Ve.svg&&(C(ge,L),C(ye,H),C(ye,N)),!0===Ve.svgFilters&&(C(ge,k),C(ye,H),C(ye,N)),!0===Ve.mathMl&&(C(ge,P),C(ye,R),C(ye,N))),e.ADD_TAGS&&(ge===ve&&(ge=w(ge)),C(ge,e.ADD_TAGS,rt)),e.ADD_ATTR&&(ye===Se&&(ye=w(ye)),C(ye,e.ADD_ATTR,rt)),e.ADD_URI_SAFE_ATTR&&C(qe,e.ADD_URI_SAFE_ATTR,rt),e.FORBID_CONTENTS&&(ze===Ge&&(ze=w(ze)),C(ze,e.FORBID_CONTENTS,rt)),Be&&(ge["#text"]=!0),ke&&C(ge,["html","head","body"]),ge.table&&(C(ge,["tbody"]),delete Ie.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw S('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw S('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');te=e.TRUSTED_TYPES_POLICY,ne=te.createHTML("")}else void 0===te&&(te=Z(G,c)),null!==te&&"string"==typeof ne&&(ne=te.createHTML(""));r&&r(e),ot=e}},ut=C({},["mi","mo","mn","ms","mtext"]),ft=C({},["foreignobject","annotation-xml"]),pt=C({},["title","style","font","a","script"]),mt=C({},[...L,...k,...M]),_t=C({},[...P,...T]),ht=function(e){let t=ee(e);t&&t.tagName||(t={namespaceURI:Ze,tagName:"template"});const n=p(e.tagName),a=p(t.tagName);return!!et[e.namespaceURI]&&(e.namespaceURI===Je?t.namespaceURI===Xe?"svg"===n:t.namespaceURI===Ye?"svg"===n&&("annotation-xml"===a||ut[a]):Boolean(mt[n]):e.namespaceURI===Ye?t.namespaceURI===Xe?"math"===n:t.namespaceURI===Je?"math"===n&&ft[a]:Boolean(_t[n]):e.namespaceURI===Xe?!(t.namespaceURI===Je&&!ft[a])&&!(t.namespaceURI===Ye&&!ut[a])&&!_t[n]&&(pt[n]||!mt[n]):!("application/xhtml+xml"!==nt||!et[e.namespaceURI]))},bt=function(e){f(a.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){e.remove()}},gt=function(e,t){try{f(a.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){f(a.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!ye[e])if(Te||Ue)try{bt(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},vt=function(e){let t=null,n=null;if(Pe)e="<remove></remove>"+e;else{const t=_(e,/^[\r\n\t ]+/);n=t&&t[0]}"application/xhtml+xml"===nt&&Ze===Xe&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const a=te?te.createHTML(e):e;if(Ze===Xe)try{t=(new z).parseFromString(a,nt)}catch(e){}if(!t||!t.documentElement){t=ae.createDocument(Ze,"template",null);try{t.documentElement.innerHTML=$e?ne:a}catch(e){}}const r=t.body||t.documentElement;return e&&n&&r.insertBefore(i.createTextNode(n),r.childNodes[0]||null),Ze===Xe?oe.call(t,ke?"html":"body")[0]:ke?t.documentElement:r},yt=function(e){return ie.call(e.ownerDocument||e,e,B.SHOW_ELEMENT|B.SHOW_COMMENT|B.SHOW_TEXT|B.SHOW_PROCESSING_INSTRUCTION|B.SHOW_CDATA_SECTION,null)},St=function(e){return e instanceof V&&(void 0!==e.__depth&&"number"!=typeof e.__depth||void 0!==e.__removalCount&&"number"!=typeof e.__removalCount||"string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof j)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},Dt=function(e){return"function"==typeof x&&e instanceof x},It=function(e,t,n){ce[e]&&l(ce[e],e=>{e.call(a,t,n,ot)})},xt=function(e){let t=null;if(It("beforeSanitizeElements",e,null),St(e))return bt(e),!0;const n=rt(e.nodeName);if(It("uponSanitizeElement",e,{tagName:n,allowedTags:ge}),e.hasChildNodes()&&!Dt(e.firstElementChild)&&y(/<[/\w]/g,e.innerHTML)&&y(/<[/\w]/g,e.textContent))return bt(e),!0;if(7===e.nodeType)return bt(e),!0;if(Le&&8===e.nodeType&&y(/<[/\w]/g,e.data))return bt(e),!0;if(!ge[n]||Ie[n]){if(!Ie[n]&&Ot(n)){if(De.tagNameCheck instanceof RegExp&&y(De.tagNameCheck,n))return!1;if(De.tagNameCheck instanceof Function&&De.tagNameCheck(n))return!1}if(Be&&!ze[n]){const t=ee(e)||e.parentNode,n=$(e)||e.childNodes;if(n&&t)for(let a=n.length-1;a>=0;--a){const i=q(n[a],!0);i.__removalCount=(e.__removalCount||0)+1,t.insertBefore(i,Y(e))}}return bt(e),!0}return e instanceof O&&!ht(e)?(bt(e),!0):"noscript"!==n&&"noembed"!==n&&"noframes"!==n||!y(/<\/no(script|embed|frames)/i,e.innerHTML)?(Ae&&3===e.nodeType&&(t=e.textContent,l([de,le,ue],e=>{t=h(t,e," ")}),e.textContent!==t&&(f(a.removed,{element:e.cloneNode()}),e.textContent=t)),It("afterSanitizeElements",e,null),!1):(bt(e),!0)},Ct=function(e,t,n){if(He&&("id"===t||"name"===t)&&(n in i||n in ct||"__depth"===n||"__removalCount"===n))return!1;if(Oe&&!xe[t]&&y(fe,t));else if(Ce&&y(pe,t));else if(!ye[t]||xe[t]){if(!(Ot(e)&&(De.tagNameCheck instanceof RegExp&&y(De.tagNameCheck,e)||De.tagNameCheck instanceof Function&&De.tagNameCheck(e))&&(De.attributeNameCheck instanceof RegExp&&y(De.attributeNameCheck,t)||De.attributeNameCheck instanceof Function&&De.attributeNameCheck(t))||"is"===t&&De.allowCustomizedBuiltInElements&&(De.tagNameCheck instanceof RegExp&&y(De.tagNameCheck,n)||De.tagNameCheck instanceof Function&&De.tagNameCheck(n))))return!1}else if(qe[t]);else if(y(be,h(n,_e,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==b(n,"data:")||!Ke[e])if(we&&!y(me,h(n,_e,"")));else if(n)return!1;return!0},Ot=function(e){return"annotation-xml"!==e&&_(e,he)},wt=function(e){It("beforeSanitizeAttributes",e,null);const{attributes:t}=e;if(!t)return;const n={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ye};let i=t.length;for(;i--;){const r=t[i],{name:o,namespaceURI:s,value:c}=r,d=rt(o);let f="value"===o?c:g(c);if(n.attrName=d,n.attrValue=f,n.keepAttr=!0,n.forceKeepAttr=void 0,It("uponSanitizeAttribute",e,n),f=n.attrValue,n.forceKeepAttr)continue;if(gt(o,e),!n.keepAttr)continue;if(!Ee&&y(/\/>/i,f)){gt(o,e);continue}if(Le&&y(/((--!?|])>)|<\/(style|title)/i,f)){gt(o,e);continue}Ae&&l([de,le,ue],e=>{f=h(f,e," ")});const p=rt(e.nodeName);if(Ct(p,d,f)){if(!Re||"id"!==d&&"name"!==d||(gt(o,e),f=Ne+f),te&&"object"==typeof G&&"function"==typeof G.getAttributeType)if(s);else switch(G.getAttributeType(p,d)){case"TrustedHTML":f=te.createHTML(f);break;case"TrustedScriptURL":f=te.createScriptURL(f)}try{s?e.setAttributeNS(s,o,f):e.setAttribute(o,f),St(e)?bt(e):u(a.removed)}catch(e){}}}It("afterSanitizeAttributes",e,null)},Et=function e(t){let n=null;const a=yt(t);for(It("beforeSanitizeShadowDOM",t,null);n=a.nextNode();){if(It("uponSanitizeShadowNode",n,null),xt(n))continue;const t=ee(n);1===n.nodeType&&(t&&t.__depth?n.__depth=(n.__removalCount||0)+t.__depth+1:n.__depth=1),(n.__depth>=st||n.__depth<0||I(n.__depth))&&bt(n),n.content instanceof d&&(n.content.__depth=n.__depth,e(n.content)),wt(n)}It("afterSanitizeShadowDOM",t,null)};return a.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,i=null,r=null,s=null;if($e=!e,$e&&(e="\x3c!--\x3e"),"string"!=typeof e&&!Dt(e)){if("function"!=typeof e.toString)throw S("toString is not a function");if("string"!=typeof(e=e.toString()))throw S("dirty is not a string, aborting")}if(!a.isSupported)return e;if(Me||lt(t),a.removed=[],"string"==typeof e&&(je=!1),je){if(e.nodeName){const t=rt(e.nodeName);if(!ge[t]||Ie[t])throw S("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof x)n=vt("\x3c!----\x3e"),i=n.ownerDocument.importNode(e,!0),1===i.nodeType&&"BODY"===i.nodeName||"HTML"===i.nodeName?n=i:n.appendChild(i);else{if(!Te&&!Ae&&!ke&&-1===e.indexOf("<"))return te&&Fe?te.createHTML(e):e;if(n=vt(e),!n)return Te?null:Fe?ne:""}n&&Pe&&bt(n.firstChild);const c=yt(je?e:n);for(;r=c.nextNode();){if(xt(r))continue;const e=ee(r);1===r.nodeType&&(e&&e.__depth?r.__depth=(r.__removalCount||0)+e.__depth+1:r.__depth=1),(r.__depth>=st||r.__depth<0||I(r.__depth))&&bt(r),r.content instanceof d&&(r.content.__depth=r.__depth,Et(r.content)),wt(r)}if(je)return e;if(Te){if(Ue)for(s=re.call(n.ownerDocument);n.firstChild;)s.appendChild(n.firstChild);else s=n;return(ye.shadowroot||ye.shadowrootmode)&&(s=se.call(o,s,!0)),s}let u=ke?n.outerHTML:n.innerHTML;return ke&&ge["!doctype"]&&n.ownerDocument&&n.ownerDocument.doctype&&n.ownerDocument.doctype.name&&y(Q,n.ownerDocument.doctype.name)&&(u="<!DOCTYPE "+n.ownerDocument.doctype.name+">\n"+u),Ae&&l([de,le,ue],e=>{u=h(u,e," ")}),te&&Fe?te.createHTML(u):u},a.setConfig=function(){lt(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Me=!0},a.clearConfig=function(){ot=null,Me=!1},a.isValidAttribute=function(e,t,n){ot||lt({});const a=rt(e),i=rt(t);return Ct(a,i,n)},a.addHook=function(e,t){"function"==typeof t&&(ce[e]=ce[e]||[],f(ce[e],t))},a.removeHook=function(e){if(ce[e])return u(ce[e])},a.removeHooks=function(e){ce[e]&&(ce[e]=[])},a.removeAllHooks=function(){ce={}},a}()}()}
,676:e=>{"use strict";e.exports=n},207:e=>{"use strict";e.exports=r},949:e=>{"use strict";e.exports=a},529:e=>{"use strict";e.exports=t},698:e=>{"use strict";e.exports=o},939:e=>{"use strict";e.exports=c},773:e=>{"use strict";e.exports=i},317:e=>{"use strict";e.exports=d},280:e=>{"use strict";e.exports=s}},f={};function p(e){var t=f[e];if(void 0!==t)return t.exports;var n=f[e]={exports:{}};return u[e].call(n.exports,n,n.exports,p),n.exports}p.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return p.d(t,{a:t}),t},p.d=(e,t)=>{for(var n in t)p.o(t,n)&&!p.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},p.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),p.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l=e?e.src:"",p.p=l.slice(0,l.lastIndexOf("/")+1);var m={};return(()=>{"use strict";var e,t;p.r(m),p.d(m,{DistributionType:()=>t,EngageAttachmentType:()=>a,FONT_FAMILY_REGULAR:()=>H,FONT_REGULAR:()=>F,TranspileProductSource:()=>n,WebpartRenderBuilder:()=>fi,analyzeDocument:()=>Di,analyzeHtmlString:()=>Si,compareHtml:()=>pi,distributionTypeString:()=>i,getFontFamily:()=>z,getFontName:()=>G,logIssuesToTraceLog:()=>vi,processEngageHtml:()=>tt,purifyTranspiledHtml:()=>Re,sanitizeFontName:()=>K}),function(e){e[e.Email=1]="Email",e[e.Teams=2]="Teams",e[e.VivaEngage=3]="VivaEngage",e[e.Web=4]="Web"}(t||(t={}));var n,a,i=((e={})[t.Email]="Email",e[t.Teams]="Teams",e[t.VivaEngage]="VivaEngage",e[t.Web]="Web",e);!function(e){e.Amplify="Amplify",e.SPOSites="SPO Sites"}(n||(n={})),function(e){e.Image="Image",e.WebLink="WebLink"}(a||(a={}));var r,o=p(529),s="OWAAutoLink",c="data-scenario-source";!function(e){e[e.UNIVERSAL_PADDING=20]="UNIVERSAL_PADDING",e[e.TABLE_FULL_WIDTH=740]="TABLE_FULL_WIDTH",e[e.SIDE_PADDING=20]="SIDE_PADDING",e[e.TABLE_RENDER_WIDTH=700]="TABLE_RENDER_WIDTH",e[e.CORNER_ROUND=4]="CORNER_ROUND",e[e.CORNER_CIRCLE=50]="CORNER_CIRCLE",e[e.ICON_SIZE=20]="ICON_SIZE",e[e.MAX_TITLE_CHAR_CARD=90]="MAX_TITLE_CHAR_CARD",e[e.PADDING_HEIGHT_WITH_COLOR=32]="PADDING_HEIGHT_WITH_COLOR",e[e.PADDING_HEIGHT_WITHOUT_COLOR=16]="PADDING_HEIGHT_WITHOUT_COLOR",e[e.ICON_SIZE_SMALL=20]="ICON_SIZE_SMALL",e[e.ICON_SIZE_MEDIUM=64]="ICON_SIZE_MEDIUM",e[e.ICON_PADDING=2]="ICON_PADDING",e[e.THUMBNAIL_WIDTH_SMALL=36]="THUMBNAIL_WIDTH_SMALL",e[e.THUMBNAIL_WIDTH_MEDIUM=252]="THUMBNAIL_WIDTH_MEDIUM",e[e.THUMBNAIL_HEIGHT_MEDIUM=142]="THUMBNAIL_HEIGHT_MEDIUM",e[e.THUMBNAIL_MSO_WIDTH_MEDIUM=316]="THUMBNAIL_MSO_WIDTH_MEDIUM",e[e.THUMBNAIL_MSO_HEIGHT_MEDIUM=178]="THUMBNAIL_MSO_HEIGHT_MEDIUM",e[e.PADDING_PERSONA_TABLE_EXTRA_SMALL=6]="PADDING_PERSONA_TABLE_EXTRA_SMALL",e[e.PADDING_PERSONA_TABLE_SMALL=12]="PADDING_PERSONA_TABLE_SMALL",e[e.PERSONA_GAP=10]="PERSONA_GAP",e[e.COL_SPACING_CARD=16]="COL_SPACING_CARD",e[e.MARGIN_ROW_NS=10]="MARGIN_ROW_NS"}(r||(r={}));var d,l=new RegExp(/^https:\/\/[a-zA-Z0-9-]+\.sharepoint(-df)?\.com\/:v:\/[a-z]+\/([%\w-._]+\/)*(.+?\.(3g2|3gp|3gpp|asf|avi|m2ts|m4v|mkv|mov|mp4|mp4v|mts|ts|webm|wmv|3G2|3GP|3GPP|ASF|AVI|M2TS|M4V|MKV|MOV|MP4|MP4V|MTS|TS|WEBM|WMV)|[A-Za-z0-9_-]{1,})(\?.+)?$/),u=p(676);function f(){return u._SPKillSwitch.isActivated("cf386800-8b1a-4aab-a476-9aa0f4217a01")}function _(){return u._SPKillSwitch.isActivated("0253b245-1fa4-48c8-82a1-ef50ccaa1293")}function h(){return u._SPKillSwitch.isActivated("084367f4-df5b-4d62-a76a-0af4e45e2444")}function b(){return u._SPKillSwitch.isActivated("8debbab1-0450-4575-99b6-c6e52587fd92")}function g(){return u._SPKillSwitch.isActivated("d58004eb-6539-4c8e-b1f0-6b4bf62d9553")}function v(){return u._SPKillSwitch.isActivated("cfcb7e24-c3a1-4972-a39d-93c3cac9c88e")}function y(){return u._SPKillSwitch.isActivated("02ecf49c-1cbd-4e62-91e4-7368ce9f4d26")}function S(){return u._SPKillSwitch.isActivated("7e82d12a-e80f-4e46-a780-72d5d85e4f74")}function D(){return u._SPKillSwitch.isActivated("ff4d8265-e007-4ac2-a2e5-647c0cea1e44")}function I(){return u._SPKillSwitch.isActivated("ccb69e83-0f18-49d0-a08b-f28365819d75")}function x(){return u._SPKillSwitch.isActivated("1f8e2b8d-3f8d-4c6b-8f4b-2b1b2e3d2f4d")}function C(){return u._SPKillSwitch.isActivated("04fb7758-e70d-4dc4-81a2-d625eeb32364")}function O(){return C()||u._SPKillSwitch.isActivated("7fda23c7-3464-431d-b71c-2c697885758b")}function w(){return u._SPKillSwitch.isActivated("c4b5f3e8-9a6f-4e7d-a2c5-7e2e3c1a9b8b")}function E(){return u._SPKillSwitch.isActivated("afac94f1-0745-4bd4-a290-fd4e04b7a076")}function A(){return u._SPKillSwitch.isActivated("5cbe5b7f-7111-4ba0-a724-1f18aea1b9c8")}function L(){return u._SPKillSwitch.isActivated("408f81a3-5096-449d-9aec-47bda9291ca2")}function k(){return u._SPKillSwitch.isActivated("492a3e96-b55d-4c8f-995c-81f76dc82c3f")}function M(){return u._SPKillSwitch.isActivated("d8bd2251-1f61-4a56-8090-8d26e9027c9e")}function P(){return u._SPKillSwitch.isActivated("67097842-0892-49f8-a780-b05f46eb7ae2")}function T(){return u._SPKillSwitch.isActivated("a7a4d956-0b88-42f4-a64e-bda1790a8bce")}function U(){return u._SPKillSwitch.isActivated("0d73b537-47ba-4616-9c8b-31b6fd89f305")}!function(e){e.FALLBACK_THUMB_ATT="backupThumbnailSrc"}(d||(d={}));var F="'Segoe UI','Segoe UI Web (West European)', 'Segoe UI', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif;",H="font-family:".concat(F);function R(e){return!u._SPKillSwitch.isActivated("c98522ef-407d-4be3-a47c-405437ed76d4")&&!!e}function N(e){var t="";if((null==e?void 0:e.italic)&&(t=t.concat("font-style: italic;")),null==e?void 0:e.fontSize){var n=B(e.fontSize);t=t.concat("font-size: ".concat(n,"px;"))}if(null==e?void 0:e.fontWeight){var a=function(e){switch(e){case"thin":return 100;case"extra-light":return 200;case"light":return 300;default:return 400;case"medium":return 500;case"semi-bold":return 600;case"bold":return 700;case"extra-bold":return 800;case"black":return 900}}(e.fontWeight);t=t.concat("font-weight: ".concat(a,";"))}return(null==e?void 0:e.overflow)&&(t=t.concat("overflow: ".concat((0,o.escape)(e.overflow),";"))),(null==e?void 0:e.textOverflow)&&(t=t.concat("text-overflow: ".concat((0,o.escape)(e.textOverflow),";"))),(null==e?void 0:e.fontColor)&&(t=t.concat("color: ".concat((0,o.escape)(e.fontColor),";"))),(null==e?void 0:e.minHeight)&&(t=t.concat("min-height: ".concat((0,o.escape)(e.minHeight),";"))),(null==e?void 0:e.lineHeight)&&(t=t.concat("line-height: ".concat((0,o.escape)(e.lineHeight),";"))),(null==e?void 0:e.lineClamp)&&(t=(t=(t=t.concat("display: -webkit-box;")).concat("-webkit-line-clamp: ".concat(e.lineClamp,";"))).concat("-webkit-box-orient: vertical;")),(null==e?void 0:e.textDecoration)&&(t=t.concat("text-decoration: ".concat((0,o.escape)(e.textDecoration),";"))),t}function B(e){switch(e){case"xxx-small":return 9;case"xx-small":return 10;case"x-small":return 12;default:return 14;case"medium":return 16;case"large":return 18;case"x-large":return 24;case"xx-large":return 32}}function j(e){var t,n="",a="",i="",r=0,o=0,s=0;if(e&&e.includes("rgb")){if(!(t=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/)))return!1;n=t[1],a=t[2],i=t[3],r=parseInt(n,10),o=parseInt(a,10),s=parseInt(i,10)}else{if(!e||!e.includes("#")||7!==e.length)return!1;n=e.substring(1,3),a=e.substring(3,5),i=e.substring(5,7),r=parseInt(n,16),o=parseInt(a,16),s=parseInt(i,16)}return Math.sqrt(r*r*.299+o*o*.587+s*s*.114)<=127.5}function V(e){return void 0===e&&(e=!1),e?r.PADDING_HEIGHT_WITH_COLOR:r.PADDING_HEIGHT_WITHOUT_COLOR}function z(e,t){return void 0===t&&(t="body"),"font-family:".concat(G(e,t))}function G(e,t){var n,a,i,r,o,s,c,d;if(void 0===t&&(t="body"),u._SPKillSwitch.isActivated("2e5be4e7-8c88-4079-8998-fe21c0d8b99e")||!u._SPFlight.isEnabled(62394)||!u._SPFlight.isEnabled(61913))return F;var l=e,f="";switch(t){case"body":f=null===(a=null===(n=null==l?void 0:l.fontSlots)||void 0===n?void 0:n.body)||void 0===a?void 0:a.fontFamily;break;case"title":f=null===(r=null===(i=null==l?void 0:l.fontSlots)||void 0===i?void 0:i.title)||void 0===r?void 0:r.fontFamily;break;case"heading":f=null===(s=null===(o=null==l?void 0:l.fontSlots)||void 0===o?void 0:o.heading)||void 0===s?void 0:s.fontFamily;break;default:f=null===(d=null===(c=null==l?void 0:l.fontSlots)||void 0===c?void 0:c.body)||void 0===d?void 0:d.fontFamily}return"".concat(f?K(f):"").concat(f?", ":"").concat(e.fonts.mediumPlus.fontFamily?"".concat(e.fonts.mediumPlus.fontFamily,";"):F)}function K(e){return"'".concat(e.replace(/"/g,"").replace(/'/g,"").replace(/-(\d+)$/g,""),"'")}var W=p(698),q=p(949);const Q=JSON.parse('{"mH":"Word Document","iE":"PowerPoint","Bu":"Excel","ZV":"Image","q3":"Text Document","Ee":"Video","Pb":"YouTube Video"}');var Y=p(773),J=p(207),X="breaklongword";function Z(e,t,n,a,i,o,s,c){void 0===t&&(t="Center"),void 0===n&&(n=8),void 0===a&&(a=16);var d=document.createElement("table");!u._SPKillSwitch.isActivated("36cc34bc-352c-4f3e-93c7-c530b3e2de1a")&&c&&d.setAttribute("data-testid",c),d.setAttribute("align",t.toLowerCase()),d.setAttribute("border","0"),d.setAttribute("cellspacing","0"),d.setAttribute("cellpadding","0"),d.style.margin="Left"===t?"auto auto auto 0":"Right"===t?"auto 0 auto auto":"auto",d.style.padding="0px",d.style.borderSpacing="0px",d.style.borderCollapse="collapse",d.style.width="unset",d.style.backgroundColor=i,d.style.borderRadius="".concat(r.CORNER_ROUND,"px");var l=document.createElement("tr");l.style.padding="0",l.style.margin="0",s&&l.style.setProperty("border","0px hidden","important");var f=document.createElement("td");return f.style.padding="0",f.style.margin="0",f.style.paddingTop="".concat(n,"px"),f.style.paddingRight="".concat(a,"px"),f.style.paddingBottom="".concat(n,"px"),f.style.paddingLeft="".concat(a,"px"),o&&(f.style.color=o),e instanceof HTMLElement?f.appendChild(e):f.appendChild(document.createTextNode(e)),l.appendChild(f),d.appendChild(l),d.outerHTML}function $(e,t,n){return"\n  ".concat(e?"\x3c!--[if ".concat(n?"(gte mso ".concat(n,")"):"mso","]>"):"\x3c!--[if !mso]>\x3c!--\x3e","\n  ").concat(t,"\n  ").concat(e?"<![endif]--\x3e":"\x3c!--<![endif]--\x3e","\n  ")}function ee(e,t){return void 0===e&&(e=!1),R(t)&&t?e?t.maxColumnWidthWithPadding:t.maxColumnWidth:e?r.TABLE_FULL_WIDTH:r.TABLE_RENDER_WIDTH}function te(){return"OWA".concat(W.Guid.generate())}function ne(e){if(q._PreviewUtility.isVideo(e))return Q.Ee;switch(e.toLowerCase()){case"doc":case"docx":return Q.mH;case"ppt":case"pptx":return Q.iE;case"xls":case"xlsx":return Q.Bu;case"heic":return Q.ZV;case"txt":return Q.q3;default:return e.toUpperCase()}}function ae(e,t){return void 0===t&&(t=20),Y.Icons.getIconUrl(e||"",t)}function ie(e){try{var t=(new DOMParser).parseFromString(e,"text/html");return se(t,"a"),se(t,":not(.".concat(X,") > span")),se(t,":not(.".concat(X,") > li")),se(t,":not(.".concat(X,") > p")),se(t,":not(.".concat(X,") > div")),t.body.innerHTML}catch(t){return J._TraceLogger.logError(J._LogSource.create("SPTranspile"),t,"Exception parsing innerHtml for breaking long word"),e}}function re(e,t){try{var n=(new DOMParser).parseFromString(e,"text/html");return oe(n,"a",t),oe(n,":not(.".concat(X,") > span"),t),oe(n,":not(.".concat(X,") > li"),t),oe(n,":not(.".concat(X,") > p"),t),oe(n,":not(.".concat(X,") > div"),t),n.body.innerHTML}catch(t){return J._TraceLogger.logError(J._LogSource.create("SPTranspile"),t,"Exception parsing innerHtml for breaking long word"),e}}function oe(e,t,n){var a=ee(!1,n)/8-16;e.querySelectorAll(t).forEach(function(e){var t=e.innerText;(null==t?void 0:t.length)>=a&&(e instanceof HTMLAnchorElement?[t]:t.split(/\s+/).filter(function(e){return e.length>=a})).length>0&&(e.style.wordBreak="break-all",e.classList.add(X))})}function se(e,t){var n=ee()/8-16;e.querySelectorAll(t).forEach(function(e){var t=e.innerText;(null==t?void 0:t.length)>=n&&(e instanceof HTMLAnchorElement?[t]:t.split(/\s+/).filter(function(e){return e.length>=n})).length>0&&(e.style.wordBreak="break-all",e.classList.add(X))})}function ce(e,t,n,a){var i=de(e,(null==n?void 0:n.textBoxColor)||"dark"),s=document.createElement("h3");s.textContent=(0,o.escape)(t),s.style.borderRadius="".concat(r.CORNER_ROUND,"px"),s.style.setProperty("margin","0px","important"),s.style.setProperty("padding","0px","important"),s.style.fontSize="20px",s.style.color=de(e,(null==n?void 0:n.textColor)||"light"),n&&(s.style.fontWeight=n.isBold?"bold":"",s.style.fontStyle=n.isItalic?"italic":"");var c=Z(s,"Left",8,8,i,void 0,a),d=document.createElement("td");d.align="left",d.style.paddingBottom="16px",x()||(d.style.paddingLeft="0px",d.style.setProperty("border","none","important")),d.innerHTML=c;var l=document.createElement("tr");return x()||l.style.setProperty("border","none","important"),l.appendChild(d),l}function de(e,t){switch(t){case"dark":return"#000000";case"theme":return e.semanticColors.inputBackgroundChecked;case"accent":return e.semanticColors.accentButtonBackground;default:return"#ffffff"}}function le(e){return null!=e?e:location.origin}function ue(e){return q._PreviewUtility.mediaServiceSupportedMap.has(e.toLowerCase())?e:void 0}function fe(e){var t,n,a,i;return Boolean((null==e?void 0:e.source)&&((null===(t=e.source)||void 0===t?void 0:t.url)||(null===(n=e.source.sharepointIds)||void 0===n?void 0:n.siteId)&&(null===(a=e.source.sharepointIds)||void 0===a?void 0:a.webId)&&(null===(i=e.source.sharepointIds)||void 0===i?void 0:i.uniqueId)))}var pe=new RegExp(/^https:\/\/[a-zA-Z0-9-]+\.sharepoint(-df)?\.com\/(:v:\/)?[a-z]+\/([%\w-._]+\/)*(.+?\.(mp4|webm|MP4|WEBM)|[A-Za-z0-9_-]{1,})(\?.+)?$/),me="ck-editor-image-container",_e="http://schema.skype.com/Mention",he={Red:"#b6424c",Orange:"#cd5a38",Yellow:"#fdc031",GreenLight:"#bdcb4d",Green:"#2c9b63",Jade:"#387a7c",Blue:"#1f54a3",Purple:"#a53a7b"},be=Object.values(he),ge={Red:"#df9299",Orange:"#f4a593",Yellow:"#fdd473",Green:"#e5f18f",DarkGreen:"#82cda8",Teal:"#9dd9db",Blue:"#c7d4e8",Purple:"#ebd3e1"},ve=Object.values(ge),ye="xx-small",Se="inherit",De="x-large",Ie="#4f52b2",xe=("color:".concat(he.Blue,";"),"color:".concat(he.Blue,";"),{text:" ",styles:[]}),Ce={blockType:"UNSTYLED",spans:[xe]},Oe=new RegExp(/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i);function we(e,t){void 0===t&&(t=!1);var n=["http","https","ftp","tel","pnm","mms","news"];if(t&&n.push("mailto"),!e)return!!u._SPKillSwitch.isActivated("37c099d1-23f7-4dfa-9854-d65f02b6352b");try{var a=new URL((0,o.escape)(e));return n.includes(a.protocol.replace(":",""))}catch(e){return!1}}function Ee(e){return new URL(Y.UrlUtility.absolutizeUrl(e)).href}function Ae(e){var t=e.split("|");return 3===t.length?t[2]:e}var Le={as:!0,as3:!0,asc:!0,ascx:!0,asm:!0,awk:!0,ltx:!0,m:!0,mkdn:!0,mm:!0,mud:!0,nfo:!0,opml:!0,osascript:!0,"3g2":!0,"3gp":!0,"3mf":!0,abap:!0,ada:!0,adp:!0,ahk:!0,ai:!0,arw:!0,asf:!0,asp:!0,bas:!0,bash:!0,bash_login:!0,bash_logout:!0,bash_profile:!0,bashrc:!0,bat:!0,bib:!0,bsh:!0,build:!0,bmp:!0,builder:!0,c:!0,"c++":!0,capfile:!0,cbk:!0,cc:!0,cfc:!0,cfm:!0,cfml:!0,cl:!0,clj:!0,cmake:!0,cmd:!0,coffee:!0,cool:!0,cpp:!0,cpt:!0,cpy:!0,cr2:!0,crw:!0,cs:!0,cshtml:!0,cson:!0,csproj:!0,css:!0,csv:!0,ctp:!0,cur:!0,cxx:!0,d:!0,dcm:!0,dcm30:!0,ddl:!0,di:!0,dic:!0,dicm:!0,dicom:!0,dif:!0,diff:!0,disco:!0,dml:!0,dng:!0,doc:!0,docm:!0,docx:!0,dotm:!0,dotx:!0,dtd:!0,dtml:!0,dwg:!0,el:!0,emake:!0,eml:!0,epub:!0,erb:!0,erf:!0,erl:!0,f90:!0,f95:!0,fbx:!0,fs:!0,fsi:!0,fsscript:!0,fsx:!0,gemfile:!0,gemspec:!0,gif:!0,gitconfig:!0,glb:!0,gltf:!0,go:!0,groovy:!0,gvy:!0,h:!0,"h++":!0,haml:!0,handlebars:!0,hbs:!0,hcp:!0,heic:!0,heif:!0,hevc:!0,hrl:!0,hs:!0,htc:!0,htm:!0,html:!0,hxx:!0,ico:!0,icon:!0,idl:!0,iim:!0,inc:!0,inf:!0,ini:!0,inl:!0,ipp:!0,irbrc:!0,jade:!0,jav:!0,java:!0,jpe:!0,jpeg:!0,jpg:!0,js:!0,json:!0,jsp:!0,jsx:!0,key:!0,l:!0,less:!0,lhs:!0,lisp:!0,log:!0,lst:!0,lua:!0,m2ts:!0,m4v:!0,make:!0,markdn:!0,markdown:!0,md:!0,mdown:!0,mef:!0,ml:!0,mli:!0,mll:!0,mly:!0,mov:!0,movie:!0,mp3:!0,mp4:!0,mp4v:!0,mrw:!0,msg:!0,mts:!0,nef:!0,nrw:!0,obj:!0,odp:!0,ods:!0,odt:!0,orf:!0,out:!0,p:!0,pages:!0,pano:!0,pas:!0,patch:!0,pdf:!0,pef:!0,php:!0,php2:!0,php3:!0,php4:!0,php5:!0,pict:!0,pl:!0,plist:!0,ply:!0,pm:!0,png:!0,pod:!0,pot:!0,potm:!0,potx:!0,pp:!0,pps:!0,ppsm:!0,ppsx:!0,ppt:!0,pptm:!0,pptx:!0,profile:!0,properties:!0,ps:!0,ps1:!0,psb:!0,psd:!0,pt:!0,py:!0,pyw:!0,r:!0,rake:!0,rb:!0,rbx:!0,rc:!0,re:!0,readme:!0,reg:!0,rest:!0,resw:!0,resx:!0,rhtml:!0,rjs:!0,rprofile:!0,rpy:!0,rss:!0,rst:!0,rtf:!0,rw2:!0,rxml:!0,s:!0,sass:!0,scala:!0,scm:!0,sconscript:!0,sconstruct:!0,script:!0,scss:!0,sgml:!0,sh:!0,shtml:!0,sketch:!0,sltx:!0,sml:!0,spm:!0,sql:!0,stl:!0,sty:!0,tcl:!0,tex:!0,text:!0,textile:!0,tif:!0,tiff:!0,tld:!0,tli:!0,tmpl:!0,tpl:!0,ts:!0,txt:!0,url:!0,vb:!0,vi:!0,vim:!0,vsd:!0,vsdx:!0,wmv:!0,wsdl:!0,xaml:!0,xbm:!0,xcf:!0,xd:!0,xhtml:!0,xls:!0,xlsb:!0,xlsx:!0,xml:!0,xoml:!0,xsd:!0,xsl:!0,xslt:!0,yaml:!0,yaws:!0,yml:!0,z:!0,zip:!0,zsh:!0},ke=p(280),Me=p(205),Pe=p.n(Me),Te=["\x3c!--[if !mso]>","\x3c!--<![endif]--\x3e","\x3c!--<![if !mso]--\x3e","\x3c!--[if gte mso 9]--\x3e","<![endif]--\x3e","\x3c!--[if (gte mso 9)]>","\x3c!--[if mso]>","\x3c!--\x3e"],Ue=["<v:roundrect","</v:roundrect>","<v:oval","</v:oval>","<v:fill","</v:fill>"],Fe=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")};function He(e){return Te.forEach(function(t,n){var a=new RegExp(Fe(t),"g");e=e.replace(a,"<msotag-".concat(n,">"))}),Ue.forEach(function(t,n){var a=new RegExp(Fe(t),"g");e=e.replace(a,"<vtag-".concat(n).concat(n%2?">":""))}),e}function Re(e){e=He(e);var t,n=Pe().sanitize(e,{ADD_ATTR:["name","style","data-id","class","data-webpartid","backupthumbnailsrc","data-loopstyle","role",c],FORBID_TAGS:["script","iframe","object","embed"],KEEP_CONTENT:!0,ALLOWED_URI_REGEXP:/^(?:(http|https|ftp|pnm|mms|news):\/\/|(tel|mailto):)?(\+?\w+)?(@)?([^\s:@]+)?([^\s:\/]+)(:[0-9]+)?(\/[^\s]*)?$/i,CUSTOM_ELEMENT_HANDLING:{allowCustomizedBuiltInElements:!0,tagNameCheck:function(e){return(0,ke.__spreadArray)((0,ke.__spreadArray)([],Array.from({length:Ue.length},function(e,t){return"vtag-".concat(t)}),!0),Array.from({length:Te.length},function(e,t){return"msotag-".concat(t)}),!0).includes(e)},attributeNameCheck:function(e){return"xmlns:v"===e||"xmlns:w"===e||"arcsize"===e||"stroke"===e||"fillcolor"===e}}});return n&&(t=n,Te.forEach(function(e,n){var a=new RegExp(Fe("<msotag-".concat(n,">")),"g");t=t.replace(a,e);var i=new RegExp("</msotag-".concat(n,">"),"g");t=t.replace(i,"")}),Ue.forEach(function(e,n){var a=new RegExp(Fe("<vtag-".concat(n).concat(n%2?">":"")),"g");t=t.replace(a,e);var i=new RegExp("</vtag-".concat(n,">"),"g");t=t.replace(i,"")}),n=t),n}function Ne(e,t){t=Be(t||{R:255,G:255,B:255});let n=e=Be(e);return void 0!==e.A&&(n={R:t.R+(e.R-t.R)*e.A,G:t.G+(e.G-t.G)*e.A,B:t.B+(e.B-t.B)*e.A}),function(e){let t=e.Y/100,n=e.Z/108.883,a=e.X/95.047;return a=a>.008856?Math.pow(a,1/3):7.787*a+16/116,t=t>.008856?Math.pow(t,1/3):7.787*t+16/116,n=n>.008856?Math.pow(n,1/3):7.787*n+16/116,{L:116*t-16,a:500*(a-t),b:200*(t-n)}}(function(e){let t=e.R/255,n=e.G/255,a=e.B/255;return t>.04045?t=Math.pow((t+.055)/1.055,2.4):t/=12.92,n>.04045?n=Math.pow((n+.055)/1.055,2.4):n/=12.92,a>.04045?a=Math.pow((a+.055)/1.055,2.4):a/=12.92,t*=100,n*=100,a*=100,{X:.4124*t+.3576*n+.1805*a,Y:.2126*t+.7152*n+.0722*a,Z:.0193*t+.1192*n+.9505*a}}(n))}function Be(e){let t,n,a,i;"R"in e?(t=e.R,n=e.G,a=e.B,i=e.A):(t=e.r,n=e.g,a=e.b,i=e.a);const r={R:t,G:n,B:a};return void 0!==i&&(r.A=i),r}function je(e,t,n){("R"in e||"r"in e)&&(e=Ne(e,n)),("R"in t||"r"in t)&&(t=Ne(t,n));const a=e.L,i=e.a,r=e.b,o=t.L,s=t.a,c=t.b,d=Math.sqrt(Math.pow(i,2)+Math.pow(r,2)),l=Math.sqrt(Math.pow(s,2)+Math.pow(c,2)),u=(d+l)/2,f=.5*(1-Math.sqrt(Math.pow(u,7)/(Math.pow(u,7)+Math.pow(25,7)))),p=(1+f)*i,m=(1+f)*s,_=Math.sqrt(Math.pow(p,2)+Math.pow(r,2)),h=Math.sqrt(Math.pow(m,2)+Math.pow(c,2)),b=ze(r,p),g=ze(c,m),v=o-a,y=h-_,S=function(e,t,n,a){if(e*t==0)return 0;if(Math.abs(a-n)<=180)return a-n;if(a-n>180)return a-n-360;if(a-n<-180)return a-n+360;throw new Error}(d,l,b,g),D=2*Math.sqrt(_*h)*Math.sin(Ve(S)/2),I=(a+o)/2,x=(_+h)/2,C=function(e,t,n,a){if(e*t==0)return n+a;if(Math.abs(n-a)<=180)return(n+a)/2;if(Math.abs(n-a)>180&&n+a<360)return(n+a+360)/2;if(Math.abs(n-a)>180&&n+a>=360)return(n+a-360)/2;throw new Error}(d,l,b,g),O=1-.17*Math.cos(Ve(C-30))+.24*Math.cos(Ve(2*C))+.32*Math.cos(Ve(3*C+6))-.2*Math.cos(Ve(4*C-63)),w=30*Math.exp(-Math.pow((C-275)/25,2)),E=Math.sqrt(Math.pow(x,7)/(Math.pow(x,7)+Math.pow(25,7))),A=1+.015*Math.pow(I-50,2)/Math.sqrt(20+Math.pow(I-50,2)),L=1+.045*x,k=1+.015*x*O,M=-2*E*Math.sin(Ve(2*w));return Math.sqrt(Math.pow(v/(1*A),2)+Math.pow(y/(1*L),2)+Math.pow(D/(1*k),2)+M*(y/(1*L))*(D/(1*k)))}function Ve(e){return e*(Math.PI/180)}function ze(e,t){if(0===e&&0===t)return 0;{const n=Math.atan2(e,t)*(180/Math.PI);return n>=0?n:n+360}}function Ge(e){return 1!==(e=Be(e)).A?`rgba(${e.R}, ${e.G}, ${e.B}, ${e.A})`:`rgb(${e.R}, ${e.G}, ${e.B})`}function Ke(e,t,n){const a=Ge(e);return function(e,t,n,a){const i={};a=a||{R:255,G:255,B:255},n=n||"closest";for(let r=0;r<e.length;r+=1){const o=e[r];let s,c;for(let e=0;e<t.length;e+=1){const i=t[e],r=je(o,i,a);s?(void 0!==c&&"closest"===n&&r<c||void 0!==c&&"furthest"===n&&r>c)&&(s=i,c=r):(s=i,c=r)}s&&(i[Ge(o)]=s)}return i}([e],t,"closest",n=n||{R:255,G:255,B:255})[a]}function We(e){e.querySelectorAll("table").forEach(function(e){var t=e.parentElement;t&&(t.removeAttribute("title"),t.removeAttribute("style"))}),e.querySelectorAll("tr, th, td").forEach(function(e){var t=(e.getAttribute("style")||"").split(";"),n=t.filter(function(e){return!e.includes("color")});n.length!==t.length&&e.setAttribute("style",n.join(";"))})}function qe(e,t){e.querySelectorAll("[style]").forEach(t)}function Qe(e){var t=e.querySelectorAll("[class]"),n={highlightColorYellow:"background-color:".concat(ge.Yellow,";"),highlightColorGreen:"background-color:".concat(ge.Green,";"),highlightColorAqua:"background-color:".concat(ge.Blue,";"),highlightColorMagenta:"background-color:".concat(ge.Purple,";"),highlightColorBlue:"background-color:".concat(ge.Blue,";"),highlightColorRed:"background-color:".concat(ge.Red,";"),highlightColorDarkBlue:"background-color:".concat(ge.Blue,";"),highlightColorTeal:"background-color:".concat(ge.Teal,";"),highlightColorDarkGreen:"background-color:".concat(ge.DarkGreen,";"),highlightColorPurple:"background-color:".concat(ge.Purple,";"),highlightColorMaroon:"background-color:".concat(ge.Purple,";"),highlightColorGold:"background-color:transparent;",highlightColorDarkGrey:"background-color:transparent;",highlightColorGrey:"background-color:transparent;",highlightColorBlack:"background-color:transparent;",fontColorRedDark:"color:".concat(he.Red,";"),fontColorRed:"color:".concat(he.Orange,";"),fontColorYellow:"color:".concat(he.Yellow,";"),fontColorYellowLight:"color:".concat(he.Yellow,";"),fontColorGreenLight:"color:".concat(he.GreenLight,";"),fontColorGreen:"color:".concat(he.Green,";"),fontColorBlueLight:"color:".concat(he.Blue,";"),fontColorBlue:"color:".concat(he.Blue,";"),fontColorBlueDark:"color:inherit;",fontColorPurple:"color:".concat(he.Purple,";"),fontColorThemeDarker:"color:inherit;",fontColorThemeDark:"color:".concat(he.Blue,";"),fontColorThemeDarkAlt:"color:".concat(he.Blue,";"),fontColorThemePrimary:"color:".concat(he.Blue,";"),fontColorThemeSecondary:"color:".concat(he.Blue,";"),fontColorThemeTertiary:"color:".concat(he.Blue,";"),fontColorNeutralTertiary:"color:inherit;",fontColorNeutralSecondaryAlt:"color:inherit;",fontColorNeutralSecondary:"color:inherit;",fontColorNeutralPrimaryAlt:"color:inherit;",fontColorNeutralPrimary:"color:inherit;",fontColorNeutralDark:"color:inherit;",fontSizeXSmall:"font-size:".concat(ye,";"),fontSizeSmall:"font-size:".concat(Se,";"),fontSizeMedium:"font-size:".concat(Se,";"),fontSizeMediumPlus:"font-size:".concat(Se,";"),fontSizeLarge:"font-size:".concat(Se,";"),fontSizeXLarge:"font-size:".concat(Se,";"),fontSizeXLargePlus:"font-size:".concat(De,";"),fontSizeXxLarge:"font-size:".concat(De,";"),fontSizeXxxLarge:"font-size:".concat(De,";"),fontSizeXxLargePlus:"font-size:".concat(De,";"),fontSizeSuper:"font-size:".concat(De,";"),fontSizeMega:"font-size:".concat(De,";")};t.forEach(function(e){var t=e.className.split(" ");t.includes(me)||t.includes("imagePlugin")||(t.forEach(function(t){if(n.hasOwnProperty(t)){var a=e.getAttribute("style")||"";e.setAttribute("style","".concat(a).concat(n[t]))}t!==me&&e.classList.remove(t)}),e.removeAttribute("class"))})}function Ye(e){e.querySelectorAll("h2, h3, h4").forEach(function(t){var n=t.nodeName.toLowerCase();if("h2"===n&&t.parentNode){var a=e.createElement("h1");a.innerHTML=t.innerHTML,t.parentNode.replaceChild(a,t)}else if("h3"===n&&t.parentNode){var i=e.createElement("h2");i.innerHTML=t.innerHTML,t.parentNode.replaceChild(i,t)}else if("h4"===n&&t.parentNode){var r=e.createElement("h3");r.innerHTML=t.innerHTML,t.parentNode.replaceChild(r,t)}})}function Je(e){if("#"===e[0]&&(4!==e.length&&5!==e.length||(e="#"+e.substring(1).split("").map(function(e){return e+e}).join("")),7===e.length||9===e.length)){var t=parseInt(e.slice(1,3),16),n=parseInt(e.slice(3,5),16),a=parseInt(e.slice(5,7),16),i=1;return 9===e.length&&(i=parseInt(e.slice(7,9),16)/255),{R:t,G:n,B:a,A:i}}}function Xe(e){var t=e.R.toString(16).padStart(2,"0"),n=e.G.toString(16).padStart(2,"0"),a=e.B.toString(16).padStart(2,"0"),i=void 0===e.A||1===e.A?"":Math.round(255*e.A).toString(16).padStart(2,"0");return"#".concat(t).concat(n).concat(a).concat(i)}function Ze(e){var t=[];return e.forEach(function(e){var n=Je(e);n&&t.push(n)}),t}function $e(e){et(e,"sub")}function et(e,t){e.querySelectorAll(t).forEach(function(e){for(var t=e.parentElement;e.firstChild;)null==t||t.insertBefore(e.firstChild,e);null==t||t.removeChild(e)})}function tt(e,t){var n=(new DOMParser).parseFromString(e,"text/html");return We(n),Qe(n),function(e){qe(e,function(e){void 0!==e.style.fontSize&&(e.removeAttribute("data-fontsize"),e.style.fontSize="".concat(16,"px"))})}(n),function(e){qe(e,function(e){void 0!==e.style.color&&e.style.removeProperty("color"),void 0!==e.style.backgroundColor&&e.style.removeProperty("background-color")})}(n),function(e){qe(e,function(e){void 0!==e.style.textAlign&&e.style.removeProperty("text-align"),void 0!==e.style.marginLeft&&e.style.removeProperty("margin-left")})}(n),(null==t?void 0:t.skipHeadingLevelShift)||function(e){Ye(e),e.querySelectorAll("h3").forEach(function(t){var n,a=e.createElement("strong");a.innerHTML=t.innerHTML;var i=e.createElement("p");i.appendChild(a),null===(n=t.parentNode)||void 0===n||n.replaceChild(i,t)})}(n),function(e){(P()?e.querySelectorAll("ol li li li li, ul li li li li"):e.querySelectorAll(":is(ul, ol) :is(ul, ol) :is(ul, ol) :is(ul, ol)")).forEach(function(e){for(var t,n=e;nt(n)>3||"LI"!==n.tagName;)n=n.parentElement;var a=n.parentElement;P()?(a.insertBefore(e,n.nextSibling),""===(null===(t=n.textContent)||void 0===t?void 0:t.trim())&&n.remove()):Array.from(e.children).filter(function(e){return"LI"===e.tagName}).forEach(function(e){a.insertBefore(e,n.nextSibling),n.textContent||n.remove(),n=e})});var t=e.querySelectorAll("ol li li li ol, ol li li li ul, ul li li li ol, ul li li li ul");Array.from(t).filter(function(e){return!e.children.length}).forEach(function(e){e.remove()})}(n),function(e){var t=e.querySelectorAll("figure");t.forEach(function(t){t.querySelectorAll("td, th").forEach(function(n){(u._SPKillSwitch.isActivated("3aec86d7-8ee1-4b6a-8a1b-ff1e07aa198d")?n.childNodes:Array.from(n.childNodes)).forEach(function(n){var a,i=""===(null===(a=n.textContent)||void 0===a?void 0:a.trim());if(u._SPKillSwitch.isActivated("faa8a794-5227-40b7-850e-09526f8a3a77")||!i)if("SPAN"===n.nodeName||"#text"===n.nodeName){var r=e.createElement("p");r.appendChild(n),t.before(r)}else t.before(n)})})}),t.forEach(function(e){e.remove()})}(n),function(e){e.querySelectorAll(".floatRight, .floatLeft").forEach(function(e){e.classList.remove("floatRight"),e.classList.remove("floatLeft"),e.dataset.alignment="Center"})}(n),u._SPKillSwitch.isActivated("19c03830-564c-44dd-9591-3d49bee3e403")||(function(e){et(e,"sup")}(n),$e(n)),n.body.innerHTML}function nt(e){for(var t=0;e.parentElement;)"OL"!==(e=e.parentElement).tagName&&"UL"!==e.tagName||t++;return t}const at=p.p+"odm_GlobeIcon_Dark_22x22_695a26eb.png",it=p.p+"odm_GlobeIcon_Light_22x22_bcbb31f2.png",rt=p.p+"odm_GlobeIcon_Light_16x9_b54fef99.png",ot=p.p+"odm_GlobeIcon_Dark_16x9_9b00435e.png",st=p.p+"odm_Excel_16x9_9cc0fffc.png",ct=p.p+"odm_PowerPoint_16x9_c99b05eb.png",dt=p.p+"odm_Word_16x9_cbe11b65.png",lt=p.p+"odm_SharePoint_16x9_968aad90.png",ut=p.p+"odm_Stream_16x9_6404c95d.png";var ft=p(939);const pt=p.p+"odm_newsCarousel1_2f061610.png";var mt,_t="".concat(u._FluentIconVersionedCdnPath,"/assets/brand-icons/product/png"),ht="https://res-2-sdf.cdn.office.net",bt=["pptx","docx","xlsx","spo","video"],gt={pptx:"powerpoint",docx:"word",xlsx:"excel",spo:"sharepoint",video:"stream"},vt={pptx:ct,docx:dt,xlsx:st,spo:lt,video:ut};function yt(e,t,n){void 0===n&&(n=!1);var a=function(e,t){return Dt(e===mt.medium?t?rt:ot:t?it:at)}(t,n),i=Y.EXTENSIONS_TO_FILENAME_MAP[e];return bt.includes(i)?St(i,t):a}function St(e,t){var n=t===mt.small?gt[e]:vt[e];if(t===mt.small){var a=ht;return sessionStorage.getItem("spfx-debug")||(a=new ft.Uri(pt).getLeftPart(ft.UriPartial.authority)),"".concat(a).concat(_t,"/").concat(n,"_32x1.png")}return Dt(n)}function Dt(e){if(!sessionStorage.getItem("spfx-debug"))return e;var t=new ft.Uri(e).getLastPathSegment();return-1===t.indexOf(".png")?e:"".concat(ht,"/files/sp-client/").concat(t)}!function(e){e[e.small=0]="small",e[e.medium=1]="medium"}(mt||(mt={}));var It=function(){function e(e,t){this._components=new Map,this._registrations=e,this._distributionType=t}return e.prototype.initialize=function(e){var t=this;this._context=(0,ke.__assign)((0,ke.__assign)({},e),{getComponent:function(e){return t._components.get(e)},processStyles:function(e){return t._getStyle(e)}});for(var n=0,a=this._registrations;n<a.length;n++){var i=new(0,a[n])(this._context);this._components.set(i.componentName,i)}},e.prototype.renderComponent=function(e){var t;return null===(t=this._components.get(e.componentName))||void 0===t?void 0:t.render(e)},e.prototype._getStyle=function(e){switch(this._distributionType){case t.VivaEngage:return function(e){var t=[];return(null==e?void 0:e.italic)&&t.push("ITALIC"),"semi-bold"!==(null==e?void 0:e.fontWeight)&&"bold"!==(null==e?void 0:e.fontWeight)&&"extra-bold"!==(null==e?void 0:e.fontWeight)||t.push("BOLD"),t}(e);case t.Teams:return function(e){if(_())return N(e);var t=N({fontColor:null==e?void 0:e.fontColor,textDecoration:null==e?void 0:e.textDecoration});if(null==e?void 0:e.fontSize){var n=function(e){switch(e){case"xxx-small":case"xx-small":case"x-small":case"small":return"x-small";case"large":case"x-large":case"xx-large":return"x-large";default:return"inherit"}}(e.fontSize);return"font-size: ".concat(n,"; ").concat(t)}return t}(e);default:return N(e)}},e}(),xt=p(317),Ct=function(e){this.context=e},Ot=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentName=xt.ComponentName.Image,t}return(0,ke.__extends)(t,e),t.prototype.getTranspileThumbnail=function(e,t,n){var a,i,r,o,s;e.width=this._fixUpDimension(e.width,e.originalWidth),e.height=this._fixUpDimension(e.height,e.originalHeight);var c=e.originalWidth,d=e.originalHeight,l=e.width,u=e.height;if(c&&d&&!e.viewportWidth&&!e.viewportHeight&&c>=(e.width||0)&&d>=(e.height||0)){var f=d,p=c,m=0,_=0;if(e.cropMode=q.CropMode.Fill,t&&n&&(50!==t||50!==n)){var h=c/d,b=l&&u?l/u:h,g=Math.round(c*t/100),v=Math.round(d*n/100);h<b?(p=c,_=0,f=Math.min(d,c/b),m=Math.max(v-f/2,0)):b<h&&(f=d,m=0,p=Math.min(c,d*b),_=Math.round(Math.max(g-p/2,0))),e.cropMode=void 0,e.height=99999}e.viewportWidth=Math.min(c,Math.round(p)),e.viewportHeight=Math.min(d,Math.round(f)),e.viewportLeft=Math.min(c-e.viewportWidth,Math.round(_)),e.viewportTop=Math.min(d-e.viewportHeight,Math.round(m))}var y=null===(s=null===(o=null===(r=null===(i=null===(a=q._ThumbnailUrlGenerator.getThumbnailUrl(e,Y.DefaultImageHelper.getDefaultImage(new q._SPResourcePath(e.spResource))))||void 0===a?void 0:a.replace("preferNoRedirect=true","prefer=NoRedirect"))||void 0===i?void 0:i.replace(/(?<=.*[\? | \&]w=)(\d+)/g,"".concat(e.width)))||void 0===r?void 0:r.replace(/(?<=.*[\? | \&]width=)(\d+)/g,"".concat(e.width)))||void 0===o?void 0:o.replace(/(?<=\/0\/c)\d+(?=x)/g,"".concat(e.width)))||void 0===s?void 0:s.replace("clientType=modernWebPart","clientType=transpile");return y?Y.UrlUtility.absolutizeUrl(y,!0):y},t.prototype.enhanceThumbnailWidth=function(e,t,n){return n&&t&&t/n<.4?e:Math.min(Math.round(1.5*e),1200,t||1200)},t.prototype._fixUpDimension=function(e,t){return(e=e?Math.round(e):e)&&t&&e>t&&(e=t),e},t}(Ct);function wt(e,t){Object.keys(t).forEach(function(n){e.setAttribute(n,t[n])})}function Et(e,t){Object.keys(t).forEach(function(n){e.style.setProperty(n,t[n])})}var At=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Email,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t=e.imageUrl,n=e.width,a=e.height,i=e.originalWidth,o=e.originalHeight,s=e.isFullBleed,c=e.fallbackImageUrl,d=e.linkUrl,l=e.altText,u=e.cropData,f=e.cropMode,p=e.cornerRounding,m=e.additionalStyles,_=e._isHeightLocked,h=e._fileType,b=e._focalX,g=e._focalY,v=e._msoStyleOverride,y=e._sharepointIds,S=Math.min(ee(!0),n),D=a&&n?a/n:o&&i?o/i:void 0,I=D?Math.round(S*D):void 0,x=this.enhanceThumbnailWidth(S,i||0,o||0),C=a&&D?Math.round(x*D):void 0;h&&ue(h)&&J._TraceLogger.logError(J._LogSource.create("SPTranspileComponents"),new Error("Unsupported Image Type"),"Unsupported image type: ".concat(h));var O={callerId:"Transpile-Components",absoluteUrl:L()?window.location.origin:this.context.authority,spResource:t,width:x,height:C,originalWidth:i,originalHeight:o,optimizePublicImage:!0,fileType:h,cropMode:f,nonExpiring:!0};if(!L()&&y&&(O.siteId=y.siteId,O.listId=y.listId,O.webId=y.webId,O.uniqueId=y.uniqueId),u){O.viewportWidth=u.cropWidth,O.viewportHeight=u.cropHeight,O.viewportLeft=u.cropX,O.viewportTop=u.cropY;var w=u.cropHeight/u.cropWidth;I=Math.round(S*w),O.height=a?Math.round(S*w):void 0}var E=this.getTranspileThumbnail(O,b,g),k=c||this._getTranspileThumbnailFallbackUrl(O,n),M={"object-fit":"cover",width:s&&A()?"100%":"".concat(S,"px"),"max-width":"100%"};((A()?s:_)||"circular"===p)&&I&&(M.height="".concat(I,"px")),this._setAdditionalStyles(M,m),"circular"===p?(M["border-radius"]="".concat(r.CORNER_CIRCLE,"%"),M.display="block"):p&&(M["border-radius"]=this._getCornerRadius(p));var P=this._getImgElement(E||"",k||"",M,l,d,v);if(("all"===p||"circular"===p)&&I){var T=this._getMSOCompatibleImgElement("circular"===p,E||"",k||"",S,I,l,d),U=this._getTargetedImgElement(T,P),F=document.createElement("div");return F.innerHTML=U,F.outerHTML}return P},n.prototype._getTranspileThumbnailFallbackUrl=function(e,t,n,a,i){return e.width=t,e.height=null!=n?n:e.height,this.getTranspileThumbnail(e,a,i)},n.prototype._getFallbackImgAttribute=function(e){var t={};return e&&(t.backupThumbnailSrc=e),t},n.prototype._getAltTextAttribute=function(e){var t={};return e?t.alt=(0,o.escape)(e):t.role="presentation",t},n.prototype._extractWin32Attribute=function(e,t){var n,a,i={};return((null==t?void 0:t.width)||e.width)&&(i.width=(null==t?void 0:t.width)?"".concat(t.width):null===(n=e.width)||void 0===n?void 0:n.replace("px","")),((null==t?void 0:t.height)||e.height)&&(i.height=(null==t?void 0:t.height)?"".concat(t.height):null===(a=e.height)||void 0===a?void 0:a.replace("px","")),i},n.prototype._getMSOCompatibleImgElement=function(e,t,n,a,i,r,o){var s=document.createElement(e?"v:oval":"v:roundrect");if(wt(s,(0,ke.__assign)({"xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:w":"urn:schemas-microsoft-com:office:word",stroke:"f"},this._getAltTextAttribute(r))),Et(s,{height:"".concat(i,"px"),width:"".concat(a,"px")}),e)wt(s,{fill:"t"});else{var c=Math.min(a,i||Number.POSITIVE_INFINITY)/2,d=Math.round(400/c);wt(s,{arcsize:"".concat(d,"%"),fillcolor:y()?"#d62828":"none"}),o&&wt(s,{href:o})}var l=document.createElement("v:fill");return wt(l,(0,ke.__assign)({type:"frame",src:t},this._getFallbackImgAttribute(n))),Et(l,{width:"".concat(a,"px"),height:"".concat(i,"px")}),y()&&wt(l,{color:"#fff"}),s.appendChild(l),s.outerHTML},n.prototype._getTargetedImgElement=function(e,t){return"".concat($(!0,e,9),"\n      ").concat($(!1,t))},n.prototype._getImgElement=function(e,t,n,a,i,r){var o=document.createElement("img"),s=(0,ke.__assign)((0,ke.__assign)((0,ke.__assign)({src:e},this._getAltTextAttribute(a)),this._getFallbackImgAttribute(t)),this._extractWin32Attribute(n,r));if(s["data-scenario-source"]="SPO",wt(o,s),Et(o,n),i){var c=document.createElement("a");return c.setAttribute("href",i),c.appendChild(o),c.outerHTML}return o.outerHTML},n.prototype._getCornerRadius=function(e){var t=["all","top","left"].includes(e)?r.CORNER_ROUND:0,n=["all","top","right"].includes(e)?r.CORNER_ROUND:0,a=["all","bottom","left"].includes(e)?r.CORNER_ROUND:0,i=["all","bottom","right"].includes(e)?r.CORNER_ROUND:0;return"".concat(t,"px ").concat(n,"px ").concat(i,"px ").concat(a,"px")},n.prototype._setAdditionalStyles=function(e,t){t&&(t.width&&(e.width=t.width),t.height&&(e.height=t.height),t.minWidth&&(e["min-width"]=t.minWidth),t.minHeight&&(e["min-height"]=t.minHeight),t.objectFit&&(e["object-fit"]=t.objectFit),t.verticalAlign&&(e["vertical-align"]=t.verticalAlign),void 0!==t.opacity&&(e.opacity="".concat(t.opacity)),t.backgroundColor&&(e["background-color"]=t.backgroundColor))},n}(Ot),Lt=250,kt=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Teams,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n=e.imageUrl,a=e.width,i=e.height,r=e.originalWidth,s=e.originalHeight,c=e.linkUrl,d=e.altText,l=e.cropData,u=e.cropMode,f=e._fileType,p=e._focalX,m=e._focalY,_=e._sharepointIds,h=Math.min(a,630),b=i&&a?i/a:s&&r?s/r:void 0,g=b?Math.round(h*b):void 0;f&&ue(f)&&J._TraceLogger.logError(J._LogSource.create("SPTranspileComponents"),new Error("Unsupported Image Type"),"Unsupported image type: ".concat(f));var v={callerId:"Transpile-Components",absoluteUrl:window.location.origin,spResource:n,nonExpiring:!0,fileType:f,cropMode:u,optimizePublicImage:!0};!L()&&_&&(v.siteId=_.siteId,v.listId=_.listId,v.webId=_.webId,v.uniqueId=_.uniqueId),l&&(v.viewportWidth=l.cropWidth,v.viewportHeight=l.cropHeight,v.originalWidth=r,v.originalHeight=s,v.viewportLeft=l.cropX,v.viewportTop=l.cropY,g=Math.round(h*(l.cropHeight/l.cropWidth)));var y={width:h,height:null!=g?g:0},S={width:null!=r?r:0,height:null!=s?s:0},D=this._computeTeamsDimension(y,S);v.width=D.width,v.height=D.height;var I=this.getTranspileThumbnail(v,p,m)||n,x=r&&s?this.getTranspileThumbnail((0,ke.__assign)((0,ke.__assign)({},v),{width:r,height:s})):void 0,C=null!==(t=null!=f?f:q._PreviewUtility.getFileExtension(new q._SPResourcePath(Y.UrlUtility.absolutizeUrl(n))))&&void 0!==t?t:"",O=this._generateImageComponentForTeams({thumbnailUrl:I,imageDimension:D,altText:d,imageUrl:n,imageExtension:C,originalImageUrl:x}),w="";return c&&we(c)&&(w='<a href="'.concat(c,'">').concat((0,o.escape)(c),"</a><br>")),"".concat(w).concat(O.outerHTML)},n.prototype._computeTeamsDimension=function(e,t){var n=e.width,a=e.height;return t.height&&t.height<=Lt?{width:t.width,height:t.height}:(a&&a>Lt&&(n=parseFloat((Lt*n/a).toFixed(1)),a=Lt),{width:n,height:a})},n.prototype._generateImageComponentForTeams=function(e){var t;try{var n=e.thumbnailUrl,a=e.imageDimension,i=e.altText,r=e.imageUrl,s=e.imageExtension,c=e.originalImageUrl,d=null!==(t=null!=s?s:q._PreviewUtility.getFileExtension(new q._SPResourcePath(Y.UrlUtility.absolutizeUrl(r))))&&void 0!==t?t:"",l=document.createElement("div");l.classList.add("imagePlugin"),l.classList.add("teamsImagePlugin"),l.setAttribute("data-original-image-url",null!=c?c:"");var u=document.createElement("img");u.setAttribute("alt",(0,o.escape)(i||"")),u.setAttribute("src",n||""),u.setAttribute("href",n||""),u.setAttribute("data-sp-originalimgsrc",""!==r?r:n),u.setAttribute("width",a.width.toString()),u.setAttribute("itemscope",d),u.setAttribute("data-teams-height",a.height.toString()),u.setAttribute("ck-editor-image","true"),u.setAttribute("data-inline-image","false"),u.setAttribute("style","vertical-align: bottom;"),u.setAttribute("itemtype","http://schema.skype.com/AMSImage");var f=document.createElement("p");return f.classList.add("ck-editor-image-container"),f.appendChild(u),f.setAttribute("style","width: ".concat(a.width,"px;")),l.appendChild(f),l}catch(e){return document.createElement("div")}},n}(Ot);function Mt(e,t,n){return{blockType:"UNORDERED_LIST_ITEM",depth:0,spans:[{text:t,styles:[]},{text:e,styles:[],entity:n?{type:"LINK",url:e}:void 0}]}}function Pt(e,t,n){return void 0===t&&(t=[]),{text:e,styles:t,entity:n}}function Tt(e){return{blockType:"UNSTYLED",spans:e}}function Ut(e,t){var n;return{blocks:e.blocks.concat(t.blocks),attachments:e.attachments.concat(t.attachments),footer:e.footer?e.footer.concat(null!==(n=t.footer)&&void 0!==n?n:[]):t.footer}}const Ft=JSON.parse('{"F":"链接:","C":"替换文字:"}');var Ht=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n,a=e.imageUrl,i=e.width,r=e.originalWidth,o=e.originalHeight,s=e.linkUrl,c=e.altText,d=e.cropMode,l=e._fileType,u=e._sharepointIds,f=Math.min(ee(!0),i),p=this.enhanceThumbnailWidth(f,r||0,o||0);l&&ue(l)&&J._TraceLogger.logError(J._LogSource.create("SPTranspileComponents"),new Error("Unsupported Image Type"),"Unsupported image type: ".concat(l));var m={callerId:"Transpile-Components",absoluteUrl:window.location.origin,spResource:a,width:p,originalWidth:r,originalHeight:o,nonExpiring:!0,cropMode:d,optimizePublicImage:!0,fileType:l};!L()&&u&&(m.siteId=u.siteId,m.listId=u.listId,m.webId=u.webId,m.uniqueId=u.uniqueId);var _={blocks:[],attachments:[this.getTranspileThumbnail(m)||a],footer:[]};return s&&(null===(t=_.footer)||void 0===t||t.push(Mt(s,Ft.F,!0))),c&&(null===(n=_.footer)||void 0===n||n.push(Mt(c,Ft.C))),_},n}(Ot),Rt=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n=e.imageUrl,i=e.width,r=e.height,o=e.originalWidth,s=e.originalHeight,c=e.linkUrl,d=e.altText,l=e.cropMode,f=e._fileType,p=e._sharepointIds;f&&ue(f)&&J._TraceLogger.logError(J._LogSource.create("SPTranspileComponents"),new Error("Unsupported Image Type"),"Unsupported image type: ".concat(f));var m={callerId:"Transpile-Components",absoluteUrl:window.location.origin,spResource:n,width:i,height:r,originalWidth:o,originalHeight:s,nonExpiring:!0,cropMode:l,optimizePublicImage:!0,fileType:f};!L()&&p&&(m.siteId=p.siteId,m.listId=p.listId,m.webId=p.webId,m.uniqueId=p.uniqueId);var _={link:this.getTranspileThumbnail(m)||n,fileType:a.Image,description:u._SPKillSwitch.isActivated("c7588fa9-6475-41a5-a27a-a3616f14a43c")?void 0:d||void 0},h=this.context.getAttachment(_);if(-1===h)return"";var b=document.createElement("div");if(c&&we(c)){var g={componentName:xt.ComponentName.TextBlock,text:c,link:c},v=null===(t=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===t?void 0:t.render(g);if(v){var y=document.createElement("div");y.innerHTML=v,b.appendChild(y)}}var S=document.createElement("attachment");return S.id=h.toString(),b.appendChild(S),b.innerHTML},n}(Ot),Nt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentName=xt.ComponentName.RichImage,t}return(0,ke.__extends)(t,e),t}(Ct),Bt=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Email,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n,a,i=e.imageUrl,r=e.originalWidth,s=e.originalHeight,c=e.isFullBleed,d=e.alignment,l=e.caption,u=e.linkUrl,f=e.altText,p=e.overlayText,m=e.overlayTextStyles,_=e._resizeDesiredWidth,h=e._cropData,b=this.context.localSectionTheme,g=r||0;a=R(this.context.endpointDetails)?c?ee(!0,this.context.endpointDetails):_?Math.min(g||99999,Math.min(ee(!1,this.context.endpointDetails),_)):Math.min(g||99999,ee(!1,this.context.endpointDetails)):c?ee(!0):_?Math.min(g||99999,Math.min(ee(),_)):Math.min(g||99999,ee());var v=void 0!==(null==m?void 0:m.overlayTransparency)&&1!==m.overlayTransparency,y={componentName:xt.ComponentName.Image,imageUrl:i,width:a,originalWidth:r,originalHeight:s,isFullBleed:A()?c:void 0,linkUrl:u,altText:f,cropData:h,cornerRounding:c?void 0:"all",_isHeightLocked:A()?void 0:c,additionalStyles:{opacity:v?null==m?void 0:m.overlayTransparency:void 0,backgroundColor:v?de(b,(null==m?void 0:m.overlayColor)||"light"):void 0,width:!A()&&c?"100%":void 0}},S=null===(n=null===(t=this.context)||void 0===t?void 0:t.getComponent(xt.ComponentName.Image))||void 0===n?void 0:n.render(y);if(!S)return"";var D=document.createElement("table");D.classList.add("image-table"),D.align=(null==d?void 0:d.toLowerCase())||"center",D.width="100%",D.border="0",D.cellSpacing="0",D.cellPadding="0",D.style.maxWidth="".concat(a,"px"),p&&""!==p&&D.appendChild(ce(b,p,m));var I=document.createElement("tr"),x=document.createElement("td");x.classList.add("image-column"),x.align="center";var C="";if(l&&""!==l){var O=document.createElement("div");O.classList.add("image-caption"),O.style.fontSize="14px",O.style.fontWeight="normal",O.style.textAlign="center",O.textContent=(0,o.escape)(l),C=O.outerHTML}return x.innerHTML="".concat(S).concat(C),I.appendChild(x),D.appendChild(I),D.outerHTML},n}(Nt);const jt=JSON.parse('{"u":"描述文字:","V":"覆盖文本:"}');var Vt=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n,a,i=e.imageUrl,r=e.originalWidth,o=e.originalHeight,s=e.isFullBleed,c=e.caption,d=e.linkUrl,l=e.altText,u=e.overlayText,f=e._resizeDesiredWidth,p=e._cropData,m=s?ee(!0):f?Math.min(r||Number.POSITIVE_INFINITY,Math.min(ee(),f)):Math.min(r||Number.POSITIVE_INFINITY,ee()),_={componentName:xt.ComponentName.Image,imageUrl:i,width:m,originalWidth:r,originalHeight:o,linkUrl:d,altText:l,cropData:p},h=null===(n=null===(t=this.context)||void 0===t?void 0:t.getComponent(xt.ComponentName.Image))||void 0===n?void 0:n.render(_);if(!h)return{blocks:[],attachments:[]};var b=[];return c&&""!==c&&b.push(Mt(c,jt.u)),u&&""!==u&&b.push(Mt(u,jt.V)),h.footer=b.concat(null!==(a=h.footer)&&void 0!==a?a:[]),h},n}(Nt),zt=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n,a,i,r=e.imageUrl,o=e.originalWidth,s=e.originalHeight,c=e.caption,d=e.linkUrl,l=e.altText,u=e.overlayText,f=e.overlayTextStyles,p=e._resizeDesiredWidth,m=e._cropData,_=p||o||652,h={componentName:xt.ComponentName.Image,imageUrl:r,width:_,originalWidth:o,originalHeight:s,linkUrl:d,altText:l,cropData:m},b=null===(n=null===(t=this.context)||void 0===t?void 0:t.getComponent(xt.ComponentName.Image))||void 0===n?void 0:n.render(h);if(!b)return"";var g=document.createElement("div");if(u){var v={componentName:xt.ComponentName.TextBlock,text:u,styles:{italic:null==f?void 0:f.isItalic,fontWeight:(null==f?void 0:f.isBold)?"bold":void 0}},y=null===(a=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===a?void 0:a.render(v);if(y){var S=document.createElement("div");S.innerHTML=y,g.appendChild(S)}}var D=document.createElement("div");if(D.innerHTML=b,g.appendChild(D),c){var I={componentName:xt.ComponentName.TextBlock,text:c},x=null===(i=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===i?void 0:i.render(I);if(x){var C=document.createElement("div");C.innerHTML=x,g.appendChild(C)}}return g.outerHTML},n}(Nt),Gt=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Teams,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n,a=e.imageUrl,i=e.originalWidth,r=e.originalHeight,s=e.isFullBleed,c=e.caption,d=e.linkUrl,l=e.altText,u=e.overlayText,f=e.overlayTextStyles,p=e._resizeDesiredWidth,m=e._cropData,_=s?630:p?Math.min(i||Number.POSITIVE_INFINITY,Math.min(630,p)):Math.min(i||Number.POSITIVE_INFINITY,630),h={componentName:xt.ComponentName.Image,imageUrl:a,width:_,originalWidth:i,originalHeight:r,linkUrl:d,altText:l,cropData:m},b=null===(n=null===(t=this.context)||void 0===t?void 0:t.getComponent(xt.ComponentName.Image))||void 0===n?void 0:n.render(h);if(!b)return"";var g="";if(c&&""!==c){var v=document.createElement("p");v.classList.add("teams-caption"),v.style.fontSize="font-size:'inherit';",v.innerHTML=(0,o.escape)(c),g=v.outerHTML}var y="";if(u&&""!==u){var S=document.createElement("h1"),D=S;if(null==f?void 0:f.isItalic){var I=document.createElement("i");D.appendChild(I),D=I}if(null==f?void 0:f.isBold){var x=document.createElement("strong");D.appendChild(x),D=x}D.textContent=(0,o.escape)(u),y=S.outerHTML}return"".concat(y).concat(b).concat(g)},n}(Nt),Kt=function(e){function t(t){var n=e.call(this,t)||this;return n.componentName=xt.ComponentName.TextBlock,n}return(0,ke.__extends)(t,e),t.prototype.getTextElement=function(e){var t=e.headerLevel,n=e.text,a=e.link,i=t?document.createElement("h".concat(this.getHeaderLevel(t))):document.createElement("p");if(a){var r=document.createElement("a");r.setAttribute("href",(0,o.escape)(Y.UrlUtility.absolutizeUrl(a))),r.textContent=n,b()||(r.setAttribute("title",(0,o.escape)(e.altText)||(0,o.escape)(n)),r.setAttribute("aria-label",(0,o.escape)(e.altText)||(0,o.escape)(n))),i.appendChild(r)}else i.textContent=n;return i},t.prototype.getHeaderLevel=function(e){return e},t}(Ct),Wt=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Email,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n=e.styles,a=e.headerLevel,i=e.text,r=e.link,s=document.createElement("span");a&&(s=document.createElement("h".concat(this.getHeaderLevel(a))));var c=null,d=n?this.context.processStyles(n):"";if(d&&s.setAttribute("style",d),s.style.margin="0",s.style.setProperty("mso-hyphenate","none"),s.style.wordWrap="break-word",s.textContent=i,r){if((c=document.createElement("a")).setAttribute("href",(0,o.escape)(r)),c.style.setProperty("text-decoration","none","important"),c.style.cursor="pointer",c.id=te(),!(null===(t=e.styles)||void 0===t?void 0:t.fontColor)){var l=this.context.localSectionTheme;c.style.setProperty("color",l.semanticColors.link,"important")}return b()||(e.altText?(c.setAttribute("title",e.altText),c.setAttribute("aria-label",e.altText)):(c.setAttribute("title",i),c.setAttribute("aria-label",i))),c.appendChild(s),c.outerHTML}return s.outerHTML},n}(Kt),qt=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Teams,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n=e.styles;if(!e.text)return"";var a=this.getTextElement(e);if(!_()){if(["bold","extra-bold","semi-bold","black"].includes(null!==(t=null==n?void 0:n.fontWeight)&&void 0!==t?t:"")){var i=document.createElement("strong");i.innerHTML=a.innerHTML,a.innerHTML="",a.appendChild(i)}if(null==n?void 0:n.italic){var r=document.createElement("i");r.innerHTML=a.innerHTML,a.innerHTML="",a.appendChild(r)}}var o=n?this.context.processStyles(n):"";return o&&a.setAttribute("style",o),a.outerHTML},n.prototype.getHeaderLevel=function(e){return e>3?3:e},n}(Kt),Qt=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n,a=e.text,i=e.styles,r=e.headerLevel,o=e.link,s={blocks:[],attachments:[]},c={blockType:"UNSTYLED",spans:[]},d=new Set;return r&&d.add("BOLD"),i&&(null!==(n=null===(t=this.context)||void 0===t?void 0:t.processStyles(i))&&void 0!==n?n:[]).forEach(function(e){return d.add(e)}),o?(c.spans.push({text:a,styles:Array.from(d),entity:{type:"LINK",url:o.toString()}}),s.blocks.push(c),s):(c.spans.push({text:a,styles:Array.from(d)}),s.blocks.push(c),s)},n}(Kt),Yt=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){if(!e.text)return"";var t=this.getTextElement(e);return e.styles&&(t=function(e,t){var n=t,a=t.childNodes[0];if(!k()&&!a)return t;if(e.italic){var i=document.createElement("i");k()?i.appendChild(n):n.appendChild(i),n=i}if(e.fontWeight&&["semi-bold","bold","extra-bold"].includes(e.fontWeight)){var r=document.createElement("b");k()?r.appendChild(n):n.appendChild(r),n=r}if("underline"===e.textDecoration){var o=document.createElement("u");k()?o.appendChild(n):n.appendChild(o),n=o}return k()||n.appendChild(a),k()?n:t}(e.styles,t)),t.outerHTML},n.prototype.getHeaderLevel=function(e){return e>2?2:e},n}(Kt),Jt=function(e){function t(t){var n=e.call(this,t)||this;return n.componentName=xt.ComponentName.Button,n}return(0,ke.__extends)(t,e),t}(Ct),Xt=function(e){function n(n){var a=e.call(this,n)||this;return a.distribution=t.VivaEngage,a}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t=e.text,n=e.link,a={blocks:[],attachments:[]},i={blockType:"UNSTYLED",spans:[{text:(0,o.escape)(t),styles:[],entity:{type:"LINK",url:n.toString()}}]};return a.blocks.push(i),a},n}(Jt),Zt=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n=e.text,a=e.link;if(w()){var i=document.createElement("u");i.textContent=n;var r=document.createElement("b");r.appendChild(i);var s=document.createElement("a");return s.setAttribute("href",(0,o.escape)(a.toString())),s.appendChild(r),s.outerHTML}var c={componentName:xt.ComponentName.TextBlock,text:n,link:a.toString(),styles:{textDecoration:"underline",fontWeight:"bold"}};return(null===(t=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===t?void 0:t.render(c))||""},n}(Jt),$t=function(e){function n(n){var a=e.call(this,n)||this;return a.distribution=t.Teams,a}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n=e.text,a=e.link;if(w()){var i=document.createElement("a");return i.setAttribute("href",(0,o.escape)(a.toString())),i.innerHTML=(0,o.escape)(n),i.setAttribute("style","font-weight: bold;"),i.outerHTML}var r={componentName:xt.ComponentName.TextBlock,text:n,link:a.toString(),styles:{fontWeight:"bold"}};return(null===(t=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===t?void 0:t.render(r))||""},n}(Jt),en=function(e){function n(n){var a=e.call(this,n)||this;return a.distribution=t.Email,a}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n,a=e.text,i=e.link,r=e.align,s=this.context.localSectionTheme;if(w()){var c=document.createElement("a");c.href=i.toString(),c.setAttribute("role","link"),c.setAttribute("aria-label",a),c.style.fontSize="".concat(16,"px"),c.style.fontWeight="".concat(400),c.style.lineHeight="".concat(22,"px"),c.style.setProperty("text-decoration","none","important"),c.style.setProperty("color",s.semanticColors.primaryButtonText,"important"),c.style.backgroundColor="".concat(s.semanticColors.primaryButtonBackground),c.style.marginBottom="".concat(8,"px"),c.title=(0,o.escape)(a),c.textContent=(0,o.escape)(a),n=c}else{var d={componentName:xt.ComponentName.TextBlock,text:(0,o.escape)(a),link:i.toString(),styles:{fontSize:"medium",fontWeight:"normal",lineHeight:"".concat(22,"px"),textDecoration:"none",fontColor:"".concat(s.semanticColors.primaryButtonText)}},l=null===(t=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===t?void 0:t.render(d);if(!l)return"";n=(new DOMParser).parseFromString(l,"text/html").body.firstChild||""}return Z(n,null!=r?r:"Center",8,16,this.context.localSectionTheme.semanticColors.primaryButtonBackground||"",void 0,void 0,"button-root-table")},n}(Jt),tn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentName=xt.ComponentName.VideoCard,t}return(0,ke.__extends)(t,e),t}(Ct),nn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t=e.thumbnailLink.link,n=t.url;return{blocks:[{blockType:"UNSTYLED",spans:[{text:t.title||"",styles:[],entity:{type:"LINK",url:f()?Y.UrlUtility.absolutizeUrl(n):Ee(n)}}]}],attachments:[]}},n}(tn),an=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n=e.thumbnailLink,a=e.fileType,i=n.link,r=i.title,o=i.description,s=i.url,c=i._skipLinkPreview,d={componentName:xt.ComponentName.FileCard,thumbnailLink:{link:{title:r,url:Ee(s),description:o,_skipLinkPreview:c}},fileType:a};return null===(t=this.context.getComponent(xt.ComponentName.FileCard))||void 0===t?void 0:t.render(d)},n}(tn),rn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Email,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n,a,i=e.fileType,d=e.thumbnailLink,l=d.link,p=d.thumbnail,m=l.url,_=l.title,h=l.description,b=this.context.localSectionTheme,g=Y.UrlUtility.absolutizeUrl(m),v=R(this.context.endpointDetails)&&this.context.endpointDetails?ee(!1,this.context.endpointDetails)*(380/700):380,y=T()?Y.Icons.getIconUrl(i,96):St("video",mt.medium),S=document.createElement("table");S.border="0",S.cellPadding="0",S.cellSpacing="0",S.align="center",S.width="100%",S.style.maxWidth=R(this.context.endpointDetails)?"".concat(ee(!1,this.context.endpointDetails),"px"):"".concat(r.TABLE_RENDER_WIDTH,"px"),S.style.display="block",S.style.borderRadius="".concat(r.CORNER_ROUND,"px"),S.style.border="1px solid ".concat(b.semanticColors.variantBorder),S.style.boxShadow="".concat(b.semanticColors.cardShadow);var D=S.insertRow().insertCell();D.width="100%",D.align="left",D.style.borderRadius="".concat(r.CORNER_ROUND,"px"),D.style.maxWidth=R(this.context.endpointDetails)?"".concat(ee(!1,this.context.endpointDetails),"px"):"".concat(r.TABLE_RENDER_WIDTH,"px");var x=document.createElement("a");x.href=f()?(0,o.escape)(g):Ee(g),x.setAttribute("data-loopstyle","embedded"),x.style.setProperty("text-decoration","none","important"),x.style.cursor="pointer",x.id=te(),x.className=s,x.style.setProperty("color",b.semanticColors.link,"important");var C={componentName:xt.ComponentName.Image,imageUrl:(null==p?void 0:p.source.url)||"",width:R(this.context.endpointDetails)?ee(!1,this.context.endpointDetails):ee(),fallbackImageUrl:y,altText:_,cornerRounding:"top",_sharepointIds:null==p?void 0:p.source.sharepointIds};I()&&(C.additionalStyles={height:"".concat(v,"px")});var O=(null===(n=null===(t=this.context)||void 0===t?void 0:t.getComponent(xt.ComponentName.Image))||void 0===n?void 0:n.render(C))||"",w=document.createElement("span");if(I()&&w.style.setProperty("max-height","".concat(v,"px"),"important"),w.style.overflow="hidden",w.innerHTML=O,x.appendChild(w),D.appendChild(x),!u._SPKillSwitch.isActivated("6d4b1e3a-7f6d-4b3b-8f3e-5b8f5c3b7a8e")&&h){var E={componentName:xt.ComponentName.TextBlock,text:h,styles:{fontSize:"small",fontWeight:"normal"}},A=null===(a=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===a?void 0:a.render(E);if(A){var L=S.insertRow().insertCell(),k=document.createElement("div");k.style.textAlign="center",k.innerHTML=A,L.appendChild(k)}}var M=S.insertRow().insertCell();M.width="100%",M.style.padding="8px";var P=document.createElement("a");P.href=f()?(0,o.escape)(g):Ee(g),P.id=te(),P.className=s,P.style.setProperty("text-decoration","none","important"),P.style.setProperty("color",b.semanticColors.link,"important");var U=Y.Icons.getIconUrl(i,r.ICON_SIZE),F=document.createElement("div");F.align="left";var H=document.createElement("img");H.width=r.ICON_SIZE,H.height=r.ICON_SIZE,H.src=U,H.style.verticalAlign="bottom",H.setAttribute(c,"SPO");var N=document.createElement("span");N.style.fontSize="14px",N.style.display="inline-block",N.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;";var B=document.createElement("span");return B.style.fontSize="14px",B.style.fontWeight="600",B.style.overflow="hidden",B.style.textOverflow="ellipsis",B.style.fontFamily=G(this.context.globalPageTheme),B.style.display="inline-block",B.style.verticalAlign="bottom",u._SPKillSwitch.isActivated("356e9db2-155e-4904-b24d-e3c34c5c1015")||(B.style.lineHeight="1.5"),B.innerHTML=(0,o.escape)((_||"").substring(0,r.MAX_TITLE_CHAR_CARD))||"",B.style.color=b.semanticColors.link,F.appendChild(H),F.appendChild(N),F.appendChild(B),P.appendChild(F),M.appendChild(P),S.outerHTML},n}(tn),on=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Teams,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t=e.thumbnailLink,n=e.fileType,a=e._spItem,i=t.link,r=i.title,s=i.description,c=i.url,d=document.createElement("a");d.href=f()?(0,o.escape)(Y.UrlUtility.absolutizeUrl(c)):Ee(c),d.target="_blank",d.textContent=(0,o.escape)(r),d.title=(0,o.escape)(r);var u,p,m=document.createElement("p"),_=document.createElement("span");if(a&&(u=c,void 0===(p=!0)&&(p=!1),p?pe.test(u):l.test(u))){var h={link:c,title:r,description:s,fileType:n,spItem:a};if(-1!==this.context.getAttachment(h)){var b=this._createUnfurlPropsFromProps(e,a);Object.keys(b).forEach(function(e){d.setAttribute(e,b[e])})}}return _.appendChild(d),s&&(m.textContent=(0,o.escape)(s),_.appendChild(m)),_.outerHTML},n.prototype._createUnfurlPropsFromProps=function(e,t){var n=e.thumbnailLink,a=e.fileType,i=n.link,r=i.title,s=i.url,c=Y.UrlUtility.absolutizeUrl(s),d=t.uniqueId;return{"data-item-props":JSON.stringify({objectUrl:c,type:a,title:r}),itemtype:"http://schema.skype.com/HyperLink/File",itemid:(0,o.escape)(d||"").toUpperCase(),"data-processed-url":"true",title:(0,o.escape)(c||"")}},n}(tn),sn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentName=xt.ComponentName.PeopleCard,t}return(0,ke.__extends)(t,e),t.prototype.generatePersonElement=function(e){var t=document.createElement("p"),n=this.getPersonName(e),a=this.getPersonRole(e),i="".concat(n).concat(a?",&nbsp":"").concat(a);return t.innerHTML=i,t},t.prototype.generateLinkElement=function(e){var t,n,a,i,r={componentName:xt.ComponentName.TextBlock,text:null!==(t=e.person.linkName)&&void 0!==t?t:"",link:null!==(n=e.person.linkUrl)&&void 0!==n?n:""},o=null===(i=null===(a=this.context)||void 0===a?void 0:a.getComponent(xt.ComponentName.TextBlock))||void 0===i?void 0:i.render(r);if(o)return(new DOMParser).parseFromString(o,"text/html").body.firstChild},t.prototype.generateDescriptionElement=function(e){var t,n,a,i={componentName:xt.ComponentName.TextBlock,text:null!==(t=e.person.description)&&void 0!==t?t:""},r=null===(a=null===(n=this.context)||void 0===n?void 0:n.getComponent(xt.ComponentName.TextBlock))||void 0===a?void 0:a.render(i);if(r)return(new DOMParser).parseFromString(r,"text/html").body.firstChild},t.prototype.getPersonName=function(e){return(0,o.escape)(e.person.name)},t.prototype.getPersonRole=function(e){return(0,o.escape)(e.person.role||"")},t}(Ct);function cn(e,t){return e&&e.length>t?"".concat(e.substring(0,t)):e}var dn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Email,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t=this._generateEmailPeopleCardProps(e);return this._generateCards(t)},n.prototype._generateEmailPeopleCardProps=function(e){switch(e.CardLayout){case xt.CardLayout.ExtraSmallCard:return this._generateExtraSmallCardProps(e);case xt.CardLayout.SmallCard:return this._generateSmallCardProps(e);case xt.CardLayout.MediumCard:return this._generateMediumCardProps(e);case xt.CardLayout.LargeCard:return this._generateLargeCardProps(e);default:return this._generateSmallCardProps(e)}},n.prototype._generateCardProps=function(e,t,n,a,i,r,o,s){var c;return(0,ke.__assign)((0,ke.__assign)({},e),{personaImageUrl:this._getUserPhotoUrl(le(this.context.authority),e.person.email,t),fallbackImageUrl:this._getFallbackUserPhotoUrl(le(this.context.authority),t),imageNaturalDimensions:this._getPersonaImageDimensionsBySize(t),trimmedDescription:cn(e.person.description,a),trimmedLinkName:cn(e.person.linkName,n),fullLinkName:null!==(c=e.person.linkName)&&void 0!==c?c:"",cardPadding:i,linkHeight:16,horzPadding:8,descPaddingTop:12,descHeight:50,cardRadius:8,nameHeight:20,roleHeight:16,nameFontSize:"small",roleFontSize:"x-small",imagePaddingRight:r,imagePaddingTop:o,imagePaddingBottom:s,nameColor:this.context.localSectionTheme.semanticColors.bodyText,roleColor:this.context.localSectionTheme.semanticColors.bodySubtext,linkColor:this.context.localSectionTheme.semanticColors.link,descriptionColor:this.context.localSectionTheme.palette.neutralPrimary,borderColor:this.context.localSectionTheme.semanticColors.variantBorder,backgroundColor:this.context.localSectionTheme.semanticColors.bodyBackground})},n.prototype._getPersonaImageDimensionsBySize=function(e){switch(e){case"XS":return{width:35,height:35};default:return{width:48,height:48};case"M":return{width:56,height:56};case"L":return{width:100,height:100}}},n.prototype._generateExtraSmallCardProps=function(e){return this._generateCardProps(e,"XS",h()?35:24,50,r.PADDING_PERSONA_TABLE_EXTRA_SMALL,r.PERSONA_GAP,28,12)},n.prototype._generateSmallCardProps=function(e){return this._generateCardProps(e,"S",h()?35:24,50,r.PADDING_PERSONA_TABLE_SMALL,r.PERSONA_GAP,28,12)},n.prototype._generateMediumCardProps=function(e){return this._generateCardProps(e,"M",h()?Number.MAX_VALUE:24,50,0,16,28,12)},n.prototype._generateLargeCardProps=function(e){return this._generateCardProps(e,"L",h()?Number.MAX_VALUE:35,190,0,16,20,12)},n.prototype._getUserPhotoUrl=function(e,t,n){var a=escape(t);return"".concat(e,"/_layouts/15/userPhoto.aspx?size=").concat(n,"&accountName=").concat(a,"&forceRedirectToCDN=true&default=user")},n.prototype._getFallbackUserPhotoUrl=function(e,t){return"".concat(e,"/_layouts/15/userPhoto.aspx?size=").concat(t)},n.prototype._generateCards=function(e){switch(e.CardLayout){case xt.CardLayout.ExtraSmallCard:case xt.CardLayout.SmallCard:return this._getProfileNameRoleTable(e);case xt.CardLayout.MediumCard:return this._generateMediumCardWithLink(e);case xt.CardLayout.LargeCard:return h()?this._generateLargeCardOld(e):this._generateLargeCard(e);default:return""}},n.prototype._generateMediumCardWithLink=function(e){var t=this._getProfileNameRoleTable(e),n=this._generateLargeAndMediumCardOuterTable(e),a=n.insertRow().insertCell();if(a.style.paddingTop="".concat(e.imagePaddingTop,"px"),a.style.paddingBottom="".concat(e.imagePaddingBottom,"px"),a.innerHTML=t,h()){var i=n.insertRow().insertCell();if(i.dataset.testid="person-link-cell",i.width="100%",i.height="".concat(e.linkHeight),i.style.paddingBottom="".concat(e.horzPadding,"px"),i.style.display="block",i.style.overflow="hidden",i.style.textOverflow="ellipsis",i.style.whiteSpace="normal",i.style.overflowWrap="normal",i.style.wordBreak="break-all",e.person.linkUrl){var r=this._generateLinkElement(e);i.innerHTML=r}}var o=n.insertRow().insertCell();if(o.dataset.testid="person-desc-cell",o.width="100%",h()?(o.height="".concat(e.descHeight),o.style.minHeight="".concat(e.descHeight,"px"),o.style.paddingTop="".concat(e.descPaddingTop,"px"),o.style.paddingBottom="".concat(e.descPaddingTop+16,"px")):(o.height="".concat(e.descHeight),o.style.paddingBottom="".concat(e.descPaddingTop,"px"),o.style.whiteSpace="normal",o.style.wordBreak="break-all",o.style.verticalAlign="top"),o.style.display="block",o.style.overflow="hidden",o.style.textOverflow="ellipsis",e.person.description){var s=this._generateLinkDescriptionElement(e);o.innerHTML=s}else o.innerHTML="<div></div>";return n.outerHTML},n.prototype._generateLinkElement=function(e){var t,n,a,i={componentName:xt.ComponentName.TextBlock,text:null!==(t=e.trimmedLinkName)&&void 0!==t?t:"",altText:e.fullLinkName,link:e.person.linkUrl,styles:{fontSize:"small",fontColor:e.linkColor}};return(null===(a=null===(n=this.context)||void 0===n?void 0:n.getComponent(xt.ComponentName.TextBlock))||void 0===a?void 0:a.render(i)).trim()},n.prototype._generateLinkDescriptionElement=function(e){var t,n,a,i={componentName:xt.ComponentName.TextBlock,text:null!==(t=e.trimmedDescription)&&void 0!==t?t:"",styles:{fontSize:"small",fontColor:e.descriptionColor}};return(null===(a=null===(n=this.context)||void 0===n?void 0:n.getComponent(xt.ComponentName.TextBlock))||void 0===a?void 0:a.render(i)).trim()},n.prototype._generateLargeAndMediumCardOuterTable=function(e){var t=document.createElement("table");return t.dataset.testid="person-card-table",t.width="100%",t.border="0",t.cellSpacing="0",t.cellPadding="0",t.style.borderCollapse="separate",h()||(t.style.height="100%"),t.style.paddingLeft="16px",t.style.paddingRight="16px",t.style.backgroundColor=e.backgroundColor,t.style.border="1px solid",t.style.borderColor=e.borderColor,t.style.borderRadius="".concat(e.cardRadius,"px"),t.style.boxSizing="border-box",t.style.boxShadow="rgba(0, 0, 0, 0.14) 0px 2px 4px, rgba(0, 0, 0, 0.12) 0px 0px 2px",t},n.prototype._generatePersonDetailsDiv=function(e){var t=this._generateTitleDivBlock(e),n=this._generateRoleDivBlock(e),a=document.createElement("div");return a.style.textAlign="left",a.dataset.id="topicHeader",a.appendChild(t),a.appendChild(n),e.person.linkUrl&&a.appendChild(this._generateLinkDivBlock(e)),a},n.prototype._generateLinkDivBlock=function(e){var t=document.createElement("div");t.dataset.testid="person-link-text";var n=this._generateLinkElement(e);return t.innerHTML=n.trim(),t},n.prototype._generateRoleDivBlock=function(e){var t,n,a,i={fontSize:"".concat(e.roleFontSize),fontWeight:"normal",overflow:"hidden",textOverflow:"ellipsis",fontColor:e.roleColor},r={componentName:xt.ComponentName.TextBlock,text:null!==(t=e.person.role)&&void 0!==t?t:"",styles:i},o=null===(a=null===(n=this.context)||void 0===n?void 0:n.getComponent(xt.ComponentName.TextBlock))||void 0===a?void 0:a.render(r),s=document.createElement("div");return s.innerHTML=o.trim(),s.style.lineHeight="".concat(e.roleHeight,"px"),s.dataset.testid="person-role-text",s.style.fontFamily=z(this.context.globalPageTheme),s},n.prototype._generateTitleDivBlock=function(e){var t,n,a={fontSize:"".concat(e.nameFontSize),fontWeight:"semi-bold",overflow:"hidden",textOverflow:"ellipsis",fontColor:e.nameColor},i={componentName:xt.ComponentName.TextBlock,text:e.person.name,styles:a},r=null===(n=null===(t=this.context)||void 0===t?void 0:t.getComponent(xt.ComponentName.TextBlock))||void 0===n?void 0:n.render(i),o=document.createElement("div");return o.innerHTML=r.trim(),o.title=escape(e.person.name),o.dataset.testid="person-name-text",o.style.lineHeight="".concat(e.nameHeight,"px"),o.style.fontFamily=z(this.context.globalPageTheme),o},n.prototype._generateLargeCard=function(e){var t=this._generatePersonImage(e),n=this._generateLargeAndMediumCardOuterTable(e),a=document.createElement("tr"),i=document.createElement("td");i.width="".concat(e.imageNaturalDimensions.width),i.height="".concat(e.imageNaturalDimensions.height),i.style.paddingTop="".concat(e.imagePaddingTop,"px"),i.style.paddingBottom="".concat(e.imagePaddingBottom,"px"),i.align="center",i.dataset.testid="person-profile-cell",i.setAttribute("role","presentation"),i.appendChild(t),a.appendChild(i);var r=document.createElement("tr"),o=document.createElement("td"),s=this._generatePersonDetailsDiv(e);o.appendChild(s),o.style.paddingTop="8px",o.style.paddingBottom="8px",o.align="left",o.height="21",o.dataset.testid="person-name-cell",r.appendChild(o);var c=document.createElement("tr"),d=document.createElement("td");if(d.style.minHeight="130px",d.style.display="block",d.style.overflow="hidden",d.style.textOverflow="ellipsis",d.style.verticalAlign="top",d.height="130",d.width="100%",d.dataset.testid="person-desc-cell",e.person.description){var l=this._generateLinkDescriptionElement(e);d.innerHTML=l}else d.innerHTML="<div></div>";return c.appendChild(d),n.appendChild(a),n.appendChild(r),n.appendChild(c),n.outerHTML},n.prototype._generateLargeCardOld=function(e){var t=this._generatePersonImage(e),n=this._generateTitleDivBlock(e),a=this._generateRoleDivBlock(e),i=this._generateLargeAndMediumCardOuterTable(e),r=i.insertRow(),o=r.insertCell();o.width="".concat(e.imageNaturalDimensions.width),o.height="".concat(e.imageNaturalDimensions.height),o.style.paddingTop="".concat(e.imagePaddingTop,"px"),o.style.paddingBottom="".concat(e.imagePaddingBottom,"px"),o.align="center",o.dataset.testid="person-profile-cell",o.setAttribute("role","presentation"),o.appendChild(t),r.appendChild(o);var s=document.createElement("tr"),c=document.createElement("td");c.style.paddingTop="8px",c.style.paddingBottom="8px",c.align="left",c.height="21",c.dataset.testid="person-name-cell",c.appendChild(n),s.appendChild(c);var d=document.createElement("tr"),l=document.createElement("td");l.style.paddingBottom="8px",l.align="left",l.dataset.testid="person-role-cell",l.appendChild(a),d.appendChild(l);var u=document.createElement("tr"),f=document.createElement("td");f.style.paddingBottom="8px",f.style.display="block",f.style.overflow="hidden",f.style.textOverflow="ellipsis",f.style.whiteSpace="normal",f.style.overflowWrap="normal",f.style.wordBreak="break-all",f.height="16",f.width="100%",f.dataset.testid="person-link-cell";var p=this._generateLinkElement(e);f.innerHTML=p,u.appendChild(f);var m=document.createElement("tr"),_=document.createElement("td");if(_.style.minHeight="130px",_.style.paddingTop="12px",_.style.paddingBottom="28px",_.style.display="block",_.style.overflow="hidden",_.style.textOverflow="ellipsis",_.height="130",_.width="100%",_.dataset.testid="person-desc-cell",e.person.description){var h=this._generateLinkDescriptionElement(e);_.innerHTML=h}return m.appendChild(_),i.appendChild(r),i.appendChild(s),i.appendChild(d),i.appendChild(u),i.appendChild(m),i.outerHTML},n.prototype._getProfileNameRoleTable=function(e){var t=this._generatePersonImage(e),n=document.createElement("table");n.dataset.testid="person-profile-table",e._align&&(n.align=e._align),e._align&&"Center"===e._align||(n.width="100%"),n.border="0",n.cellSpacing="0",n.cellPadding="0",n.style.padding="".concat(e.cardPadding,"px");var a=n.insertRow(),i=a.insertCell();if(i.dataset.testid="person-profile-cell",i.width="".concat(e.imageNaturalDimensions.width),i.height="".concat(e.imageNaturalDimensions.height),i.align="center",i.setAttribute("role","presentation"),i.style.paddingRight="".concat(e.imagePaddingRight,"px"),i.appendChild(t),h()){var r=this._generateTitleDivBlock(e),o=this._generateRoleDivBlock(e);(c=a.insertCell()).dataset.testid="person-name-cell",c.height="".concat(e.nameHeight);var s=document.createElement("div");s.style.textAlign="left",s.dataset.id="topicHeader",s.appendChild(r),s.appendChild(o),c.appendChild(s)}else{var c;(c=a.insertCell()).dataset.testid="person-name-cell",c.height="".concat(e.nameHeight);var d=this._generatePersonDetailsDiv(e);c.appendChild(d)}return n.outerHTML},n.prototype._generatePersonImage=function(e){var t,n,a,i={componentName:xt.ComponentName.Image,imageUrl:e.personaImageUrl,fallbackImageUrl:e.fallbackImageUrl,width:e.imageNaturalDimensions.width,height:e.imageNaturalDimensions.height,cornerRounding:"circular"},r=null!==(a=null===(n=null===(t=this.context)||void 0===t?void 0:t.getComponent(xt.ComponentName.Image))||void 0===n?void 0:n.render(i))&&void 0!==a?a:"",o=(new DOMParser).parseFromString(r,"text/html").body.firstChild;return o.dataset.testid="person-image",o.align="center",o},n}(sn),ln=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Teams,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){if(!e.person.name)return"";switch(e.CardLayout){case xt.CardLayout.ExtraSmallCard:case xt.CardLayout.SmallCard:return this._generateSmallCard(e);case xt.CardLayout.MediumCard:case xt.CardLayout.LargeCard:return this._generateLargeAndMediumCard(e);default:return""}},n.prototype.getPersonName=function(e){return e.person.aadObjectId?this._populateAtMentionList(e.person):this._createNonMentionTag(e.person)},n.prototype._generateLargeAndMediumCard=function(e){var t=document.createElement("div"),n=this.generatePersonElement(e);t.appendChild(n);var a=this.generateLinkElement(e);a&&t.appendChild(a);var i=this.generateDescriptionElement(e);return i&&t.appendChild(i),t.innerHTML},n.prototype._generateSmallCard=function(e){return this.generatePersonElement(e).outerHTML},n.prototype._createNonMentionTag=function(e){var t=document.createElement("span");return t.style.color=Ie,t.textContent=(0,o.escape)(e.name),t.outerHTML},n.prototype._populateAtMentionList=function(e){var t=this.context.getPerson(e);return this._createTeamsAtMention(e.name,t)},n.prototype._createTeamsAtMention=function(e,t){var n=document.createElement("readonly");n.className="skipProofing",n.contentEditable="false",n.setAttribute("itemtype",_e);var a=document.createElement("span");a.className="personTag",a.setAttribute("itemtype",_e),a.setAttribute("itemscope",""),a.setAttribute("itemid",t.toString());var i=document.createElement("span");return i.style.color=Ie,i.textContent=(0,o.escape)(e),a.appendChild(i),n.appendChild(a),n.outerHTML},n}(sn),un=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n,a={blocks:[],attachments:[]};if(!e.person.name)return a;var i=[Pt("".concat(e.person.name,", ")),Pt(null!==(t=e.person.role)&&void 0!==t?t:"")];if(a.blocks.push(Tt(i)),e.CardLayout!==xt.CardLayout.SmallCard){var r=e.person.linkUrl;if(r){var o=Y.UrlUtility.absolutizeUrl(r),s=[Pt("".concat(null!==(n=e.person.linkName)&&void 0!==n?n:r),[],{type:"LINK",url:o})];a.blocks.push(Tt(s))}var c=e.person.description;c&&(s=[Pt("".concat(c))],a.blocks.push(Tt(s))),a.blocks.push(Ce)}return a},n}(sn),fn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){if(!e.person.name)return"";var t=this.generatePersonElement(e);if(e.CardLayout===xt.CardLayout.SmallCard)return t.outerHTML;var n=document.createElement("div");n.appendChild(t);var a=this.generateLinkElement(e);a&&n.appendChild(a);var i=this.generateDescriptionElement(e);return i&&n.appendChild(i),n.innerHTML},n.prototype.getPersonName=function(t){return n=E()?t.person.email:Ae(t.person.email),Oe.test(n)?this._getMailToLink(t):e.prototype.getPersonName.call(this,t);var n},n.prototype._getMailToLink=function(e){var t=E()?e.person.email:Ae(e.person.email),n=document.createElement("a");return n.textContent=e.person.name,n.setAttribute("href","mailto:".concat(t)),n.outerHTML},n}(sn),pn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentName=xt.ComponentName.PeopleLayout,t}return(0,ke.__extends)(t,e),t.prototype.generatePeopleCard=function(e,t){var n,a,i={componentName:xt.ComponentName.PeopleCard,person:e,CardLayout:t};return(null===(a=null===(n=this.context)||void 0===n?void 0:n.getComponent(xt.ComponentName.PeopleCard))||void 0===a?void 0:a.render(i)).trim()},t}(Ct),mn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Email,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t;if(!e.people||e.people&&0===e.people.length)return"";var n=R()?ee(!1,this.context.endpointDetails):ee(!1),a=document.createElement("table");a.dataset.testid="people-main-table",a.width="100%",a.border="0",a.cellPadding="0",a.cellSpacing="0",a.align="center",a.style.maxWidth="".concat(n,"px");for(var i=0;e.people.length>0&&i<e.people.length;i++){var r=document.createElement("tr");r.dataset.testid="people-row",r.style.display="flex",r.style.flexWrap="wrap",r.style.justifyContent="left";var o=this._generatePeopleCell(e.people[i],e.cardLayout);if(r.appendChild(o),R(this.context.endpointDetails)&&(null===(t=this.context.endpointDetails)||void 0===t?void 0:t.isMultiColumnSection))a.appendChild(r);else{if(++i<e.people.length){var s=this._generatePeopleCell(e.people[i],e.cardLayout);r.appendChild(s)}else{var c=document.createElement("td");if(R())this._applyPersonCardMultiColumnCellStyle(c,e.cardLayout,n);else{var d=this._getPersonCardCellStyle(e.cardLayout,n);c.style.cssText=d}h()||(c.dataset.testid="person-empty-cell"),r.appendChild(c)}a.appendChild(r)}}return a.outerHTML},n.prototype._generatePeopleCell=function(e,t){var n=R()&&this.context.endpointDetails?this.context.endpointDetails.maxColumnWidth:700,a=this.context.globalPageTheme.palette.neutralPrimary,i=this._getPersonCardCellStyle(t,n,a),r=this._getCardWidthPerc(t,n),o=document.createElement("td"),s="person-card-"+t;return o.dataset.testid=s,o.style.cssText=i,o.width="".concat(r,"%"),o.innerHTML=this._renderPeopleCard(e,t),o},n.prototype._renderPeopleCard=function(e,t){var n,a,i={componentName:xt.ComponentName.PeopleCard,person:e,CardLayout:t};return(null===(a=null===(n=this.context)||void 0===n?void 0:n.getComponent(xt.ComponentName.PeopleCard))||void 0===a?void 0:a.render(i)).trim()},n.prototype._applyPersonCardMultiColumnCellStyle=function(e,t,n,a){var i=this._getCardWidth(t,n),o=this._getCardWidthPerc(t,n);switch(t){case xt.CardLayout.LargeCard:case xt.CardLayout.MediumCard:e.style.padding="".concat(r.COL_SPACING_CARD/2,"px"),this._applyPersonCellFlexStyle(e,i);break;case xt.CardLayout.SmallCard:default:e.width="".concat(o,"%"),e.style.width="".concat(o,"%"),e.style.color=null!=a?a:"",e.style.padding="".concat(r.MARGIN_ROW_NS/2,"px 0"),this._applyPersonCellFlexStyle(e,i)}},n.prototype._applyPersonCellFlexStyle=function(e,t){var n;e.style.flex="45%",e.style.minWidth=(null===(n=this.context.endpointDetails)||void 0===n?void 0:n.isMultiColumnSection)?"".concat(190,"px"):"".concat(210,"px"),e.style.maxWidth="".concat(t,"px")},n.prototype._getPersonCardCellStyle=function(e,t,n){var a=this._getCardWidth(e,t),i=this._getCardWidthPerc(e,t),o=this._getFlexStyle(a);switch(e){case xt.CardLayout.LargeCard:case xt.CardLayout.MediumCard:return"padding:".concat(r.COL_SPACING_CARD/2,"px; ").concat(o);case xt.CardLayout.SmallCard:default:return"width:".concat(i,"%; ").concat(n?"color:".concat(n,";"):""," padding:").concat(r.MARGIN_ROW_NS/2,"px 0; ").concat(o)}},n.prototype._getFlexStyle=function(e){return"flex:45%; min-width:210px; max-width:".concat(e,"px;")},n.prototype._getCardWidth=function(e,t){var n;return R()&&(null===(n=this.context.endpointDetails)||void 0===n?void 0:n.isMultiColumnSection)?t-(e===xt.CardLayout.SmallCard?0:r.COL_SPACING_CARD):t/2-(e===xt.CardLayout.SmallCard?0:r.COL_SPACING_CARD)},n.prototype._getCardWidthPerc=function(e,t){var n,a=this._getCardWidth(e,t);return R()&&(null===(n=this.context.endpointDetails)||void 0===n?void 0:n.isMultiColumnSection)?Math.round(100*a/t):e===xt.CardLayout.SmallCard?50:Math.round(100*a/t)},n}(pn),_n=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Teams,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t=this,n=[];if(e.people.forEach(function(a,i){xt.CardLayout.SmallCard===e.cardLayout?n.push(t._generateSmallPeopleLinkItem(a,e.cardLayout)):(n.push(t._generateMediumAndLargePeopleLinkItem(a,e.cardLayout)),n.push(i!==e.people.length-1||1===e.people.length?"<hr>":""))}),xt.CardLayout.SmallCard===e.cardLayout){if(n.length>0){var a=document.createElement("ul");return a.innerHTML=n.join(""),a.outerHTML}return""}return n.length>0?"".concat(n.join("")):""},n.prototype._generateSmallPeopleLinkItem=function(e,t){var n=this.generatePeopleCard(e,t),a=document.createElement("li");return a.innerHTML=n,a.outerHTML},n.prototype._generateMediumAndLargePeopleLinkItem=function(e,t){return this.generatePeopleCard(e,t)},n}(pn),hn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t=this,n={blocks:[],attachments:[]};return e.people.forEach(function(a,i){var r=t._renderPeopleCard(a,e.cardLayout);n=Ut(n,r)}),n},n.prototype._renderPeopleCard=function(e,t){var n,a,i={componentName:xt.ComponentName.PeopleCard,person:e,CardLayout:t};return null===(a=null===(n=this.context)||void 0===n?void 0:n.getComponent(xt.ComponentName.PeopleCard))||void 0===a?void 0:a.render(i)},n}(pn),bn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t=this;if(e.people.length<1)return"";var n=e.cardLayout,a=document.createElement("div");return e.people.forEach(function(e){var i=t.generatePeopleCard(e,n);if(i){n!==xt.CardLayout.SmallCard&&a.childElementCount>0&&a.appendChild(document.createElement("br"));var r=document.createElement("div");r.innerHTML=i,a.appendChild(r)}}),a.innerHTML},n}(pn),gn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentName=xt.ComponentName.Divider,t}return(0,ke.__extends)(t,e),t}(Ct),vn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){return{blocks:[],attachments:[]}},n}(gn),yn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){return document.createElement("hr").outerHTML},n}(gn),Sn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Teams,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){return document.createElement("hr").outerHTML},n}(gn),Dn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Email,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n=e.length,a=e.weight,i=null!==(t=this.context.localSectionTheme.palette.neutralTertiaryAlt)&&void 0!==t?t:"#c7c7c7",r=document.createElement("div");r.setAttribute("aria-hidden","true"),r.setAttribute("role","presentation");var o=document.createElement("table");o.setAttribute("role","presentation"),o.style.border="0px",o.style.width="".concat(n,"%"),o.style.padding="0px",o.style.borderSpacing="0px",o.setAttribute("align","center");var s=document.createElement("tr"),c=document.createElement("td");return c.style.height="0px",c.style.width="100%",c.style.margin="0",c.style.borderTop="".concat(a,"px solid"),c.style.borderColor=i,c.style.borderLeftStyle="none",c.style.borderRightStyle="none",c.style.borderBottomStyle="none",s.appendChild(c),o.appendChild(s),r.appendChild(o),r.innerHTML+="<br>",r.outerHTML},n}(gn),In=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentName=xt.ComponentName.Spacer,t}return(0,ke.__extends)(t,e),t}(Ct),xn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){return{blocks:[],attachments:[]}},n}(In),Cn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){return"containerBlocks"},n}(In),On=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Teams,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){for(var t=e.height,n=document.createElement("div"),a=(t-2*V())/19,i=0;i<a;i++)n.appendChild(document.createElement("br"));return n.outerHTML},n}(In),wn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Email,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t=e.height,n=this._getHeight(t),a=document.createElement("div");return a.setAttribute("aria-hidden","true"),a.setAttribute("role","presentation"),a.setAttribute("tabIndex","-1"),a.setAttribute("height","".concat(n)),a.style.height="".concat(n,"px"),a.style.lineHeight="".concat(n,"px"),a.style.outline="0",a.style.position="relative",a.innerHTML="&nbsp;",a.outerHTML},n.prototype._getHeight=function(e){return 2*V()>e?e:Math.abs(e-2*V())},n}(In),En=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentName=xt.ComponentName.FileCard,t}return(0,ke.__extends)(t,e),t.prototype.getFileLink=function(e){var t,n=e.thumbnailLink.link.url,a={componentName:xt.ComponentName.TextBlock,text:this.getFileName(e),link:n};return null===(t=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===t?void 0:t.render(a)},t.prototype.getFileName=function(e){var t=e.fileType,n=e.thumbnailLink.link.title;return(0,o.escape)("".concat(n).concat(t?".".concat(t):""))},t}(Ct),An=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Email,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n,a,i,s,c,d,l,u,p=e.thumbnailLink,m=e.fileType,_=e.iconProps,h=p.link,b=p.thumbnail,g=h.url,v=h.title,y=h.description;if(!g)return"";var D=Y.UrlUtility.absolutizeUrl("/_layouts/15/images/sitepagethumbnail.png"),I=null!==(t=null!=m?m:Y.ExtensionHelper.getExtension(g))&&void 0!==t?t:"",x=document.createElement("table");x.border="0",x.cellPadding="0",x.cellSpacing="0",x.width="100%",x.align="center",x.style.maxWidth="".concat(r.TABLE_RENDER_WIDTH,"px"),x.style.boxShadow=this.context.localSectionTheme.semanticColors.cardShadow,x.style.borderRadius="".concat(r.CORNER_ROUND,"px"),x.style.border="1px solid ".concat(this.context.localSectionTheme.semanticColors.variantBorder),x.style.display="block",x.className="emailFileCard";var C=.4*r.TABLE_RENDER_WIDTH,O=C*(9/16),w=(null==_?void 0:_.iconUrl)?_.iconUrl:ae(I),E=(null==_?void 0:_.iconUrl)?_.iconUrl:ae(I,96),A=T()?E:yt(I,mt.medium),L=x.insertRow(),k=L.insertCell();k.rowSpan=2,k.width="".concat(40,"%"),k.align="left",k.style.borderRadius="".concat(r.CORNER_ROUND,"px 0 0 ").concat(r.CORNER_ROUND,"px"),k.style.maxWidth="".concat(r.TABLE_RENDER_WIDTH,"px"),k.style.padding="0px",k.className="emailFileCardImage";var M=document.createElement("a");M.href=f()?(0,o.escape)(g):Ee(g),M.style.setProperty("text-decoration","none","important"),M.style.setProperty("color",this.context.localSectionTheme.semanticColors.link,"important"),M.style.cursor="pointer",M.style.display="inline-block",M.id=te(),M.className="emailFileCardImageLink",M.style.wordBreak="break-word";var P=(null==b?void 0:b.source)?b.source.url:void 0,U={componentName:xt.ComponentName.Image,imageUrl:null!==(a=null!==(n=null!=P?P:g)&&void 0!==n?n:D)&&void 0!==a?a:A,altText:v,fallbackImageUrl:A,height:O,width:C,cropMode:q.CropMode.Fill,cornerRounding:S()?"top":"left",additionalStyles:{minHeight:"110px",objectFit:"contain",width:"100%",height:"".concat(O,"px"),verticalAlign:"bottom"},_fileType:I};(null===(i=null==b?void 0:b.source)||void 0===i?void 0:i.sharepointIds)&&(U._sharepointIds=b.source.sharepointIds);var F=null===(s=this.context.getComponent(xt.ComponentName.Image))||void 0===s?void 0:s.render(U);F&&""!==F&&(M.innerHTML=F),k.appendChild(M);var H=L.insertCell();H.width="".concat(60,"%"),H.style.verticalAlign="top",H.style.padding="0px 12px";var R=document.createElement("table");R.border="0",R.cellPadding="0",R.cellSpacing="0",R.align="left",R.style.padding="0px",R.className="emailFileCardContentTable";var N=R.insertRow().insertCell();N.vAlign="top",N.style.verticalAlign="top";var B=document.createElement("div");B.align="left",B.style.verticalAlign="top";var j=document.createElement("a");j.href=f()?(0,o.escape)(g):Ee(g),j.style.setProperty("text-decoration","none","important"),j.style.setProperty("color",this.context.localSectionTheme.semanticColors.link,"important"),j.style.cursor="pointer",j.id=te(),j.className="OWAAutoLink";var V=document.createElement("p");V.className="emailFileCardContentLink",V.style.fontFamily=z(this.context.globalPageTheme),V.style.margin="5px 0px",V.style.overflow="hidden",V.style.textOverflow="ellipsis",V.style.fontSize="14px",V.style.fontWeight="600";var G=(v||"").substring(0,r.MAX_TITLE_CHAR_CARD);if(V.innerHTML=G,j.appendChild(V),B.appendChild(j),!y){var K=document.createElement("p");K.setAttribute("height","16"),K.style.height="16px",K.style.fontSize="10px",K.style.margin="0",K.innerHTML="&nbsp;",N.appendChild(K)}if(N.appendChild(B),y){var W=R.insertRow().insertCell();W.vAlign="bottom",W.style.verticalAlign="bottom";var Q=document.createElement("div");Q.align="left",Q.style.verticalAlign="bottom";var J=document.createElement("p");J.style.fontFamily=z(this.context.globalPageTheme),J.style.overflow="hidden",J.style.textOverflow="ellipsis",J.style.minHeight="40px",J.className="emailFileCardDescription",S()||(J.style.fontSize="12px");var X=y.substring(0,r.MAX_TITLE_CHAR_CARD),Z={componentName:xt.ComponentName.TextBlock,text:X,styles:{fontWeight:"normal",fontSize:"x-small"}},$=null===(c=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===c?void 0:c.render(Z);J.innerHTML=$,Q.appendChild(J),W.appendChild(Q)}var ee=x.insertRow().insertCell();ee.vAlign="bottom",ee.style.verticalAlign="bottom",ee.style.padding="0px 12px",H.appendChild(R);var ie=document.createElement("table");ie.border="0",ie.cellPadding="0",ie.cellSpacing="0",ie.align="left",ie.style.padding="12px 0px",ee.appendChild(ie);var re=ie.insertRow(),oe=re.insertCell();oe.style.verticalAlign="bottom",oe.style.paddingRight="8px";var se=document.createElement("span"),ce={componentName:xt.ComponentName.Image,imageUrl:w,altText:I,width:20,height:20,cropMode:q.CropMode.Fill,additionalStyles:{verticalAlign:"bottom"}},de=null===(d=this.context.getComponent(xt.ComponentName.Image))||void 0===d?void 0:d.render(ce);de&&""!==de&&(se.innerHTML=de),oe.appendChild(se);var le=re.insertCell();le.style.verticalAlign="middle";var ue={componentName:xt.ComponentName.TextBlock,text:null!==(l=null==_?void 0:_.iconText)&&void 0!==l?l:ne(I),styles:{fontSize:"xx-small",lineHeight:"14px"}},fe=null===(u=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===u?void 0:u.render(ue),pe=(new DOMParser).parseFromString(fe,"text/html").body.querySelector("span");return pe.className="emailFileCardIconName",le.appendChild(pe),x.outerHTML},n}(En),Ln=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Teams,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n=e.thumbnailLink.link,a=n.url,i=n.description;if(!a)return"";var r=this.getFileLink(e);if(i){var o={componentName:xt.ComponentName.TextBlock,text:i},s=null===(t=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===t?void 0:t.render(o);return"".concat(r," ").concat(s)}return r},n}(En),kn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n=e.thumbnailLink.link,a=n.url,i=n.title,r={componentName:xt.ComponentName.TextBlock,text:i||"",link:a};return null===(t=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===t?void 0:t.render(r)},n}(En),Mn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){if(!e.thumbnailLink.link.url)return"";var t=this.getFileLink(e);if(e.thumbnailLink.link._skipLinkPreview)return t;var n={link:Y.UrlUtility.absolutizeUrl(e.thumbnailLink.link.url),fileType:a.WebLink};return this.context.getAttachment(n),t},n}(En);const Pn=p.p+"odm_YouTube_20x20_5c2cbec1.png";var Tn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentName=xt.ComponentName.YoutubeCard,t}return(0,ke.__extends)(t,e),t.prototype.extractYouTubeVideoIdFromLink=function(e){var t=new URL(e),n=null;return"youtu.be"===t.hostname?n=t.pathname.slice(1):"www.youtube.com"!==t.hostname&&"www.youtube-nocookie.com"!==t.hostname||("/watch"===t.pathname?n=new URLSearchParams(t.search).get("v"):t.pathname.startsWith("/embed/")&&(n=t.pathname.slice(7))),n||""},t.prototype.getComponentProps=function(e,t){void 0===t&&(t=!1);var n=e.thumbnailLink,a=e.caption,i=n.link,r=i.title,o=i.url,s=this.extractYouTubeVideoIdFromLink(o),c="https://i.ytimg.com/vi/".concat(s,"/hqdefault.jpg"),d=t&&this._convertToWatchLink(s)||o;return{componentName:xt.ComponentName.FileCard,thumbnailLink:{link:{title:r,url:d,description:a},thumbnail:{source:{url:c}}},iconProps:{iconUrl:Pn,iconText:Q.Pb}}},t.prototype._convertToWatchLink=function(e){return e?"https://www.youtube.com/watch?v=".concat(e):e},t}(Ct),Un=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.componentName=xt.ComponentName.YoutubeCard,n.distribution=t.Email,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n=this.getComponentProps(e);return null===(t=this.context.getComponent(xt.ComponentName.FileCard))||void 0===t?void 0:t.render(n)},n}(Tn),Fn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.componentName=xt.ComponentName.YoutubeCard,n.distribution=t.Teams,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n=this.getComponentProps(e);return null===(t=this.context.getComponent(xt.ComponentName.FileCard))||void 0===t?void 0:t.render(n)},n}(Tn),Hn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.componentName=xt.ComponentName.YoutubeCard,n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n=this.getComponentProps(e,!0);return null===(t=this.context.getComponent(xt.ComponentName.FileCard))||void 0===t?void 0:t.render(n)},n}(Tn),Rn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n=this.getComponentProps(e,!0);return n.thumbnailLink.link._skipLinkPreview=e.thumbnailLink.link._skipLinkPreview,null===(t=this.context.getComponent(xt.ComponentName.FileCard))||void 0===t?void 0:t.render(n)},n}(Tn),Nn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentName=xt.ComponentName.LinkCard,t}return(0,ke.__extends)(t,e),t.prototype.getLinkElement=function(e,t){var n,a;void 0===t&&(t=!0);var i=e.thumbnailLink.link,r=i.url,o=i.description,s=document.createElement("div"),c={componentName:xt.ComponentName.TextBlock,text:this.getTitleText(e),link:r},d={componentName:xt.ComponentName.TextBlock,text:null!=o?o:""},l=null===(n=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===n?void 0:n.render(d),u=null===(a=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===a?void 0:a.render(c);if(u){var f=document.createElement("div");f.innerHTML=u,s.appendChild(f)}if(t&&o&&l){var p=this.getDescriptionElement(l);s.appendChild(p)}return s},t.prototype.getTitleText=function(e){return e.thumbnailLink.link.title||""},t.prototype.getDescriptionElement=function(e){var t=document.createElement("div");return t.innerHTML=e,t},t.prototype.hasThumbnail=function(e){return Boolean(e&&(e.source.url||e.source.sharepointIds))},t}(Ct),Bn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n=e.thumbnailLink.link,a=n.url,i=n.title,r=Y.UrlUtility.absolutizeUrl(a),o=new URL(r).hostname.replace("www.","").replace("https://",""),s={componentName:xt.ComponentName.TextBlock,text:i||o,link:r};return null===(t=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===t?void 0:t.render(s)},n}(Nn),jn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t=e.cardSize,n=e.thumbnailLink.link,i=n.url,r=n._skipLinkPreview;if(!i)return"";var o=t===xt.CardLayout.SmallCard||t===xt.CardLayout.MediumCard,s=this.getLinkElement(e,o);if(r)return s.innerHTML;var c={link:Ee(i),fileType:a.WebLink};return this.context.getAttachment(c),s.innerHTML},n.prototype.getTitleText=function(e){var t=Y.UrlUtility.absolutizeUrl(e.thumbnailLink.link.url),n=new URL(t).hostname.replace("www.","").replace("https://","");return e.thumbnailLink.link.title?e.thumbnailLink.link.title:n},n.prototype.getDescriptionElement=function(e){var t=document.createElement("ul"),n=document.createElement("li");return n.innerHTML=e,t.appendChild(n),t},n}(Nn),Vn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Teams,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){return e.cardSize===xt.CardLayout.ExtraLargeCard?this._renderExtraLargeCard(e):this._renderLinkCard(e)},n.prototype.getTitleText=function(e){var t=e.thumbnailLink,n=e.cardSize,a=t.link,i=a.url,r=a.title,s=Y.UrlUtility.absolutizeUrl(i);if(n===xt.CardLayout.LargeCard){var c=new URL(s).hostname.replace("www.","");return r||c}var d,l=ft.HtmlEncoding.encodeText(r||""),u=new W.Uri(s),f=q._PreviewUtility.getFileExtension(new q._SPResourcePath(s))||"",p="";return d=f.toLowerCase(),Le[d.replace(".","")]&&(p=".".concat(f.toLowerCase())),"".concat((0,o.escape)("".concat(l.substring(0,M()?20:40)).concat(p))," (").concat(u.getHost(),")")},n.prototype._renderLinkCard=function(e){return e.thumbnailLink.link.url?this.getLinkElement(e).outerHTML:""},n.prototype._renderExtraLargeCard=function(e){var t,n,a=e.thumbnailLink,i=e.callToAction,r=e.topic,o=a.link,s=a.thumbnail,c=o.description,d=o.title,l=o.url,u=document.createElement("div");if(r){var f={componentName:xt.ComponentName.TextBlock,text:r.substring(0,20),styles:{fontWeight:"bold"}};!M()&&f.styles&&(f.text=r.substring(0,40),f.styles.fontSize="medium"),this._generateTextContentForExtraLargeCard(f,u)}if(d){var p={componentName:xt.ComponentName.TextBlock,text:d.substring(0,20),headerLevel:1};M()||(p.text=d.substring(0,110),p.headerLevel=2,p.styles={fontSize:"large"}),this._generateTextContentForExtraLargeCard(p,u)}if(c){var m={componentName:xt.ComponentName.TextBlock,text:c.substring(0,M()?20:500)};this._generateTextContentForExtraLargeCard(m,u)}if(i){var _={componentName:xt.ComponentName.TextBlock,text:null==i?void 0:i.substring(0,20),link:l,styles:{textDecoration:"underline"}};!M()&&_.styles&&(_.text=null==i?void 0:i.substring(0,40),_.styles.fontWeight="bold"),this._generateTextContentForExtraLargeCard(_,u)}if(this.hasThumbnail(s)){var h={componentName:xt.ComponentName.Image,imageUrl:null!==(t=null==s?void 0:s.source.url)&&void 0!==t?t:"",width:630,height:250,altText:null==s?void 0:s.alternateText,_sharepointIds:null==s?void 0:s.source.sharepointIds},b=null===(n=this.context.getComponent(xt.ComponentName.Image))||void 0===n?void 0:n.render(h);if(b){var g=document.createElement("span");g.innerHTML=b,u.appendChild(g)}}return u.outerHTML},n.prototype._generateTextContentForExtraLargeCard=function(e,t){var n,a,i=null===(a=null===(n=this.context)||void 0===n?void 0:n.getComponent(xt.ComponentName.TextBlock))||void 0===a?void 0:a.render(e);if(i){var r=document.createElement("span");r.innerHTML=i,t.appendChild(r)}},n}(Nn),zn=16/9,Gn=16,Kn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Email,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t=e.thumbnailLink,n=e.isDisplayLink,a=e.cardSize,i=e.callToAction,r=e.topic,o=t.link,s=t.thumbnail,c=(0,ke.__assign)((0,ke.__assign)({},o),{url:Y.UrlUtility.absolutizeUrl(o.url)}),d=c.url,l=c.title,u=c.description,f=this.context.localSectionTheme,p=a===xt.CardLayout.LargeCard||a===xt.CardLayout.ExtraLargeCard?"":a===xt.CardLayout.MediumCard?f.palette.white:f.semanticColors.primaryButtonBackground,m=this._getMainTable(a,f,p),_=m;if(a===xt.CardLayout.SmallCard){var h=document.createElement("tr");m.appendChild(h),_=h}var b={},g=this._getImageElement(c,a,f,p,s);if(g&&(C()?_.appendChild(g):b.imageElement=g),r&&a===xt.CardLayout.ExtraLargeCard){var v=this._getTopicHeader(r);v&&(C()?_.appendChild(v):b.topicElement=v)}var y=this._getTitleElement(l,d,!!s,a,f,p);if(y&&(C()?_.appendChild(y):b.titleElement=y),a===xt.CardLayout.LargeCard&&n){var S=this._getHostNameElement(d,!!l,f);C()?_.appendChild(S):b.hostNameElement=S}if((a===xt.CardLayout.LargeCard||a===xt.CardLayout.ExtraLargeCard)&&u){var D=this._getDescriptionElement(u,a);D&&(C()?_.appendChild(D):b.descriptionElement=D)}if(a===xt.CardLayout.ExtraLargeCard&&i){var I=this._getCallToAction(i,d);I&&(C()?_.appendChild(I):b.callToActionElement=I)}return C()?m.outerHTML:this._createLinkCard(b,a,f,p).outerHTML},n.prototype._createLinkCard=function(e,t,n,a){var i=e.imageElement,o=e.titleElement,s=e.descriptionElement,c=e.hostNameElement,d=e.topicElement,l=e.callToActionElement,u=document.createElement("table");switch(this._applyRootTableStyles(u,t,n,a),t){case xt.CardLayout.SmallCard:var f=u.insertRow();i&&f.appendChild(i),o&&f.appendChild(o);break;case xt.CardLayout.MediumCard:case xt.CardLayout.ExtraLargeCard:i&&u.appendChild(i),t===xt.CardLayout.ExtraLargeCard&&d&&u.appendChild(d),o&&u.appendChild(o),t===xt.CardLayout.ExtraLargeCard&&s&&u.appendChild(s),t===xt.CardLayout.ExtraLargeCard&&l&&u.appendChild(l);break;case xt.CardLayout.LargeCard:if(O())i&&u.appendChild(i),o&&u.appendChild(o),c&&u.appendChild(c),s&&u.appendChild(s);else{var p=.4*r.TABLE_RENDER_WIDTH/zn,m=u.insertRow();i&&m.appendChild(i);var _=m.insertCell();_.width="".concat(60,"%"),_.style.verticalAlign="top",_.vAlign="bottom",_.height="".concat(p-44);var h=_.appendChild(document.createElement("table"));h.border="0",h.cellPadding="0",h.cellSpacing="12",h.align="left",h.style.padding="0px",o&&h.appendChild(o),s&&h.appendChild(s);var b=u.insertRow().insertCell();b.vAlign="bottom",b.style.verticalAlign="bottom",b.height="".concat(44);var g=document.createElement("table");g.border="0",g.cellPadding="0",g.cellSpacing="12",g.align="left",b.appendChild(g),c&&g.appendChild(c)}}return u},n.prototype._applyRootTableStyles=function(e,t,n,a){var i=R(this.context.endpointDetails)?ee(!1,this.context.endpointDetails):ee(!1),o=t===xt.CardLayout.LargeCard?"link-root-table":"quicklinks-cardtable";e.setAttribute("data-testId",o),e.setAttribute("cellpadding","0"),e.setAttribute("cellspacing","0"),e.setAttribute("width","100%"),t===xt.CardLayout.LargeCard?(e.setAttribute("align","center"),e.style.maxWidth="".concat(i,"px"),O()||(e.setAttribute("border","0"),e.style.maxWidth="".concat(r.TABLE_RENDER_WIDTH,"px"),e.style.boxShadow=this.context.localSectionTheme.semanticColors.cardShadow,e.style.borderRadius="".concat(r.CORNER_ROUND,"px"),e.style.border="1px solid ".concat(this.context.localSectionTheme.semanticColors.variantBorder))):(e.setAttribute("border","0"),e.setAttribute("height","100%"),e.style.borderCollapse="separate",e.style.borderRadius="4px",e.style.backgroundColor=a,t===xt.CardLayout.MediumCard?(e.style.borderSpacing="0px",e.style.border="1px solid ".concat(n.semanticColors.variantBorder),e.style.boxShadow="rgba(0, 0, 0, 0.14) 0px 2px 4px, rgba(0, 0, 0, 0.12) 0px 0px 2px"):(e.style.paddingLeft="12px",e.style.paddingRight="12px"))},n.prototype._getMainTable=function(e,t,n){var a=document.createElement("table");return this._applyRootTableStyles(a,e,t,n),a},n.prototype._getImageElement=function(e,t,n,a,i){var o,s,c,d,l=e.url,f=R(this.context.endpointDetails)?ee(!1,this.context.endpointDetails):ee(!1),p=t===xt.CardLayout.MediumCard||!O()&&t===xt.CardLayout.LargeCard?r.ICON_SIZE_MEDIUM:r.ICON_SIZE_SMALL,m=p+r.ICON_PADDING,_=O()||t!==xt.CardLayout.LargeCard?t===xt.CardLayout.MediumCard?r.THUMBNAIL_WIDTH_MEDIUM:r.THUMBNAIL_WIDTH_SMALL:.4*r.TABLE_RENDER_WIDTH,h=O()||t!==xt.CardLayout.LargeCard?t===xt.CardLayout.MediumCard?r.THUMBNAIL_HEIGHT_MEDIUM:_:_/zn;if((t===xt.CardLayout.LargeCard&&O()||t===xt.CardLayout.ExtraLargeCard)&&this.hasThumbnail(i)){var b=Math.round(f/zn);d={componentName:xt.ComponentName.Image,imageUrl:null!==(o=null==i?void 0:i.source.url)&&void 0!==o?o:"",width:f,height:b,cornerRounding:"all",_sharepointIds:null==i?void 0:i.source.sharepointIds}}else if((t!==xt.CardLayout.LargeCard||!O())&&t!==xt.CardLayout.ExtraLargeCard){var g=q._PreviewUtility.getFileExtension(new q._SPResourcePath(l)),y=this._isReservedAspxLink(l),S=j(a)?it:at;if(T())D=y?S:g&&Y.Icons.getIconUrl(g,p)||S,d=this.hasThumbnail(i)&&!y?{componentName:xt.ComponentName.Image,imageUrl:null!==(s=null==i?void 0:i.source.url)&&void 0!==s?s:"",fallbackImageUrl:D,width:_,height:h,altText:null==i?void 0:i.alternateText,cropMode:"aspx"===g?void 0:q.CropMode.Fill,cornerRounding:t===xt.CardLayout.MediumCard?"top":void 0,additionalStyles:{width:t===xt.CardLayout.MediumCard?"100%":"".concat(_,"px"),height:"".concat(h,"px"),verticalAlign:"middle",display:t===xt.CardLayout.MediumCard?"block":void 0},_msoStyleOverride:v()||t!==xt.CardLayout.MediumCard?void 0:{width:r.THUMBNAIL_MSO_WIDTH_MEDIUM,height:r.THUMBNAIL_MSO_HEIGHT_MEDIUM},_sharepointIds:null==i?void 0:i.source.sharepointIds}:{componentName:xt.ComponentName.Image,imageUrl:D,width:m,height:m,additionalStyles:{width:"".concat(m,"px"),height:"".concat(m,"px"),verticalAlign:"middle"}};else{var D=yt(g||"",t===xt.CardLayout.MediumCard||t===xt.CardLayout.LargeCard?mt.medium:mt.small,j(a)),I=this.hasThumbnail(i)||t===xt.CardLayout.MediumCard||t===xt.CardLayout.LargeCard?_:m,x=this.hasThumbnail(i)||t===xt.CardLayout.MediumCard||t===xt.CardLayout.LargeCard?h:m;d={componentName:xt.ComponentName.Image,imageUrl:(null==i?void 0:i.source.url)||D,fallbackImageUrl:D,width:I,height:x,altText:null==i?void 0:i.alternateText,cropMode:"aspx"===g?void 0:q.CropMode.Fill,cornerRounding:O()||t!==xt.CardLayout.LargeCard?t===xt.CardLayout.MediumCard?"top":void 0:"left",additionalStyles:{width:t===xt.CardLayout.MediumCard||U()&&!O()&&t===xt.CardLayout.LargeCard?"100%":"".concat(I,"px"),height:"".concat(x,"px"),verticalAlign:O()||t!==xt.CardLayout.LargeCard?"middle":"bottom",display:t===xt.CardLayout.MediumCard?"block":void 0,minHeight:O()||t!==xt.CardLayout.LargeCard?void 0:"110px",objectFit:U()&&!O()&&t===xt.CardLayout.LargeCard?"contain":void 0},_msoStyleOverride:v()||t!==xt.CardLayout.MediumCard?void 0:{width:r.THUMBNAIL_MSO_WIDTH_MEDIUM,height:r.THUMBNAIL_MSO_HEIGHT_MEDIUM},_sharepointIds:null==i?void 0:i.source.sharepointIds}}}var C=d?null===(c=this.context.getComponent(xt.ComponentName.Image))||void 0===c?void 0:c.render(d):void 0;if(C){var w=document.createElement("td");if(O()||t!==xt.CardLayout.LargeCard)if(t===xt.CardLayout.LargeCard||t===xt.CardLayout.ExtraLargeCard){var E=r.UNIVERSAL_PADDING;w.setAttribute("data-testid","link-thumbnail-cell"),w.setAttribute("width","100%"),w.setAttribute("align","left"),w.style.maxWidth="".concat(f,"px"),w.style.paddingTop="".concat(E,"px"),w.style.paddingBottom="".concat(t===xt.CardLayout.ExtraLargeCard?0:E,"px")}else w.setAttribute("width",t===xt.CardLayout.MediumCard?"100%":"".concat(_)),w.setAttribute("height","".concat(h)),w.setAttribute("align","center"),w.style.width=t===xt.CardLayout.MediumCard?"100%":"".concat(_,"px"),w.style.height="".concat(h,"px"),w.style.backgroundColor=t===xt.CardLayout.MediumCard?n.semanticColors.defaultStateBackground:n.semanticColors.primaryButtonBackground,t===xt.CardLayout.MediumCard?(w.style.padding="0px",w.style.borderRadius="4px"):(w.style.paddingTop="12px",w.style.paddingBottom="12px");else w.rowSpan=2,w.width="".concat(40,"%"),w.align=u._SPKillSwitch.isActivated("4be7d10c-fb23-4dc5-bcea-2304c15ee439")?"left":"center",w.style.borderRadius="".concat(r.CORNER_ROUND,"px 0 0 ").concat(r.CORNER_ROUND,"px"),w.style.maxWidth="".concat(r.TABLE_RENDER_WIDTH,"px"),w.style.padding="0px",w.setAttribute("data-testid","link-thumbnail-cell");var A=void 0;if(t===xt.CardLayout.ExtraLargeCard?A=document.createElement("span"):((A=document.createElement("a")).setAttribute("href",l),A.style.setProperty("text-decoration","none","important"),A.style.cursor="pointer"),A.innerHTML=C,w.appendChild(A),t===xt.CardLayout.SmallCard||!O()&&t===xt.CardLayout.LargeCard)return w;var L=document.createElement("tr");return L.appendChild(w),L}},n.prototype._getTitleElement=function(e,t,n,a,i,o){var s;if(a!==xt.CardLayout.LargeCard||e){var c={componentName:xt.ComponentName.TextBlock,text:null!=e?e:"",link:a!==xt.CardLayout.ExtraLargeCard?t:void 0,styles:this._getTitleStyles(a,i)},d=null===(s=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===s?void 0:s.render(c);if(d){var l=document.createElement("td");if(l.setAttribute("data-testid","link-title-cell"),a!==xt.CardLayout.LargeCard||O())if(a===xt.CardLayout.LargeCard||a===xt.CardLayout.ExtraLargeCard){var u=n?0:r.UNIVERSAL_PADDING;l.setAttribute("width","100%"),l.setAttribute("height","36px"),l.style.margin="0",l.style.overflowWrap="break-word",a===xt.CardLayout.LargeCard?l.style.padding="".concat(u,"px ").concat(Gn,"px ").concat(Gn,"px ").concat(Gn,"px"):g()&&(l.style.margin="0px 5px")}else l.setAttribute("align","left"),l.style.height=a===xt.CardLayout.MediumCard?"65px":"40px",l.style.paddingLeft=a===xt.CardLayout.MediumCard?"10px":"12px",l.style.backgroundColor=o,a===xt.CardLayout.MediumCard&&(l.style.borderBottomLeftRadius="4px",l.style.borderBottomRightRadius="4px",l.style.paddingRight="10px");else l.vAlign="top",l.style.verticalAlign="top";if(a===xt.CardLayout.LargeCard){var f=document.createElement("div");if(f.setAttribute("align","left"),O()){var p=document.createElement("p");p.style.cursor="pointer",p.style.margin="0",p.innerHTML=d,f.appendChild(p)}else f.style.verticalAlign="top",f.innerHTML=d;l.appendChild(f)}else l.innerHTML=d;if(a===xt.CardLayout.SmallCard)return l;var m=document.createElement("tr");return m.appendChild(l),m}}},n.prototype._getHostNameElement=function(e,t,n){var a,i=new URL(e).hostname.replace("www.",""),r={componentName:xt.ComponentName.TextBlock,text:i,link:t?void 0:e,styles:{fontSize:O()?"x-small":"xx-small",lineHeight:O()?void 0:"14px"}},o=null===(a=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===a?void 0:a.render(r),s=document.createElement("tr"),c=document.createElement("td");if(c.setAttribute("data-testid","link-host-cell"),O()?(c.setAttribute("width","100%"),c.style.verticalAlign="top",c.style.padding="0px ".concat(Gn,"px ").concat(12,"px ").concat(Gn,"px")):(c.style.verticalAlign="middle",c.style.lineHeight="20px"),O()){var d=document.createElement("div");d.setAttribute("align","left");var l=document.createElement("p");l.style.height="16px",l.style.margin="0",l.style.color="".concat(null==n?void 0:n.semanticColors.bodyText),l.innerHTML=null!=o?o:"",d.appendChild(l),c.appendChild(d)}else c.innerHTML=null!=o?o:"";return s.appendChild(c),s},n.prototype._getDescriptionElement=function(e,t){var n,a={componentName:xt.ComponentName.TextBlock,text:O()||t!==xt.CardLayout.LargeCard?e:e.substring(0,r.MAX_TITLE_CHAR_CARD),styles:{fontSize:t===xt.CardLayout.ExtraLargeCard?"small":"x-small",lineHeight:t===xt.CardLayout.ExtraLargeCard?"20px":void 0}},i=null===(n=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===n?void 0:n.render(a);if(i){var o=document.createElement("tr"),s=document.createElement("td");s.setAttribute("data-testid","link-desc-cell"),O()||t!==xt.CardLayout.LargeCard?(s.setAttribute("width","100%"),s.style.verticalAlign="top",t===xt.CardLayout.ExtraLargeCard?g()?s.style.padding="5px 0px":s.style.margin="5px 0px":s.style.padding="0 ".concat(Gn,"px ").concat(20,"px ").concat(Gn,"px")):(s.vAlign="bottom",s.style.verticalAlign="bottom",s.setAttribute("data-testid","link-desc-cell"));var c=document.createElement("div");c.setAttribute("align","left"),O()||t!==xt.CardLayout.LargeCard||(c.style.verticalAlign="bottom");var d=document.createElement("p");return d.style.fontFamily=z(this.context.globalPageTheme),d.style.margin="0",O()||t!==xt.CardLayout.LargeCard?(d.style.whiteSpace="break-spaces",d.style.overflow="break-word"):(d.style.overflow="hidden",d.style.textOverflow="ellipsis",d.style.minHeight="40px",d.style.fontSize="12px"),d.innerHTML=i,c.appendChild(d),s.appendChild(c),o.appendChild(s),o}},n.prototype._isReservedAspxLink=function(e){var t=new q._SPResourcePath(e);if("aspx"===(q._PreviewUtility.getFileExtension(t)||"")){var n=(null==e?void 0:e.lastIndexOf("/"))||-1;if(-1!==n){var a=e.substring(0,n+1).toLowerCase();if(a.toLowerCase().endsWith("/forms/")||a.endsWith("/_layouts/15/"))return!0}}return!1},n.prototype._getTitleStyles=function(e,t){if(e===xt.CardLayout.ExtraLargeCard)return{fontSize:"x-large",fontWeight:"semi-bold",lineHeight:"20px"};if(e===xt.CardLayout.LargeCard)return O()?{fontSize:"medium",fontWeight:"semi-bold"}:{overflow:"hidden",textOverflow:"ellipsis",fontSize:"small",fontWeight:"semi-bold"};var n={fontSize:"small",lineHeight:"20px",textOverflow:"ellipsis",overflow:"hidden",lineClamp:2};return e===xt.CardLayout.MediumCard?(0,ke.__assign)((0,ke.__assign)({},n),{fontWeight:"semi-bold",fontColor:t.semanticColors.bodyText}):(0,ke.__assign)((0,ke.__assign)({},n),{fontColor:t.semanticColors.primaryButtonText})},n.prototype._getTopicHeader=function(e){var t,n={componentName:xt.ComponentName.TextBlock,text:e,styles:{fontSize:"small",fontWeight:"semi-bold",lineHeight:"20px"}},a=null===(t=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===t?void 0:t.render(n);if(a){var i=document.createElement("tr"),r=document.createElement("td");return r.setAttribute("data-testid","link-topic-cell"),r.setAttribute("width","100%"),r.setAttribute("height","20px"),r.innerHTML=a,i.appendChild(r),i}},n.prototype._getCallToAction=function(e,t){var n,a={componentName:xt.ComponentName.TextBlock,link:t,text:e,styles:{textDecoration:"underline",lineHeight:"20px",fontSize:"small",fontWeight:"semi-bold"}},i=null===(n=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===n?void 0:n.render(a);if(i){var r=document.createElement("tr"),o=document.createElement("td");return o.setAttribute("data-testid","link-call-to-action-cell"),o.setAttribute("width","100%"),o.style.overflowWrap="break-word",o.innerHTML=i,r.appendChild(o),r}},n}(Nn),Wn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentName=xt.ComponentName.LinkLayout,t}return(0,ke.__extends)(t,e),t.prototype.getTitleContent=function(e,t,n){var a;if(!e)return"";var i={componentName:xt.ComponentName.TextBlock,text:e,headerLevel:t,styles:n};return null===(a=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===a?void 0:a.render(i)},t.prototype.getLinkListElement=function(e){var t=this,n=e.thumbnailLinks,a=e.cardSize,i=document.createElement("ul");return n.forEach(function(e){var n=t.getLinkContent(e,a);n&&i.appendChild(n)}),i},t.prototype.getLinkContent=function(e,t){var n,a={componentName:xt.ComponentName.LinkCard,thumbnailLink:e,cardSize:t},i=null===(n=this.context.getComponent(xt.ComponentName.LinkCard))||void 0===n?void 0:n.render(a);if(i){var r=document.createElement("li");return r.innerHTML=i,r}},t}(Ct),qn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t=this,n=e.thumbnailLinks,a=e.title,i=e.cardSize,r=[];return a&&r.push({blockType:"UNSTYLED",spans:[{text:a,styles:["BOLD"]}]}),n.forEach(function(e){var n=t._getLinkContent(e,i);n&&r.push(n)}),{blocks:r,attachments:[]}},n.prototype._getLinkContent=function(e,t){var n,a={componentName:xt.ComponentName.LinkCard,thumbnailLink:e,cardSize:t},i=null===(n=this.context.getComponent(xt.ComponentName.LinkCard))||void 0===n?void 0:n.render(a);if(i&&i.blocks.length>0){var r=i.blocks[0];return r.blockType="UNORDERED_LIST_ITEM",r.depth=0,r}},n}(Wn),Qn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t=e.thumbnailLinks,n=e.title;if(0===t.length)return"";var a=document.createElement("div"),i=this.getTitleContent(n,void 0,{fontWeight:"bold"});i&&(a.innerHTML=i);var r=this.getLinkListElement(e);return a.appendChild(r),a.outerHTML},n}(Wn),Yn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Email,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t=e.thumbnailLinks,n=e.cardSize,a=e.title;if(!t)return"";var i=u._SPKillSwitch.isActivated("505ca426-2d83-43b6-a3d9-63cac3a598d0")?6:10,r=n===xt.CardLayout.MediumCard?Math.min(t.length,i):t.length;if(0===r)return"";var o=R(this.context.endpointDetails)?ee(!1,this.context.endpointDetails):ee(!1),s=document.createElement("table");s.classList.add("quicklnks-main-table"),wt(s,{border:"0",cellpadding:"0",cellspacing:"0",align:"center",width:"100%"}),Et(s,{"max-width":"".concat(o,"px")});var c=this.getTitleContent(a,3);if(c){var d=document.createElement("tr");d.classList.add("quicklinks-title"),wt(d,{width:"100%"}),d.innerHTML=c,s.appendChild(d)}for(var l=n===xt.CardLayout.MediumCard?6.5:5,f=0;f<r;f++){var p=this._createContentRow(l);p.appendChild(this._getContentCell(n,t[f])),++f<r?p.appendChild(this._getContentCell(n,t[f])):p.appendChild(this._getContentCell(n)),s.appendChild(p)}return s.outerHTML},n.prototype._createContentRow=function(e){var t=document.createElement("tr");return t.classList.add("quicklinks-row"),Et(t,{display:"flex","flex-wrap":"wrap","justify-content":"center","padding-top":"".concat(e,"px"),"padding-bottom":"".concat(e,"px")}),t},n.prototype._getContentCell=function(e,t){var n,a=document.createElement("td");if(a.classList.add("quicklinks-card"),wt(a,{width:"50%"}),Et(a,{padding:"10px ".concat(e===xt.CardLayout.MediumCard?15:12,"px"),"border-collapse":"collapse",flex:"42%","min-width":"200px","max-width":"280px"}),t){var i={componentName:xt.ComponentName.LinkCard,thumbnailLink:t,cardSize:e},r=null===(n=this.context.getComponent(xt.ComponentName.LinkCard))||void 0===n?void 0:n.render(i);a.innerHTML=r}return a},n}(Wn),Jn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Teams,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t=e.thumbnailLinks,n=e.title;if(0===t.length)return"";var a=document.createElement("div"),i=this.getTitleContent(n,void 0,{fontWeight:"bold"});i&&(a.innerHTML=i);var r=this.getLinkListElement(e);return a.appendChild(r),a.outerHTML},n}(Wn),Xn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentName=xt.ComponentName.MapCard,t}return(0,ke.__extends)(t,e),t.prototype.getTitleContent=function(e){var t;if(!e)return"";var n={componentName:xt.ComponentName.TextBlock,text:e,styles:{fontWeight:"bold"}};return null===(t=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===t?void 0:t.render(n)},t.prototype.getAddressContent=function(e){var t;if(!e)return"";var n={componentName:xt.ComponentName.TextBlock,text:e};return null===(t=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===t?void 0:t.render(n)},t.prototype.getMapImage=function(e,t,n){var a,i={componentName:xt.ComponentName.Image,imageUrl:this.getMapUrl(e,t,n),width:t,height:n,_fileType:"png"};return null===(a=this.context.getComponent(xt.ComponentName.Image))||void 0===a?void 0:a.render(i)},t.prototype.getMapUrl=function(e,t,n){var a=e.latitude,i=e.longitude,r=e.zoomLevel,o=e.pushPin,s=e.mapType;return this.checkLocations(a,i),o&&this.checkLocations(o.latitude,o.longitude),"https://dev.virtualearth.net/REST/v1/Imagery/Map/".concat(this._getMapType(s),"/").concat(a,",").concat(i,"/").concat(r,"?").concat(o?"pushpin=".concat(null==o?void 0:o.latitude,",").concat(null==o?void 0:o.longitude,";").concat(56,";"):"","&mapSize=").concat(t,",").concat(n,"&key=").concat("AobmrKIjQInHa8zf5IjtCu3zVgIZFewRhY9M8NUzpYfvMdO2RKDO2eKI6uRFrP6b")},t.prototype.checkLocations=function(e,t){if(e<-90||e>90)throw new Error("Latitude should be between -90 and 90");if(t<-180||t>180)throw new Error("Longitude should be between -180 and 180")},t.prototype._getMapType=function(e){switch(e){case"birdseyeV2":return"aerial";case"streetside":return"road";default:return e}},t}(Ct),Zn=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Email,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n,a,i=e.title,r=e.address,o=document.createElement("table");o.style.maxWidth="100%",o.width="100%",o.cellPadding="0",o.cellSpacing="0";var s=o.insertRow().insertCell();s.width="100%",s.align="left";var c=document.createElement("div");if(c.style.margin="16px 0",c.style.wordWrap="break-word",i){var d={componentName:xt.ComponentName.TextBlock,text:i,headerLevel:4};(l=null===(t=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===t?void 0:t.render(d))&&(c.innerHTML=l)}if(r){var l,u={componentName:xt.ComponentName.TextBlock,text:r,styles:{fontSize:"medium"}};if(l=null===(n=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===n?void 0:n.render(u)){var f=document.createElement("p");f.style.margin="0",f.innerHTML=l,c.appendChild(f)}}s.appendChild(c);var p=o.insertRow().insertCell();p.width="100%",p.align="center";var m=R(this.context.endpointDetails)?ee(!1,this.context.endpointDetails):ee(),_=Math.round(m*(9/16)),h=this.getMapUrl(e,m,_),b={componentName:xt.ComponentName.Image,imageUrl:h,width:m,height:_,cornerRounding:"all",additionalStyles:{objectFit:"cover"}},g=null===(a=this.context.getComponent(xt.ComponentName.Image))||void 0===a?void 0:a.render(b);return g&&(p.innerHTML+=g),o.outerHTML},n}(Xn),$n=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t=e.title,n=e.address,a=e.zoomLevel,i=e.mapType,r=e.latitude,s=e.longitude;this.checkLocations(r,s);var c="https://bing.com/maps/default.aspx?cp=".concat(r.toFixed(5),"~").concat(s.toFixed(5),"&lvl=").concat(a).concat(i?"&style=".concat(this._getEngageMapType(i)):""),d={blocks:[],attachments:[]};return t&&d.blocks.push({blockType:"UNSTYLED",spans:[{text:t,styles:[]}]}),d.blocks.push({blockType:"UNSTYLED",spans:[{text:n||(0,o.escape)(c),styles:[],entity:{type:"LINK",url:c}}]}),d},n.prototype._getEngageMapType=function(e){switch(e){case"aerial":return"a";default:return"r";case"aerialWithLabels":return"h";case"birdseye":case"birdseyeV2":case"birdseyeWithLabels":return"b"}},n}(Xn),ea=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t=e.title,n=e.address,a=document.createElement("div"),i=this.getTitleContent(t);if(i){var r=document.createElement("div");r.innerHTML=i,a.appendChild(r)}var o=this.getAddressContent(n);if(o){var s=document.createElement("div");s.innerHTML=o,a.appendChild(s)}var c=this.getMapImage(e,700,Math.round(393.75));if(c){var d=document.createElement("div");d.innerHTML=c,a.appendChild(d)}return a.innerHTML},n}(Xn),ta=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Teams,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t=e.title,n=e.address,a=document.createElement("span"),i=this.getTitleContent(t);i&&(a.innerHTML+=i);var r=this.getAddressContent(n);r&&(a.innerHTML+=r);var o=this.getMapImage(e,630,250);return o&&(a.innerHTML+=o),a.outerHTML},n}(Xn),na=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentName=xt.ComponentName.ImageGallery,t}return(0,ke.__extends)(t,e),t}(Ct),aa=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){return{blocks:[],attachments:[]}},n}(na),ia=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){return""},n}(na),ra=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Teams,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){return""},n}(na);const oa=JSON.parse('{"n":"See all {0} Images"}');var sa=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Email,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n=this,a=e.showMoreLink,i=e.imageUrls,r=e.layout;if(!i.length)return"";var o=[];if(i.forEach(function(e){var t,a={componentName:xt.ComponentName.Image,imageUrl:e.imageUrl,altText:e.altText,width:213,height:213,cornerRounding:"all",cropMode:"fill"},i=null===(t=n.context.getComponent(xt.ComponentName.Image))||void 0===t?void 0:t.render(a);i&&o.push(i)}),o.length>0){var s=document.createElement("table");s.style.maxWidth=R(this.context.endpointDetails)?"".concat(ee(!1,this.context.endpointDetails)):"".concat(ee(),"px"),s.align="center",s.width="100%";var c=document.createElement("tr");if(s.appendChild(c),"Grid"===r)for(var d=0;d<6;d+=3){for(var l=this._createEmptyRow(),u=0;u<3;u++){var p=d+u;p<o.length&&((b=this._createEmptyCell()).innerHTML=o[p],l.appendChild(b))}if(l.children.length<3)for(var m=3-l.children.length,_=0;_<m;_++){var h=this._createEmptyCell();l.appendChild(h)}s.appendChild(l)}else{var b;(b=(l=this._createEmptyRow()).insertCell()).style.maxHeight="".concat(ee(),"px"),b.style.paddingBottom="20px",b.width="100%";var g={componentName:xt.ComponentName.Image,imageUrl:i[0].imageUrl,altText:i[0].altText,width:ee(),cornerRounding:"all",cropMode:"fill"},v=null===(t=this.context.getComponent(xt.ComponentName.Image))||void 0===t?void 0:t.render(g);v&&(b.innerHTML=v,s.appendChild(l))}if(a){var y=this._createEmptyRow(),S=document.createElement("td");S.style.paddingBottom="20px",S.width="100%",S.colSpan=3;var D=document.createElement("div");D.style.textAlign="right",D.style.padding="4px";var I=document.createElement("a");I.href=f()?a:Ee(a),I.style.border="1px solid ".concat(this.context.localSectionTheme.semanticColors.bodyDivider),I.style.borderRadius="4px",I.style.boxShadow="0px 0.6px 1.8px rgba(0, 0, 0, 0.1), 0px 3.2px 7.2px rgba(0, 0, 0, 0.13)",I.style.padding="8px 12px",I.style.textDecoration="none",I.style.fontSize="16px",I.style.setProperty("color",this.context.localSectionTheme.semanticColors.link,"important"),I.style.lineHeight="16px";var x=document.createElement("div");x.style.textAlign="center",x.style.verticalAlign="middle",x.style.display="table-cell",x.innerHTML=ft.StringHelper.format(oa.n,i.length),I.appendChild(x),D.appendChild(I),S.appendChild(D),y.appendChild(S),s.appendChild(y)}return s.outerHTML}return""},n.prototype._createEmptyCell=function(){var e=document.createElement("td");return e.style.paddingRight="20px",e.style.paddingBottom="20px",e.style.maxWidth="".concat(ee()/3,"px"),e.width="33%",e},n.prototype._createEmptyRow=function(){var e=document.createElement("tr");return e.style.paddingTop="6.5px",e.style.paddingBottom="6.5px",e},n}(na),ca=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentName=xt.ComponentName.OrganizationChart,t}return(0,ke.__extends)(t,e),t.prototype.handleListRender=function(e){var t=this,n=e.personInFocus,a=e.directsReports,i=e.managers;if(!n)return"";var r=document.createElement("div");r.classList.add("org-chart-wrapper");var o=document.createElement("ul"),s=this._createPersonListItem(e.personInFocus);if(s){if(s.classList.add("org-chart-person-in-focus"),o.appendChild(s),a&&a.length>0){var c=document.createElement("ul");a.forEach(function(e){var n=t._createPersonListItem(e);n&&(n.classList.add("org-chart-direct-report"),c.append(n))}),s.appendChild(c)}if(i&&i.length>0){var d=this.buildManagerHierarchy(i);if(d){var l=this._getDeepestNestedListItem(d);l&&l.appendChild(o),r.appendChild(d)}}else r.appendChild(o)}return r.outerHTML},t.prototype.buildManagerHierarchy=function(e){var t=this,n=document.createElement("ul");return e.forEach(function(a,i){var r=t._createPersonListItem(a);if(r){if(r.classList.add("org-chart-manager"),i+1<e.length){var o=e.slice(i+1),s=t.buildManagerHierarchy(o);s&&r.append(s)}0===i&&n.append(r)}}),n},t.prototype._getDeepestNestedListItem=function(e){for(var t=e,n=t.querySelector("ul");n;)n=(t=n).querySelector("ul");return t.querySelector("li")},t.prototype._createPersonListItem=function(e){var t,n={componentName:xt.ComponentName.PeopleCard,person:e,CardLayout:xt.CardLayout.SmallCard},a=null===(t=this.context.getComponent(xt.ComponentName.PeopleCard))||void 0===t?void 0:t.render(n);if(a){var i=(new DOMParser).parseFromString(a,"text/html").body.firstChild||void 0,r=this._convertParagraphToListItem(i);return r.classList.add("org-chart-person-element"),r}},t.prototype._convertParagraphToListItem=function(e){var t=document.createElement("li");return t.innerHTML=e.innerHTML||"",e.replaceWith(t),t},t}(Ct),da=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Email,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n,a=e.personInFocus,i=e.directsReports,r=e.managers,o=e.title,s=R(this.context.endpointDetails)?ee(!1,this.context.endpointDetails):ee();if(!a)return"";var c=document.createElement("table");if(c.className="org-chart-table",c.cellSpacing="0",c.cellPadding="0",c.align="center",c.style.maxWidth="".concat(s,"px"),c.style.color=this.context.localSectionTheme.semanticColors.bodyText,c.style.backgroundColor=this.context.localSectionTheme.semanticColors.bodyBackground,c.style.borderRadius="4px",c.width="100%",o){var d=document.createElement("p");d.className="org-title",d.style.backgroundColor=this.context.localSectionTheme.semanticColors.bodyBackground;var l={componentName:xt.ComponentName.TextBlock,text:o,styles:{fontColor:this.context.localSectionTheme.semanticColors.bodyText,fontWeight:"semi-bold",fontSize:"x-large",lineHeight:"32px"}},u=null===(t=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===t?void 0:t.render(l);if(u){d.innerHTML=u;var f=c.insertRow().insertCell();f.style.padding="16px",f.appendChild(d)}c.appendChild(d)}var p=c.insertRow().insertCell();i&&i.length>0?p.style.paddingBottom="":p.style.paddingBottom="16px";var m=document.createElement("table");if(m.cellSpacing="0",m.cellPadding="0",m.align="center",m.width="50%",m.style.color=this.context.localSectionTheme.semanticColors.bodyText,m.style.backgroundColor=this.context.localSectionTheme.semanticColors.bodyBackground,m.style.maxWidth="".concat(s/2,"px"),r&&r.length>0)for(var _=0;r.length>0&&_<r.length;_++){var h=m.insertRow(),b=this._getPersonHtml(r[_],!1);b&&(h.appendChild(b),m.appendChild(this._getOrgReportRow()))}var g=m.insertRow();g.className="org-heroperson-row";var v=this._getPersonHtml(a,!1);if(v&&(g.appendChild(v),i&&i.length>0&&m.appendChild(this._getOrgReportRow())),p.appendChild(m),i&&i.length>0){var y=c.insertRow().insertCell();y.style.padding="0 16px";var S=document.createElement("div");S.style.backgroundColor=this.context.localSectionTheme.semanticColors.bodyStandoutBackground,S.style.border="1px solid ".concat(this.context.localSectionTheme.semanticColors.variantBorder);var D={componentName:xt.ComponentName.PeopleLayout,people:i,cardLayout:xt.CardLayout.SmallCard},I=null===(n=this.context.getComponent(xt.ComponentName.PeopleLayout))||void 0===n?void 0:n.render(D);I&&(S.innerHTML=I,y.appendChild(S))}return c.outerHTML},n.prototype._getPersonHtml=function(e,t){var n,a=t?50:100,i=R(this.context.endpointDetails)?ee(!1,this.context.endpointDetails):ee(!1),r=document.createElement("td");r.style.width="".concat(a,"%"),r.style.padding="6px",r.style.borderRadius="4px",t?(r.style.flex="45%",r.style.minWidth="210px",r.style.maxWidth="".concat(i/2,"px"),r.style.boxSizing="border-box",r.style.border="1px solid transparent",r.colSpan=2,r.align="center"):(r.style.minWidth="".concat(i/2,"px"),r.style.border="1px solid ".concat(this.context.localSectionTheme.semanticColors.variantBorder),r.style.background="none transparent");var o={componentName:xt.ComponentName.PeopleCard,person:e,CardLayout:xt.CardLayout.SmallCard},s=null===(n=this.context.getComponent(xt.ComponentName.PeopleCard))||void 0===n?void 0:n.render(o);if(s)return r.innerHTML=s,r},n.prototype._getOrgReportRow=function(){var e=document.createElement("tr"),t=document.createElement("td");t.className="org-report-link";var n=document.createElement("div");return n.style.width="1px",n.style.height="12px",n.style.paddingLeft="50%",n.style.borderRight="1px solid ".concat(this.context.localSectionTheme.semanticColors.variantBorder),n.style.boxSizing="border-box",t.appendChild(n),e.appendChild(t),e},n}(ca),la=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){return{blocks:[],attachments:[]}},n}(ca),ua=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t=e.personInFocus,n=e.directsReports,a=e.managers;if(!t)return"";var i=a;return i&&i.length>0&&(i=n&&n.length>0?i.slice(-1):i.slice(-2)),e.managers=i,this.handleListRender(e)},n}(ca),fa=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Teams,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){return this.handleListRender(e)},n}(ca),pa=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentName=xt.ComponentName.CallToAction,t}return(0,ke.__extends)(t,e),t}(Ct),ma=32,_a=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Email,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n,a,i,r=e.description,o=e.buttonLabel,s=e.buttonUrl,c=e.align,d=e.imageUrl,l=e.focalX,u=e.focalY,f=ee(),p=114+(r?Math.round(27*Math.ceil(r.length/55)):0),m={componentName:xt.ComponentName.TextBlock,text:null!=r?r:"",styles:{fontSize:"large",fontWeight:"semi-bold",fontColor:"#E0E0E0"}},_={componentName:xt.ComponentName.Button,text:o,link:s,align:null!=c?c:"Center"},h={componentName:xt.ComponentName.Image,imageUrl:null!=d?d:"",width:f,height:p,cornerRounding:"all",_focalX:l,_focalY:u},b=r?null===(t=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===t?void 0:t.render(m):void 0,g=null===(n=this.context.getComponent(xt.ComponentName.Button))||void 0===n?void 0:n.render(_),v=null===(a=this.context.getComponent(xt.ComponentName.Image))||void 0===a?void 0:a.render(h),y=document.createElement("table");if(y.setAttribute("align","center"),y.setAttribute("width","100%"),y.style.maxWidth="".concat(f,"px"),b){var S=document.createElement("tr"),D=document.createElement("td");D.setAttribute("data-testid","callToAction-description-cell"),D.style.textAlign="left",D.style.paddingTop="".concat(ma,"px"),D.style.paddingLeft="".concat(ma,"px"),D.style.paddingRight="".concat(ma,"px");var I=document.createElement("table");I.style.margin="Left"===c?"auto auto auto 0":"Right"===c?"auto 0 auto auto":"auto",I.style.padding="0",I.style.borderSpacing="0",I.style.borderCollapse="collapse",I.style.width="unset",I.style.backgroundColor="".concat("rgb(50,50,50)"),I.style.borderRadius="4px",I.setAttribute("cellpadding","0"),I.setAttribute("cellspacing","0"),I.setAttribute("border","0"),I.setAttribute("align",null!==(i=null==c?void 0:c.toLowerCase())&&void 0!==i?i:"center");var x=document.createElement("tr");x.style.padding="0",x.style.margin="0";var C=document.createElement("td");C.style.padding="0",C.style.margin="0",C.style.padding="8px 16px",C.innerHTML=b,C.getElementsByTagName("span")[0].style.lineHeight="".concat(27,"px"),C.getElementsByTagName("span")[0].style.borderRadius="4px",C.getElementsByTagName("span")[0].style.display="inline-block",x.appendChild(C),I.appendChild(x),D.appendChild(I),S.appendChild(D),y.appendChild(S)}var O=document.createElement("tr"),w=document.createElement("td");w.setAttribute("data-testid","callToAction-button-cell"),w.style.textAlign="left",w.style.padding=b?"0 ".concat(ma,"px ").concat(ma,"px"):"".concat(ma,"px"),w.innerHTML=g,O.appendChild(w),y.appendChild(O);var E=document.createElement("div");E.innerHTML=null!=v?v:"";var A=E.getElementsByTagName("img")[0].getAttribute("src")||"";return y.setAttribute("data-testid","callToAction-root-table"),y.setAttribute("background","".concat(A)),y.setAttribute("bgcolor","#ffffff"),y.setAttribute("valign","top"),y.style.backgroundSize="cover",y.outerHTML},n}(pa),ha=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n=e.buttonLabel,a=e.buttonUrl,i=e.align,r={componentName:xt.ComponentName.Button,text:n,link:a,align:null!=i?i:"Left"};return null===(t=this.context.getComponent(xt.ComponentName.Button))||void 0===t?void 0:t.render(r)},n}(pa),ba=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){return""},n}(pa),ga=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Teams,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n=e.buttonLabel,a=e.buttonUrl,i={componentName:xt.ComponentName.Button,text:n,link:a},r=null===(t=this.context.getComponent(xt.ComponentName.Button))||void 0===t?void 0:t.render(i),o=document.createElement("div");return o.innerHTML=r,o.outerHTML},n}(pa),va=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentName=xt.ComponentName.TextPill,t}return(0,ke.__extends)(t,e),t}(Ct),ya=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Email,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n=e.text,a=e.backgroundColor,i=e.borderRadius,r=e.textStyles,o=e.align,s=this._getPillColors(a),c=0;r&&r.fontSize&&(c=B(r.fontSize),r.fontSize=void 0);var d={componentName:xt.ComponentName.TextBlock,text:n,styles:r},l=d?null===(t=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===t?void 0:t.render(d):void 0,u=document.createElement("table");u.setAttribute("align",o?o.toLowerCase():"left");var f=document.createElement("td");f.setAttribute("width","100%"),f.style.lineHeight="24px",s.textColor&&(f.style.color=s.textColor);var p=document.createElement("div");p.setAttribute("data-testid","email-text-pill"),p.style.height="24px",p.style.borderWidth="4px 12px",p.style.borderStyle="solid",p.style.boxSizing="border-box",p.style.lineHeight="24px",p.style.display="flex",p.style.justifyContent="center",i&&(p.style.borderRadius="".concat(i,"px")),p.style.backgroundColor="".concat(s.pillBackgroundColor),p.style.borderColor="".concat(s.pillBackgroundColor),p.style.setProperty("color",s.textColor,"important"),p.style.letterSpacing="1px",p.style.fontSize="".concat(c,"px"),p.style.textOverflow="ellipsis",p.style.whiteSpace="nowrap",p.style.overflow="hidden",p.style.maxWidth="294px",p.style.alignItems="center",p.innerHTML=null!=l?l:"",f.appendChild(p);var m=document.createElement("tr");return m.appendChild(f),u.appendChild(m),u.outerHTML},n.prototype._getPillColors=function(e){var t="",n="";switch(e){case"accent":t=this.context.globalPageTheme.palette.accent,n=this.context.globalPageTheme.palette.white;break;case"themePrimary":t=this.context.localSectionTheme.palette.themePrimary,n=this.context.localSectionTheme.semanticColors.buttonText;break;case"themeSecondary":t=this.context.localSectionTheme.palette.themeSecondary,n=this.context.localSectionTheme.semanticColors.buttonText}return{pillBackgroundColor:t,textColor:n}},n}(va),Sa=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Teams,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n=e.text,a=e.textStyles,i={componentName:xt.ComponentName.TextBlock,text:n,styles:a};return null===(t=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===t?void 0:t.render(i)},n}(va),Da=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n=e.text,a={componentName:xt.ComponentName.TextBlock,text:n};return null===(t=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===t?void 0:t.render(a)},n}(va),Ia=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n=e.text,a=e.textStyles,i={componentName:xt.ComponentName.TextBlock,text:n,styles:a};return null===(t=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===t?void 0:t.render(i)},n}(va),xa=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentName=xt.ComponentName.Banner,t}return(0,ke.__extends)(t,e),t.prototype.getImageContent=function(e,t,n){var a,i,r,o,s,c,d=e.thumbnail;if(!(null==d?void 0:d.source))return"";var l={componentName:xt.ComponentName.Image,originalWidth:null===(a=d.originalDimensions)||void 0===a?void 0:a.width,originalHeight:null===(i=d.originalDimensions)||void 0===i?void 0:i.height,imageUrl:null!==(r=d.source.url)&&void 0!==r?r:"",width:t,height:n,cropMode:"fill"};return"focalPoint"===(null===(o=d.cropWindow)||void 0===o?void 0:o.type)&&(l._focalX=d.cropWindow.focalPoint.offsetLeft,l._focalY=d.cropWindow.focalPoint.offsetTop),d.source.sharepointIds&&d.source.sharepointIds.siteId&&d.source.sharepointIds.webId&&d.source.sharepointIds.uniqueId&&(l._sharepointIds={siteId:d.source.sharepointIds.siteId,webId:d.source.sharepointIds.webId,listId:null===(s=d.source.sharepointIds)||void 0===s?void 0:s.listId,uniqueId:d.source.sharepointIds.webId}),null===(c=this.context.getComponent(xt.ComponentName.Image))||void 0===c?void 0:c.render(l)},t.prototype.getTopicHeaderContent=function(e){var t,n=e.header,a=e.showHeader,i=e.textAlignment;if(!a||!n)return"";var r=null!=i?i:"Left",o={componentName:xt.ComponentName.TextPill,text:n.toUpperCase(),backgroundColor:"accent",borderRadius:2,textStyles:{fontSize:"small",fontWeight:"bold"},align:r};return null===(t=this.context.getComponent(xt.ComponentName.TextPill))||void 0===t?void 0:t.render(o)},t.prototype.getTitleContent=function(e,t){var n;if(!e)return"";var a={componentName:xt.ComponentName.TextBlock,text:e,headerLevel:1,styles:t};return null===(n=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===n?void 0:n.render(a)},t.prototype.getAuthorContent=function(e){var t;if(!e||0===e.length)return"";var n={componentName:xt.ComponentName.PeopleCard,person:e[0],CardLayout:xt.CardLayout.ExtraSmallCard};return null===(t=this.context.getComponent(xt.ComponentName.PeopleCard))||void 0===t?void 0:t.render(n)},t}(Ct),Ca=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n.componentName=xt.ComponentName.Banner,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n,a,i,r=e.title,o=e.header,s=e.showHeader,c=e.authors;if(c&&c.length>0){var d=c[0],l=d.email,u=d.name,f=d.role;i={name:u,email:l,aadObjectId:d.aadObjectId,role:f}}var p={blocks:[],attachments:[]};if(s&&o){var m={componentName:xt.ComponentName.TextPill,text:o.toUpperCase(),backgroundColor:"accent",borderRadius:2,textStyles:{fontSize:"x-small",fontWeight:"semi-bold",overflow:"hidden",lineHeight:"16px"}};p=null===(t=this.context.getComponent(xt.ComponentName.TextPill))||void 0===t?void 0:t.render(m)}var _={blocks:[],attachments:[]};if(r){var h={componentName:xt.ComponentName.TextBlock,text:r,headerLevel:1,styles:{fontWeight:"bold"}};_=null===(n=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===n?void 0:n.render(h)}var b={blocks:[],attachments:[]};if(i){var g={componentName:xt.ComponentName.PeopleCard,person:i,CardLayout:xt.CardLayout.ExtraSmallCard};b=null===(a=this.context.getComponent(xt.ComponentName.PeopleCard))||void 0===a?void 0:a.render(g)}return{blocks:(0,ke.__spreadArray)((0,ke.__spreadArray)((0,ke.__spreadArray)([],p.blocks,!0),_.blocks,!0),b.blocks,!0),attachments:(0,ke.__spreadArray)((0,ke.__spreadArray)((0,ke.__spreadArray)([],p.attachments,!0),_.attachments,!0),b.attachments,!0)}},n}(xa),Oa=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n.componentName=xt.ComponentName.Banner,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t=e.title,n=e.authors,a=e.thumbnail,i=document.createElement("div"),r=fe(a)?this.getImageContent(e,700,150):"";if(r){var o=document.createElement("div");o.innerHTML=r,i.appendChild(o)}var s=this.getTopicHeaderContent(e);if(s){var c=document.createElement("div");c.innerHTML=s,i.appendChild(c)}var d=this.getTitleContent(t);if(d){var l=document.createElement("div");l.innerHTML=d,i.appendChild(l)}var u=this.getAuthorContent(n);if(u){var f=document.createElement("div");f.innerHTML=u,i.appendChild(f)}return i.innerHTML},n}(xa),wa=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Teams,n.componentName=xt.ComponentName.Banner,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t=e.title,n=e.authors,a=fe(e.thumbnail)?this.getImageContent(e,740,140):"",i=this.getTopicHeaderContent(e),r=this.getTitleContent(t,{fontSize:"x-large"}),o=this.getAuthorContent(n);return"".concat(null!=a?a:"").concat(null!=i?i:"").concat(null!=r?r:"").concat(null!=o?o:"")},n}(xa),Ea="0px 20px 15px",Aa=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Email,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n,a,i,r,o,s,c,d,l,f,p,m,_,h,b,g,v,y=e.title,S=e.authors,D=e.thumbnail,I=e.header,x=e.showHeader,C=e.textAlignment,O=e.layout,w=e._isCustomFullWidth,E=ee(w),L=null!=C?C:"Left";if(S&&S.length>0){var k=S[0],M=k.email,P=k.name,T=k.role;v={name:P,email:M,aadObjectId:k.aadObjectId,role:T}}var U={fontSize:"xx-large",lineHeight:"40px"};u._SPKillSwitch.isActivated("afaf03eb-ff00-4068-a0a5-b46a0746eecb")||(U.fontColor=this.context.localSectionTheme.palette.black);var F="";if(fe(D)){var H={componentName:xt.ComponentName.Image,originalWidth:null===(t=null==D?void 0:D.originalDimensions)||void 0===t?void 0:t.width,originalHeight:null===(n=null==D?void 0:D.originalDimensions)||void 0===n?void 0:n.height,imageUrl:null!==(a=null==D?void 0:D.source.url)&&void 0!==a?a:"",width:740,height:this._getImageHeight(O),isFullBleed:!!A()||void 0,cropMode:"fill",additionalStyles:{width:A()?void 0:"100%"}};"focalPoint"===(null===(i=null==D?void 0:D.cropWindow)||void 0===i?void 0:i.type)&&(H._focalX=null===(r=null==D?void 0:D.cropWindow)||void 0===r?void 0:r.focalPoint.offsetLeft,H._focalY=null===(o=null==D?void 0:D.cropWindow)||void 0===o?void 0:o.focalPoint.offsetTop),(null===(c=null===(s=null==D?void 0:D.source)||void 0===s?void 0:s.sharepointIds)||void 0===c?void 0:c.siteId)&&(null===(l=null===(d=null==D?void 0:D.source)||void 0===d?void 0:d.sharepointIds)||void 0===l?void 0:l.webId)&&(null===(p=null===(f=null==D?void 0:D.source)||void 0===f?void 0:f.sharepointIds)||void 0===p?void 0:p.uniqueId)&&(H._sharepointIds={siteId:D.source.sharepointIds.siteId,webId:D.source.sharepointIds.webId,listId:null===(m=D.source.sharepointIds)||void 0===m?void 0:m.listId,uniqueId:D.source.sharepointIds.uniqueId}),F=null===(_=this.context.getComponent(xt.ComponentName.Image))||void 0===_?void 0:_.render(H)}var R="";if(x&&I){var N={componentName:xt.ComponentName.TextPill,text:I.toUpperCase(),backgroundColor:"accent",borderRadius:2,textStyles:{fontSize:"x-small",fontWeight:"semi-bold",overflow:"hidden",textOverflow:"ellipsis",lineHeight:"16px"},align:null!=L?L:"left"};R=null===(h=this.context.getComponent(xt.ComponentName.TextPill))||void 0===h?void 0:h.render(N)}var B="";if(y){var j={componentName:xt.ComponentName.TextBlock,text:y,headerLevel:1,styles:U};B=null===(b=this.context.getComponent(xt.ComponentName.TextBlock))||void 0===b?void 0:b.render(j)}var V="";if(v){var z={componentName:xt.ComponentName.PeopleCard,person:v,CardLayout:xt.CardLayout.ExtraSmallCard,_align:C};V=null===(g=this.context.getComponent(xt.ComponentName.PeopleCard))||void 0===g?void 0:g.render(z)}var G,K=document.createElement("table");if(K.setAttribute("data-testid","link-root-table"),K.setAttribute("cellspacing","0"),K.setAttribute("cellpadding","0"),K.setAttribute("align","center"),K.setAttribute("width","100%"),K.style.maxWidth="".concat(E,"px"),w&&(K.style.padding="0px"),F){var W=document.createElement("tr");(G=document.createElement("td")).innerHTML=F,W.appendChild(G),K.appendChild(W)}return(B||V||R)&&(W=document.createElement("tr"),(G=document.createElement("td")).style.width="100%",G.style.padding="0px 15px 15px 15px",W.appendChild(G),K.appendChild(W)),R&&(W=document.createElement("tr"),(G=document.createElement("td")).setAttribute("width","100%"),G.setAttribute("data-testid","topic-header"),w&&(G.style.padding=Ea),G.innerHTML=R,W.appendChild(G),K.appendChild(W)),B&&(W=document.createElement("tr"),(G=document.createElement("td")).setAttribute("data-testid","banner-title"),G.width="100%",G.align=L,w&&(G.style.padding=Ea),G.innerHTML=B,W.appendChild(G),K.appendChild(W)),V&&(W=document.createElement("tr"),(G=document.createElement("td")).setAttribute("data-testid","banner-author"),G.align=L,w&&(G.style.padding=Ea),G.innerHTML=V,W.appendChild(G),K.appendChild(W)),K.outerHTML},n.prototype._getImageHeight=function(e){return e&&"Tall"===e?200:140},n}(xa),La=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentName=xt.ComponentName.TitleRegion,t}return(0,ke.__extends)(t,e),t}(Ct),ka=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Email,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n,a=e.title,i=e.authors,r=e.thumbnail,o=e.header,s=e.showHeader,c=e.textAlignment,d=e.layout,l={componentName:xt.ComponentName.Banner,title:a,authors:i,thumbnail:r,header:o,showHeader:s,textAlignment:c,layout:d,_isCustomFullWidth:!0};return null!==(n=null===(t=this.context.getComponent(xt.ComponentName.Banner))||void 0===t?void 0:t.render(l))&&void 0!==n?n:""},n}(La),Ma=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n=e.title,a=e.showHeader,i=e.header;if(!n)return{attachments:[],blocks:[],footer:[]};var r={blocks:[],attachments:[]};return a&&i&&r.blocks.push({blockType:"UNSTYLED",spans:[{text:D()?i:i.toUpperCase(),styles:[]}]}),r.blocks.push({blockType:"UNSTYLED",spans:[{text:D()?null!==(t=null==n?void 0:n.toUpperCase())&&void 0!==t?t:"":n,styles:["BOLD"]}]}),r},n}(La);const Pa=JSON.parse('{"S":"{0}: {1}"}');var Ta=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Teams,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n,a=e.title,i=e.header,r=e.showHeader,o=e.announcementBanner,s={subject:r&&i&&a?ft.StringHelper.format(Pa.S,i,a).substring(0,250):null!=a?a:""};if(o&&"Announcement"===(null===(t=this.context)||void 0===t?void 0:t.postType)&&(s.headlineColor=o.headlineColor,s.headline=o.headline.substring(0,44),u._SPFlight.isEnabled(61900))){var c=Number(s.headlineColor);n=this._announcementCardForColor(isNaN(c)?0:c)}return n&&(s.cards=[n]),JSON.stringify(s)},n.prototype._announcementCardForColor=function(e){void 0===e&&(e=0);var t=u.Guid.newGuid().toString();return{appId:"announcement-card",contentType:"application/vnd.microsoft.teams.messaging-announcementBanner",cardClientId:"announcement-card-".concat(t.replace(/-/g,"")),content:{colorTheme:e.toString()}}},n}(La),Ua=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n,a,i,r,o,s,c,d,l,u,f,p,m,_=e.title,h=e.header,b=e.showHeader,g=e.thumbnail,v={title:b&&h&&_?ft.StringHelper.format(Pa.S,h,_):null!=_?_:""};if(fe(g)){var y={componentName:xt.ComponentName.Image,originalWidth:null===(t=null==g?void 0:g.originalDimensions)||void 0===t?void 0:t.width,originalHeight:null===(n=null==g?void 0:g.originalDimensions)||void 0===n?void 0:n.height,imageUrl:null!==(a=null==g?void 0:g.source.url)&&void 0!==a?a:"",width:1e3,height:200,cropMode:"fill"};"focalPoint"===(null===(i=null==g?void 0:g.cropWindow)||void 0===i?void 0:i.type)&&(y._focalX=null===(r=null==g?void 0:g.cropWindow)||void 0===r?void 0:r.focalPoint.offsetLeft,y._focalY=null===(o=null==g?void 0:g.cropWindow)||void 0===o?void 0:o.focalPoint.offsetTop),(null===(c=null===(s=null==g?void 0:g.source)||void 0===s?void 0:s.sharepointIds)||void 0===c?void 0:c.siteId)&&(null===(l=null===(d=null==g?void 0:g.source)||void 0===d?void 0:d.sharepointIds)||void 0===l?void 0:l.webId)&&(null===(f=null===(u=null==g?void 0:g.source)||void 0===u?void 0:u.sharepointIds)||void 0===f?void 0:f.uniqueId)&&(y._sharepointIds={siteId:g.source.sharepointIds.siteId,webId:g.source.sharepointIds.webId,listId:null===(p=g.source.sharepointIds)||void 0===p?void 0:p.listId,uniqueId:g.source.sharepointIds.uniqueId});var S=null===(m=this.context.getComponent(xt.ComponentName.Image))||void 0===m?void 0:m.render(y);S&&(v.headerImageId=function(e){var t=(new DOMParser).parseFromString(e,"text/html"),n=Array.from(t.getElementsByTagName("attachment"));if(n&&n.length>0)return n[0].id}(S))}return JSON.stringify(v)},n}(La),Fa=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentName=xt.ComponentName.RTEWebpart,t._imageClass="div.imagePlugin[data-imageurl]",t._imageTag="transpileimage",t}return(0,ke.__extends)(t,e),t.prototype.insertInlineImages=function(e,t){var n=this,a=document.createElement(this._containerType);t.forEach(function(e){var t,i=document.createElement(n._containerType),r=null===(t=n.context.getComponent(e.componentName))||void 0===t?void 0:t.render(e);r&&(i.innerHTML=r,a.appendChild(i))}),a.innerHTML&&e.replaceWith(a)},t.prototype._processCK4Images=function(e,t){var n=this,a=(new DOMParser).parseFromString(e,"text/html");return a.querySelectorAll('div.webPartInRte[data-widget="inlineimage"]').forEach(function(e){var a=e.getAttribute("data-instance-id");if(a&&t.has(a)){var i=t.get(a);i&&n.insertInlineImages(e,i)}}),a.body.innerHTML},t.prototype._fixLinks=function(e){if(!e||-1===e.indexOf("<a "))return e;var t=(new DOMParser).parseFromString(e,"text/html"),n=t.querySelectorAll("a"),a=!1;return n.forEach(function(e){var t=e.getAttribute("href");(null==t?void 0:t.startsWith("/"))&&(e.setAttribute("href",Y.UrlUtility.absolutizeUrl(t)),a=!0);var n=e.getAttribute("class");e.setAttribute("class",n?"".concat(n," ").concat(s):s),e.getAttribute("id")||e.setAttribute("id",te()),a=!0}),a?t.body.innerHTML:e},t.prototype.extractImageProp=function(e,t){if(t){var n=e.getAttribute("data-imageid");if(n){var a=t.get(n);if(a){var i=R(this.context.endpointDetails)?ee(!1,this.context.endpointDetails):ee(),r=((null==a?void 0:a.alignment)||"center").toLowerCase();if(r=r.indexOf("right")>=0?"right":r.indexOf("left")>=0?"left":"center",a.link){var o=Y.UrlUtility.absolutizeUrl(a.link);a.link=o}var s=a.naturalHeight,c=a.naturalWidth,d=a.height,l=a.width,u=null==a?void 0:a.colWidth,f=s&&c?s/c:d/l;return R(this.context.endpointDetails)&&u&&u>i&&(u=i),(0,ke.__assign)((0,ke.__assign)({},a),{width:null!=l?l:i,colWidth:null!=u?u:i,aspectRatio:f,alignment:r,tableWidth:i})}}}},t}(Ct),Ha=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Email,n._containerType="span",n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n=e.htmlContent,a=e.ck4InlineImages,i=e.parentClass,r=e.childClass,o=e.inlineImages,s=n;if(a&&a.size>0&&(s=this._processCK4Images(s,a)),!(s=null!==(t=this._fixLinks(this.processImages(s,o)))&&void 0!==t?t:""))return"";s=this._convertRTETablesForTranspile(s),s=R(this.context.endpointDetails)?re(s,this.context.endpointDetails):ie(s),s=u._SPKillSwitch.isActivated("73901615-0665-4636-810b-fbb2c1bf4e3c")?s:this._removeEmptyLineBreaksInLists(s);var c=document.createElement("div");c.className=i;var d=document.createElement("div");return d.className=r,d.style.fontSize="16px",d.style.cssText+="".concat(z(this.context.globalPageTheme)," word-break:break-word;"),d.innerHTML=s,c.appendChild(d),c.outerHTML},n.prototype.processImages=function(e,t){var n=this;if(!e||-1===e.indexOf("imagePlugin"))return e;var a=(new DOMParser).parseFromString(e,"text/html");return a.querySelectorAll(this._imageClass).forEach(function(e){var i,r=e.querySelector(n._imageTag);if(r){var o=n.extractImageProp(r,t);if(e.removeChild(r),o){var s=o.imageUrl,c=o.tableWidth,d=o.widthPercent,l=o.naturalHeight,f=o.naturalWidth,p=o.aspectRatio,m=o.colWidth,_=o.isImageShape,h=o.link,b=o.overlay,g=o.width,v=(o.height,o.alignment),y=o.caption,S=o.altText;if(s){var D,I=g;I=m*d/100,I=Math.round(Math.min(m-(_&&m===c?140:0),Math.max(I,50))),D=Math.round(p*I);var x={componentName:xt.ComponentName.Image,imageUrl:s,width:I,originalHeight:l,originalWidth:f,cornerRounding:"all",altText:u._SPKillSwitch.isActivated("816c9b99-c01c-44d0-b38d-a2094ab1c7bb")?null!=y?y:"":S,additionalStyles:{height:"".concat(D,"px")}};h&&(x.linkUrl=h);var C=null===(i=n.context.getComponent(xt.ComponentName.Image))||void 0===i?void 0:i.render(x),O=a.createElement("span");C&&(O.innerHTML=C,n._createInlineImage(a,e,O,I,v,y,b))}}}}),a.body.innerHTML},n.prototype._createInlineImage=function(e,t,n,a,i,r,o){var s,c=e.createElement("div");t.appendChild(c),c.setAttribute("align",(null==i?void 0:i.toLowerCase())||"center");var d=e.createElement("table");if(!x()&&(d.style.padding="0",d.cellPadding="0",d.cellSpacing="0",d.style.textAlign="center",d.style.tableLayout="fixed",d.style.width="100%",d.style.setProperty("border","none","important"),d.style.maxWidth="".concat(a),(null==o?void 0:o.text)&&(null==o?void 0:o.styles))){var l=o.styles,u=ce(this.context.localSectionTheme,o.text,l,!0);d.prepend(u),c.appendChild(d)}if(r){(s=e.createElement("div")).innerText=r,s.innerHTML=r;var f="imgCaption";s.setAttribute("id",f),s.style.textAlign="center",s.style.fontSize="14px",s.style.fontWeight="normal",x()&&(d.style.padding="0",d.cellPadding="0",d.cellSpacing="0",d.style.textAlign="center",d.style.tableLayout="fixed",d.style.width="100%",d.style.setProperty("border","none","important"),d.style.maxWidth="".concat(a));var p=e.createElement("tr"),m=e.createElement("td");p.style.setProperty("border","none","important"),p.style.padding="0",m.style.setProperty("border","none","important"),m.style.padding="0",m.insertAdjacentHTML("beforeend",n.innerHTML),p.appendChild(m),d.appendChild(p);var _=e.createElement("tr"),h=e.createElement("td");if(_.style.setProperty("border","none","important"),_.style.padding="0",h.style.setProperty("border","none","important"),h.style.padding="0",h.style.textAlign="center",s.outerHTML){var b=e.createElement("div");b.innerHTML=R(this.context.endpointDetails)?re(s.outerHTML,this.context.endpointDetails):ie(s.outerHTML),h.appendChild(b)}else h.appendChild(s);_.appendChild(h),d.appendChild(_),t.setAttribute("role","figure"),t.setAttribute("aria-labelledby",f)}else n.setAttribute("role","presentation"),c.insertAdjacentHTML("beforeend",n.innerHTML);x()&&(null==o?void 0:o.text)&&(null==o?void 0:o.styles)&&(l=o.styles,u=ce(this.context.localSectionTheme,o.text,l,!0),c.prepend(u)),s&&c.appendChild(d)},n.prototype._convertRTETablesForTranspile=function(e){var t=this,n=(new DOMParser).parseFromString(e,"text/html"),a=n.querySelectorAll("table");return a.forEach(function(e){t._applyTableColumnWidthInlineStyle(e)}),a.forEach(function(e){t._removePastedTableStyles(e)}),n.querySelectorAll('figure[title="Table"]').forEach(function(e){e.style.width&&"100%"!==e.style.width&&e.style.removeProperty("width")}),n.body.innerHTML},n.prototype._removeEmptyLineBreaksInLists=function(e){var t=(new DOMParser).parseFromString(e,"text/html"),n=t.querySelectorAll("ul, ol"),a=0;return n.forEach(function(e){e.querySelectorAll("li").forEach(function(e){for(;e.innerHTML.includes(">&nbsp;</p>")&&!e.innerHTML.includes("<br")&&e.lastChild;)e.removeChild(e.lastChild),a++;for(;a>0&&e.lastChild;){var t=document.createElement("br");e.after(t),a--}})}),t.body.innerHTML},n.prototype._applyTableColumnWidthInlineStyle=function(e){var t,n=this._getTableColumnWidthList(e);if(null===(t=e.getAttribute("class"))||void 0===t?void 0:t.includes("ck-table-resized")){var a=e.querySelector("tr");a&&Array.from(a.cells).forEach(function(e,t){t<n.length&&(e.style.width="".concat(n[t],"%"))})}},n.prototype._getTableColumnWidthList=function(e){var t=[],n=e.querySelector("colgroup");return n&&n.querySelectorAll("col").forEach(function(e){var n,a,i,r=null!==(i=null===(a=null===(n=e.getAttribute("style"))||void 0===n?void 0:n.match(/width:(\d+(\.\d+)?)%/))||void 0===a?void 0:a[1])&&void 0!==i?i:"0";t.push(parseFloat(r))}),t},n.prototype._removePastedTableStyles=function(e){var t=this,n=e.querySelectorAll("th"),a=e.querySelectorAll("td");n.forEach(function(e){t._removePastedCellStyleHelper(e)}),a.forEach(function(e){t._removePastedCellStyleHelper(e)})},n.prototype._removePastedCellStyleHelper=function(e){e.style.removeProperty("border-left-color"),e.style.removeProperty("border-right-color"),e.style.removeProperty("border-top-color"),e.style.removeProperty("border-bottom-color"),e.style.removeProperty("border-left-width"),e.style.removeProperty("border-right-width")},n}(Fa);const Ra=JSON.parse('{"D":"图像"}');var Na,Ba,ja=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.Teams,n._containerType="span",n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n,a,i,r,o=e.htmlContent,s=e.ck4InlineImages,c=e.inlineImages,d=o;return s&&s.size>0&&(d=this._processCK4Images(o,s)),(d=null!==(t=this._fixLinks(this.processImages(d,c)))&&void 0!==t?t:"")?(a=null!=d?d:"",i=null===(n=e.rteStylingOptions)||void 0===n?void 0:n.skipHeadingLevelShift,We(r=(new DOMParser).parseFromString(a,"text/html")),i||Ye(r),Qe(r),function(e){e.querySelectorAll("[style]").forEach(function(e){var t=e.getAttribute("style")||"",n=t.split(";").find(function(e){return e.includes("font-size")});if(n){var a=n.split(":")[1].trim();if(a.includes("px")){var i,r=parseInt(a.replace("px",""),10);i=r<12?ye:r<24?Se:De,e.setAttribute("style","".concat(t.replace(a,i))),e.removeAttribute("data-fontsize")}}})}(r),function(e){var t=Ze(be),n=Ze(ve);e.querySelectorAll("[style]").forEach(function(e){var a=e.getAttribute("style")||"",i=a.split(";"),r=i.find(function(e){return e.includes("color")});if(r&&(s=Je(r.split(":")[1].trim()))){var o=Xe(Ke(s,t));e.setAttribute("style","".concat(a.replace(r.split(":")[1].trim(),o)))}var s,c=i.find(function(e){return e.includes("background-color")});c&&(s=Je(c.split(":")[1].trim()))&&(o=Xe(Ke(s,n)),e.setAttribute("style","".concat(a.replace(c.split(":")[1].trim(),o))))})}(r),function(e){e.querySelectorAll("ul ol > li, ol ol > li").forEach(function(e){var t=e.getAttribute("style")||"";e.setAttribute("style","".concat(t,"list-style: ").concat("decimal",";"))}),e.querySelectorAll("li").forEach(function(t){t.querySelectorAll("div:not(.imagePlugin):not(.teamsImagePlugin):not(.webPartInRte), p").forEach(function(t){for(var n=e.createElement("span"),a=0,i=Array.from(t.attributes);a<i.length;a++){var r=i[a],o=r.name,s=r.value;n.setAttribute(o,s)}for(;t.firstChild;)n.appendChild(t.firstChild);t.replaceWith(n)})})}(r),$e(r),function(e){e.querySelectorAll('[style*="text-align"]').forEach(function(e){e.style.removeProperty("text-align")})}(r),r.body.innerHTML):""},n.prototype.processImages=function(e,t){var n=this;if(!e||-1===e.indexOf("imagePlugin"))return e;var a=(new DOMParser).parseFromString(e,"text/html");return a.querySelectorAll(this._imageClass).forEach(function(e){var a=e.querySelector(n._imageTag);if(a){var i=n.extractImageProp(a,t);if(e.removeChild(a),i){var r=i.imageUrl,o=i.naturalHeight,s=i.naturalWidth,c=i.isImageShape,d=i.link,l=i.overlay,u=i.width,f=i.caption,p=i.altText;if(r){var m={componentName:xt.ComponentName.RichImage,imageUrl:r,_resizeDesiredWidth:u,originalHeight:o,originalWidth:s,caption:f,altText:p||Ra.D};if(!c&&o&&s&&s>u&&(m._cropData={cropWidth:s,cropHeight:o,cropX:0,cropY:0}),d&&(m.linkUrl=d),l&&(null==l?void 0:l.text)&&(null==l?void 0:l.styles)){m.overlayText=null==l?void 0:l.text;var _=null==l?void 0:l.styles;m.overlayTextStyles=_}n.insertInlineImages(e,[m])}}}}),a.body.innerHTML},n}(Fa),Va=/<ul>\s*?.*?<\/ul>|<ol>\s*?.*?<\/ol>/g,za=/<strong>\s*?.*?<\/strong>/g,Ga=/<i>\s*?.*?<\/i>/g,Ka=/<i><strong>\s*?.*?<\/strong><\/i>/g,Wa=/<\/?span[^>]*>/g,qa=/<p\s*?(.*?)>(\s*?.*?)<\/p>/g,Qa=/<u\s*?(.*?)>(\s*?.*?)<\/u>/g,Ya=/<s\s*?(.*?)>(\s*?.*?)<\/s>/g,Ja=/<\/?sub[^>]*>/g,Xa=/<\/?sup[^>]*>/g,Za=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n._containerType="",n._vivaEngageTranspiledBlocks={blocks:[],attachments:[]},n._convertSpecialHTMLSymbolsInVivaEngage=function(e){return e.replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")},n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n=e.htmlContent,a=e.ck4InlineImages,i=e.inlineImages,r=n;a&&a.size>0&&(r=this._processCK4Images(r,a)),r=null!==(t=this._fixLinks(this.processImages(n,i)))&&void 0!==t?t:"";var o=document.createElement("div");return o.innerHTML=r||"",o.children.length>0&&this._transpileHtmlElementToJson(o,0,"UNSTYLED",!1,!0),this._vivaEngageTranspiledBlocks},n.prototype.insertInlineImages=function(e,t){var n=this,a=[];t.forEach(function(e){var t,i=null===(t=n.context.getComponent(e.componentName))||void 0===t?void 0:t.render(e);i&&a.push(i)}),e.setAttribute("engage-content",JSON.stringify(a))},n.prototype.processImages=function(e,t){var n=this;if(!e||-1===e.indexOf("imagePlugin"))return e;var a=(new DOMParser).parseFromString(e,"text/html");return a.querySelectorAll(this._imageClass).forEach(function(e){var a=e.querySelector(n._imageTag);if(a){var i=n.extractImageProp(a,t);if(e.removeChild(a),i){var r=i.imageUrl,o=i.naturalHeight,s=i.naturalWidth,c=i.isImageShape,d=i.link,l=i.overlay,u=i.width,f=i.caption,p=i.altText;if(r){var m={componentName:xt.ComponentName.RichImage,imageUrl:r,_resizeDesiredWidth:u,originalHeight:o,originalWidth:s,caption:f,altText:p};if(!c&&o&&s&&s>u&&(m._cropData={cropWidth:s,cropHeight:o,cropX:0,cropY:0}),d&&(m.linkUrl=d),(null==l?void 0:l.text)&&(null==l?void 0:l.styles)){m.overlayText=l.text;var _=l.styles;m.overlayTextStyles={isBold:null==_?void 0:_.isBold,isItalic:null==_?void 0:_.isItalic}}n.insertInlineImages(e,[m])}}}}),a.body.innerHTML},n.prototype._transpileHtmlElementToJson=function(e,t,n,a,i){void 0===i&&(i=!1);for(var r=function(r){switch(e.children[r].tagName){case"UL":o._transpileHtmlElementToJson(e.children[r],t+1,"UNORDERED_LIST_ITEM",a);break;case"OL":o._transpileHtmlElementToJson(e.children[r],t+1,"ORDERED_LIST_ITEM",a);break;case"LI":var s=["DIV","OL","UL","H1","H2","H3","H4"],c=Array.from(e.children[r].childNodes),d=[],l=[];if(c.forEach(function(e){s.includes(e.nodeName)?l.push(e):"P"===e.nodeName?d.push.apply(d,Array.from(e.childNodes)):d.push(e)}),d.length>0&&o._transpileInlineLinkSentence(n,{nodeList:d},t,a?["ITALIC"]:void 0),l.length>0){var u=document.createElement("div");l.forEach(function(e){return u.appendChild(e)}),o._transpileHtmlElementToJson(u,t,n,a)}break;case"FIGURE":case"TABLE":o._transpileHtmlElementToJson(e.children[r],t,"UNSTYLED",a);break;case"COLGROUP":break;case"THEAD":case"TBODY":for(var f=e.children[r].children,p=["DIV","P","OL","UL","BLOCKQUOTE","H1","H2","H3","H4"],m=0;m<f.length;m++){for(var _=f[m].children,h=function(e){var t=Array.from(_[e].childNodes),n=t.filter(function(e){return!p.includes(e.nodeName)}),i=t.filter(function(e){return p.includes(e.nodeName)});if(n.length>0&&o._transpileInlineLinkSentence("UNSTYLED",{nodeList:n},void 0,a?["ITALIC"]:void 0),i.length>0){var r=document.createElement("div");i.forEach(function(e){return r.appendChild(e)}),o._transpileHtmlElementToJson(r,0,"UNSTYLED",a)}},b=0;b<_.length;b++)h(b);(m<f.length-1||"THEAD"===e.children[r].tagName)&&o._vivaEngageTranspiledBlocks.blocks.push(Ce)}break;case"BLOCKQUOTE":o._transpileHtmlElementToJson(e.children[r],t,"UNSTYLED",!0,i);break;case"H1":case"H2":case"H3":case"H4":o._transpileInlineLinkSentence(n,{nodeList:e.children[r].childNodes},t,a?["ITALIC","BOLD"]:["BOLD"]);break;case"DIV":if(e.children[r].classList.contains("imagePlugin")||e.children[r].matches('div.webPartInRte[data-widget="inlineimage"]')){var g=e.children[r];o._transpileEngageImage(g)}break;case"P":o._transpileInlineLinkSentence("UNSTYLED",{nodeList:e.children[r].childNodes},void 0,a?i?["ITALIC","BOLD"]:["ITALIC"]:void 0);break;default:o._vivaEngageTranspiledBlocks.blocks.push({blockType:"UNSTYLED",spans:o._transpileStyledSentence(e.children[r].innerHTML)})}},o=this,s=0;s<e.children.length;s++)r(s)},n.prototype._transpileInlineLinkSentence=function(e,t,n,a){for(var i={blockType:e,depth:n&&"UNSTYLED"!==e?n>2?2:n-1:void 0,spans:[]},r=0;r<t.nodeList.length;r++)switch(t.nodeList[r].nodeName){case"A":i.spans.push({text:(t.nodeList[r].textContent||"").replace(String.fromCharCode(160)," "),styles:[],entity:{type:"LINK",url:t.nodeList[r].getAttribute("href")||""}});break;case"DIV":var o=document.createElement("div");o.appendChild(t.nodeList[r]),this._transpileHtmlElementToJson(o,0,"UNSTYLED",!1);break;case"#text":i.spans.push({text:(t.nodeList[r].textContent||"").replace(String.fromCharCode(160)," "),styles:[]});break;case"BR":"UNSTYLED"!==e?i.spans.push(xe):(i.spans.length>0?a&&i.spans.forEach(function(e){e.styles=Array.from(new Set(a.concat(e.styles)))}):i.spans.push(xe),this._vivaEngageTranspiledBlocks.blocks.push(i),i={blockType:"UNSTYLED",spans:[]});break;default:this._transpileStyledSentence(t.nodeList[r].outerHTML).forEach(function(e){i.spans.push(e)})}a&&i.spans.forEach(function(e){e.styles=Array.from(new Set(a.concat(e.styles)))}),this._vivaEngageTranspiledBlocks.blocks.push(i)},n.prototype._transpileStyledSentence=function(e){for(var t=this,n=[],a=e.replace(Va,"").replace(Wa,"").replace(qa,"$2").replace(Qa,"$2").replace(Ya,"$2").replace(Ja,"").replace(Xa,"");a.length>0;){var i=a.match(Ka)||[],r=a.match(za)||[],o=a.match(Ga)||[],s=i.length>0?a.indexOf(o[0]):a.length,c=r.length>0?a.indexOf(r[0]):a.length,d=o.length>0?a.indexOf(o[0]):a.length;if(0===s)n.push({text:this._convertSpecialHTMLSymbolsInVivaEngage(a.split("</strong></i>")[0].replace("<i><strong>","")),styles:["ITALIC","BOLD"]}),a=a.slice(a.indexOf("</strong></i>")+13);else if(0===c)n.push({text:this._convertSpecialHTMLSymbolsInVivaEngage(a.split("</strong>")[0].replace("<strong>","")),styles:["BOLD"]}),a=a.slice(a.indexOf("</strong>")+9);else if(0===d){var l=a.split("</i>")[0].replace("<i>","");this._transpileStyledSentence(l).forEach(function(e){var a=Array.from(new Set(["ITALIC"].concat(e.styles)));n.push({text:t._convertSpecialHTMLSymbolsInVivaEngage(e.text),styles:a})}),a=a.slice(a.indexOf("</i>")+4)}else n.push({text:this._convertSpecialHTMLSymbolsInVivaEngage(a.slice(0,Math.min(c,d,s))),styles:[]}),a=a.slice(Math.min(c,d,s))}return n},n.prototype._transpileEngageImage=function(e){var t=this;try{var n=e.getAttribute("engage-content");n&&JSON.parse(n).forEach(function(e){var n,a;(null===(n=t._vivaEngageTranspiledBlocks.footer)||void 0===n?void 0:n.length)&&(null===(a=e.footer)||void 0===a?void 0:a.length)&&t._vivaEngageTranspiledBlocks.footer.push(Ce),t._vivaEngageTranspiledBlocks=Ut(t._vivaEngageTranspiledBlocks,e)})}catch(e){J._TraceLogger.logError(J._LogSource.create("EngageTranspile"),e,"EngageRTEWebpart")}},n}(Fa),$a=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.distribution=t.VivaEngage,n._containerType="div",n}return(0,ke.__extends)(n,e),n.prototype.render=function(e){var t,n=e.htmlContent,a=e.ck4InlineImages,i=e.inlineImages,r=n;return a&&a.size>0&&(r=this._processCK4Images(n,a)),(r=null!==(t=this._fixLinks(this.processImages(r,i)))&&void 0!==t?t:"")?tt(null!=r?r:"",null==e?void 0:e.rteStylingOptions):""},n.prototype.processImages=function(e,t){var n=this;if(!e||-1===e.indexOf("imagePlugin"))return e;var a=(new DOMParser).parseFromString(e,"text/html");return a.querySelectorAll(this._imageClass).forEach(function(e){var a=e.querySelector(n._imageTag);if(a){var i=n.extractImageProp(a,t);if(e.removeChild(a),i){var r=i.imageUrl,o=i.naturalHeight,s=i.naturalWidth,c=i.isImageShape,d=i.link,l=i.overlay,u=i.width,f=i.caption,p=i.altText;if(r){var m={componentName:xt.ComponentName.RichImage,imageUrl:r,_resizeDesiredWidth:u,originalHeight:o,originalWidth:s,caption:f,altText:p};if(!c&&o&&s&&s>u&&(m._cropData={cropWidth:s,cropHeight:o,cropX:0,cropY:0}),d&&(m.linkUrl=d),l&&(null==l?void 0:l.text)&&(null==l?void 0:l.styles)){m.overlayText=null==l?void 0:l.text;var _=null==l?void 0:l.styles;m.overlayTextStyles={isBold:null==_?void 0:_.isBold,isItalic:null==_?void 0:_.isItalic}}n.insertInlineImages(e,[m])}}}}),a.body.innerHTML},n}(Fa),ei=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentName=xt.ComponentName.Screenshot,t}return(0,ke.__extends)(t,e),t}(Ct);!function(e){e[e.Email=1]="Email",e[e.Teams=2]="Teams",e[e.VivaEngage=3]="VivaEngage",e[e.Web=4]="Web"}(Na||(Na={})),function(e){e.VivaAmplify="VivaAmplify",e.WebTranspile="WebTranspile",e.PageToEmail="PageToEmail",e.ShareByEmail="ShareByEmail"}(Ba||(Ba={}));var ti,ni,ai=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.distribution=Na.Email,t}return(0,ke.__extends)(t,e),t.prototype.render=function(e){var t=document.createElement("table");t.setAttribute("data-testid","link-root-table"),t.setAttribute("cellspacing","0"),t.setAttribute("cellpadding","0"),t.setAttribute("align","center"),t.setAttribute("width","100%");var n=document.createElement("tr"),a=document.createElement("td"),i=document.createElement("img");i.src=e.url,i.alt=e.altText||"",i.style.width="100%",a.innerHTML=i.outerHTML;var r=document.createElement("div");return r.style.visibility="hidden",r.setAttribute("width","0"),r.setAttribute("height","0"),r.style.width="0px",r.style.height="0px",r.style.fontSize="0px",r.setAttribute("tabindex","-1"),r.setAttribute("aria-hidden","true"),r.innerText=e.altText||"",a.appendChild(r),n.appendChild(a),t.appendChild(n),t.outerHTML},t}(ei),ii=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentName=xt.ComponentName.Screenshot,t.distribution=Na.VivaEngage,t}return(0,ke.__extends)(t,e),t.prototype.render=function(e){return{blocks:[],attachments:[]}},t}(ei),ri=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentName=xt.ComponentName.Screenshot,t.distribution=Na.VivaEngage,t}return(0,ke.__extends)(t,e),t.prototype.render=function(e){return""},t}(ei),oi=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentName=xt.ComponentName.Screenshot,t.distribution=Na.Teams,t}return(0,ke.__extends)(t,e),t.prototype.render=function(e){return""},t}(ei),si=new It([Wt,en,rn,At,Bt,Dn,wn,An,Un,Zn,Kn,dn,mn,Yn,da,_a,ya,sa,Aa,ka,Ha,ai],t.Email),ci=new It([qt,$t,on,kt,Gt,Sn,On,Ln,Fn,ta,Vn,ln,_n,Jn,fa,ga,Sa,ra,wa,Ta,ja,oi],t.Teams),di=new It([Qt,Xt,nn,Ht,Vt,vn,xn,kn,Hn,$n,Bn,un,hn,qn,la,ha,Da,aa,Ca,Ma,Za,ii],t.VivaEngage),li=new It([Yt,Zt,an,Rt,zt,yn,Cn,Mn,Rn,ea,jn,fn,bn,Qn,ua,ba,Ia,ia,Oa,Ua,$a,ri],t.VivaEngage),ui=((ti={})[t.Email]=si,ti[t.Teams]=ci,ti[t.Web]=si,ti[t.VivaEngage]=di,ti),fi=function(){function e(){this._factories=new Map}return e.prototype.build=function(e){var t,n,a,r=e.componentList,o=e.distributionType,s=e.context,c=e.componentLogging,d=new J._QosMonitor("TranspileWebpartBuilder"),l={alias:c.webpartAlias,webpartId:c.webpartId,transpileCorrelationId:c.eventId,distributionType:i[o],product:c.product,errorList:[],componentList:[]},u=[],f=this._getFactory(o,s);if(!f){var p="Factory failed to initialize";l.errorList.push({errorType:ft.ResultTypeEnum.Failure,error:new Error(p),errorMessage:p})}for(var m=0,_=r;m<_.length;m++){var h=_[m];l.componentList.push(h.componentName);try{var b=null==f?void 0:f.renderComponent(h);b?u.push(b):(p="Returned undefined or empty",l.errorList.push({errorType:ft.ResultTypeEnum.ExpectedFailure,errorMessage:p,error:new Error(p),componentName:h.componentName}))}catch(e){l.errorList.push({errorType:ft.ResultTypeEnum.Failure,error:e,errorMessage:e.message,componentName:h.componentName})}}var g,v=void 0;return 0===l.errorList.length?d.writeSuccess(l):((g=l.errorList.find(function(e){return e.errorType===ft.ResultTypeEnum.Failure}))?d.writeUnexpectedFailure(g.error.message,g.error,l):(g=l.errorList[0],d.writeExpectedFailure(g.error.message,g.error,l)),p=null!==(t=null==g?void 0:g.errorMessage)&&void 0!==t?t:"Webpart Unknown error",v={errorType:null!==(n=null==g?void 0:g.errorType)&&void 0!==n?n:ft.ResultTypeEnum.Failure,error:null!==(a=null==g?void 0:g.error)&&void 0!==a?a:new Error(p),errorMessage:p,componentName:null==g?void 0:g.componentName}),{content:u,errorData:v}},e.prototype._getFactory=function(e,n){var a=this._factories.get(e);return void 0===a&&(a=ui[e],e===t.VivaEngage&&n.transpileEngageAsHtml&&(a=li),a&&(null==a||a.initialize(n),this._factories.set(e,a))),a},e}();function pi(e,t){e=He(e),t=He(t);var n=new DOMParser,a=n.parseFromString(e.replace(/\s*(<[^>]+>)\s*/g,"$1"),"text/html"),i=n.parseFromString(t.replace(/\s*(<[^>]+>)\s*/g,"$1"),"text/html");_i(a.body,i.body)}function mi(e,t){if(e!==t)throw new Error("Expected: ".concat(e," | Received: ").concat(t))}function _i(e,t){var n,a,i=Array.from(e.childNodes).sort(function(e,t){return e.nodeName.localeCompare(t.nodeName)}),r=Array.from(t.childNodes).sort(function(e,t){return e.nodeName.localeCompare(t.nodeName)}),o=i.map(function(e){return e.nodeName}).join(", "),s=r.map(function(e){return e.nodeName}).join(", ");mi("ChildElementCheck: Node: ".concat(e.nodeName," | Children Count: ").concat(i.length," Names: ").concat(o),"ChildElementCheck: Node: ".concat(t.nodeName," | Children Count: ").concat(r.length," Names: ").concat(s)),function(e,t){var n;try{mi("AttributeCount Node: ".concat(e.nodeName," | AttributeLength: ").concat(e.attributes.length," Name: ").concat(Array.from(e.attributes).sort(function(e,t){return e.name.localeCompare(t.name)}).map(function(e){return e.name}).join(", ")),"AttributeCount Node: ".concat(t.nodeName," | AttributeLength: ").concat(t.attributes.length," Name: ").concat(Array.from(t.attributes).sort(function(e,t){return e.name.localeCompare(t.name)}).map(function(e){return e.name}).join(", ")));for(var a=0;a<e.attributes.length;a++){var i=hi(e.attributes[a]),r=hi(null!==(n=t.attributes.getNamedItem(e.attributes[a].name))&&void 0!==n?n:void 0);mi("Node: ".concat(e.nodeName," | AttrName: ").concat(e.attributes[a].name," AttributeValue: ").concat(i),"Node: ".concat(t.nodeName," | AttrName: ").concat(e.attributes[a].name," AttributeValue: ").concat(r))}}catch(n){throw new Error("Error in compareElementAttributes failed:\n      Failure : ".concat(n,"\n      SourceElement : ").concat(e.outerHTML,"\n      TargetElement : ").concat(t.outerHTML))}}(e,t),function(e,t){var n=e.style.length,a=t.style.length;mi("StyleCount: Element: ".concat(e.nodeName," Value: ").concat(n),"StyleCount: Element: ".concat(t.nodeName," Value: ").concat(a));for(var i=0;i<e.style.length;i++){var r=e.style[i],o=e.style.getPropertyValue(r),s=t.style.getPropertyValue(r);if(!s)throw new Error("StyleCompare: Element: ".concat(e.nodeName," Value: ").concat(r," not found in target"));mi("StyleCompare: Element: ".concat(e.nodeName," Name: ").concat(r," Value: ").concat(o),"StyleCompare: Element: ".concat(e.nodeName," Name: ").concat(r," Value: ").concat(s))}}(e,t);for(var c=0;c<i.length;c++)if("styles"!==i[c].nodeName)if(i[c].nodeType===Node.TEXT_NODE){var d=null!==(n=i[c].textContent)&&void 0!==n?n:"",l=null!==(a=r[c].textContent)&&void 0!==a?a:"";mi("TextNodeCompare: Element: ".concat(i[c].nodeName," Value: ").concat(d),"TextNodeCompare: Element: ".concat(r[c].nodeName," Value: ").concat(l))}else if(i[c].nodeType===Node.ELEMENT_NODE)_i(i[c],r[c]);else{if(i[c].nodeType!==Node.COMMENT_NODE)throw new Error("Node Type is not supported ".concat(e.childNodes[c].nodeType));mi("CommentNode: ".concat(i[c].textContent),"CommentNode: ".concat(r[c].textContent))}}function hi(e){return e?e.value.split(":").map(function(e){return e.trim().replace(";","")}).join(":"):""}function bi(e,t){var n=e.getAttribute(t);return n?parseFloat(n):NaN}function gi(e){var t=function(e){var t=window.getComputedStyle(e);return parseFloat(t.width)+parseFloat(t.paddingLeft)+parseFloat(t.paddingRight)}(e),n=function(e){return bi(e,"width")}(e);return isNaN(n)?t:n}function vi(e){e.forEach(function(e){if(e.type===ni.WidthRender){var t=e;J._TraceLogger.logVerbose(J._LogSource.create("EmailTranspiler"),"Parent: ".concat(t.parent.tagName,", Parent TestId: ").concat(t.parent.dataset.testid," Parent Width: ").concat(t.parentWidth,", Render Width: ").concat(t.renderWidth))}else e.type===ni.ParentChild&&(t=e,J._TraceLogger.logVerbose(J._LogSource.create("EmailTranspiler"),"Parent: ".concat(t.parent.tagName,", Parent TestId: ").concat(t.parent.dataset.testid," Child: ").concat(t.child.tagName,", Child TestId: ").concat(t.child.dataset.testid," Parent Width: ").concat(t.parentWidth,", Child Width: ").concat(t.childWidth)))})}function yi(e,t){void 0===t&&(t=[]);var n=gi(e),a=Array.from(e.children),i=bi(e,"max-width");return i>0&&n>i&&t.push({parent:e,parentWidth:n,renderWidth:i,type:ni.WidthRender}),a.forEach(function(a){var i=gi(a);i>n&&t.push({parent:e,child:a,parentWidth:n,childWidth:i,type:ni.ParentChild}),yi(a,t)}),t}function Si(e){return Di((new DOMParser).parseFromString(e.replace(/\s*(<[^>]+>)\s*/g,"$1"),"text/html").body)}function Di(e){return yi(e,[])}!function(e){e[e.ParentChild=0]="ParentChild",e[e.WidthRender=1]="WidthRender"}(ni||(ni={}))})(),m})())})();