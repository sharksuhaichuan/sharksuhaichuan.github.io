define("e9ca96c8-1783-446d-aff0-ba323343576d_0.1.0",["tslib","@microsoft/sp-diagnostics","@microsoft/sp-core-library","@ms/sp-image-shared","@microsoft/sp-image-helper","@ms/sp-component-utilities","@ms/office-ui-fabric-react-bundle"],(e,t,n,a,i,r,o)=>(()=>{"use strict";var s={676:e=>{e.exports=n},207:e=>{e.exports=t},949:e=>{e.exports=i},141:e=>{e.exports=o},773:e=>{e.exports=r},912:e=>{e.exports=a},280:t=>{t.exports=e}},c={};function d(e){var t=c[e];if(void 0!==t)return t.exports;var n=c[e]={exports:{}};return s[e](n,n.exports,d),n.exports}d.d=(e,t)=>{for(var n in t)d.o(t,n)&&!d.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},d.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),d.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var l={};return(()=>{var e;d.r(l),d.d(l,{CheckName:()=>e,applyOverlayColorToImage:()=>I,checkA11yForRte:()=>H,checkAltText:()=>o,getAltTextCheckResult:()=>s,getColor:()=>F,getHeadingLevel:()=>c,hexToRgba:()=>D,hexToUint8ClampedArray:()=>v,imageBackgroundColorContrastCheck:()=>g,imageOverlayTextColorContrastCheck:()=>S,isEnabledWebpart:()=>N,isHighContrastMode:()=>C,isInstanceDismissed:()=>f,loadImageToCanvas:()=>y,runSafeCheck:()=>u}),function(e){e[e.HeadingOrder=0]="HeadingOrder",e[e.EmptyLink=1]="EmptyLink",e[e.MissingTableHeader=2]="MissingTableHeader",e[e.AltText=3]="AltText",e[e.ColorContrast=4]="ColorContrast"}(e||(e={}));var t=d(280),n=d(207),a=d(676);function i(){return a._SPKillSwitch.isActivated("64cd0399-bb80-448a-91dc-9950f84513f3")}const r=n._LogSource.create("AccessibilityCheckerUtil");function o(e,t){return!!(e||t&&""!==(null==t?void 0:t.trim()))}function s(t,n,a,i,r){let s;return t.forEach((t,c)=>{r&&!r(t)||(void 0===s&&(s={checkName:e.AltText,displayText:n,isSuccess:!0,extraData:[]}),o(i(t),a(t))||(s.isSuccess=!1,s.extraData||(s.extraData=[]),s.extraData.push(c)))}),s}function c(e){switch(e.toUpperCase()){case"H1":return 1;case"H2":return 2;case"H3":return 3;case"H4":return 4;default:return 0}}function u(e){return(0,t.__awaiter)(this,void 0,void 0,function*(){const t=new n._QosMonitor("AccessibilityAssistant.Scanner.PerCheck"),a={};try{const n=yield e();return function(e){if(void 0!==e&&(null===e||"object"!=typeof e||"boolean"!=typeof e.isSuccess||"number"!=typeof e.checkName||"string"!=typeof e.displayText))throw new Error("Invalid check result")}(n),i()||t.writeSuccess(),n}catch(e){return n._TraceLogger.logError(r,e),void(i()||(a.errorStack=e.stack,t.writeUnexpectedFailure("FailedToScanA11yResultsForOneCheck",e,a)))}})}function f(e){return JSON.parse(window.sessionStorage.getItem("DismissedInstances")||"[]").includes(e)}var p=d(912),m=d(949),_=d(773);const h=[.2126,.7152,.0722],b=["p","a","h1","h2","h3","h4","h5","h6","span","pre","strong","u","s","sub","sup"];function g(e,t,n){const a=function(e){const t=[];for(let n=0;n<e.length;n+=4)t.push(new O(e.slice(n,n+3)));return t}(e);return function(e,t,n){const a=w(t),i=Math.ceil(.5*e.length),r=function(e,t){let n;return!t&&e<=.18333?n=4.5*(e+.05)-.05:t&&e<=.3&&(n=3*(e+.05)-.05),n}(a,n),o=function(e,t){let n;return!t&&e>=.175?n=(e+.05)/4.5-.05:t&&e>=.1&&(n=(e+.05)/3-.05),n}(a,n),s=r?e.filter(e=>e.lum>=r).length:0,c=o?e.filter(e=>e.lum<=o).length:0;return e.length-s-c<=i}(a,t,n)}function v(e){if(!/^#?([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/.test(e))throw new Error("Invalid hex color string");3===(e=e.replace(/^#/,"")).length&&(e=e.split("").map(e=>e+e).join(""));const t=parseInt(e,16);return new Uint8ClampedArray([t>>16&255,t>>8&255,255&t])}function y(e){return(0,t.__awaiter)(this,void 0,void 0,function*(){const t=a._SPKillSwitch.isActivated("7b82a18e-a3b8-47b6-b10f-c9c4e66ecf2a")?e:function(e){return _.DefaultImageHelper.isStockImage(e)?_.DefaultImageHelper.getDefaultImage(new m._SPResourcePath(e)):e}(e),n=yield(0,p.loadImage)(t,"anonymous"),i=document.createElement("canvas");i.width=600,i.height=n.naturalHeight/n.naturalWidth*600;const r=i.getContext("2d");if(!r)throw new Error("canvas.getContext return null");return r.drawImage(n,0,0,i.width,i.height),r.globalCompositeOperation="source-over",Promise.resolve({canvas:i,ctx:r})})}function S(e,n,a,i,r,o,s,c){return(0,t.__awaiter)(this,void 0,void 0,function*(){const{canvas:t,ctx:d}=yield y(e);s&&c&&0!==c&&I(d,t,s,c),r&&o&&0!==o&&I(d,t,r,o);const l=g(d.getImageData(0,0,t.width,t.height).data,v(n),x(i,a));return Promise.resolve(l)})}function D(e,t=1){return`rgba(${parseInt(e.substring(1,3),16)}, ${parseInt(e.substring(3,5),16)}, ${parseInt(e.substring(5,7),16)}, ${t})`}function I(e,t,n,a){e.globalCompositeOperation="source-over";const i=D(n,a);e.fillStyle=i,e.fillRect(0,0,t.width,t.height)}function x(e,t){return e>=24||t&&e>=18.5}function C(){return matchMedia("(forced-colors: active) or (-ms-high-contrast: active)").matches}class O{constructor(e){this.color=e,this.lum=w(this.color)}}function w(e){let t=0;for(let n=0;n<3;n++){let a=e[n]/255;a=a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4),t+=a*h[n]}return t}function E(e){const t=e.match(/\d+(\.\d+)?/g);if(!t||3!==t.length&&4!==t.length)return[0,0,0,0];const[n,a,i]=[parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10)];return[n,a,i,4===t.length?parseFloat(t[3]):1]}var A=d(141);const L=JSON.parse('{"kt":"标题顺序不一致","GN":"缺少链接说明","jU":"缺少表格标题","G5":"缺少可选文字","z9":"难以辨认的文本对比度"}');function k(t){const n=Array.from(t.querySelectorAll("h1, h2, h3, h4"));if(0===n.length)return;const a={checkName:e.HeadingOrder,displayText:L.kt,isSuccess:!0,violatedNodes:[],shouldOpenPropertyPane:!1},i=c(n[0].tagName);return n.forEach((e,t)=>{var r;const o=0===t?i:c(n[t-1].tagName),s=c(e.tagName);(s<i||Math.abs(s-o)>1)&&(a.isSuccess=!1,null===(r=a.violatedNodes)||void 0===r||r.push(e))}),a}function M(t){const n=Array.from(t.querySelectorAll("a"));if(0===n.length)return;const a={checkName:e.EmptyLink,displayText:L.GN,isSuccess:!0,violatedNodes:[],shouldOpenPropertyPane:!1};return n.forEach(e=>{var t;""===e.text.trim()&&(a.isSuccess=!1,null===(t=a.violatedNodes)||void 0===t||t.push(e))}),a}function P(t){const n=Array.from(t.querySelectorAll("table"));if(0===n.length)return;const a={checkName:e.MissingTableHeader,displayText:L.jU,isSuccess:!0,violatedNodes:[],shouldOpenPropertyPane:!1};return n.forEach(e=>{var t;null===e.querySelector("th")&&(a.isSuccess=!1,null===(t=a.violatedNodes)||void 0===t||t.push(e))}),a}function T(t){const n=Array.from(t.querySelectorAll(".imagePlugin"));if(0===n.length)return;const a={checkName:e.AltText,displayText:L.G5,isSuccess:!0,violatedNodes:[],shouldOpenPropertyPane:!1};return n.forEach(e=>{var t;o("true"===e.getAttribute("data-isdecorative"),e.getAttribute("data-alttext")||"")||(a.isSuccess=!1,null===(t=a.violatedNodes)||void 0===t||t.push(e))}),a}function U(n,a,i){var r;return(0,t.__awaiter)(this,void 0,void 0,function*(){if(C())return;const o=function(t,n){if(!t)return;const a=function(e,t){const n=[];if(!e)return n;const a=e.getAttribute("data-sp-feature-instance-id"),i=e.querySelector('[data-automation-id="textBox"]');if(!i)return n;const r=a?function(e){const t=[],n=window.sessionStorage.getItem("DismissedRTENode");return n&&JSON.parse(n).forEach(n=>{const[a,i]=n.split("::");a===e&&t.push(i)}),t}(a):[];return t.forEach(e=>{i.querySelectorAll(e).forEach(e=>{(function(e){var t;return!(!e.firstChild||e.firstChild.nodeType!==Node.TEXT_NODE||""===(null===(t=e.firstChild.textContent)||void 0===t?void 0:t.trim()))})(e)&&!r.includes(e.outerHTML)&&n.push(e)})}),n}(t,b);if(0===a.length)return;const i={checkName:e.ColorContrast,displayText:L.z9,isSuccess:!0,violatedNodes:[],shouldOpenPropertyPane:!1},r=(0,A.getTheme)().semanticColors.bodyBackground;return a.forEach(e=>{var t;(function(e,t,n,a){const i=window.getComputedStyle(e),r=i.fontSize,o=parseInt(r.replace(/[^0-9]/g,""),10);let s=function(e){let t=e,n=!1,a=[0,0,0,0];for(;!n&&0===a[3]&&t.parentElement;)a=E(window.getComputedStyle(t).backgroundColor),n="CanvasZone"===t.getAttribute("data-automation-id"),t=t.parentElement;return a}(e);const c=E(i.color);let d;return a&&0===s[3]?d=g(a,new Uint8ClampedArray(c),x(o,n)):(0===s[3]&&(s=v(t)),d=function(e,t,n){const a=w(e),i=w(t),r=a>i?(a+.05)/(i+.05):(i+.05)/(a+.05);return n?r>=3:r>=4.5}(new Uint8ClampedArray(c),new Uint8ClampedArray(s),x(o,n))),d})(e,r,"STRONG"===e.nodeName,n)||(i.isSuccess=!1,null===(t=i.violatedNodes)||void 0===t||t.push(e))}),i}(a,i),s=yield function(n){return(0,t.__awaiter)(this,void 0,void 0,function*(){const a=Array.from(n.querySelectorAll(".imagePlugin"));if(0===a.length)return Promise.resolve(void 0);const i={checkName:e.ColorContrast,displayText:L.z9,isSuccess:!0,violatedNodes:[],shouldOpenPropertyPane:!1};return yield Promise.all(a.map(e=>(0,t.__awaiter)(this,void 0,void 0,function*(){var t,n;const a="true"===e.getAttribute("data-isoverlaytextenabled"),r=!!e.getAttribute("data-overlaytext")&&""!==(null===(t=e.getAttribute("data-overlaytext"))||void 0===t?void 0:t.trim()),o=e.getAttribute("data-imageurl");if(a&&r&&o){const t=F(e.getAttribute("data-overlaystylestextcolor")||"light"),a=F(e.getAttribute("data-overlaystylestextboxcolor")||"dark"),r=Number(e.getAttribute("data-overlaystylestextboxopacity")||.54),s=F(e.getAttribute("data-overlaystylesoverlaycolor")||"light"),c=Number(e.getAttribute("data-overlaystylesoverlaytransparency")||0),d="true"===e.getAttribute("data-overlaystylesisbold"),l=Number(e.getAttribute("data-overlaystylesfontsize")||16);t&&((yield S(o,t,d,l,a,r,s,c))||(i.isSuccess=!1,null===(n=i.violatedNodes)||void 0===n||n.push(e)))}}))),Promise.resolve(i)})}(n);return o?s?o.isSuccess?s:(s.isSuccess||s.violatedNodes&&s.violatedNodes.length>0&&(null===(r=o.violatedNodes)||void 0===r||r.push(...s.violatedNodes)),o):o:s})}function F(e){const t=(0,A.getTheme)(),n=t.semanticColors.inputBackgroundChecked,a=t.semanticColors.accentButtonBackground;return new Map([["light","#ffffff"],["dark","#000000"],["theme1",n],["theme2",a]]).get(e)}function H(e,n,i){return(0,t.__awaiter)(this,void 0,void 0,function*(){if(a._SPKillSwitch.isActivated("5d484391-1267-4674-afee-62f401455f02")){const t=[k(e),M(e),P(e),T(e),yield U(e,n,i)];return Promise.resolve(t)}{const t=[()=>k(e),()=>M(e),()=>P(e),()=>T(e),()=>U(e,n,i)];return(yield Promise.all(t.map(e=>u(e)))).filter(e=>void 0!==e)}})}const R={"c70391ea-0b10-4ee9-b2b4-006d3fcad0cd":!0,"d1d91016-032f-456d-98a4-721247c305e8":!0,"8404d628-4817-4b3a-883e-1c5a4d07892e":!0,"c4bd7b2f-7b6e-4599-8485-16504575f590":!0,"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788":!0};function N(e){const t=R[e];return void 0!==t&&!1!==t&&(!0===t||a._SPFlight.isEnabled(t))}})(),l})());