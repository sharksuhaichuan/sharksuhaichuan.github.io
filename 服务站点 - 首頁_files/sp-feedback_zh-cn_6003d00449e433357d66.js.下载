(()=>{var e=document.currentScript;define("2ade42ba-c2c8-4cc4-9b7b-bd962efd6162_1.0.0",["tslib","@microsoft/load-themed-styles","@microsoft/sp-core-library","@microsoft/sp-diagnostics","@microsoft/sp-page-context","@ms/office-ui-fabric-react-bundle","@ms/sp-a11y","@ms/sp-office-browser-feedback","@ms/sp-telemetry","@ms/odsp-core-bundle","@ms/sp-topic-dataproviders","@microsoft/sp-loader"],(t,n,a,i,r,o,s,c,d,l,u,f)=>(()=>{"use strict";var p,m,_,h={8424:e=>{e.exports=n},9676:e=>{e.exports=a},2207:e=>{e.exports=i},8414:e=>{e.exports=f},7408:e=>{e.exports=r},8698:e=>{e.exports=l},2141:e=>{e.exports=o},2193:e=>{e.exports=s},4596:e=>{e.exports=c},9408:e=>{e.exports=d},4511:e=>{e.exports=u},280:e=>{e.exports=t}},b={};function g(e){var t=b[e];if(void 0!==t)return t.exports;var n=b[e]={exports:{}};return h[e].call(n.exports,n,n.exports,g),n.exports}g.m=h,g.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return g.d(t,{a:t}),t},g.d=(e,t)=>{for(var n in t)g.o(t,n)&&!g.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},g.f={},g.e=e=>Promise.all(Object.keys(g.f).reduce((t,n)=>(g.f[n](e,t),t),[])),g.u=e=>"chunk."+{231:"CopilotDebugTools",435:"copilotCampaignDefinitions",494:"sp-feedback-dynamic",706:"sp-feedback-getFeedbackOptions",927:"custom-gpt-graphUtilities"}[e]+"_"+({435:1}[e]?"zh-cn":"none")+"_"+{231:"4e2cc86775e175b814dc",435:"69408ac689b51ec2a409",494:"759ed9444a5663c1b868",706:"6e0300226a5c3b0c9484",927:"6972eebcca8eee398c6a"}[e]+".js",g.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),p={},m="2ade42ba-c2c8-4cc4-9b7b-bd962efd6162_1.0.0:",g.l=(e,t,n,a)=>{if(p[e])p[e].push(t);else{var i,r;if(void 0!==n)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var c=o[s];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==m+n){i=c;break}}i||(r=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,g.nc&&i.setAttribute("nonce",g.nc),i.setAttribute("data-webpack",m+n),i.src=e,0!==i.src.indexOf(window.location.origin+"/")&&(i.crossOrigin="anonymous")),p[e]=[t];var d=(t,n)=>{i.onerror=i.onload=null,clearTimeout(l);var a=p[e];if(delete p[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach(e=>e(n)),t)return t(n)},l=setTimeout(d.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=d.bind(null,i.onerror),i.onload=d.bind(null,i.onload),r&&document.head.appendChild(i)}},g.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},_=e?e.src:"",g.p=_.slice(0,_.lastIndexOf("/")+1),g.f.compat=(e,t)=>{for(var n=function(e){return{706:[{i:"8494e7d7-6b99-47b2-a741-59873e42f16f",v:"12.67.73",m:9773}],927:[{i:"cc2cc925-b5be-41bb-880a-f0f8030c6aff",v:"5.6.346",m:9939}]}[e]||[]}(e),a=0;a<n.length;a++)g.m[n[a].m]||(e=>{t.push(v.SPComponentLoader.loadComponentById(e.i,e.v).then(t=>{g.m[e.m]=e=>e.exports=t}))})(n[a])};var v=g(8414);(()=>{var e={834:0};g.f.j=(t,n)=>{var a=g.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise((n,i)=>a=e[t]=[n,i]);n.push(a[2]=i);var r=g.p+g.u(t),o=new Error;g.l(r,n=>{if(g.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",o.name="ChunkLoadError",o.type=i,o.request=r,a[1](o)}},"chunk-"+t,t)}};var t=(t,n)=>{var a,i,[r,o,s]=n,c=0;if(r.some(t=>0!==e[t])){for(a in o)g.o(o,a)&&(g.m[a]=o[a]);s&&s(g)}for(t&&t(n);c<r.length;c++)i=r[c],g.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self["webpackJsonp_2ade42ba-c2c8-4cc4-9b7b-bd962efd6162_1.0.0"]=self["webpackJsonp_2ade42ba-c2c8-4cc4-9b7b-bd962efd6162_1.0.0"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var y={};return(()=>{g.r(y),g.d(y,{SPFeedback:()=>V,spFeedbackServiceKey:()=>z});var e=g(280);g(8424).loadStyles("#obf-TFormContainer{color:#000!important}",!0);var t=g(9676),n=g(2207),a=g(7408),i=g(2141),r=g(2193);const o=function(n){function a(e){return n.call(this,e,{serviceKey:a.serviceKey,isShared:!1})||this}return(0,e.__extends)(a,n),a.prototype.createA11yManager=function(e){var a=this;t.Validate.isNotNullOrUndefined(e,"domElement"),n.prototype.createServiceComponent.call(this,this.componentConfiguration,function(t){return r.A11yManager.create(e,a.componentConfiguration||void 0)})},Object.defineProperty(a.prototype,"a11yManager",{get:function(){return this.serviceComponent},enumerable:!1,configurable:!0}),a.a11yServiceName="sp-pages-core:A11yManager",a.serviceKey=t.ServiceKey.create(a.a11yServiceName,a),a}(function(){function e(e,n){t.Validate.isNotNullOrUndefined(e,"serviceScope"),t.Validate.isNotNullOrUndefined(n,"serviceConfiguration"),t.Validate.isNotNullOrUndefined(n.serviceKey,"serviceConfiguration.serviceKey"),this._serviceScope=e,this._serviceConfiguration=n,this._isDisposed=!1}return e.prototype.dispose=function(){this._isDisposed||(this.onDispose(),this._isDisposed=!0)},Object.defineProperty(e.prototype,"componentConfiguration",{get:function(){return this._componentConfiguration},set:function(e){this._componentConfiguration=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serviceConfiguration",{get:function(){return this._serviceConfiguration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serviceScope",{get:function(){return this._serviceScope},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!1,configurable:!0}),e.prototype.createServiceComponent=function(e,n){t.Validate.isNotNullOrUndefined(n,"componentFactory"),void 0===this._serviceComponent&&(this._componentConfiguration=e,this._serviceComponent=n(e))},Object.defineProperty(e.prototype,"serviceComponent",{get:function(){return this._serviceComponent},enumerable:!1,configurable:!0}),e.prototype.onDispose=function(){},e}());var s=g(4596),c=g(9408);const d=JSON.parse('{"yU":"你刚才发布了一个页面! 请告诉我们是否进行顺利。","rC":"只需回答两个问题即可。","c_":"当然可以","VO":"以后再说","$4":"如果有人问起，你在 SharePoint 中向其他人推荐创建和发布页面的可能性有多大?","kW":"1 - 非常不满意","BQ":"2","Pc":"3","xx":"4","qs":"5 - 非常满意","Vp":"1 - 根本不可能","My":"5 - 极有可能","BI":"按 Alt+向下键，转到反馈表。","Bg":"你刚才编辑了一张图像! 请告诉我们是否进行顺利。","aI":"你如何评价 SharePoint 页面中的图像体验?","xI":"请告诉我们更多信息。你为什么选择该评分?","$P":"你刚刚编辑了一个页面!告诉我们进展如何。","MN":"使用文本 Web 部件的难易程度如何?","Y_":"1 - 非常困难","Y4":"5 - 很简单","sT":"只需回答一个问题即可。","Rf":"当然可以","iv":"以后再说","Th":"你向朋友或同事推荐 SharePoint 协议的可能性有多大?","Yr":"1 - 根本不可能","np":"2","YM":"3","V4":"4","d3":"5 - 极有可能","Nv":"请提供有助于改进你的体验的建议。","Ks":"告诉我们进展如何。"}');var l={CampaignId:"dd025788-0c5d-4dde-812e-2b30af0d3bf9",StartTimeUtc:"2020-03-19T00:00:00Z",EndTimeUtc:"2026-01-01T00:00:00Z",GovernedChannelType:0,Scope:{Type:1},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296e3},CooldownPeriod:{Type:0,IntervalSeconds:10368e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"PublishFeatureUsage",Count:1,IsAggregate:!0},Content:{Prompt:{Title:d.yU,Question:d.rC,YesLabel:d.c_,NoLabel:d.VO},Rating:{isZeroBased:!1,Question:d.$4,RatingValuesAscending:[d.Vp,d.BQ,d.Pc,d.xx,d.My]},Question:{Question:d.xI}}},PrimaryPriority:3};const u=JSON.parse('{"Lm":"你已创建新页面！告诉我们它是如何进行。","kJ":"你对创建和查找页面的满意度如何?","kT":"请提供详细信息。为何选择此评分?"}');var f,p,m=(0,e.__assign)((0,e.__assign)({},{CampaignId:"f75eef0a-4a84-4533-a546-1948d664e5b1",StartTimeUtc:"2024-01-01T00:00:00Z",EndTimeUtc:"2026-12-01T00:00:00Z"}),{GovernedChannelType:0,Scope:{Type:1},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296e3},CooldownPeriod:{Type:0,IntervalSeconds:10368e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,IsAggregate:!0,Activity:"SharePointStartCreatePage",Count:1},{Type:0,IsAggregate:!0,Activity:"SharePointStartUsage",Count:1}],IsAggregate:!0},Content:{Prompt:{Title:u.Lm,Question:d.rC,YesLabel:d.c_,NoLabel:d.VO},Rating:{isZeroBased:!1,Question:u.kJ,RatingValuesAscending:[d.kW,d.BQ,d.Pc,d.xx,d.qs]},Question:{Question:u.kT}}},PrimaryPriority:3}),_={CampaignId:"5ad3420d-1e81-40f3-80bd-812c7989977a",StartTimeUtc:"2023-03-10T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,Scope:{Type:1},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296e3},CooldownPeriod:{Type:0,IntervalSeconds:7884e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"ImageEditUsage",Count:5,IsAggregate:!0},Content:{Prompt:{Title:d.Bg,Question:d.rC,YesLabel:d.c_,NoLabel:d.VO},Rating:{isZeroBased:!1,Question:d.aI,RatingValuesAscending:[d.kW,d.BQ,d.Pc,d.xx,d.qs]},Question:{Question:d.xI}}},PrimaryPriority:3},h={CampaignId:"37cdaeac-09cf-40a4-b22a-1c0af173f566",StartTimeUtc:"2025-01-16T00:00:00Z",EndTimeUtc:"2025-02-22T00:00:00Z",GovernedChannelType:0,Scope:{Type:1},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296e3},CooldownPeriod:{Type:0,IntervalSeconds:7884e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,IsAggregate:!1,Activity:"RichTextEditorUsage",Count:2},{Type:0,IsAggregate:!1,Activity:"PageAuthoringEndUsage",Count:1}]},Content:{Prompt:{Title:d.$P,Question:d.rC,YesLabel:d.c_,NoLabel:d.VO},Rating:{isZeroBased:!1,Question:d.MN,RatingValuesAscending:[d.Y_,d.BQ,d.Pc,d.xx,d.Y4]},Question:{Question:d.xI}}},PrimaryPriority:3},b={CampaignId:"049eae42-7cae-4f45-b362-134673bcdf23",StartTimeUtc:"2024-07-11T07:00:00Z",EndTimeUtc:"2024-12-31T08:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296e3},CooldownPeriod:{Type:0,IntervalSeconds:7884e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,IsAggregate:!1,Activity:"AgreementsTriggerAction",Count:1}]},Content:{Prompt:{Title:d.Ks,Question:d.sT,YesLabel:d.Rf,NoLabel:d.iv},Rating:{isZeroBased:!1,Question:d.Th,RatingValuesAscending:[d.Yr,d.np,d.YM,d.V4,d.d3]},Question:{Question:d.Nv}}},PrimaryPriority:3},v=[];function S(){return(0,e.__awaiter)(this,void 0,void 0,function(){var t,n;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return f?[2]:[4,f=g.e(231).then(g.bind(g,8176))];case 1:if(p=e.sent().tools,!v.length)return[3,6];t=0,n=v,e.label=2;case 2:return t<n.length?[4,(0,n[t])(p)]:[3,5];case 3:e.sent(),e.label=4;case 4:return t++,[3,2];case 5:v=[],e.label=6;case 6:return[2]}})})}function D(e){p?e(p):v.push(e)}function I(){return window.$copilot||(window.$copilot={availability:{},loadDebugTools:S,get tools(){if(!p)throw Error("Call `await $copilot.loadDebugTools()` first to load the tools");return p},context:{},get perfCounters(){return{featuresOn:void 0,featuresOff:void 0,killSwitchesOn:void 0,killSwitchesOff:void 0}},internal:{onDebugToolsLoaded:D}}),window.$copilot}var x=g(8698),C={ODB:61554},O={ODB:62043};function w(){return x.FeatureOverrides.isFeatureEnabled(O)}var E=!1;function A(e){var t,n=L("Error"),a=I();a.availability.customCopilotEAPCheckErrorType=e,null===(t=window.localStorage)||void 0===t||t.setItem(n,a.availability.customCopilotEAPCheckErrorType)}function L(e){return"UserInEAPGroup_".concat(e)}var k={ODB:61346},M=[l,_,m,h,b],P=n._LogSource.create("".concat(R,".CampaignDefinitions"));function T(a){return(0,e.__awaiter)(this,void 0,void 0,function(){var i,r,o,s,c,d,l;return(0,e.__generator)(this,function(u){switch(u.label){case 0:return u.trys.push([0,3,,4]),i=!t._SPKillSwitch.isActivated("5a3badec-fe8e-4903-a033-9636ac4ae139")&&function(e){var t,n,a=e.pageContextForEAPCheck,i=I();if(!x.KillSwitch.isActivated("87a98255-e313-4151-a344-a023c75eaadb","10/18/2024","isgulati - enable rcd check before enabling copilot")&&(null==a?void 0:a.IsRestrictedContentDiscoverabilityEnabled))return i.availability.isRCDEnabled=!0,!1;if(!x.KillSwitch.isActivated("99f050db-9dd7-4098-8772-9cee7e595faf","10/03/2024","isgulati - enable site check before enabling copilot")&&!function(e){var t=!0;return x.KillSwitch.isActivated("44d3c708-0bb8-444d-8457-4b05f3853ba7")||x.FeatureOverrides.isFeatureEnabled(k)||!e||(t=0===(0,x.getVariantAndLogExposure)(90214,e)),I().availability.isSiteAllowed=t,t}(a))return i.availability.isSiteAllowed=!1,!1;if(x.FeatureOverrides.isFeatureEnabled(C))return!0;if(w()){if(i.availability.customCopilotEAPCheckEnabled=!0,!a||!a.aadUserId)return A(a?"MissingAADUserId":"MissingPageContext"),!1;i.availability.aadUserId=a.aadUserId;var r=(t=a.aadUserId,"true"===(null===(n=window.localStorage)||void 0===n?void 0:n.getItem(L(t))));return i.availability.isUserInEAP=r,function(e){if(!w()||E||!e||!e.aadUserId)return Promise.resolve();var t=L(e.aadUserId);return E=!0,g.e(927).then(g.bind(g,1687)).then(function(n){return n.isCurrentUserInEAPGroup(e).then(function(e){var n;null===(n=window.localStorage)||void 0===n||n.setItem(t,e.toString())})})}(a).catch(function(){A("CacheRefreshError")}),r}return!1}({pageContextForEAPCheck:null==a?void 0:a.legacyPageContext}),r=(0,e.__spreadArray)([],M,!0),i?[4,U()]:[3,2];case 1:o=u.sent(),r=r.concat(o),u.label=2;case 2:for(s=0,c=r;s<c.length;s++)void 0===(d=c[s]).PrimaryPriority&&(d.PrimaryPriority=3,n._TraceLogger.logVerbose(P,"Ensured ".concat(d.CampaignId," PrimaryPriority is 3")));return window.localStorage?window.localStorage.setItem("obf-CampaignDefinitions",JSON.stringify(r)):n._TraceLogger.logVerbose(P,"LocalStorageNotAvailable"),[3,4];case 3:return l=u.sent(),new n._QosMonitor("".concat(R,".CampaignDefinitions")).writeUnexpectedFailure("StorageFailure",l),[3,4];case 4:return[2]}})})}function U(){return(0,e.__awaiter)(this,void 0,void 0,function(){return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,g.e(435).then(g.bind(g,9520)).then(function(e){return e.customCopilotCampaignDefinitions}).catch(function(e){return n._TraceLogger.logError(P,e,"FailedCustomCopilotCampaignDefinitions"),[]})];case 1:return[2,e.sent()]}})})}const F=function(){function e(){}return e.EDOG="edog",e.PROD_BUBBLE="prodbubble",e.PROD="prod",e}();var H=g(4511),R="SPFeedback",N=s.officeFeedbackIntlBaseUrl,B="AppUsageTime",j="UpdateFlightsForOfficeFeedback",V=function(){function r(e){var t=this;this.instanceId="f709c1cd-2daf-4093-a99a-a167b55ebc23",this.componentId="f709c1cd-2daf-4093-a99a-a167b55ebc23",this.isDisposed=!1,e.whenFinished(function(){t._serviceScope=e,t._pageContext=e.consume(a.PageContext.serviceKey),t._a11yService=e.consume(o.serviceKey)})}return r._translateOfficeFeedbackPolicies=function(t){var n=(0,e.__assign)({},r._defaultFeedbackPolicy);return t.forEach(function(e){if("common\\feedback"===e.key&&"Web"===e.platform)switch(e.settingId){case"office16;L_SendFeedback":n.policyAllowFeedback="1"===e.value;break;case"office16;L_SendSurvey":n.policyAllowSurvey="1"===e.value;break;case"office16;L_Screenshot":n.policyAllowScreenshot="1"===e.value;break;case"office16;L_EmailCollection":n.policyAllowContact="1"===e.value;break;case"office16;L_LogCollection":n.policyAllowContent="1"===e.value}}),n},r._getOCPSPolicies=function(e){return r._policies?Promise.resolve(r._policies):new H.OCPSPolicyDataProvider(e).getPolicies().then(function(e){if(e.value&&e.value.length>0){var t=e.value[0].policiesPayload;if(t)return r._policies=r._translateOfficeFeedbackPolicies(t),r._policies}return r._defaultFeedbackPolicy}).catch(function(e){return r._floodgateLogError("getOCPSPolicies",!1),r._defaultFeedbackPolicy})},r._getMonitor=function(e){return new n._AutoAlertableQosMonitor(e,n._AutoAlertableMonitorType.DynamicReliabilityQosMediumSev4)},r._handleDismiss=function(t,a){var i,o,s,c,d,l={campaignId:t},u=new n._LogEntry(R,a?"Submitted":"Dismissed",n._LogType.Event,l);if(n._EngagementLogger.logEventWithLogEntry(u),a){var f=null===(i=r._spFloodgate)||void 0===i?void 0:i.getEngine(),p="Unknown";if(f){var m=f.launchedSurveys;if(!m)return p="NoSurveys",void r._logNoBackupScore(p);var _=void 0;for(var h in m)if((null===(c=null===(s=null===(o=m[h])||void 0===o?void 0:o.surveyInfo)||void 0===s?void 0:s.data)||void 0===c?void 0:c.backEndIdentifier)===t){if(void 0!==(_=null===(d=m[h].rating)||void 0===d?void 0:d.selectedIndex)){var b=new n._LogEntry(R,"Rated",n._LogType.Event,(0,e.__assign)((0,e.__assign)({},l),{rating:(++_).toString()}));n._EngagementLogger.logEventWithLogEntry(b)}else p="NoSurveyResult",r._logNoBackupScore(p);return}p="CampaignMismatch"}else p="NoEngine";r._logNoBackupScore(p)}},r._logNoBackupScore=function(e){r._getMonitor("".concat(R,".NoBackupScore")).writeUnexpectedFailure(e)},r._setFloodgateWindowEvents=function(){this&&(window.addEventListener("focus",r._resumeUsage),window.addEventListener("blur",r._pauseUsage),window.addEventListener("unload",r._stopFloodgate),document.addEventListener(j,this._handleFlightsForOfficeFeedback))},r._stopFloodgate=function(){r._spFloodgate?(r._pauseUsage(),r._spFloodgate.stop()):r._floodgateLogError("floodGateUndefinedAtStop",!1)},r._startFloodgateAsync=function(){return r._spFloodgate||r._floodgateLogError("floodGateUndefinedAtStart",!0),r._spFloodgate.start().then(function(){return r._resumeUsage()}).catch(function(e){r._floodgateLogError("floodGateStartFailed",!0,e)})},r._pauseUsage=function(){r._spFloodgate&&r._spFloodgate.stop(),r._activityListener?r._activityListener.logActivityStopTime(B,new Date):r._floodgateLogError("floodGateUndefinedAtPause",!1)},r._resumeUsage=function(){r._spFloodgate&&r._spFloodgate.start().catch(function(){}),r._activityListener?(r._activityListener.logActivity("AppResume"),r._activityListener.logActivityStartTime(B)):r._floodgateLogError("floodGateUndefinedAtResume",!1)},r._initializeStartFloodgateAsync=function(){return r._spFloodgate.initialize().then(function(){return r._startFloodgateAsync()}).then(function(){n._TraceLogger.logVerbose(r._logSource,"Initialized and started floodgate successfully")}).catch(function(e){r._floodgateLogError("_initializeStartFloodgateAsync",!0,e)})},r._floodgateLogError=function(e,t,a){if(a=a||new Error(e),n._TraceLogger.logError(r._logSource,a,e),t)throw r._getMonitor("".concat(R,".").concat(e)).writeUnexpectedFailure(void 0,a),a},r._getTheme=function(){var e,t,n=window.__themeState__;return(null==n?void 0:n.theme)&&(e=n.theme.themePrimary,t=n.theme.themeSecondary),{themePrimary:e||"#0078d4",themeSecondary:t||"#2b88d8"}},Object.defineProperty(r,"_buildNumber",{get:function(){var e=c._Telemetry.buildNumber,t=/[0-9]{1,4}-?[0-9]{1,2}-?[0-9]{1,2}\.[0-9]{1,9}/;return t.test(e)?e.match(t)[0].replace(/-/g,""):"0"},enumerable:!1,configurable:!0}),Object.defineProperty(r,"_activityListener",{get:function(){var e,t;return null===(t=null===(e=r._spFloodgate)||void 0===e?void 0:e.getEngine())||void 0===t?void 0:t.getActivityListener()},enumerable:!1,configurable:!0}),Object.defineProperty(r,"_infoOnUIAppHost",{get:function(){var e="Default";return t._BrowserUtilities.isTeamsWebViewHosted()||t._BrowserUtilities.isTeamsBrowserHosted()||t._BrowserUtilities.isEmbeddedInSite()?e="TeamsNonMobile":(t._BrowserUtilities.isTeamsAndroidHosted()||t._BrowserUtilities.isTeamsIOSHosted())&&(e="TeamsMobile"),e},enumerable:!1,configurable:!0}),r.prototype.startAppUsageAsync=function(e){return this._feedbackOptions=e,this.setupFloodgate().then(function(){r._activityListener&&r._activityListener.logActivityStartTime(B)}).catch(function(e){n._TraceLogger.logError(r._logSource,e,"SPFeedbackUtility.startAppUsageAsync")})},r.prototype.setupFeedback=function(t){var n=this;if(r._isFeedbackInitialized)return Promise.resolve(r._spFeedback);var a=r._getMonitor("".concat(R,".setupFeedback"));return(0,s.loadFloodgateAsync)().then(function(){return(0,e.__awaiter)(n,void 0,void 0,function(){return(0,e.__generator)(this,function(e){switch(e.label){case 0:return r._spFeedback=window.OfficeBrowserFeedback,[4,this._initializeFeedback(t)];case 1:return e.sent(),a.writeSuccess(),[2,r._spFeedback]}})})}).catch(function(e){throw a.writeUnexpectedFailure("SetUpFail",e),e})},r.prototype.setupFloodgate=function(){var t=this;if(r._isFloodgateInitialized)return Promise.resolve(r._spFeedback);var n=r._getMonitor("".concat(R,".setupFloodgate"));return(0,s.loadFloodgateAsync)().then(function(){return(0,e.__awaiter)(t,void 0,void 0,function(){return(0,e.__generator)(this,function(e){switch(e.label){case 0:return r._spFeedback=window.OfficeBrowserFeedback,r._spFloodgate=r._spFeedback.floodgate,[4,this._initializeFloodgate()];case 1:return e.sent(),n.writeSuccess(),[2,r._spFeedback]}})})}).catch(function(e){throw n.writeUnexpectedFailure("SetUpFail",e),e})},r.prototype.logActivityForFeedbackAsync=function(e){if(e&&(void 0===e.isDependentExpGroup||(null==e?void 0:e.isDependentExpGroup))){var t=r._getMonitor("".concat(R,".logActivityForFeedbackAsync"));return this.setupFloodgate().then(function(){r._activityListener.logActivity(e.name),t.writeSuccess()}).catch(function(e){return t.writeUnexpectedFailure("FeedbackLogActivityFail",e),Promise.reject(e)})}},r.prototype.onSurveyActivated=function(e,t){var a="SurveyActivated",i="".concat(R,".").concat(a),o=new n._AutoAlertableQosMonitor(i,n._AutoAlertableMonitorType.DynamicReliabilityQosMediumSev4),s=null==t?void 0:t.getCampaignId(),c={alias:s};try{if(s){var l={campaignId:s},u=new n._LogEntry(R,a,n._LogType.Event,l);n._EngagementLogger.logEventWithLogEntry(u),null==o||o.writeSuccess(c)}else n._EngagementLogger.logEvent(i),null==o||o.writeSuccess();window.addEventListener("keydown",this._handleKeyDown,!1)}catch(e){null==o||o.writeUnexpectedFailure("onSurveyActivated",e,c),r._floodgateLogError("onSurveyActivatedPreLog",!1,e)}e.launch(),this._a11yService.a11yManager.alert(d.BI)},r.prototype.dispose=function(){window.removeEventListener("focus",r._resumeUsage),window.removeEventListener("blur",r._pauseUsage),window.removeEventListener("unload",r._stopFloodgate),window.removeEventListener("keydown",this._handleKeyDown,!1),document.removeEventListener(j,r._handleFlightsForOfficeFeedback),t._SPEventManager.instance.unregisterEvent("recordSurveyEvent",this,this.logActivityForFeedbackAsync),r._isFeedbackInitialized=!1,r._isFloodgateInitialized=!1,this.isDisposed=!0},r.prototype._initializeFeedback=function(n){var a,i;return(0,e.__awaiter)(this,void 0,void 0,function(){var o,c,d,l,u,f,p,m,_,h;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,this._getFeedbackOptions()];case 1:return o=e.sent(),r._isFeedbackInitialized||!o?[2]:[4,T(c=this._pageContext)];case 2:return e.sent(),d=t.Environment.type===t.EnvironmentType.Local?1:0,l=r._getTheme(),u=null===(a=c.aadInfo)||void 0===a?void 0:a.tenantId.toString(),f="a:".concat(null===(i=c.aadInfo)||void 0===i?void 0:i.userId.toString()),(p={feedbackTenant:window.location.hostname}).appData=JSON.stringify({UiHost:r._infoOnUIAppHost}),m=r._buildNumber,_=c.legacyPageContext,(h=n)?[3,4]:[4,r._getOCPSPolicies(this._serviceScope)];case 3:h=e.sent(),e.label=4;case 4:return r._spFeedback.initOptions={appId:o.appId,applicationGroup:p,build:m,environment:d,intlFilename:"officebrowserfeedbackstrings.js",intlUrl:N,locale:c.cultureInfo.currentUICultureName,onError:function(e){r._getMonitor("".concat(R,".initOnError")).writeUnexpectedFailure("SDKErrorHandler",new Error(e))},primaryColour:l.themePrimary,sessionId:c.site.correlationId.toString(),sendFeedbackPolicyValue:h.policyAllowSurvey?1:0,screenshot:h.policyAllowScreenshot,secondaryColour:l.themeSecondary,stylesUrl:s.officeFeedbackCssUrl,telemetryGroup:{audienceGroup:this._pageEnvironment,deviceType:navigator.userAgent,loggableUserId:f,officeUILang:c.legacyPageContext.currentLanguage,platform:navigator.platform,tenantId:u,featureArea:o.featureArea},showEmailAddress:h.policyAllowContact,userEmail:c.user.email,webGroup:{browser:navigator.appCodeName,browserVersion:navigator.appVersion},bugForm:o.bugForm,isShowThanks:o.isShowThanks,telemetrySink:(0,s.getTelemetrySink)({featureArea:o.featureArea,legacyPageContext:_,pageContext:c,version:m})},r._spFeedback.initOptions.telemetryGroup.flights=Array.from(r._flightsForTelemetryGroup).join(","),r._isFeedbackInitialized=!0,t._SPEventManager.instance.registerEvent("recordSurveyEvent",this,this.logActivityForFeedbackAsync),[2]}})})},r.prototype._initializeFloodgate=function(){return(0,e.__awaiter)(this,void 0,void 0,function(){var a,i,o,s,c,d;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,this._initializeFeedback()];case 1:if(e.sent(),r._isFloodgateInitialized)return[3,8];if(a={enabled:!1,ecsClient:void 0},i={enabled:!1,theme:"M365Light",cdnStringConfig:{uiStringsCdnEnabled:!0}},(t._SPKillSwitch.isActivated("e972ce16-52f2-4665-9772-79ec3186c4df")||1!==t._SPExperiment.getVariantAndLogExposure(90347))&&!t._SPFlight.isEnabled(62373))return[3,6];o=r._getMonitor("".concat(R,".dynamicCampaign")),s=new Map([["agent","ChillSharePoint"]]),e.label=2;case 2:return e.trys.push([2,5,,6]),[4,g.e(494).then(g.bind(g,3015))];case 3:return[4,(c=new(e.sent().Client)({appName:"SharePoint",appVersion:r._buildNumber,language:this._pageContext.cultureInfo.currentUICultureName,filters:s,localStorageProvider:r._spFloodgate.getStorageProvider()})).start()];case 4:return e.sent(),a.ecsClient=c,c.telemetryEvents.subscribe(function(e,t){n._TraceLogger.logVerbose(r._logSource,"Dynamic Campaign Telemetry event '".concat(e,"' with details: ").concat(t))}),a.enabled=!0,i.enabled=!0,o.writeSuccess(),[3,6];case 5:return d=e.sent(),o.writeUnexpectedFailure("FailedToStartOrSubscribe",d),n._TraceLogger.logError(r._logSource,d),[3,6];case 6:return r._spFloodgate.initOptions={onSurveyActivatedCallback:this,onDismiss:r._handleDismiss,dynamicCampaignConfig:a,dynamicUxConfig:i,governanceServiceEnabled:!0},[4,r._getOCPSPolicies(this._serviceScope).then(function(e){r._spFloodgate.initOptions.surveyEnabled=e.policyAllowSurvey,r._spFloodgate.initOptions.showEmailAddress=e.policyAllowContact}).catch(function(e){r._floodgateLogError("_initializeFloodgate",!1,e)})];case 7:e.sent(),r._setFloodgateWindowEvents(),r._initializeStartFloodgateAsync().then(function(){r._isFloodgateInitialized=!0}),e.label=8;case 8:return[2]}})})},r.prototype._handleKeyDown=function(e){if(e.altKey&&e.which===i.KeyCodes.pageDown){var t=document.getElementById("obf-TPromptContainer")||void 0;t?this._a11yService.a11yManager.focusTo(t):r._floodgateLogError("toastContainerNotFound",!1)}},Object.defineProperty(r.prototype,"_pageEnvironment",{get:function(){var e=this._pageContext;switch((e.legacyPageContext&&e.legacyPageContext.env||"").toLowerCase()){case F.EDOG:case F.PROD_BUBBLE:return"Dogfood";default:return"Production"}},enumerable:!1,configurable:!0}),r.prototype._getFeedbackOptions=function(){return(0,e.__awaiter)(this,void 0,void 0,function(){var t,n=this;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return this._feedbackOptions?[3,2]:(t=this,[4,g.e(706).then(g.bind(g,1309)).then(function(e){return e.getFeedbackOptions(n._pageContext,n._serviceScope)})]);case 1:t._feedbackOptions=e.sent(),e.label=2;case 2:return[2,this._feedbackOptions]}})})},r.feedbackServiceName="sp-feedback:SPFeedback",r._defaultFeedbackPolicy={policyAllowFeedback:!0,policyAllowSurvey:!0,policyAllowScreenshot:!1,policyAllowContact:!1,policyAllowContent:!1},r._flightsForTelemetryGroup=new Set,r._logSource=n._LogSource.create(R),r._isFeedbackInitialized=!1,r._isFloodgateInitialized=!1,r._handleFlightsForOfficeFeedback=function(e){var t=e;if(t&&t.detail&&t.detail.flights){var n=!1,a=function(e){var t,a=e.split("_"),i=2===a.length?a[1]:void 0;void 0!==i&&(t="0"===i?"1":"0",t=a[0]+"_"+t),t&&r._flightsForTelemetryGroup.has(t)&&(r._flightsForTelemetryGroup.delete(t),n=!0)};if("string"==typeof t.detail.flights){var i=t.detail.flights;a(i),r._flightsForTelemetryGroup.has(i)||(r._flightsForTelemetryGroup.add(i),n=!0)}else t.detail.flights.forEach(function(e){a(e),r._flightsForTelemetryGroup.has(e)||(r._flightsForTelemetryGroup.add(e),n=!0)});n&&r._isFloodgateInitialized&&(r._isFloodgateInitialized=!1,r._stopFloodgate(),r._spFeedback.initOptions.telemetryGroup.flights=Array.from(r._flightsForTelemetryGroup).join(","),r._startFloodgateAsync().then(function(){r._isFloodgateInitialized=!0}))}},r}(),z=t.ServiceKey.create(V.feedbackServiceName,V)})(),y})())})();