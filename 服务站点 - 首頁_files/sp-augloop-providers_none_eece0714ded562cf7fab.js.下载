define("2c950d8f-3a0f-45af-9963-41b17249c30b_0.1.0",["tslib","@microsoft/sp-diagnostics","@microsoft/sp-core-library"],(e,t,n)=>(()=>{"use strict";var a={676:e=>{e.exports=n},207:e=>{e.exports=t},280:t=>{t.exports=e}},i={};function r(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={exports:{}};return a[e](n,n.exports,r),n.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return(()=>{r.r(o),r.d(o,{HubbleStockImageProvider:()=>_,KeyPhrasesProvider:()=>h,RankInfo:()=>v,RankRewardSuggestionsProvider:()=>g,TranslateContentProvider:()=>b});var e,t,n,a,i,s,c=r(280);!function(e){e.Attribution="Attribution",e.ContentSource="ContentSource",e.ContentTier="ContentTier",e.ContentType="ContentType",e.Description="Description",e.PivotNames="PivotNames",e.ForeignID="ForeignID",e.Id="Id",e.IsNew="IsNew",e.LicenseLink="LicenseLink",e.OriginId="OriginId",e.PivotId="PivotId",e.SearchScore="SearchScore",e.Thumbnail="Thumbnail",e.Keywords="Keywords"}(e||(e={})),function(e){e.Image="Image",e.SVG="SVG",e.SmallThumbnail="SmallThumbnail",e.MediumThumbnail="MediumThumbnail",e.LargeThumbnail="LargeThumbnail",e.XLargeThumbnail="XLargeThumbnail",e.XXLargeThumbnail="XXLargeThumbnail"}(t||(t={})),function(e){e.LoopingVideos="32318599-a475-448c-a583-7aadf5e41c8c",e.Icons="f9a6197b-243d-4381-ad7d-43250cb11014",e.Illustrations="5c594da3-1700-4c4e-824b-dbefe528f53b",e.CartoonPeople="71309e27-d6ab-4fa5-865c-60d4e6d863b3",e.Images="f8218404-63dd-4670-b0f5-f8b50674f963",e.AiGeneratedImages="60f8b9be-536b-4a0f-9552-f3321c243f86",e.CutoutPeople="42fea961-805e-4900-a0f5-7288c55d7780",e.Stickers="0678df82-d05e-475d-9c04-5daa1f5c6d55",e.Emojis="84e04d41-3574-4764-a2d3-c24ae80c75eb",e.Audios="72b42841-c22c-44fd-9ac3-964371503269"}(n||(n={})),function(e){e.Icon="Icon",e.Image="Image",e.Video="Video",e.Audio="Audio"}(a||(a={})),function(e){e.My="My",e.Stock="Stock",e.Enterprise="Enterprise",e.External="External"}(i||(i={})),function(e){e.Bing="Bing",e.Getty="Getty",e.GettyVideo="GettyVideo",e.Giphy="Giphy",e.GooglePhotos="GooglePhotos",e.Hubble="Hubble",e.OneDrivePhotos="OneDrivePhotos",e.Shutterstock="Shutterstock",e.Storyblocks="Storyblocks",e.TAS="TAS",e.Tenor="Tenor",e.Unknown="Unknown"}(s||(s={}));var d,l=r(207),u=r(676);function f(){return u._SPKillSwitch.isActivated("0e9f5a95-9c99-4a3b-a9d1-4f689cf06d1b")}function p(){return u._SPKillSwitch.isActivated("b9dd7407-391f-4520-a294-e9f0a094cfb0")}var m=((d={})[t.SmallThumbnail]="small",d[t.MediumThumbnail]="medium",d[t.LargeThumbnail]="large",d[t.XLargeThumbnail]="xLarge",d[t.XXLargeThumbnail]="xxLarge",d),_=function(){function n(e){this._logSource=l._LogSource.create("HubbleStockImageProvider"),this._qosMonitor=new l._QosMonitor("HubbleStockImageProvider"),this._alProxy=e}return n.prototype.getHubbleStockImages=function(e,t,n,a,i){return void 0===a&&(a=!1),(0,c.__awaiter)(this,void 0,void 0,function(){return(0,c.__generator)(this,function(r){if(!this._alProxy)return l._TraceLogger.logVerbose(this._logSource,"AL proxy is not available","getHubbleStockImages"),[2,void 0];try{return u._SPKillSwitch.isActivated("0ea66954-02fd-42fe-9cc9-d3a1d7848f82")?[2,this._getHubbleStockImagesWithoutTimeout(e,t,n,a)]:[2,this._getHubbleStockImagesWithTimeout(e,t,n,a,i)]}catch(e){return this._qosMonitor.writeUnexpectedFailure("HubbleStockImageFailed",e),[2,void 0]}return[2]})})},n.prototype._getHubbleStockImagesWithoutTimeout=function(e,t,n,a){var i,r=this;return null===(i=this._alProxy)||void 0===i?void 0:i.findProviderContentAnnotationImages(e,void 0,t,n).then(function(e){if(r._qosMonitor.writeSuccess(),e){var t=e.data.Result.PartGroups;return r._parseImages(t,a)}})},n.prototype._getHubbleStockImagesWithTimeout=function(e,t,n,a,r){var o,s,c=this,d=p()?3e4:1e4,l=new Promise(function(e){s=setTimeout(function(){c._qosMonitor.writeExpectedFailure("Timeout",void 0),e(void 0)},d)});return Promise.race([l,null===(o=this._alProxy)||void 0===o?void 0:o.findProviderContentAnnotationImages(e,void 0,t,n,r?i.External:i.Stock)]).then(function(e){if(e){if(u._SPKillSwitch.isActivated("5f34b48a-b271-4a63-aa40-3db5cf11dc9f")||clearTimeout(s),"Success"===(null==e?void 0:e.data.Status)){c._qosMonitor.writeSuccess();var t=e.data.Result.PartGroups;return c._parseImages(t,a)}throw new Error(null==e?void 0:e.data.Error)}})},n.prototype._parseImages=function(n,a){var i=[];return n.forEach(function(n){var r,o,s,c,d,l,u;a&&(u={},f()?u={small:{height:n.ImageParts[1].Height,width:n.ImageParts[1].Width,url:n.ImageParts[1].SourceUrl},medium:{height:n.ImageParts[2].Height,width:n.ImageParts[2].Width,url:n.ImageParts[2].SourceUrl},large:{height:n.ImageParts[3].Height,width:n.ImageParts[3].Width,url:n.ImageParts[3].SourceUrl},xLarge:{height:n.ImageParts[4].Height,width:n.ImageParts[4].Width,url:n.ImageParts[4].SourceUrl}}:n.ImageParts.forEach(function(e){e.ImageCategory!==t.Image&&e.ImageCategory!==t.SVG&&u&&(u[m[e.ImageCategory]]={url:e.SourceUrl,width:e.Width,height:e.Height})})),(f()||n.ImageParts.length)&&i.push({url:n.ImageParts[0].SourceUrl,width:n.ImageParts[0].Width,height:n.ImageParts[0].Height,description:null===(o=null===(r=n.TextParts)||void 0===r?void 0:r.find(function(t){return t.TextCategory===e.Description}))||void 0===o?void 0:o.Text,previewThumbnails:u,id:null===(c=null===(s=n.TextParts)||void 0===s?void 0:s.find(function(t){return t.TextCategory===e.Id}))||void 0===c?void 0:c.Text,contentProvider:null===(l=null===(d=n.TextParts)||void 0===d?void 0:d.find(function(e){return"ContentProvider"===e.TextCategory}))||void 0===l?void 0:l.Text})}),i},n}(),h=function(){function e(e){this._logSource=l._LogSource.create("KeyPhrasesProvider"),this._qosMonitor=new l._QosMonitor("KeyPhrasesProvider"),this._alProxy=e}return e.prototype.getKeyPhrases=function(e,t){return(0,c.__awaiter)(this,void 0,void 0,function(){return(0,c.__generator)(this,function(n){if(!this._alProxy)return l._TraceLogger.logVerbose(this._logSource,"AL proxy is not available","getKeyPhrases"),[2,void 0];try{return u._SPKillSwitch.isActivated("16c2e9a6-7224-4ee0-8cd1-5a118aa5a3a5")?[2,this._getKeyPhrasesWithoutTimeout(e,t)]:[2,this._getKeyPhrasesWithTimeout(e,t)]}catch(e){return this._qosMonitor.writeUnexpectedFailure("KeyPhrasesProviderFailed",e),[2,void 0]}return[2]})})},e.prototype._getKeyPhrasesWithTimeout=function(e,t){var n,a=this,i=p()?3e4:1e4,r=new Promise(function(e){setTimeout(function(){a._qosMonitor.writeExpectedFailure("Timeout",void 0),e(void 0)},i)});return Promise.race([r,null===(n=this._alProxy)||void 0===n?void 0:n.getKeyPhrases(e,t)]).then(function(e){if(e){if(e)return a._qosMonitor.writeSuccess(),e.keyPhrases;throw new Error("Response undefined")}})},e.prototype._getKeyPhrasesWithoutTimeout=function(e,t){var n,a=this;return null===(n=this._alProxy)||void 0===n?void 0:n.getKeyPhrases(e,t).then(function(e){return a._qosMonitor.writeSuccess(),e?e.keyPhrases:void 0})},e}(),b=function(){function e(e){this._logSource=l._LogSource.create("TranslateContentProvider"),this._qosMonitor=new l._QosMonitor("TranslateContentProvider"),this._alProxy=e}return e.prototype.getTranslatedContent=function(e,t,n){return(0,c.__awaiter)(this,void 0,void 0,function(){var a=this;return(0,c.__generator)(this,function(i){if(!this._alProxy)return l._TraceLogger.logVerbose(this._logSource,"AL proxy is not available","getTranslatedContent"),[2,void 0];try{return[2,this._alProxy.translateContent(e,t,n).then(function(e){var t;return a._qosMonitor.writeSuccess(),e?null===(t=e.translatedContent)||void 0===t?void 0:t.TranslatedText:void 0})]}catch(e){return this._qosMonitor.writeUnexpectedFailure("TranslateContentProviderFailed",e),[2,void 0]}return[2]})})},e}(),g=function(){function e(e){this._logSource=l._LogSource.create("RankRewardSuggestionsProvider"),this._alProxy=e}return e.prototype.rank=function(e){return(0,c.__awaiter)(this,void 0,void 0,function(){var t;return(0,c.__generator)(this,function(n){if(!this._alProxy)return l._TraceLogger.logVerbose(this._logSource,"AL proxy is not available","getRankSuggestions"),[2,void 0];t=new l._QosMonitor("RankSuggestions");try{return[2,this._alProxy.rankSuggestions(e).then(function(e){return e.error?void t.writeExpectedFailure("RankSuggestionsWorkflowFailed",{name:"RankSuggestionsWorkFlowError",message:e.error}):(t.writeSuccess(),{eventId:e.eventId,recommendationId:e.probableAction})}).catch(function(e){t.writeUnexpectedFailure("RankSuggestionsWorkflowFailed",e)})]}catch(e){t.writeUnexpectedFailure("RankSuggestionsAlProxyFailed",e)}return[2]})})},e.prototype.reward=function(e){return(0,c.__awaiter)(this,void 0,void 0,function(){var t;return(0,c.__generator)(this,function(n){if(!this._alProxy)return l._TraceLogger.logVerbose(this._logSource,"AL proxy is not available","getRewardSuggestions"),[2,void 0];t=new l._QosMonitor("RewardSuggestion");try{return[2,this._alProxy.rewardSuggestion(e).then(function(e){e.error?t.writeExpectedFailure("RewardSuggestionWorkflowFailed",{name:"RewardSuggestionWorkFlowError",message:e.error}):t.writeSuccess()}).catch(function(e){t.writeUnexpectedFailure("RewardSuggestionWorkflowFailed",e)})]}catch(e){t.writeUnexpectedFailure("RewardSuggestionAlProxyFailed",e)}return[2]})})},e}(),v=function(e,t){this.recommendationId=e,this.eventId=t}})(),o})());