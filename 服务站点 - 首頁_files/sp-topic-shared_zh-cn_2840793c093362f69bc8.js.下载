(()=>{var e=document.currentScript;define("49d290fb-a38e-4001-97d3-a2db486db2fa_0.1.0",["tslib","@microsoft/sp-diagnostics","@microsoft/sp-core-library","@microsoft/sp-page-context","@microsoft/sp-http","@ms/sp-topic-sdk","@ms/odsp-utilities-bundle","@microsoft/sp-lodash-subset","@ms/sp-component-utilities","@microsoft/sp-loader","@ms/odsp-core-bundle","react","react-dom","@ms/sp-telemetry","@microsoft/sp-webpart-base","@microsoft/sp-component-base","@ms/office-ui-fabric-react-bundle","@microsoft/load-themed-styles","@ms/sp-fluentui-migration-reactdom-render-bundle","@ms/sp-fluentui-migration-button-bundle","@ms/sp-fluentui-migration-stack-bundle","@ms/sp-fluentui-migration-link-bundle"],(t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D)=>(()=>{"use strict";var I,x,C,O={5201:(e,t,n)=>{n.d(t,{xd:()=>r,zw:()=>i});var a=n(9676);function i(){return a._SPKillSwitch.isActivated("03fe1e3a-35a4-4d30-9d7d-eba1b4537dbb")}function r(){return a._SPKillSwitch.isActivated("59ff883c-6d48-4c2c-b79c-6c005b458221")}}
,3372:(e,t,n)=>{n.d(t,{p:()=>a});var a=function(){function e(){}return e.titleRegion="1.4",e.definition="1.3.0",e.people="1.1.0",e.resource="1.5.0",e.sites="1.1",e.graph="1.3",e.disambiguation="1.0",e.faqs="1.0",e.impactMetrics="1.0",e}()}
,4749:(e,t,n)=>{n.d(t,{OC:()=>l,OP:()=>d,cw:()=>o,dy:()=>s,nX:()=>c});var a=n(9676),i=n(9773),r=n(7270);function o(e,t,n,o){a.Validate.isNotNullOrUndefined(e,"serviceScope"),a.Validate.isNotNullOrUndefined(o,"newRelation");var s=e.consume(i.EntityRelationsService.serviceKey)[i.RelationsContainerKey].relations;s[t]||(s[t]={}),o.forEach(function(e){(0,r.s)(e.curationDetails)||delete e.curationDetails}),s[t][n]=o}function s(e,t){a.Validate.isNotNullOrUndefined(e,"serviceScope"),a.Validate.isNotNullOrUndefined(t,"badge"),e.consume(i.EntityRelationsService.serviceKey).relationsContainer.badges=[t]}function c(e){a.Validate.isNotNullOrUndefined(e,"serviceScope"),e.consume(i.EntityRelationsService.serviceKey).relationsContainer.badges=[]}function d(e){a.Validate.isNotNullOrUndefined(e,"serviceScope");var t=e.consume(i.EntityRelationsService.serviceKey);t.relationsContainer.relations={},t.relationsContainer.badges=[]}function l(e,t,n){return{author:{email:e,name:t,upn:n},time:(new Date).toISOString()}}}
,3304:(e,t,n)=>{n.d(t,{U:()=>p});var a=n(9676),i=n(9773),r=n(4749),o=n(3025),s=n(3372),c=n(7199);const d=JSON.parse('{"tX":"标题区","e3":"标题区域说明","hN":"摘要","jC":"人员","VZ":"文件和页面","Gb":"相关网站","WM":"图形","IT":"对话","nx":"问题和答案","u3":"来自社区的问题","f8":"主题","Ux":"与当前主题相关的人员。","Z2":"与当前主题相关的文档。","xV":"与当前主题相关的主题。","G7":"与当前主题相关的网站。","_h":"Viva Engage与当前主题相关的对话。"}');var l,u=n(5931),f=n(1278);!function(e){e[e.YammerTopic=745]="YammerTopic",e[e.SupportExternalResources=60695]="SupportExternalResources",e[e.AllowUnlicensedUsers=61280]="AllowUnlicensedUsers"}(l||(l={}));var p=function(){function e(){}return e.getLayoutWebPartIds=function(t,n){return[{webPartId:e.TITLE_REGION_WP_ID},{webPartId:e.DEFINITION_WP_ID},{webPartId:e.IMPACT_METRIC_WP_ID,disabled:!(0,u.$C)(t)},{webPartId:e.RELATED_PEOPLE_WP_ID},{webPartId:e.FAQS_WP_ID,disabled:!(0,u.ez)(t)},{webPartId:e.RELATED_DOCS_WP_ID},{webPartId:e.RELATED_SITES_WP_ID},{webPartId:e.GRAPH_WP_ID,disabled:!(0,f.X$)()&&e._isFlightEnabled(l.AllowUnlicensedUsers)&&!n},{webPartId:e.YAMMER_WP_ID,disabled:!e._isFlightEnabled(l.YammerTopic)}].filter(function(e){return!e.disabled}).map(function(e){return e.webPartId})},e.getLayoutTemplate=function(t,n){a.Validate.isNotNullOrUndefined(t,"topic"),a.Validate.isNotNullOrUndefined(t.Id,"topicId"),a.Validate.isNotNullOrUndefined(t.Name,"topicName");var r=[];return e.getLayoutWebPartIds(n.legacyPageContext,(0,i.isCortexEnabled)(n)).forEach(function(a){switch(a){case e.TITLE_REGION_WP_ID:r.push({id:e.TITLE_REGION_WP_ID,title:d.tX,dataVersion:s.p.titleRegion,instanceId:e.TITLE_REGION_WP_ID,description:d.e3,serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},properties:{imageSourceType:i.ImageSourceType.none,title:t.Name,textAlignment:"Left",showPublishDate:!1,authors:void 0,showTopicHeader:!0,authorByline:void 0,layoutType:"TopicPage",topicId:t.Id,topicName:t.Name,topicHeader:d.f8,preventTitleOverwrite:!0,hasTitleBeenCommitted:(0,c.cI)()}});break;case e.DEFINITION_WP_ID:var o=[];r.push({id:e.DEFINITION_WP_ID,instanceId:e.OVERVIEW_RTE_INSTANCE_ID,title:d.hN,description:d.hN,dataVersion:s.p.definition,properties:{content:t.Definition,title:d.hN,topicName:t.Name,curated:o,removed:o,confirmedTopicTypes:e._getTopicTypesInfo(t.Types,n)}});break;case e.RELATED_PEOPLE_WP_ID:r.push({id:e.RELATED_PEOPLE_WP_ID,instanceId:e.RELATED_PEOPLE_WP_ID,title:d.jC,description:d.Ux,dataVersion:s.p.people,properties:{title:d.jC,topicName:t.Name,curated:e._defaultCurated(t,n),removed:[]}});break;case e.FAQS_WP_ID:r.push({id:e.FAQS_WP_ID,instanceId:e.FAQS_WP_ID,title:"",description:"",dataVersion:s.p.faqs,properties:{}});break;case e.IMPACT_METRIC_WP_ID:r.push({id:e.IMPACT_METRIC_WP_ID,instanceId:e.IMPACT_METRIC_WP_ID,title:"",description:"",dataVersion:s.p.impactMetrics,properties:{}});break;case e.RELATED_DOCS_WP_ID:r.push({id:e.RELATED_DOCS_WP_ID,instanceId:e.RELATED_DOCS_WP_ID,title:d.VZ,description:d.Z2,dataVersion:e._isFlightEnabled(l.SupportExternalResources)?s.p.resource:"1.4.0",properties:{title:d.VZ,topicName:t.Name,curated:[]}});break;case e.RELATED_SITES_WP_ID:r.push({id:e.RELATED_SITES_WP_ID,instanceId:e.RELATED_SITES_WP_ID,title:d.Gb,description:d.G7,dataVersion:s.p.sites,properties:{curated:[],removed:[]}});break;case e.GRAPH_WP_ID:r.push({id:e.GRAPH_WP_ID,instanceId:e.GRAPH_WP_ID,title:d.WM,description:d.xV,dataVersion:s.p.graph,properties:{isOnTopicPage:!0,title:d.WM,topicName:t.Name,titleFontWeightBold:!0,curated:[]}});break;case e.YAMMER_WP_ID:r.push({id:e.YAMMER_WP_ID,instanceId:e._YAMMER_QUESTIONSANDANSWERS_WP_INSTANCE_ID,title:d.IT,description:d._h,dataVersion:"1.0",properties:{isOnTopicPage:!0,title:(0,u.ez)(n.legacyPageContext)||(0,u.Jr)()?d.u3:d.nx,type:"Topic",legacyId:t.Id,feedSubtype:"QUESTIONS",threadCount:3,showHighlights:!0,templateType:"Cortex"}},{id:e.YAMMER_WP_ID,instanceId:e._YAMMER_CONVERSATIONS_WP_INSTANCE_ID,title:d.IT,description:d._h,dataVersion:"1.0",properties:{isOnTopicPage:!0,title:d.IT,type:"Topic",legacyId:t.Id,feedSubtype:"ALL",threadCount:3,showHighlights:!0,templateType:"Cortex"}})}}),r},e.getAnchorIdForWebPart=function(e){var t;return(t={},t[this.RELATED_DOCS_WP_ID]=o.yF,t[this.RELATED_PEOPLE_WP_ID]=o.iL,t[this.GRAPH_WP_ID]=o.um,t[this.RELATED_SITES_WP_ID]=o.r6,t[this.IMPACT_METRIC_WP_ID]=o.HX,t)[e]},e.getTitleRegionData=function(t,n){return e.getLayoutTemplate(t,n).filter(function(t){return t.id===e.TITLE_REGION_WP_ID})[0]},e._defaultCurated=function(e,t){if(e.Id===i.NULL_TOPIC_ENTITY.Id){var n=t.user,a=n.displayName,o=n.email,s=n.loginName;return[{id:o,name:a,email:o,upn:s,curationDetails:(0,r.OC)(o,a,s)}]}return[]},e._getTopicTypesInfo=function(e,t){var n=t.user,a=n.displayName,i=n.email,o=n.loginName;return e?e.map(function(e){return{Id:e.Id,DisplayName:e.DisplayName,Type:"TopicType",curationDetails:(0,r.OC)(i,a,o)}}):[]},e._isFlightEnabled=function(e){return a._SPFlight.isEnabled(e)},e.TITLE_REGION_WP_ID="cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",e.RELATED_DOCS_WP_ID="9346e298-66c6-4122-853c-a1eef08b5827",e.RELATED_PEOPLE_WP_ID="29991a50-6f14-42e0-9536-aef85d91b05c",e.LOCKED_RTE_WP_ID="09fc0123-851e-4fd3-bdd6-6e2e31cb1ef7",e.DEFINITION_WP_ID="e9ee7242-273c-473f-bfa5-149b32873501",e.GRAPH_WP_ID="81ce1eba-74ad-4f0d-a692-2133b98bc308",e.YAMMER_WP_ID="cb3bfe97-a47f-47ca-bffb-bb9a5ff83d75",e.RELATED_SITES_WP_ID="8670c27e-8fb2-46a9-a4fe-ea4515d2d9e1",e.FAQS_WP_ID="c12e69f3-404a-4ae7-b11a-bfd1175a7b00",e.IMPACT_METRIC_WP_ID="e3b2b12f-4fae-4c51-b593-dce186c7b7b5",e.OVERVIEW_RTE_INSTANCE_ID="7aca70c6-02bc-4b46-a27e-093e34a7a4dc",e._YAMMER_CONVERSATIONS_WP_INSTANCE_ID="6f5b4c2a-5f50-4e2b-a7be-3e78496c0bd2",e._YAMMER_QUESTIONSANDANSWERS_WP_INSTANCE_ID="46747584-1075-4555-92d9-dc0dd04af129",e}()}
,7199:(e,t,n)=>{n.d(t,{m6:()=>w,bI:()=>v,cb:()=>O,d6:()=>k,hp:()=>L,H2:()=>A,V2:()=>M,uH:()=>E,Er:()=>I,eD:()=>C,Bv:()=>x,cI:()=>D,Eo:()=>P,q3:()=>y});var a=n(280),i=n(9676),r=n(7408),o=n(2207),s=n(9939),c=n(9773),d=function(e){function t(n,a,i){var r=e.call(this,"Page Service error with code: ".concat(n,". ").concat(a?a.message:"").concat(i||""))||this;return r.__proto__=t.prototype,r._code=n,r.stack=a&&a.stack,r}return(0,a.__extends)(t,e),Object.defineProperty(t.prototype,"code",{get:function(){return this._code},enumerable:!1,configurable:!0}),t}(Error),l=n(5201),u=function(){function e(){var e=this;this.enqueueClientFormSavePromise=function(t,n){return e._serviceProvider.enqueueClientFormSavePromise(t,n)}}return e._filterHiddenFields=function(e){return e.fields=e.fields.filter(function(e){return!e.schema||!e.schema.Hidden||!0!==e.schema.Hidden}),e},Object.defineProperty(e.prototype,"isInitialized",{get:function(){return!!this._serviceProvider},enumerable:!1,configurable:!0}),e.prototype.initialize=function(e){this._serviceProvider=e},e.prototype.getCurrentItem=function(){return this._serviceProvider.getCurrentItem().then(function(t){return e._filterHiddenFields(t)})},e.prototype.updateCurrentItem=function(t){return void 0===t&&(t=!1),this._serviceProvider.updateCurrentItem(t).then(function(t){return e._filterHiddenFields(t)})},e.prototype.openPageSettingsPanel=function(){return this._serviceProvider.openPageSettingsPanel()},e.prototype.getChromeOptions=function(){return this._serviceProvider.getChromeOptions()},e.prototype.getPagePublishInfo=function(){return this._serviceProvider.getPagePublishInfo()},e.prototype.getPageBasicInfo=function(){return this._serviceProvider.getPageBasicInfo()},e.prototype.getPageMultilingualInfo=function(){return this._serviceProvider.getPageMultilingualInfo()},e.prototype.getWebPartsPageSettings=function(){var e;return(null===(e=this._serviceProvider)||void 0===e?void 0:e.getWebPartsPageSettings())||{isTitleHeadingLevelsEnabled:!1}},e.prototype.subscribe=function(e,t,n){return this._serviceProvider.subscribe(e,t,n),Promise.resolve()},e.prototype.unsubscribe=function(e,t,n){return this._serviceProvider.unsubscribe(e,t,n),Promise.resolve()},e.prototype.getAutoSaver=function(){return this._serviceProvider.getAutoSaver()},e.prototype.getClientFormProvider=function(){return this._serviceProvider.getClientFormProvider()},e.prototype.getItemUpdateQueue=function(){return Promise.resolve(this._serviceProvider.getItemUpdateQueue())},e.prototype.invalidatePageNavigationCache=function(){return Promise.resolve(this._serviceProvider.invalidatePageNavigationCache())},e.prototype.generateTranspileContent=function(e,t,n){return Promise.resolve(this._serviceProvider.generateTranspileContent(e,t,n))},e.prototype.saveStreams=function(e,t,n){return Promise.resolve(this._serviceProvider.saveStreams(e,t,n))},e.serviceKey=i.ServiceKey.create("sp-component-utilities:PageService",e),e.logSource=o._LogSource.create("PageService"),(0,a.__decorate)([f],e.prototype,"getCurrentItem",null),(0,a.__decorate)([f],e.prototype,"updateCurrentItem",null),(0,a.__decorate)([f],e.prototype,"openPageSettingsPanel",null),(0,a.__decorate)([f],e.prototype,"getChromeOptions",null),(0,a.__decorate)([f],e.prototype,"getPagePublishInfo",null),(0,a.__decorate)([f],e.prototype,"subscribe",null),(0,a.__decorate)([f],e.prototype,"unsubscribe",null),(0,a.__decorate)([f],e.prototype,"getAutoSaver",null),(0,a.__decorate)([f],e.prototype,"getClientFormProvider",null),(0,a.__decorate)([f],e.prototype,"getItemUpdateQueue",null),(0,a.__decorate)([f],e.prototype,"invalidatePageNavigationCache",null),(0,a.__decorate)([f],e.prototype,"generateTranspileContent",null),(0,a.__decorate)([f],e.prototype,"saveStreams",null),e}();function f(e,t,n){var a=function(e){return e=e||new d(1),o._TraceLogger.logError(u.logSource,e),Promise.reject(e)};return{value:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._serviceProvider?n.value.apply(this,e):a()}}}var p=i.RootServiceKey.create("sp-component-utilities:PageService",u),m=n(3025),_=n(7206),h=n(7426),b=n(4867),g=n(3785);function v(e,t,n,a,r){i.Validate.isNotNullOrUndefined(e,"name"),i.Validate.isNotNullOrUndefined(t,"id"),i.Validate.isNotNullOrUndefined(n,"pageContext"),i.Validate.isNotNullOrUndefined(a,"linkSource");var o=(0,h.A)(n),s="".concat(o,"/_layouts/15/TopicPagePreview.aspx?topicId=")+"".concat(t,"&topicName=").concat(encodeURIComponent(e));return r&&(s+="&".concat(m.rd.Language,"=").concat(r)),(0,_.A)(s,a)}function y(e){i.Validate.isNotNullOrUndefined(e,"url"),window.open(e,"_blank")}function S(e){var t=new URL(e||window.location.href).pathname.toLowerCase();return t.substring(t.lastIndexOf("/")+1)}function D(e){return(0,c.isLayoutsPage)(e)&&S(e).toLowerCase()===m.Oy.topicPagePreviewStubFileName.toLowerCase()}function I(){return(0,c.isLayoutsPage)()&&S().toLowerCase()===m.Oy.createTopicPageStubFileName.toLowerCase()}function x(){return S().toLowerCase()===m.Oy.newPageStubFileName.toLowerCase()||I()}function C(){return-1!==new URL(window.location.href).pathname.toLowerCase().indexOf(m.Oy.disambiguationPageStubFileName)}function O(e){return"".concat((0,h.A)(e),"/").concat(c.LAYOUTS_PAGE_PREFIX).concat(m.Oy.createTopicPageStubFileName,"?Mode=Edit&isNewTopicPage=true")}var w=new Set(["doc","docx","one","ppt","pptx","xls","xlsx"]);function E(e){var t=((null==e?void 0:e.split(".").pop())||"").toLowerCase();if(e&&"msg"===t){var n=A(e),a=n.substring(0,n.lastIndexOf("/")),i=e.substring(0,e.lastIndexOf("/"));return"".concat(i,"?id=").concat(n,"&parent=").concat(a)}return e}function A(e){return new URL(e).pathname}function L(e,t){var n=new o._QosMonitor(t),a=e.consume((0,l.xd)()?u.serviceKey:p),i=e.consume(r.PageContext.serviceKey);return(null==i?void 0:i.list)?a.getCurrentItem().then(function(e){var t,a,i=null===(a=null===(t=null==e?void 0:e.item)||void 0===t?void 0:t.properties)||void 0===a?void 0:a.uniqueId;return i?n.writeSuccess():n.writeUnexpectedFailure("getUndefinedPageUniqueId"),i}).catch(function(e){n.writeUnexpectedFailure("getPageUniqueIdFailed",e)}):Promise.resolve(void 0)}function k(e){var t=e.topicName,n=e.topicId,i=e.source,r=e.buildNumber,o=e.feedbackEmail,c=e.pageContext,d=e.mailSubject,l=e.mailBody,u=e.extraDebugStrings,f=encodeURIComponent(s.StringHelper.format(b.k$,t)),p="".concat(b.ur).concat(i),m="".concat(b.Vo).concat(n),_="".concat(b.iE).concat(t),h="".concat(b.jx,"buildNumber=").concat(r),g="".concat(b.n).concat(window.navigator.userAgent),v="".concat(b.U$).concat(c.legacyPageContext.currentLanguage),y=(0,a.__spreadArray)((0,a.__spreadArray)((0,a.__spreadArray)([p,m],(0,a.__read)(d?[_]:[]),!1),[h,g,v],!1),(0,a.__read)(u||[]),!1).join("\n"),S=encodeURIComponent("".concat(null!=l?l:b.q6,"\n\n\n").concat(b.Ts,"\n").concat(y));return"mailto:".concat(o,"?subject=").concat(null!=d?d:f,"&body=").concat(S)}var M=function(e,t){return(0,a.__awaiter)(void 0,void 0,void 0,function(){var n,i,r,o,s,c,d,l,u;return(0,a.__generator)(this,function(f){switch(f.label){case 0:n=[],f.label=1;case 1:f.trys.push([1,6,7,8]),i=(0,a.__values)(e),r=i.next(),f.label=2;case 2:return r.done?[3,5]:(o=r.value,c=(s=n).push,[4,t(o)]);case 3:c.apply(s,[f.sent()]),f.label=4;case 4:return r=i.next(),[3,2];case 5:return[3,8];case 6:return d=f.sent(),l={error:d},[3,8];case 7:try{r&&!r.done&&(u=i.return)&&u.call(i)}finally{if(l)throw l.error}return[7];case 8:return[2,n]}})})},P=function(e,t,n){return new g.M(e).log(t,{numberOfTopics:n.length,lifecycleStates:Array.from(new Set(n.map(function(e){var t;return e.LifeCycleState||(null===(t=e.LifeCycle)||void 0===t?void 0:t.State)||""}))).sort().join(",")})}}
,6563:(e,t,n)=>{n.d(t,{M:()=>i});var a=n(280),i=function(e){function t(n){var a=e.call(this,n)||this;return a._isExpected=!1,a.__proto__=t.prototype,a.errorType="AadTokenError",a}return(0,a.__extends)(t,e),Object.defineProperty(t.prototype,"isExpected",{get:function(){return this._isExpected||!1},set:function(e){this._isExpected=e},enumerable:!1,configurable:!0}),t}(Error)}
,3025:(e,t,n)=>{n.d(t,{E3:()=>m,HX:()=>c,Kc:()=>y,Nq:()=>D,Oy:()=>a,P2:()=>v,Pr:()=>p,U_:()=>h,b7:()=>u,bq:()=>b,fb:()=>g,ge:()=>_,h7:()=>l,hf:()=>x,hy:()=>d,iL:()=>i,lO:()=>S,qc:()=>I,r6:()=>s,rd:()=>f,um:()=>o,yF:()=>r});const a=function(){function e(){}return e.topicViewerConfirmedTopicsLogPrefix="CSKIM.TopicViewer.ConfirmedTopics.DP",e.topicViewerUnconfirmedTopicsLogPrefix="CSKIM.TopicViewer.UnconfirmedTopics.DP",e.topicViewerExcludedTopicsLogPrefix="CSKIM.TopicViewer.ExcludedTopics.DP",e.topicPagePreviewStubFileName="TopicPagePreview.aspx",e.createTopicPageStubFileName="CreateTopicPage.aspx",e.newPageStubFileName="newpage.aspx",e.disambiguationPageStubFileName="TopicDisambiguation.aspx",e.topicCacheDuration=864e5,e.kmTopicIdAttribute="data-sp-topic-id",e.kmHashtaggedTopicIdAttribute="data-sp-hashtagged-topic-id",e.kmTopicCardAttribute="data-sp-topic-card",e.kmAnnotateLogPrefix="CSIKM.Annotate",e.kmTopicPickerLogPrefix="CSIKM.TopicPicker",e.kmTopicCenterLogPrefix="CSIKM.TopicCenter",e.kmFeedbackLogPrefix="CSIKM.Feedback",e.kmTopicCardLogPrefix="CSIKM.TopicCard",e.kmTopicPageLogPrefix="CSIKM.TopicPage",e.kmTopicCacheLogPrefix="CSIKM.TopicCache",e.timeZoneStartIndexInDatetime=19,e.pageVersionParam="version",e.pageVersionCompareFromParam="versionCompareFrom",e.pageVersionCompareToParam="versionCompareTo",e.currentTopicLoadedEvent="CurrentTopicLoadedEvent",e.topicMergeStatusUpdateEvent="TopicMergeStatusUpdateEvent",e.gptVersion="gptVersion",e.ascending=1,e.descending=2,e.onAnnotateTitleEventName="onAnnotateTitle_Cortex",e.topicNameChangeEventName="TopicNameChangedEvent_Cortex",e.showTopicPublishTeachingBubbleEventName="ShowTopicPublishTeachingBubble_Cortex",e}();var i="topic_related_people",r="topic_related_resources",o="topic_related_topics",s="topic_related_sites",c="topic_impact_metrics",d="_",l={Curated:"Curated",NotCurated:"NotCurated"},u={MinedDefinition:"MinedDefinition",Definition:"Definition",NoDefinition:"NoDefinition"},f={TopicId:"topicId",TopicName:"topicName",LinkSource:"ls",TopicsCount:"top",SkipCount:"skip",Language:"lang",QnAOptOut:"QnAOptOut",DisableMergeRedirect:"disableMergeRedirect"},p={HashtaggedAnnotation:"HASHTAGGEDANNOTATION",Annotation:"ANNOTATION",TopicCard:"CARD",TopicManagement:"MGMT",GraphWebPart:"GRAPH",MyTopics:"MYTOPICS",DisambiguationContext:"DISAMBIGUATION",AmbiguousTopic:"AMBIGUOUS_TOPIC",DisambiguationLanguage:"DISAMBIGUATION_LANGUAGE",VivaConnections:"VC",UserCentricTopicGraph:"UCTG",TopicsPaneAutoHighlights:"TOPICS_PANE_AUTO_HIGHLIGHTS",TopicsPaneHashtaggedHighlights:"TOPICS_PANE_HASHTAGGED_HIGHLIGHTS"},m=window.innerWidth<640,_=2,h=2,b="Empty response from substrate getTopicById api",g={author:{email:"",name:"",upn:""},time:"",isAddedFromSearch:!1},v="topic-page-privacy-banner-close-button",y=10,S=50,D="unspecified",I="MIXED",x="*"}
,5931:(e,t,n)=>{n.d(t,{$C:()=>g,Az:()=>b,Bd:()=>h,FM:()=>S,Fv:()=>s,Jr:()=>I,Ky:()=>o,Ys:()=>_,ZP:()=>c,_N:()=>p,ez:()=>v,fk:()=>y,hp:()=>x,iY:()=>r,oK:()=>m,sO:()=>l,tL:()=>f,vZ:()=>D,w1:()=>d,yn:()=>u});var a=n(9676),i=n(9305),r={TopicExperienceFeedback:1057,TopicPageGPT:1986,SwitchAPIRequestMethod:60866,ManagedDashboardV2:1335,SourceColumn:60906,SupportProviderTypeOverride:1753,TopicActivities:1926,CopilotCuration:60217};function o(){return a._SPFlight.isEnabled(1442)}function s(){return a._SPFlight.isEnabled(r.SwitchAPIRequestMethod)}function c(){return a._SPFlight.isEnabled(60589)}function d(){return a._SPFlight.isEnabled(r.SupportProviderTypeOverride)}function l(){return a._SPFlight.isEnabled(60621)}function u(){return a._SPFlight.isEnabled(60475)}function f(){return a._SPFlight.isEnabled(60672)}function p(){return a._SPFlight.isEnabled(r.ManagedDashboardV2)}function m(){return a._SPFlight.isEnabled(r.SourceColumn)}function _(){return a._SPFlight.isEnabled(r.CopilotCuration)}function h(){return a._SPFlight.isEnabled(r.TopicActivities)}function b(){return a._SPFlight.isEnabled(1505)}function g(e){return a._SPFlight.isEnabled(61039)||(0,i.isCortexEapUser)(e)&&a._SPFlight.isEnabled(61047)}function v(e){return a._SPFlight.isEnabled(60966)}function y(){return a._SPFlight.isEnabled(1058)}function S(){return a._SPFlight.isEnabled(60819)}function D(){return a._SPFlight.isEnabled(60854)}function I(){return a._SPFlight.isEnabled(60217)}function x(){return a._SPFlight.isEnabled(61278)}}
,1278:(e,t,n)=>{n.d(t,{A3:()=>c,Br:()=>g,EI:()=>f,Hy:()=>r,Kq:()=>i,M2:()=>m,Oe:()=>d,S1:()=>_,U5:()=>o,X$:()=>b,X2:()=>p,dw:()=>u,fx:()=>l,jF:()=>h,kR:()=>s});var a=n(9676);function i(){return a._SPKillSwitch.isActivated("5d59e193-3eba-43ce-bb04-4614661bd72a")}function r(){return a._SPKillSwitch.isActivated("22e79ebf-0921-4f6d-aeda-66e9fa4b81bb")}function o(){return a._SPKillSwitch.isActivated("a445b26c-fc09-42b2-bed9-03f8a9a6e95f")}function s(){return a._SPKillSwitch.isActivated("c023ae48-1012-48c1-ae45-3b971c686502")}function c(){return a._SPKillSwitch.isActivated("5aac75ed-6e15-4ab2-be51-058c09a81215")}function d(){return a._SPKillSwitch.isActivated("9534e3ff-04aa-4200-b1c0-5fe423ea194e")}function l(){return a._SPKillSwitch.isActivated("eab97c5d-c013-41ed-92ff-666d681b1722")}function u(){return a._SPKillSwitch.isActivated("3055acfe-e542-48bd-b875-d979ccb9b3b8")}function f(){return a._SPKillSwitch.isActivated("7c7f5275-ef87-4273-8638-2ba2ac14a477")}function p(){return a._SPKillSwitch.isActivated("d78120c0-739d-4a5e-9fe2-f5911563c426")}function m(){return a._SPKillSwitch.isActivated("7a337ca1-a011-4e5c-9235-1c5583946423")}function _(){return a._SPKillSwitch.isActivated("a7ab661f-bc29-4026-b91d-0df30e80f571")}function h(){return a._SPKillSwitch.isActivated("64de3692-fa20-4cac-bccc-837b767f06d7")}function b(){return a._SPKillSwitch.isActivated("4c26b865-0068-466a-aaa6-275d1de029d4")}function g(){return a._SPKillSwitch.isActivated("971bb732-e242-4228-92a1-41a0ea44f941")}}
,7206:(e,t,n)=>{n.d(t,{A:()=>i});var a=n(3025);function i(e,t){if(!e)return e;var n=new URL(e);return n.searchParams.append(a.rd.LinkSource,t),n.href}}
,4241:(e,t,n)=>{n.d(t,{N:()=>r,p:()=>o});var a=n(280),i=n(3304);function r(e){var t,n,r,o,s,c=JSON.parse(e);try{for(var d=(0,a.__values)(c),l=d.next();!l.done;l=d.next()){var u=l.value;if(u.id===i.U.DEFINITION_WP_ID)return(null===(o=null===(r=u.serverProcessedContent)||void 0===r?void 0:r.searchablePlainTexts)||void 0===o?void 0:o.content)||(null===(s=u.properties)||void 0===s?void 0:s.content)||""}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}return""}function o(e,t,n,a,i,r,o,s){return{Id:n,CurrentLanguage:s,DisplayName:e,State:"Mined, Curated",Url:a,LifeCycle:{State:"Published"},RelatedResourcesMap:[{Key:"People",Value:[{Id:i,Type:"People",State:"Curated",LifeCycle:{State:"Published"},MyFeedbackStatus:"Undetermined",EmailAddress:i,UserPrincipalName:o,DisplayName:r,Curator:{DisplayName:r,EmailAddress:i,UserPrincipalName:o},LastCurator:{DisplayName:r,EmailAddress:i,UserPrincipalName:o}}]}],RelatedEntitiesMap:[],AlternateNames:[],Definition:t,Definitions:[{Value:t,State:"Curated",LifeCycle:{State:"Published"}}]}}}
,9050:(e,t,n)=>{n.d(t,{A:()=>_});var a=n(280),i=n(2207),r=n(9676),o=n(7408),s=n(1909),c=n(5931),d=n(1278),l=n(908),u=n(1725),f=n(9305),p=n(5296),m=n(9939);const _=function(){function e(e,t,n){void 0===t&&(t=!0);var a=this;this._requestId={value:""},this._language=void 0,this._serviceScope=e,this._useSetCortexDisabledFlag=t,this._extraData={},e.whenFinished(function(){a._pageContext=e.consume(o.PageContext.serviceKey),a._tokenDataProvider=new f.TokenDataProvider(a._serviceScope,a._pageContext)}),this._scenario=n}return Object.defineProperty(e.prototype,"_authTokenEndpoint",{get:function(){return f.SUBSTRATE_REQUEST_DOMAIN},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_substrateEndpoint",{get:function(){return"".concat(f.SUBSTRATE_REQUEST_DOMAIN,"/").concat("KnowledgeGraph/api/v1.0","/").concat(this.apiName).concat(this.apiParams)},enumerable:!1,configurable:!0}),e.getRoutingKMAPIKey=function(e){var t=new i._QosMonitor("".concat(l.OY,".getRoutingKMAPIKey"));if(!(0,d.Kq)()){if(e.aadInfo&&e.aadInfo.userId&&e.aadInfo.tenantId)return t.writeSuccess(),"OID:".concat(e.aadInfo.userId,"@").concat(e.aadInfo.tenantId);t.writeUnexpectedFailure("PageContext AadInfo is missing")}return"SMTP:".concat(e.user.email)},Object.defineProperty(e.prototype,"pageContext",{get:function(){return this._pageContext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fetchRetryOptions",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPost",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apiName",{get:function(){return"Topics"},enumerable:!1,configurable:!0}),e.prototype.getCustomRequestOptions=function(e){},Object.defineProperty(e.prototype,"xScenario",{get:function(){return this._scenario},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"qosTag",{get:function(){throw new Error("Needs to be overridden by the derived class")},enumerable:!1,configurable:!0}),e.prototype.getRequest=function(e,t,n){var a=this;void 0===e&&(e=""),void 0===n&&(n=!1);var r="".concat(l.OY,".AuthTokenFetch").concat(this._qosSuffix),o="".concat(l.OY,".").concat(this.qosTag,".").concat(n?"Init":"API",".").concat(l.TI).concat(this._qosSuffix),s="".concat(l.OY,".").concat(this.qosTag,".").concat(l.TI).concat(this._qosSuffix);return this._qosMonitorAuthTokenFetch=new i._QosMonitor(r),this._qosMonitorAuthTokenFetchWithTokenType=new i._QosMonitor("".concat(r)),this._qosMonitorTotal=new i._QosMonitor(s),this._qosMonitorTotalWithTokenType=new i._QosMonitor("".concat(s)),this._aadTokenFetchSucceeded=!1,i._EngagementLogger.logEvent(s),(0,c.w1)()&&(this._providerType=(0,u.at)(l.k0)),this._makeRequest(this._substrateEndpoint,this._authTokenEndpoint,e,function(){a._aadTokenFetchSucceeded=!0,a._qosMonitorAuthTokenFetch.writeSuccess(),a._qosMonitorAuthTokenFetchWithTokenType.writeSuccess(),a._qosMonitorAPI=new i._QosMonitor(o),a._qosMonitorAPIWithTokenType=new i._QosMonitor("".concat(o))}).then(function(e){return p.l.processSubstrateHttpResponse(e,a._requestId,a._qosMonitorAPI,a._qosMonitorAPIWithTokenType,a._qosMonitorTotal,a._qosMonitorTotalWithTokenType,a._useSetCortexDisabledFlag,a._extraData)}).catch(function(e){return p.l.handleSubstrateAPIException(e,a._aadTokenFetchSucceeded,a._qosMonitorAuthTokenFetch,a._qosMonitorAuthTokenFetchWithTokenType,a._qosMonitorAPI,a._qosMonitorAPIWithTokenType,a._qosMonitorTotal,a._qosMonitorTotalWithTokenType,a._extraData)})},Object.defineProperty(e.prototype,"correlationId",{get:function(){return this._requestId.value},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apiParams",{get:function(){var e=new URLSearchParams("");if(this._isDebugUrl){var t=new URL(window.location.href).searchParams.get("pipeline");t&&e.append("pipeline",t)}(0,c.Fv)()&&this.isPost||e.append("provider","Yggdrasil");var n=e.toString();return n?"?".concat(n):""},enumerable:!1,configurable:!0}),e.prototype._getAPI=function(e,t,n,a,i){var r=this,o=function(){return r.isPost?t.post(e+n,s.AadHttpClient.configurations.v1,r._getRequestOptions(a)):t.get(e+n,s.AadHttpClient.configurations.v1,r._getRequestOptions(a))};return i?function(e,t){var n=(0,m.Retry)({callback:e,retries:t.retries,delay:t.retryDelay,canRetry:function(e){return t.logError(e),t.shouldRetryOnError(e)}});return n.then(function(e){t.logResponse(e),t.logFinal("RESOLVED")},function(e){t.logError(e),t.logFinal("CAUGHT")}),n}(o,i):o()},Object.defineProperty(e.prototype,"_shouldRetryAPIFailures",{get:function(){return!!this.fetchRetryOptions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_qosSuffix",{get:function(){return(0,f.isHeartbeatTenant)(this.pageContext)?".Heartbeat":""},enumerable:!1,configurable:!0}),e.prototype._getAPIRetryOptions=function(){var e=this,t=[],n=0,r=0,o=void 0;this._apiRetryQosMonitor=new i._QosMonitor("".concat(l.OY,".").concat(this.qosTag,".Retry").concat(this._qosSuffix)),n=performance.now();var s,c,d,u,f=function(){return{sr:t.length+1,clientReqId:e._extraData.clientRequestId,duration:(a=performance.now(),i=(a-n).toFixed(1),n=a,+i)};var a,i};return(0,a.__assign)((0,a.__assign)({},{retries:void 0===(c=(s=this.fetchRetryOptions).retries)?1:c,retryDelay:void 0===(d=s.retryDelay)?500:d,shouldRetryOnError:void 0===(u=s.shouldRetryOnError)?function(){return!0}:u}),{logResponse:function(e){var n=f();n.httpStatus=e.status,t.push(n),r=e.status},logError:function(e){var n=f();n.error=e.toString(),n.onLine=navigator.onLine,t.push(n),o=e},logFinal:function(n){e._extraData.FinalStatus=n,e._extraData.AttemptsInfo=JSON.stringify(t),e._extraData.TotalRetryAttempts=t.length-1,t.length>1&&("RESOLVED"===n?e._apiRetryQosMonitor.writeExpectedFailure("HTTP ".concat(r.toString()," ").concat(t.length-1),void 0,e._extraData):e._apiRetryQosMonitor.writeUnexpectedFailure("".concat(o.message," ").concat(t.length-1),o,e._extraData))}})},e.prototype._getRequestOptions=function(t){var n;n=(new Date).getTime();var a={},i=r.Guid.newGuid().toString(),o=e.getRoutingKMAPIKey(this.pageContext);a.headers={},a.headers["Content-Type"]="application/json",a.headers["X-AnchorMailbox"]=o,a.headers["X-RoutingParameter-SessionKey"]=o,a.headers["Client-Request-Id"]=i,a.headers["request-id"]=i,(0,u.zk)()&&(a.headers[l.aR]="true"),t&&(a.headers.Authorization="Bearer ".concat(t)),this.xScenario&&(a.headers["X-Scenario"]=this.xScenario),this._language&&(a.headers["X-Accept-Language"]=this._language);var s=new URL(window.location.href).searchParams;return(0,c.hp)()&&s.has(l.rk)&&(a.headers["X-Debug-KnowledgebasePipelineOverride"]=s.get(l.rk)),this.getCustomRequestOptions(a),this._clientRequestId=i,this._extraData.clientRequestId=i,this._extraData.getRequestOptionsTime="".concat((new Date).getTime()-n," ms"),this._extraData.culture=this._language,this._extraData.scenario=this.xScenario,a},e.prototype._makeRequest=function(e,t,n,a){var i=this;return this._tokenDataProvider.getOAuthToken(t).then(function(t){a();var r=i._serviceScope.consume(s.HttpClient.serviceKey),o="string"==typeof t?t:t.token;return i._getAPI(e,r,n,o,i._shouldRetryAPIFailures?i._getAPIRetryOptions():void 0)})},Object.defineProperty(e.prototype,"_isDebugUrl",{get:function(){var e=new URL(window.location.href).searchParams;return r._SPFlight.isDebugFlightEnabled&&"true"===e.get("debug")},enumerable:!1,configurable:!0}),e}()}
,908:(e,t,n)=>{n.d(t,{$t:()=>o,OY:()=>a,RQ:()=>f,TI:()=>i,Z0:()=>d,ZT:()=>s,aR:()=>r,k0:()=>u,rk:()=>l,wK:()=>c});var a="CSIKM.Substrate",i="DP",r="X-SPDF-TestFeedback",o="https://microsoft.sharepoint-df.com/teams/knowledgehub",s="https://microsoft.sharepoint-df.com",c="https://microsoft.sharepoint.com/sites/knowledgecenter",d="feedbackDebugMode",l="kbPipelineIdOverride",u="provider",f=["Turing","YggdrasilAndTuring"]}
,2872:(e,t,n)=>{var a;n.d(t,{A:()=>i,E:()=>a}),function(e){e[e.BadRequest=400]="BadRequest",e[e.Conflict=409]="Conflict",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.NotAcceptable=406]="NotAcceptable",e[e.ServerError=500]="ServerError",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.NotImplemented=501]="NotImplemented",e[e.TooManyRequests=429]="TooManyRequests",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.Unauthorized=401]="Unauthorized"}(a||(a={}));const i=a}
,7669:(e,t,n)=>{n.d(t,{A:()=>i});var a=n(280);const i=function(e){function t(n,a,i,r){void 0===n&&(n="unknown"),void 0===a&&(a=200),void 0===r&&(r=!1);var o=e.call(this,n)||this;return"unknown"===n&&(o.isUnknown=!0),o.__proto__=t.prototype,o.status=a,o.code=i,o.isExpected=r,o.errorType="RestApiError",o}return(0,a.__extends)(t,e),t}(Error)}
,5296:(e,t,n)=>{n.d(t,{R:()=>f,l:()=>p});var a,i=n(2207),r=n(9676),o=n(8216),s=n(5201),c="lastCortexDisableFlagLogged",d=n(7669),l=n(6563),u=n(1278);!function(e){e.Deserialization="DeserializationError",e.Offline="Offline",e.TokenFetch="TokenFetchError",e.CortexDisabled="CortexDisabled",e.GroupMembershipNotAvailable="GroupMembershipNotAvailable",e.GuestUserNotSupported="GuestUserNotSupported"}(a||(a={}));var f={Cancelled:["cancelled","geannuleerd","キャンセルしました","cancelado","отменено","已取消","annullato","annulé"]},p=function(){function e(){}return e.processSubstrateHttpResponse=function(e,t,n,d,l,u,f,p,m){var _=this;if(r.Validate.isNotNullOrUndefined(e,"response"),r.Validate.isNotNullOrUndefined(t,"requestId"),r.Validate.isNotNullOrUndefined(n,"qosMonitorAPI"),r.Validate.isNotNullOrUndefined(l,"qosMonitorTotal"),r.Validate.isNotNullOrUndefined(d,"qosMonitorAPI"),r.Validate.isNotNullOrUndefined(u,"qosMonitorTotal"),r.Validate.isNotNullOrUndefined(f,"useSetCortexDisabledFlag"),f&&function(e){if(!(0,o.X)()&&403===(null==e?void 0:e.status)){var t=new Date((new Date).getTime()+36e5);if(null===sessionStorage||void 0===sessionStorage?void 0:sessionStorage.setItem){sessionStorage.setItem("cortexDisableFlag",t.toISOString());var n="CSIKM.CortexEnabledFlag.Set.True";(0,s.zw)()?i._EngagementLogger.logEvent(n):(a=n,void 0===r&&(r=!0),(null===sessionStorage||void 0===sessionStorage?void 0:sessionStorage.getItem)&&(null!==(d=sessionStorage.getItem(c))&&void 0!==d?d:"")!==a&&(null===sessionStorage||void 0===sessionStorage?void 0:sessionStorage.setItem)&&(r&&i._EngagementLogger.logEvent(a),sessionStorage.setItem(c,a))),!(0,s.zw)()&&(null===sessionStorage||void 0===sessionStorage?void 0:sessionStorage.removeItem)&&sessionStorage.removeItem(c)}}var a,r,d}(e),e.headers&&(t.value=e.headers.get("request-id"),p.requestId=t.value),p.status=e.status,!e.ok){var h="Substrate Cortex API server failure: $tag::".concat(e.status,"::").concat(e.statusText);return 403===e.status?this._processSubstrateHttpResponseFailure(h,e,!0,n,d,l,u,a.CortexDisabled,p,m):this._getInnerErrorFromResponse(e).then(function(t){var i=null==t?void 0:t.error.message,r=null==t?void 0:t.error.code;return 400===e.status&&/Guest user is not supported/i.test(i)?_._processSubstrateHttpResponseFailure(h,e,!0,n,d,l,u,a.GuestUserNotSupported,p,m):(h+=t?", ErrorCode:".concat(r,", ErrorMessage:").concat(i):", ErrorMessage: Failed to retrieve",_._processSubstrateHttpResponseFailure(h,e,!1,n,d,l,u,_._getFormattedHttpStatus(e.status),p,m))})}try{return n.writeSuccess(p),l.writeSuccess(p),d.writeSuccess(p),u.writeSuccess(p),e.json()}catch(i){var b=i;return this._processSubstrateHttpResponseFailure("Substrate Cortex API deserialization failure: $tag::[RequestId: ".concat(t.value,", Name:").concat(b.name,", message:").concat(b.message,", stack:").concat(b.stack),e,!1,n,d,l,u,a.Deserialization,p,m)}},e.handleSubstrateAPIException=function(e,t,n,i,o,s,c,f,p){if(r.Validate.isNotNullOrUndefined(e,"error"),e instanceof d.A)throw e;var m=void 0;if(t)window.navigator.onLine?(m=void 0===e.status?new Error("Substrate Cortex API failure: $tag::[Name:".concat(e.name,", message:").concat(e.name,", stack:").concat(e.stack)):e,null==o||o.writeUnexpectedFailure(e.message,m,p),null==c||c.writeUnexpectedFailure(e.message,m,p),null==s||s.writeUnexpectedFailure(e.message,m,p),null==f||f.writeUnexpectedFailure(e.message,m,p)):(m=new Error("Substrate Cortex API failure Offline: $tag::[Name:".concat(e.name,", message:").concat(e.message,", stack:").concat(e.stack)),null==o||o.writeExpectedFailure(a.Offline,m,p),null==c||c.writeExpectedFailure(a.Offline,m,p),null==s||s.writeExpectedFailure(a.Offline,m,p),null==f||f.writeExpectedFailure(a.Offline,m,p));else{var _="Substrate Cortex token failure: $tag::[Name:".concat(e.name,", message:").concat(e.message,", stack:").concat(e.stack,", aadTokenFetchSucceeded:").concat(t);m=new l.M(_),window.navigator.onLine?(null==n||n.writeUnexpectedFailure(e.message,m),null==i||i.writeUnexpectedFailure(e.message,m)):(null==n||n.writeExpectedFailure(a.Offline,m),null==i||i.writeExpectedFailure(a.Offline,m),(0,u.A3)()&&(m.isExpected=!0)),(0,u.A3)()||(m.isExpected=!0),null==o||o.writeExpectedFailure(a.TokenFetch,m,p),null==c||c.writeExpectedFailure(a.TokenFetch,m,p),null==s||s.writeExpectedFailure(a.TokenFetch,m,p),null==f||f.writeExpectedFailure(a.TokenFetch,m,p)}throw m},e._processSubstrateHttpResponseFailure=function(e,t,n,a,i,r,o,s,c,l){var u=new d.A(e,t.status,s,n);return l&&(l.restApiError=u),n?(a.writeExpectedFailure(s,u,c),r.writeExpectedFailure(s,u,c),i.writeExpectedFailure(s,u,c),o.writeExpectedFailure(s,u,c)):(a.writeUnexpectedFailure(s,u,c),r.writeUnexpectedFailure(s,u,c),i.writeUnexpectedFailure(s,u,c),o.writeUnexpectedFailure(s,u,c)),Promise.reject(u)},e._getFormattedHttpStatus=function(e){return"HTTP ".concat(e.toString())},e._getInnerErrorFromResponse=function(e){return e.json().then(function(e){return e}).catch(function(){return Promise.resolve(void 0)})},e}()}
,8090:(e,t,n)=>{n.d(t,{Qi:()=>l,V3:()=>s,fv:()=>o,hK:()=>p,hN:()=>u,hx:()=>d,sS:()=>c,vR:()=>v,vt:()=>y,zb:()=>f});var a=n(280),i=n(9773),r=n(5271),o=11;function s(e){return{Id:e.Id,DisplayName:e.DisplayName,isSuggested:"Mined"===e.State}}function c(e){var t,n;return{LastModifiedTime:e.LastModifiedTime,Title:e.Title,Url:e.Url,Modifier:e.LastModifier?{Email:e.LastModifier.EmailAddress,Name:e.LastModifier.DisplayName,Upn:e.LastModifier.UserPrincipalName}:void 0,ViewCount:e.ViewCount,AIReason:{ReasonType:e.AIReason&&e.AIReason.ReasonType?e.AIReason.ReasonType:"",TopicMentionsCount:null===(t=e.AIReason)||void 0===t?void 0:t.TopicMentionsCount},Languages:null===(n=e.Languages)||void 0===n?void 0:n.map(i.tryMapLanguageToCulture),Id:e.Id,Type:e.Type,State:e.State,FilePath:e.FilePath,Extension:e.Extension,DownloadUrl:e.DownloadUrl,SiteId:(0,r.A)(e.SiteId||""),WebId:(0,r.A)(e.WebId||""),UniqueId:(0,r.A)(e.UniqueId||""),LogoUrl:e.LogoUrl}}function d(e){var t,n=e.RelatedResourcesMap,a=[];return null==n||n.forEach(function(e){"People"===e.Key&&(a=e.Value)}),null!==(t=null==a?void 0:a.map(function(e){return l(e)}))&&void 0!==t?t:[]}function l(e){var t;return{Email:e.EmailAddress,Name:e.DisplayName,Upn:e.UserPrincipalName,OId:e.ObjectId,Description:e.Description,LifecycleState:e.LifeCycle,AIReason:e.AIReason?{Count:e.AIReason.FileContributions?e.AIReason.FileContributions.length:0,DocumentContributedTo:(null===(t=e.AIReason.FileContributions)||void 0===t?void 0:t.length)>0?{Title:e.AIReason.FileContributions[0].Title+(e.AIReason.FileContributions[0].Extension?"."+e.AIReason.FileContributions[0].Extension:""),Url:e.AIReason.FileContributions[0].Url}:{}}:void 0,LastCurator:e.LastCurator,LastFeedbackModifier:e.LastFeedbackModifier}}function u(e){return(0,a.__assign)((0,a.__assign)({},e),{SiteId:(0,r.A)(e.SiteId),WebId:(0,r.A)(e.WebId),LifecycleState:e.LifeCycle})}function f(e){return{Acronym:e.Acronym,Title:e.Title,BannerColor:e.Color,BannerImageUrl:e.LogoUrl,Url:e.Url,Type:"Site",ItemReference:{SiteId:(0,r.A)(e.SiteId),WebId:(0,r.A)(e.WebId),Type:"SiteReference"},EntityState:e.State}}function p(e){var t,n,a,r,c=e.RelatedResourcesMap,d=e.RemovedRelatedResourcesMap,f=[],p=[],g=[],v=[],y=[],S=[],D=[],I=!1,x=!1,C=!1;c&&c.length>0&&c.forEach(function(e){"People"===e.Key?(f=e.Value,I=e.MoreResultsAvailable):"File"===e.Key?(p=e.Value,x=e.MoreResultsAvailable):"Site"===e.Key?(g=e.Value,C=e.MoreResultsAvailable):"TopicType"===e.Key&&(D=e.Value||[])}),null==d||d.forEach(function(e){"People"===e.Key?v=e.Value:"File"===e.Key?y=e.Value:"Site"===e.Key&&(S=e.Value)});var O=[];return(null===(t=e.Definitions)||void 0===t?void 0:t.length)&&e.Definitions.forEach(function(e){O.push(function(e){var t,n,a,r=null===(n=null===(t=e.AIReason)||void 0===t?void 0:t.SourceFiles)||void 0===n?void 0:n[0];return{Definition:e.Value,SourceType:"Wikipedia"===(null==r?void 0:r.Source)?"Wikipedia":"Private",State:e.State,LifecycleState:e.LifeCycle,Url:null==r?void 0:r.Url,WacUrl:null==r?void 0:r.Url,SourceDocumentTitle:null==r?void 0:r.Title,SourceDocumentExtension:null==r?void 0:r.Extension,Languages:null===(a=e.Languages)||void 0===a?void 0:a.map(i.tryMapLanguageToCulture),SourceFile:r}}(e))}),{CurrentLanguage:(0,i.tryMapLanguageToCulture)(e.CurrentLanguage),Definitions:O,Definition:e.Definition,DisambiguationContext:null===(n=e.DisambiguationContext)||void 0===n?void 0:n.Value,Id:e.Id,Name:e.DisplayName,State:e.State,Score:e.RelevanceScore,Type:e.TopicType,Types:D.map(s),Badges:e.Badges,TopicTypes:D,MergeStatus:e.MergeStatus,PrimaryName:_(e.PrimaryName),RelatedDocuments:m(p),RelatedPeople:f.map(l),RelatedSites:g.map(u),RemovedRelatedDocuments:m(y),RemovedRelatedPeople:v.map(l),RemovedRelatedSites:S.map(u),Url:e.Url,AlternateNames:(null===(a=e.AlternateNames)||void 0===a?void 0:a.map(b))||[],AtTheMinimumRelatedPeopleCount:I?o:f.length,AtTheMinimumRelatedResourcesCount:x?o:p.length,AtTheMinimumRelatedTopicsCount:C?o:g.length,HasPrimaryType:e.HasPrimaryType,HiddenMinedDocuments:[],HiddenMinedPeople:[],Languages:null===(r=e.Languages)||void 0===r?void 0:r.map(h),LifecycleState:e.LifeCycle,OriginalIds:e.AncestorIds,Source:e.Source,OriginalTopicEntity:e,ImpactMetrics:e.ImpactMetrics}}function m(e){return e.filter(function(e){return"File"===e.Type||"Connector"===e.Type}).map(c)}function _(e){var t;if(e)return{Name:e.Name,State:e.State,Languages:null===(t=e.Languages)||void 0===t?void 0:t.map(i.tryMapLanguageToCulture)}}function h(e){return{culture:(0,i.tryMapLanguageToCulture)(e.Value),url:e.Url}}function b(e){var t,n,a;return{Name:e.Name,State:e.State,Languages:null===(t=e.Languages)||void 0===t?void 0:t.map(i.tryMapLanguageToCulture),AIReason:{ReasonType:null===(n=e.AIReason)||void 0===n?void 0:n.ReasonType,SourceFiles:null===(a=e.AIReason)||void 0===a?void 0:a.SourceFiles.map(g)}}}function g(e){return{Extension:e.Extension||"",Source:e.Source,Title:e.Title,Url:e.Url}}function v(e){var t={EntityDetails:[],PageMatches:[]};if(e.EntityAnnotation){var n=e.EntityAnnotation.SectionMatches;if(n.length){var a=n.map(function(e){return{ComponentId:e.SectionId,Matches:e.EntityMatches.map(function(e){return{Start:e.StartPos,Length:e.Length,HighlightedName:e.HighlightedName,Entities:[{EntityId:e.Entities[0].Id,Score:0}]}})}});t.PageMatches=a;var i=e.EntityAnnotation.EntityDetails;t.EntityDetails=i}}return t}function y(e){var t={value:[]};if(e&&e.length>0){var n=e.map(function(e){var t,n;return{EntityId:e.Id,Name:e.DisplayName,Type:e.Type,Definition:e.Definition,AlternateNames:null!==(n=null===(t=e.AlternateNames)||void 0===t?void 0:t.map(b))&&void 0!==n?n:[],RelatedPeople:d(e),DisambiguationContext:e.DisambiguationContext}});t.value=n}return t}}
,1725:(e,t,n)=>{n.d(t,{at:()=>r,xW:()=>i,zk:()=>o});var a=n(908);function i(e){var t=e.headers.get("sprequestguid")||"",n=e.headers.get("microsoftsharepointteamservices")||"";return"[HTTP]:".concat(e.status," - ").concat(e.statusText," [CorrelationId]:").concat(t," [Version]:").concat(n)}function r(e){return new URL(window.location.href).searchParams.get(e)}function o(){var e,t=new URL(window.location.href).searchParams;return-1!==window.location.href.toLowerCase().indexOf(a.$t)||0===window.location.href.toLowerCase().indexOf(a.ZT)&&"true"===(null===(e=t.get(a.Z0))||void 0===e?void 0:e.toLocaleLowerCase().trim())}}
,9061:(e,t,n)=>{n.d(t,{XN:()=>u,fv:()=>i.fv,wK:()=>r.wK,Sr:()=>o.A,aR:()=>r.aR,$w:()=>m,Fu:()=>f,zk:()=>a.zk,at:()=>a.at,xW:()=>a.xW,vR:()=>i.vR,sS:()=>i.sS,hx:()=>i.hx,Qi:()=>i.Qi,hN:()=>i.hN,zb:()=>i.zb,vt:()=>i.vt,hK:()=>i.hK,V3:()=>i.V3});var a=n(1725),i=n(8090),r=n(908),o=n(7669),s=n(280),c=n(529),d=n(8216),l=n(9050),u=function(e){function t(t,n,a){return void 0===a&&(a=!1),e.call(this,t,a,n)||this}return(0,s.__extends)(t,e),Object.defineProperty(t.prototype,"qosTag",{get:function(){return"GetTopicByNames"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiName",{get:function(){return"Topics/Names"},enumerable:!1,configurable:!0}),t.prototype.fetchTopics=function(e,t){return(0,d.X)()?Promise.resolve([]):(this._language=t,this._topicNames=(0,c.uniq)(null==e?void 0:e.filter(function(e){return e}).map(function(e){return e.trim()})),(0,c.isEmpty)(this._topicNames)?Promise.resolve([]):this.getRequest().then(function(e){return e.value}))},t.prototype.getCustomRequestOptions=function(t){e.prototype.getCustomRequestOptions.call(this,t),t.body=JSON.stringify({TopicNames:this._topicNames})},t}(l.A),f=function(e){function t(t,n){var a=e.call(this,t,!1,n)||this;return a._typeIds=[],a}return(0,s.__extends)(t,e),t.prototype.getTypes=function(e,t){return void 0===e&&(e=[]),this._typeIds=e,this._language=t,this.getRequest().then(function(e){return e.value})},t.prototype.getCustomRequestOptions=function(t){e.prototype.getCustomRequestOptions.call(this,t),t.body=JSON.stringify({Ids:this._typeIds})},Object.defineProperty(t.prototype,"qosTag",{get:function(){return"GetTopicTypes"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiName",{get:function(){return"Types"},enumerable:!1,configurable:!0}),t}(l.A),p=n(9676),m=function(e){function t(t,n){void 0===n&&(n="SPPages.TopicPage.QnASetting");var a=this;return p.Validate.isNotNullOrUndefined(t,"serviceScope"),(a=e.call(this,t,void 0,n)||this)._payload=[],a}return(0,s.__extends)(t,e),Object.defineProperty(t.prototype,"apiName",{get:function(){return"Settings/QnANotifications/Ids"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"qosTag",{get:function(){return"QnANotificationsByTopicIds"},enumerable:!1,configurable:!0}),t.prototype.optOutByTopicId=function(e){return p.Validate.isNotNullOrUndefined(e,"topicId"),this._payload=[{TopicId:e,Enabled:!1}],this.getRequest()},t.prototype.getCustomRequestOptions=function(e){e.body=JSON.stringify(this._payload)},t}(l.A)}
,3785:(e,t,n)=>{n.d(t,{M:()=>r});var a=n(280),i=n(9305),r=function(){function e(e){this.customData={},this._serviceScope=e}return e.prototype.log=function(e,t,n){var r=this;void 0===t&&(t={});var o=(0,i.tryGetTopicsSdk)(),s=function(i){i.logEvent(e,(0,a.__assign)((0,a.__assign)({},r.customData),t),n)};o?s(o):(0,i.getTopicsSdk)(this._serviceScope).then(s)},e}()}
,4706:(e,t,n)=>{function a(e,t){var n,a;return(null===(a=null===(n=e.RelatedResourcesMap)||void 0===n?void 0:n.filter(function(e){return e.Key===t})[0])||void 0===a?void 0:a.Value)||[]}n.d(t,{P:()=>a})}
,5271:(e,t,n)=>{function a(e){return e.toLowerCase().replace(/[{}]/g,"")}n.d(t,{A:()=>a})}
,7426:(e,t,n)=>{n.d(t,{A:()=>c});var a=n(9676),i=n(2207),r="https://microsoft.sharepoint-df.com/teams/knowledgehub",o="https://microsoft.sharepoint.com/sites/knowledgecenter",s=["odspcsitest","olfilato-test-site","EdensTestSPDF","knowledgehub"];function c(e){var t,n;a.Validate.isNotNullOrUndefined(e,"pageContext");var c=i._LogSource.create("TopicUtilities");if(function(e){a.Validate.isNotNullOrUndefined(e,"pageContext");var t=e.site.absoluteUrl.toLowerCase();return-1!==t.indexOf("microsoft.sharepoint-df.com")&&s.some(function(e){return-1!==t.indexOf(e)})}(e))return r;if(null===(n=null===(t=e.legacyPageContext)||void 0===t?void 0:t.knowledgeHubSiteDetails)||void 0===n?void 0:n.Url){var d=e.legacyPageContext.knowledgeHubSiteDetails.Url;return d===r?o:d}return-1!==location.origin.toLowerCase().indexOf("microsoft")?o:void i._TraceLogger.logError(c,new Error("Error: Configure the KnowledgeCenter URL for Knowledge Mining scenarios to work correctly."))}}
,4721:(e,t,n)=>{n.d(t,{T8:()=>o.A,g0:()=>P,zS:()=>y,eZ:()=>T,u8:()=>x.u8,QC:()=>j,Pn:()=>s,ZP:()=>c.A,wN:()=>x.wN,Ov:()=>u,IW:()=>M,vE:()=>D,rd:()=>S,wI:()=>k,uR:()=>N,Bp:()=>d,Uk:()=>l,NL:()=>f,YQ:()=>C,gP:()=>_.s,Tc:()=>I,MW:()=>L,dn:()=>m,M_:()=>x.M_,K6:()=>F,ig:()=>U,zx:()=>B,Fl:()=>i,Vy:()=>r.A});var a=n(3025);function i(e){return(null==e?void 0:e.length)>0?a.h7.Curated:a.h7.NotCurated}var r=n(8418),o=n(5271);function s(e){var t;return null===(t=e.knowledgeHubSiteDetails)||void 0===t?void 0:t.Url}var c=n(7426);function d(e,t){var n,a;return u([e.Id].concat(null!==(n=e.AncestorIds)&&void 0!==n?n:[]),[t.Id].concat(null!==(a=t.AncestorIds)&&void 0!==a?a:[]))}function l(e,t){var n,a,i=new Set([e.Id].concat(null!==(n=e.OriginalIds)&&void 0!==n?n:[]));return[t.Id].concat(null!==(a=t.OriginalIds)&&void 0!==a?a:[]).some(function(e){return i.has(e)})}function u(e,t){var n=new Set(e);return t.some(function(e){return n.has(e)})}function f(e){return"Suggested"===e||"UserSuggested"===e}var p=n(4867);function m(e,t){var n=(0,c.A)(t),a=t.legacyPageContext.layoutsUrl||"_layouts/15",i="".concat(n,"/").concat(a,"/error.aspx?Title=").concat(p.iS,"&ErrorText=").concat(e);window.postMessage("router://".concat(i),window.location.origin)}var _=n(7270),h=n(7408),b=n(9773),g=n(9305),v=n(5931);function y(e){return(0,g.getPageContext)(e).then(function(t){if((0,b.isEnvSPDF)()){var n=t.legacyPageContext;if(n){var a=new h.SPPermission(n.webPermMasks);return Promise.resolve((0,b.isCortexEnabled)(t)&&a.hasAnyPermissions(h.SPPermission.manageLists,h.SPPermission.manageWeb)&&(0,v.sO)())}}return(0,g.getTopicsSdk)(e).then(function(e){return e.canUserEditTopics()&&(!(0,b.isEnvMSIT)(t)||e.canUserManageTopics())})})}function S(e,t){var n;return Boolean(null===(n=t.RelatedPeople)||void 0===n?void 0:n.some(function(t){return D(e,t.Email,t.Upn)}))}function D(e,t,n){return!(!t&&!n)&&(Boolean(t&&(t===e.email||t===e.loginName))||Boolean(n&&(n===e.email||n===e.loginName)))}function I(e){return(0,g.getTopicsSdk)(e).then(function(e){return Boolean(e.isPreviewUser())}).catch(function(){return!1})}var x=n(5161);function C(e){return"Suggested"===e||"Confirmed"===e||"UserSuggested"===e}var O=n(280),w=n(9061),E=n(6563),A=n(2872);function L(e,t,n,a,i){var r,o=n.error,s=n.errorName,c=n.prefix;s?r=s:function(e){return e&&("AadTokenError"===e.errorType||e instanceof E.M)}(o)?r="TokenError":function(e){return e&&("RestApiError"===e.errorType||e instanceof w.Sr)}(o)&&(r=A.E[o.status]),a||(a={errorMessage:o instanceof w.Sr?o.code:o.message}),r&&e.log(t,a,(0,O.__assign)({error:"".concat(null!=c?c:"").concat(r)},i))}function k(e){return!!(e&&"isExpected"in e&&e.isExpected)}function M(e){return 0===e.indexOf("CRKB_")}function P(e,t){var n=e.consume(b.EntityRelationsService.serviceKey).relationsContainer,a=n.recentActivities;if(a){for(var i=!1,r=0;r<a.length;r++)if(a[r].type===t.type){"ResourcesAddedActivity"===t.type?a[r]=(0,O.__assign)((0,O.__assign)({},t),{resourceCount:(0,O.__assign)((0,O.__assign)({},a[r].resourceCount),t.resourceCount)}):a[r]=(0,O.__assign)({},t),i=!0;break}i||a.push(t)}else n.recentActivities=[t]}function T(e,t){return{type:e,author:{email:t.email,name:t.displayName,upn:t.loginName},time:(new Date).toISOString()}}function U(e,t){return F(e.consume(b.TopicDataService.serviceKey).currentTopic).then(function(n){return!(!(0,v.Ys)()||t||n)&&"en-us"===(0,x.wN)(e)})}function F(e){return n.e(738).then(n.bind(n,6480)).then(function(t){var n,a=t.SKIP_TOPICS;return a.has(e.Id)||(null===(n=e.AncestorIds)||void 0===n?void 0:n.some(function(e){return a.has(e)}))})}var H=n(4706),R=n(1278);function N(e,t,n){var a,i,r=new Set([t.Id].concat(null!==(a=t.AncestorIds)&&void 0!==a?a:[]));if([n.Id].concat(null!==(i=n.AncestorIds)&&void 0!==i?i:[]).some(function(e){return r.has(e)})||t.Url===n.Url)return!1;if(!(0,R.Br)())return!0;var o=new Set((0,O.__spreadArray)((0,O.__spreadArray)([],(0,O.__read)(e),!1),(0,O.__read)((0,H.P)(t,"TopicType").filter(function(t){return-1===e.indexOf(t.Id)}).map(function(e){return e.Id})),!1).slice(0,3)),s=(0,H.P)(n,"TopicType").map(function(e){return e.Id}).slice(0,3),c=s.filter(function(e){return!o.has(e)});return(0,R.fx)()&&0===o.size?0===s.length:s.length===o.size&&0===c.length}function B(e){var t,n=document.querySelector('[data-automation-id="CommandBarUnlockEditButton"]');n?n.click():(null===(t=j())||void 0===t||t.click(),e&&(window.location.hash=e))}function j(){return document.querySelector('[data-automation-id="pageCommandBarEditButton"]')}}
,7270:(e,t,n)=>{function a(e){var t,n,a;return Boolean(e&&((null===(t=e.author)||void 0===t?void 0:t.name)||(null===(n=e.author)||void 0===n?void 0:n.email)||(null===(a=e.author)||void 0===a?void 0:a.upn))&&e.time)}n.d(t,{s:()=>a})}
,5161:(e,t,n)=>{n.d(t,{M_:()=>l,u8:()=>c,wN:()=>d});var a=n(7408),i=n(9773),r=n(3025),o=n(5931),s=n(7199);function c(e){if(e){var t=new URL(e);return t.searchParams.append(r.rd.LinkSource,r.rd.Language),t.searchParams.append("stay","true"),t.toString()}}function d(e){var t,n;if(e._isFinished){var r=e.consume(a.PageContext.serviceKey),c=e.consume(i.TopicDataService.serviceKey);return(0,o.yn)()?null===(t=c.currentPageLanguage)||void 0===t?void 0:t.toLowerCase():(0,s.cI)()?c.topicPageMultilingualInfo.previewLanguage:(null===(n=c.topicPageMultilingualInfo)||void 0===n?void 0:n.isTranslation)?c.topicPageMultilingualInfo.translationLanguage:r.web.languageName.toLowerCase()}}function l(e,t,n){var r,s;if(t._isFinished){var c=t.consume(a.PageContext.serviceKey),l=t.consume(i.TopicDataService.serviceKey),u=(0,o.yn)()?null===(r=l.multilingualSourcePageInfo)||void 0===r?void 0:r.language.toLowerCase():c.web.languageName.toLowerCase();if(e)return u;if(n&&0!==n.length){var f=c.cultureInfo.currentUICultureName.toLowerCase(),p=(0,o.yn)()?d(t):null===(s=l.currentPageLanguage)||void 0===s?void 0:s.toLowerCase(),m=n.map(i.tryMapLanguageToCulture);return p&&-1!==m.indexOf(p)?p:f&&-1!==m.indexOf(f)?f:u&&-1!==m.indexOf(u)?u:m[0]}}}}
,8418:(e,t,n)=>{n.d(t,{A:()=>i});var a=n(3025);function i(e){return(null==e?void 0:e.split(a.hy)[0])||""}}
,8216:(e,t,n)=>{n.d(t,{X:()=>a});var a=function(){try{return!!window.sessionStorage.getItem("_isRunningTABTest")}catch(e){return console.log("No session storage accessible: "+e),!1}}}
,8424:e=>{e.exports=g},1962:e=>{e.exports=h},9676:e=>{e.exports=a},2207:e=>{e.exports=n},1909:e=>{e.exports=r},8414:e=>{e.exports=l},529:e=>{e.exports=c},7408:e=>{e.exports=i},6642:e=>{e.exports=_},8698:e=>{e.exports=u},9939:e=>{e.exports=s},2141:e=>{e.exports=b},9773:e=>{e.exports=d},8926:e=>{e.exports=y},8118:e=>{e.exports=D},7976:e=>{e.exports=v},9276:e=>{e.exports=S},9408:e=>{e.exports=m},9305:e=>{e.exports=o},5959:e=>{e.exports=f},8398:e=>{e.exports=p},280:e=>{e.exports=t},4867:e=>{e.exports=JSON.parse('{"k$":"主题反馈: {0}","q6":"请告诉我们你对本主题的体验。信息是否准确或有用?","Ts":"工程笔记: ","ur":"来源: ","Vo":"主题 id: ","iE":"主题名称:","jx":"工具包版本: ","n":"浏览器代理: ","U$":"用户语言: ","iS":"当前主题详细信息不可用。"}')}
},w={};function E(e){var t=w[e];if(void 0!==t)return t.exports;var n=w[e]={exports:{}};return O[e](n,n.exports,E),n.exports}E.m=O,E.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return E.d(t,{a:t}),t},E.d=(e,t)=>{for(var n in t)E.o(t,n)&&!E.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},E.f={},E.e=e=>Promise.all(Object.keys(E.f).reduce((t,n)=>(E.f[n](e,t),t),[])),E.u=e=>"chunk."+{738:"topic-hide-copilot-topicIds",830:"topic-shared-topic-creation"}[e]+"_"+({830:1}[e]?"zh-cn":"none")+"_"+{738:"ef0f81f409dd01b46f58",830:"6af6742a76e5f5f0061f"}[e]+".js",E.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),I={},x="49d290fb-a38e-4001-97d3-a2db486db2fa_0.1.0:",E.l=(e,t,n,a)=>{if(I[e])I[e].push(t);else{var i,r;if(void 0!==n)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var c=o[s];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==x+n){i=c;break}}i||(r=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,E.nc&&i.setAttribute("nonce",E.nc),i.setAttribute("data-webpack",x+n),i.src=e,0!==i.src.indexOf(window.location.origin+"/")&&(i.crossOrigin="anonymous")),I[e]=[t];var d=(t,n)=>{i.onerror=i.onload=null,clearTimeout(l);var a=I[e];if(delete I[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach(e=>e(n)),t)return t(n)},l=setTimeout(d.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=d.bind(null,i.onerror),i.onload=d.bind(null,i.onload),r&&document.head.appendChild(i)}},E.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},C=e?e.src:"",E.p=C.slice(0,C.lastIndexOf("/")+1),E.f.compat=(e,t)=>{for(var n=function(e){return{830:[{i:"c79b9f88-6338-40fb-b463-3aad22a88b15",v:"0.1.0",m:9146},{i:"4c7a0268-816b-4ba5-ab33-df85b4bbf18c",v:"0.1.0",m:8327},{i:"93dfc7f4-039c-4dc5-b10f-bf09ab171eba",v:"0.1.0",m:493},{i:"ffe5c101-373a-4bd2-bebb-13082852bab0",v:"0.1.0",m:8738},{i:"91976643-f860-4be9-ba8f-32b82339a0ca",v:"0.1.0",m:8106},{i:"a86b8f98-2f15-4506-b455-c1e9fe8da1bd",v:"0.1.0",m:1048},{i:"fab65e60-a04f-4772-874c-10691e4afa4b",v:"0.1.0",m:8253}]}[e]||[]}(e),a=0;a<n.length;a++)E.m[n[a].m]||(e=>{t.push(A.SPComponentLoader.loadComponentById(e.i,e.v).then(t=>{E.m[e.m]=e=>e.exports=t}))})(n[a])};var A=E(8414);(()=>{var e={706:0};E.f.j=(t,n)=>{var a=E.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise((n,i)=>a=e[t]=[n,i]);n.push(a[2]=i);var r=E.p+E.u(t),o=new Error;E.l(r,n=>{if(E.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",o.name="ChunkLoadError",o.type=i,o.request=r,a[1](o)}},"chunk-"+t,t)}};var t=(t,n)=>{var a,i,[r,o,s]=n,c=0;if(r.some(t=>0!==e[t])){for(a in o)E.o(o,a)&&(E.m[a]=o[a]);s&&s(E)}for(t&&t(n);c<r.length;c++)i=r[c],E.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self["webpackJsonp_49d290fb-a38e-4001-97d3-a2db486db2fa_0.1.0"]=self["webpackJsonp_49d290fb-a38e-4001-97d3-a2db486db2fa_0.1.0"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var L={};return(()=>{E.r(L),E.d(L,{AadTokenError:()=>be.M,AnyLanguageKey:()=>i.hf,CuratedTypes:()=>i.h7,DEFAULT_RELATION_COUNT:()=>i.Kc,DUMMY_CURATION_DETAILS:()=>i.fb,DataVersion:()=>Oe.p,DeferredPeopleDataProvider:()=>C,DeferredTopicCreation:()=>ue,DefinitionTypes:()=>i.b7,EmptyResponseError:()=>A,EngagementLogger:()=>G.M,ExperienceFeedback:()=>de,FEEDBACK_EMAIL:()=>ce,FeedbackDataProvider:()=>D,GetTopicsByNamesDataProvider:()=>_e.XN,KnowledgeCenterPerfComponents:()=>He,LIFECYCLE_TO_LOC_STRING:()=>Ue,LIFECYCLE_TO_MANAGED_LIFECYCLE:()=>Te,LinkSourceTypes:()=>i.Pr,MAX_RELATION_COUNT:()=>i.lO,MORE_RESULTS_SIGNAL:()=>_e.fv,MSIT_KNOWLEDGE_HUB_URL:()=>_e.wK,MixedLanguageKey:()=>i.qc,MultilingualSourceMessage:()=>Ce,MyTopicsDataProvider:()=>ve,MyTopicsFeedbackDataProvider:()=>ie,PagesFlightId:()=>r.iY,RELATED_DOCUMENTS_LIMIT:()=>i.U_,RELATED_PEOPLE_LIMIT:()=>i.ge,RestApiError:()=>ke.A,SPDF_TEST_HEADER:()=>_e.aR,STATUS_DESCRIPTION:()=>Fe,SUBSTRATE_GETTOPICBYID_EMPTY_RESPONSE_ERROR:()=>i.bq,SubstrateFeedbackDataProvider:()=>h,SubstrateGetSubscirptionsDataProvider:()=>m,SubstrateGetTopicSuggestionProvider:()=>b,SubstrateManageTopicsDataProvider:()=>d,SubstrateManageTopicsFilterOptionsDataProvider:()=>u,SubstrateManagedDashboardDataProvider:()=>ge,SubstrateMergeTopicsDataProvider:()=>f,SubstrateQnANotificationsDataProvider:()=>_e.$w,SubstrateTopicStatusDataProvider:()=>p,SubstrateTopicsAnalyticsDataProvider:()=>je,SubstrateUpdateSubscriptionsDataProvider:()=>_,SuggestedDefinitionSourceElement:()=>Ie,TOPIC_ID_ORIGIN_BREAKER:()=>i.hy,TOPIC_IMPACT_METRICS_ANCHOR_ID:()=>i.HX,TOPIC_PRIVACY_CLOSE_BUTTON_ID:()=>i.P2,TOPIC_RELATED_PEOPLE_ANCHOR_ID:()=>i.iL,TOPIC_RELATED_RESOURCES_ANCHOR_ID:()=>i.yF,TOPIC_RELATED_SITES_ANCHOR_ID:()=>i.r6,TOPIC_RELATED_TOPICS_ANCHOR_ID:()=>i.um,TopicConstants:()=>i.Oy,TopicDataProviderHelper:()=>g.l,TopicPageEngagementLogger:()=>K,TopicPageEngagementLoggerDeprecated:()=>q,TopicPageLayoutDefaultTemplate:()=>v.U,TopicPageParams:()=>i.rd,TopicTypesDataProvider:()=>_e.Fu,UnspecifiedLanguageKey:()=>i.Nq,WEB_VIEW_EXTENSIONS:()=>S.m6,WikiSourceElement:()=>xe,_BaseKMWebPart:()=>te,_BaseSubstrateTopicDataProvider:()=>e.A,_SubstrateAnnotationDataProvider:()=>T,_SubstrateGetTopicByIdDataProvider:()=>k,_SubstrateGetTopicsByIdsDataProvider:()=>M,_SubstrateRelatedTopicsDataProvider:()=>U,_cleanGuid:()=>we.T8,_translateDoc:()=>O.sS,_translatePeople:()=>O.hx,_translatePerson:()=>O.Qi,_translateSubstrateSuggestionSearchAPIResponse:()=>O.vt,addAllowedEditors:()=>Ve,addBadgesToEntityRelations:()=>y.dy,addEntityRelations:()=>y.cw,addLinkSource:()=>he.A,addRecentActivity:()=>we.g0,buildTopicEntity:()=>re.p,canUserCreateTopic:()=>we.zS,chooseIcon:()=>fe,enableTestFeedback:()=>_e.zk,generatePreviewUrl:()=>S.bI,getActivity:()=>we.eZ,getCreateTopicPageUrl:()=>S.cb,getCurationDetails:()=>y.OC,getDefaultPageUrlWithSource:()=>we.u8,getEditCommand:()=>we.QC,getFeedbackMailLink:()=>S.d6,getFileNameWithExtension:()=>Be,getKnowledgeHubUrl:()=>we.Pn,getKnowledgeHubUrlWithOverrides:()=>we.ZP,getLatestCurationAuthorProfile:()=>J,getPageUniqueId:()=>S.hp,getParameterValue:()=>_e.at,getPathName:()=>S.H2,getRelatedResources:()=>Ne.P,getStatusMessage:()=>_e.xW,getTopicPageEngagementLogger:()=>W,getTopicPageLanguage:()=>we.wN,getTopicsBySerial:()=>S.V2,getTopicsWebpartDidMountEventEventName:()=>ee,getWebviewUrl:()=>S.uH,hasSameId:()=>we.Ov,homeAndTopicPageGradientBackground:()=>Re,isAddProviderTypeParamEnabled:()=>r.w1,isAddSourceColumnFlightEnabled:()=>r.oK,isAnnotatePageTitleFlightEnabled:()=>r.Ky,isCSIEnableCreateTopicCrossSitesEnabled:()=>r.sO,isCSITopicImpactMetricsFlightEnabled:()=>r.$C,isCopilotCurationFlightEnabled:()=>r.Ys,isCreateTopicPage:()=>S.Er,isCuratedTopicId:()=>we.IW,isCurrentUser:()=>we.vE,isCurrentUserInSuggested:()=>we.rd,isDisambiguationPage:()=>S.eD,isExpectedError:()=>we.wI,isFixPendingLogicOfDisposedKMWebPartKSActivated:()=>o.S1,isLanguageFilterFlightEnabled:()=>r.FM,isManagedDashboardV2Enabled:()=>r._N,isMergeTopicsV1FlightEnabled:()=>r.Az,isMobileView:()=>i.E3,isNewPage:()=>S.Bv,isPreviewPage:()=>S.cI,isSameAuthor:()=>X,isSameNameTopic:()=>we.uR,isSameTopic:()=>we.Bp,isSameTranslatedTopicDeprecated:()=>we.Uk,isSitesSegmentationFlightEnabled:()=>r.fk,isSuggestedEntity:()=>we.NL,isSwitchAPIRequestMethodEnabled:()=>r.Fv,isTopicActivitiesEnabled:()=>r.Bd,isTopicCopilotChatNewExpEnabled:()=>r.Jr,isTopicFaqWPFlightEnabled:()=>r.ez,isTopicPipelineIdOverrideFlightEnabled:()=>r.hp,isTopicSuggested:()=>we.YQ,isTopicsMultilingualV3FlightEnabled:()=>r.yn,isTypesFilterFlightEnabled:()=>r.vZ,isUseObjectstoreForTopicManagementEnabled:()=>r.ZP,isValidCurationDetails:()=>we.gP,isZeroTermSuggestionsFlightEnabled:()=>r.tL,loadIsEAPUser:()=>we.Tc,logASHAError:()=>we.MW,logEngagement:()=>me,logEventWithTopicsSDK:()=>Me,logMergeTopicsEngagement:()=>S.Eo,openInNewTab:()=>S.q3,openTopicErrorPage:()=>we.dn,pickContentCultureFromLanguages:()=>we.M_,resetAllowedEditors:()=>ze,resetBadges:()=>y.nX,resetEntityRelations:()=>y.OP,resetHiddenHighlights:()=>Ke,resetHideListEditor:()=>qe,saveHiddenHighlightstoService:()=>Ge,saveHideListEditortoService:()=>We,shouldHideGptExperience:()=>we.K6,shouldShowGptExperience:()=>we.ig,switchToEditMode:()=>we.zx,topicCurated:()=>we.Fl,topicOrigin:()=>we.Vy,translateAnnotationResponse:()=>_e.vR,translateDoc:()=>_e.sS,translatePeople:()=>_e.hx,translatePerson:()=>_e.Qi,translateSite:()=>_e.hN,translateSiteMetadata:()=>_e.zb,translateSubstrateSuggestionSearchAPIResponse:()=>_e.vt,translateSubstrateTopicEntity:()=>_e.hK,translateTopicType:()=>_e.V3,useTypeName:()=>Le,useUpdateRequiredFields:()=>Ee});var e=E(9050),t=E(280),n=E(9676),a=E(529),i=E(3025),r=E(5931),o=E(1278),s=E(908),c=E(1725),d=function(e){function d(t){return e.call(this,t,!1)||this}return(0,t.__extends)(d,e),d.prototype.getTopics=function(e){var t,s,c=e.Size;if(n.Validate.isNotNullOrUndefined(c,"count"),(0,r.fk)()&&!(0,a.isEmpty)(e.Filters.Sites)){var d=(0,a.cloneDeep)(e);d.Filters.Sites=d.Filters.Sites.map(function(e){return e.ItemReference.SiteId}),this._queryOptions=d}else this._queryOptions=e;return(0,o.X2)()||(this._language=i.qc),(0,r.FM)()&&(this._language=(null===(t=e.Filters.Languages)||void 0===t?void 0:t[0])!==i.Nq?(null===(s=e.Filters.Languages)||void 0===s?void 0:s[0])||i.qc:i.hf),this.getRequest()},Object.defineProperty(d.prototype,"apiName",{get:function(){return"Topics/Managed"},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"apiParams",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"qosTag",{get:function(){return"ManageTopics"},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"xScenario",{get:function(){var e=this._queryOptions.Filters.LifeCycleStates;return e.length>0&&"Removed"===e[0]?"SPPages.TopicManagementV3.RemovedTopics":"SPPages.TopicManagementV3.ActiveTopics"},enumerable:!1,configurable:!0}),d.prototype.getCustomRequestOptions=function(e){e.headers["X-ODataQuery"]="true",e.headers.accept="application/json",(0,r.oK)()&&(e.headers["X-Debug-EnableSourcesForTopicCenter"]="true",e.headers["X-Debug-EnableSourcesV2ForTopicCenter"]="true"),(0,r.fk)()&&(e.headers["X-Debug-EnableSitesForTopicCenter"]="true"),(0,r.FM)()&&(e.headers["X-Debug-EnableLanguagesForTopicCenter"]="true"),(0,r.vZ)()&&(e.headers["X-Debug-EnableTypesForTopicCenter"]="true"),(0,o.EI)()||(e.headers["X-Debug-EnableTopicScoreNormalizationV2"]="true"),e.headers["X-Debug-ServerSidePaginationEnabledHeader"]="true";var n=new URL(window.location.href).searchParams;(0,r.hp)()&&(0,c.zk)()&&n.has(s.rk)?e.body=JSON.stringify((0,t.__assign)((0,t.__assign)({},this._queryOptions),{kbPipelineIdOverride:n.get(s.rk)})):e.body=JSON.stringify(this._queryOptions)},d}(e.A),l=E(7408),u=function(e){function n(t){return e.call(this,t,!1)||this}return(0,t.__extends)(n,e),n.prototype.getFilterOptions=function(e){var t=this._serviceScope.consume(l.PageContext.serviceKey);return this._language=t.cultureInfo.currentUICultureName,this._filters=e,this.getRequest()},Object.defineProperty(n.prototype,"apiName",{get:function(){return"Topics/Managed/Filters"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"apiParams",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"qosTag",{get:function(){return"ManageTopicsFilters"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"xScenario",{get:function(){return"SPPages.TopicManagement.GetFilterOptions"},enumerable:!1,configurable:!0}),n.prototype.getCustomRequestOptions=function(e){e.headers["X-ODataQuery"]="true",e.headers.accept="application/json",(0,r.oK)()&&(e.headers["X-Debug-EnableSourcesForTopicCenter"]="true",e.headers["X-Debug-EnableSourcesV2ForTopicCenter"]="true"),e.headers["X-Debug-ServerSidePaginationEnabledHeader"]="true",e.body=JSON.stringify(this._filters)},n}(e.A),f=function(e){function i(t,n){return e.call(this,t,void 0,n)||this}return(0,t.__extends)(i,e),i.prototype.queueTopicsToMerge=function(e){return n.Validate.isNotNullOrUndefined(e,"topicIds"),this._topicIds=e.filter(function(e){return!(0,a.isEmpty)(e.trim())}),this.getRequest()},Object.defineProperty(i.prototype,"qosTag",{get:function(){return"MergeTopics"},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"apiName",{get:function(){return"Topics/Merge"},enumerable:!1,configurable:!0}),i.prototype.getCustomRequestOptions=function(t){e.prototype.getCustomRequestOptions.call(this,t),t.body=JSON.stringify({TopicIds:this._topicIds})},i}(e.A),p=function(e){function n(t,n){return e.call(this,t,void 0,n)||this}return(0,t.__extends)(n,e),n.prototype.getTopicStatus=function(e,t){return this._topicIds=[e.trim()],this._properties=t.filter(function(e){return!(0,a.isEmpty)(e.trim())}),this.getRequest().then(function(e){var t;return null===(t=e.value)||void 0===t?void 0:t[0]})},Object.defineProperty(n.prototype,"qosTag",{get:function(){return"TopicStatus"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"apiName",{get:function(){return"Topics/Status"},enumerable:!1,configurable:!0}),n.prototype.getCustomRequestOptions=function(t){e.prototype.getCustomRequestOptions.call(this,t),t.body=JSON.stringify({TopicIds:this._topicIds,Properties:this._properties})},n}(e.A),m=function(e){function n(t){return e.call(this,t,!1)||this}return(0,t.__extends)(n,e),n.prototype.getSubscriptions=function(){return this.getRequest().then(function(e){return null==e?void 0:e.value})},Object.defineProperty(n.prototype,"apiName",{get:function(){return"Notification/Subscriptions"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"apiParams",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"qosTag",{get:function(){return"GetNotificationSubscriptions"},enumerable:!1,configurable:!0}),n.prototype.getCustomRequestOptions=function(e){e.headers["X-ODataQuery"]="true",e.headers.accept="application/json"},n}(e.A),_=function(e){function n(t){var n=e.call(this,t,!1)||this;return n._subscriptions=[],n}return(0,t.__extends)(n,e),n.prototype.updateSubscriptions=function(e){return this._subscriptions=e,this.getRequest()},Object.defineProperty(n.prototype,"apiName",{get:function(){return"Notification/Subscriptions/Update"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"apiParams",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"qosTag",{get:function(){return"UpdateNotificationSubscriptions"},enumerable:!1,configurable:!0}),n.prototype.getCustomRequestOptions=function(e){e.headers["X-ODataQuery"]="true",e.headers.accept="application/json",e.body=JSON.stringify({Subscriptions:this._subscriptions})},n}(e.A),h=function(e){function a(t){var a=this;return n.Validate.isNotNullOrUndefined(t,"serviceScope"),(a=e.call(this,t,!1)||this)._topics=[],a}return(0,t.__extends)(a,e),Object.defineProperty(a.prototype,"apiName",{get:function(){return"Topics/".concat(this._feedbackType)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"qosTag",{get:function(){return"ManageTopics.".concat(this._feedbackType)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"xScenario",{get:function(){return"Confirm"===this._feedbackType?"SPPages.TopicManagement.Confirmed":"Exclude"===this._feedbackType?"SPPages.TopicManagement.Removed":void 0},enumerable:!1,configurable:!0}),a.prototype.provideFeedback=function(e,t){return n.Validate.isNotNullOrUndefined(e,"topics"),n.Validate.isNotNullOrUndefined(t,"feedbackType"),this._feedbackType=t,this._topics=e.map(function(e){return{Id:e.Id,Name:e.Name}}),this.getRequest()},a.prototype.getCustomRequestOptions=function(e){e.body=JSON.stringify({Topics:this._topics})},a}(e.A),b=function(e){function a(t,n){var i=e.call(this,t,void 0,n)||this;return i._warmUpQueryRun=!1,i._zeroTermSuggestionsResult=[],i._language=i.pageContext.cultureInfo.currentUICultureName,i._shouldWarmUpSuggestionsApi()&&(a._lastInitQueryTime=(new Date).getTime(),i._warmUpSuggestionsApi()),i}return(0,t.__extends)(a,e),Object.defineProperty(a.prototype,"qosTag",{get:function(){return"GetTopicSuggestion"},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isPost",{get:function(){return!1},enumerable:!1,configurable:!0}),a.prototype.getTopicSuggestion=function(e,t){var n,a=this;if(0===e.length&&(null===(n=this._lastQuerySuggestionsResult)||void 0===n?void 0:n.length)>0)return(0,r.tL)()?Promise.resolve(this._zeroTermSuggestionsResult):Promise.resolve(this._lastQuerySuggestionsResult);0===e.length&&(e=(0,r.tL)()?"":"a");var i="&prefix=".concat(encodeURIComponent(e),"&topicCount=").concat(t);return this.getRequest(i,void 0,this._warmUpQueryRun).then(function(e){return a._lastQuerySuggestionsResult=e.value,Promise.resolve(a._lastQuerySuggestionsResult)})},a.prototype._warmUpSuggestionsApi=function(){var e=this;if(this._isPageInEditMode&&!this._warmUpQueryRun){this._warmUpQueryRun=!0;var t=(0,r.tL)()?"":"a",a=n._SPFlight.isEnabled(663)?10:5;this.getTopicSuggestion(t,a).then(function(t){(0,r.tL)()&&(e._zeroTermSuggestionsResult=t)}),this._warmUpQueryRun=!1}},a.prototype._shouldWarmUpSuggestionsApi=function(){var e=(new Date).getTime()-a._lastInitQueryTime;return!a._lastInitQueryTime||e>3e5},Object.defineProperty(a.prototype,"_isPageInEditMode",{get:function(){return-1!==new URLSearchParams(window.location.search).toString().indexOf("Mode=Edit")},enumerable:!1,configurable:!0}),a}(e.A),g=E(5296),v=E(3304),y=E(4749),S=E(7199);const D=function(e){function a(t,a,i){void 0===i&&(i="SPPages.TopicCard.Feedback");var r,o,s,c,d,l,u=this;return n.Validate.isNotNullOrUndefined(t,"serviceScope"),(u=e.call(this,t,void 0,i)||this)._spoId=a,u._currentPageId={SiteId:null!==(o=null===(r=u._spoId.siteId)||void 0===r?void 0:r.toString())&&void 0!==o?o:n.Guid.empty.toString(),WebId:null!==(c=null===(s=u._spoId.webId)||void 0===s?void 0:s.toString())&&void 0!==c?c:n.Guid.empty.toString(),UniqueId:null!==(l=null===(d=u._spoId.uniqueId)||void 0===d?void 0:d.toString())&&void 0!==l?l:n.Guid.empty.toString()},u}return(0,t.__extends)(a,e),a.prototype.processFeedback=function(e,t){return n.Validate.isNotNullOrUndefined(e,"topicEntity"),n.Validate.isNotNullOrUndefined(t,"feedbackQuestion"),n.Validate.isNotNullOrUndefined(t.ResponseType,"feedbackQuestion.ResponseType"),this._requestBody=this._buildProcessFeedbackAPIRequestBody(e,t),this.getRequest()},Object.defineProperty(a.prototype,"apiName",{get:function(){return"TopicCardFeedback"},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"qosTag",{get:function(){return"TopicCardFeedback"},enumerable:!1,configurable:!0}),a.prototype.getCustomRequestOptions=function(e){e.body=this._requestBody},a.prototype._buildProcessFeedbackAPIRequestBody=function(e,t){var n,a={EntityId:e.Id,Name:e.Name,CurrentPageId:this._currentPageId,QuestionType:t.QuestionType,ResponseType:t.ResponseType};return"Person"===(null===(n=t.RelatedEntity)||void 0===n?void 0:n.Type)&&(a.RelatedPerson=t.RelatedEntity.EntityIdentity),JSON.stringify({Request:a})},a}(e.A);var I=E(8414),x=E(2207),C=function(){function e(){}return e.load=function(t){if(!e._peopleDataProviderPromise){var n=new x._QosMonitor("".concat(t,".PeopleDataProvider.DeferredLoad"));e._peopleDataProviderPromise=I.SPComponentLoader.loadComponentById(e._peopleDataProviderComponentId).then(function(e){return n.writeSuccess(),e.PeopleDataProvider}).catch(function(e){throw n.writeUnexpectedFailure("LoadModuleFailure",e),e})}return e._peopleDataProviderPromise},e._peopleDataProviderComponentId="8b7ae98f-492d-4304-93df-8f8a9fbedf11",e}(),O=E(8090),w=E(8216),A=function(e){function n(t){var a=e.call(this,t)||this;return a.__proto__=n.prototype,a}return(0,t.__extends)(n,e),n}(Error),k=function(e){function c(t,n,a){var r=e.call(this,t,!0,a)||this;return r._handleResponse=function(e){if(0===e.value.length)throw new A(i.bq);return e.value[0]},r._useMined=n,r}return(0,t.__extends)(c,e),Object.defineProperty(c.prototype,"qosTag",{get:function(){return"GetTopicById"},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"apiName",{get:function(){return(0,r.Fv)()?"Topics/Ids":this._useMined?"Topics/Mined":"Topics"},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"xScenario",{get:function(){return(0,o.dw)()?"SPPages.TopicPage.Read":this._scenario||"SPPages.TopicPage.Read"},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"isPost",{get:function(){return(0,r.Fv)()},enumerable:!1,configurable:!0}),c.prototype.getTopic=function(e,t,i,s,c){if(void 0===t&&(t=this._useMined),n.Validate.isNonemptyString(e,"topicId"),(0,w.X)()){var d=this._getTABMockMinedData(),l={value:[]};return d&&(l=JSON.parse(d)).value.length>0&&(l.value[0].Id=e),Promise.resolve(l).then(this._handleResponse)}if(this._useMined=t,this._language=s,(0,o.Oe)()||(this._customOptions=c),(0,r.Fv)())return this._resourceOptions=i,this._topicId=e,this.getRequest().then(this._handleResponse);var u="";return(0,a.isEmpty)(i)||(0,a.each)(i,function(e,t){return u+="&".concat(t.toLowerCase(),"=").concat(e)}),this.getRequest("&id=".concat(e).concat(u)).then(this._handleResponse)},c.prototype.getCustomRequestOptions=function(n){var a;e.prototype.getCustomRequestOptions.call(this,n),(0,r.Fv)()&&(n.body=JSON.stringify((0,t.__assign)({TopicIds:[this._topicId],IsMinedOnly:this._useMined,ResourceOptions:this._resourceOptions},(0,r.w1)()&&-1!==s.RQ.indexOf(this._providerType)&&{ProviderType:this._providerType}))),(0,o.Oe)()||(n.headers=(0,t.__assign)((0,t.__assign)({},n.headers),null===(a=this._customOptions)||void 0===a?void 0:a.headers)),(0,r.Az)()&&"true"===new URL(window.location.href).searchParams.get(i.rd.DisableMergeRedirect)&&(n.headers["X-DisableMergeRedirect"]="true")},c.prototype._getTABMockMinedData=function(){return window.sessionStorage.getItem("MOCK_TOPIC_MINED_RESPONSE")},c}(e.A),M=function(e){function i(t,n){return void 0===n&&(n="SPPages.TopicCard.Embedded"),e.call(this,t,void 0,n)||this}return(0,t.__extends)(i,e),i.prototype.fetchTopics=function(e,t){return n.Validate.isNotNullOrUndefined(e,"topicIds"),this._topicIds=e.filter(function(e){return!(0,a.isEmpty)(e.trim())}),this._language=null==t?void 0:t.language,this._topicsGraphDepth=null==t?void 0:t.topicsGraphDepth,0===this._topicIds.length?Promise.resolve([]):this.getRequest().then(function(e){return e.value})},Object.defineProperty(i.prototype,"qosTag",{get:function(){return"GetTopicsByIds"},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"apiName",{get:function(){return"Topics/Ids"},enumerable:!1,configurable:!0}),i.prototype.getCustomRequestOptions=function(n){e.prototype.getCustomRequestOptions.call(this,n),n.body=JSON.stringify((0,t.__assign)((0,t.__assign)({TopicIds:this._topicIds},Boolean(this._topicsGraphDepth)&&{RelatedTopics:{TopicsGraphDepth:this._topicsGraphDepth}}),(0,r.w1)()&&-1!==s.RQ.indexOf(this._providerType)&&{ProviderType:this._providerType}))},i}(e.A),P=E(8698),T=function(e){function a(t,n){var a=e.call(this,t)||this;return a._doNotRetrieveTopicDetails=n,a}return(0,t.__extends)(a,e),a.prototype.getAnnotations=function(e,t){return n.Validate.isNotNullOrUndefined(e,"contentArr"),n.Validate.isNotNullOrUndefined(t,"spoId"),this._contentArr=e,this._spoId=t,this._language=this.pageContext.cultureInfo.currentUICultureName,this.getRequest().then(function(e){return e})},Object.defineProperty(a.prototype,"fetchRetryOptions",{get:function(){return{shouldRetryOnError:function(e){var t;return-1===g.R.Cancelled.indexOf(null===(t=e.message)||void 0===t?void 0:t.toLowerCase())},retries:1}},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"apiName",{get:function(){return"Annotation"},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"qosTag",{get:function(){var e="Annotation";return this._doNotRetrieveTopicDetails?"".concat(e,".DoNotRetrieveDetails"):e},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"xScenario",{get:function(){return"SPPages.TopicAnnotation.SPPage"},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"clientRequestId",{get:function(){return this._clientRequestId},enumerable:!1,configurable:!0}),a.prototype.getCustomRequestOptions=function(e){var t,n,i,r,s,c,d=this,l={Provider:"Yggdrasil"};l.TextSections=this._contentArr.map(function(e){return{SectionId:e.id,Text:e.text,RetrieveTopicDetails:!d._doNotRetrieveTopicDetails}}),l.CurrentPageId={SiteId:null!==(n=null===(t=this._spoId.siteId)||void 0===t?void 0:t.toString())&&void 0!==n?n:a._allTopicsPageGuid,WebId:null!==(r=null===(i=this._spoId.webId)||void 0===i?void 0:i.toString())&&void 0!==r?r:a._allTopicsPageGuid,UniqueId:null!==(c=null===(s=this._spoId.uniqueId)||void 0===s?void 0:s.toString())&&void 0!==c?c:a._allTopicsPageGuid},e.body=JSON.stringify({AnnotationRequest:l});var u=new URL(window.location.href).searchParams;e&&e.headers&&("0"===u.get("threshold")&&(e.headers["X-Debug-SkipAnnotationFiltering"]="true"),"true"===u.get("yukonFlight")&&(e.headers["X-Debug-IsYukonHighlightFlightEnabled"]="true"),(0,o.Hy)()||(1===(0,P.getVariantAndLogExposure)(90146,this.pageContext.legacyPageContext)?e.headers["X-Debug-ExperimentalWTQ"]="true":e.headers["X-Debug-ExperimentalWTQ"]="false"))},a._allTopicsPageGuid="9833225a-d24b-4b9e-b16d-bba52bae6e23",a}(e.A),U=function(e){function a(t,n){void 0===n&&(n="SPPages.TopicPage.RelatedTopics");var a=e.call(this,t,void 0,n)||this;return a._graphDepth=1,a}return(0,t.__extends)(a,e),a.prototype.getTopicEntity=function(e,t,a){return void 0===t&&(t={}),n.Validate.isNotNullOrUndefined(e,"topicId"),this._language=a,(0,r.Fv)()?(this._topicId=e,this.getRequest().then(function(e){var t=e.value;return null==t?void 0:t[0]})):this.getRequest("&wholeTopicQualityModelVersion=V9&TopicsGraphDepth=1&id=".concat(e,"&").concat(this._generateQueryString(t))).then(function(e){var t=e.value;return null==t?void 0:t[0]})},a.prototype.setGraphDepth=function(e){this._graphDepth=e},Object.defineProperty(a.prototype,"qosTag",{get:function(){return"GetRelatedTopics"},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"apiName",{get:function(){return(0,r.Fv)()?"Topics/Ids":"Topics"},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"apiParams",{get:function(){return(0,r.Fv)()?"":"?provider=Yggdrasil"},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isPost",{get:function(){return(0,r.Fv)()},enumerable:!1,configurable:!0}),a.prototype.getCustomRequestOptions=function(n){e.prototype.getCustomRequestOptions.call(this,n),n.headers["X-Debug-EnableRelatedTopics"]="true",n.headers["X-Debug-EnableMultiHopRelatedTopics"]="true",(0,r.Fv)()&&(n.body=JSON.stringify({TopicIds:[this._topicId],RelatedTopics:(0,t.__assign)({TopicsGraphDepth:this._graphDepth,FocalTopicAdjacentTopics:6},(0,r.w1)()&&-1!==s.RQ.indexOf(this._providerType)&&{ProviderType:this._providerType})}))},a.prototype._generateQueryString=function(e){return new URLSearchParams(e).toString()},a}(e.A),F=E(5959),H=E.n(F),R=(E(8398),E(7976)),N=E(9408),B=E(6642),j=E(1962),V=E(9773),z=E(2141),G=E(3785),K=function(e){function n(t,n){var a,i,r,o,s,c=e.call(this,t)||this,d=t.consume(V.TopicDataService.serviceKey),u=t.consume(l.PageContext.serviceKey);return n&&(c.customData={topicId:n.Id,topicStatus:n.State,hasTopicDescription:Boolean(null===(i=null===(a=n.Definitions)||void 0===a?void 0:a[0])||void 0===i?void 0:i.Value),topicLifeCycleState:null===(r=n.LifeCycle)||void 0===r?void 0:r.State,topicSource:n.Source||"",topicRelevanceScore:n.RelevanceScore,pageLayout:"TopicPage",pageCulture:(null===(o=null==d?void 0:d.topicPageMultilingualInfo)||void 0===o?void 0:o.translationLanguage)||(null===(s=null==d?void 0:d.topicPageMultilingualInfo)||void 0===s?void 0:s.previewLanguage)||"",userCulture:u.cultureInfo.currentUICultureName,topicsCulture:u.web.languageName}),c}return(0,t.__extends)(n,e),n}(G.M);function W(e,t){return t||(t=e.consume(V.TopicDataService.serviceKey).currentTopic),new K(e,t)}var q=function(e){function n(t,n){var a,i,r,o,s,c=e.call(this,t)||this,d=t.consume(V.TopicDataService.serviceKey),u=t.consume(l.PageContext.serviceKey);return n&&(c.customData={topicId:n.Id,topicStatus:n.State,hasTopicDescription:Boolean(null===(i=null===(a=n.Definitions)||void 0===a?void 0:a[0])||void 0===i?void 0:i.Definition),topicLifeCycleState:null===(r=n.LifecycleState)||void 0===r?void 0:r.State,topicSource:n.Source||"",topicRelevanceScore:n.Score,pageLayout:"TopicPage",pageCulture:(null===(o=null==d?void 0:d.topicPageMultilingualInfo)||void 0===o?void 0:o.translationLanguage)||(null===(s=null==d?void 0:d.topicPageMultilingualInfo)||void 0===s?void 0:s.previewLanguage)||"",userCulture:u.cultureInfo.currentUICultureName,topicsCulture:u.web.languageName}),c}return(0,t.__extends)(n,e),n}(G.M),Q=E(5161),Y=function(e){function n(t){var n=e.call(this,t)||this;return n.state={error:void 0},n}return(0,t.__extends)(n,e),n.prototype.componentDidMount=function(){var e,t;!this.state.error&&this.props.isReadyToCompleteRender&&this.props.onRenderSuccess(),null===(t=(e=this.props).onDidMount)||void 0===t||t.call(e)},n.prototype.componentDidUpdate=function(e){!this.state.error&&this.props.isReadyToCompleteRender&&this.props.onRenderSuccess()},n.prototype.componentDidCatch=function(e,t){this.setState({error:e}),this.props.onRenderFailure(e)},n.prototype.render=function(){if(this.state.error)throw this.state.error;return this.props.children},n}(F.Component);function J(e,n,a){var i=new x._QosMonitor("".concat(a,".getLatestCurationAuthorProfile"));return n.then(function(n){return n.getPeopleInfo(e.upn||e.email).then(function(n){return i.writeSuccess(),(0,t.__assign)((0,t.__assign)({},e),{name:n.name||"",email:n.email||""})})}).catch(function(t){return i.writeUnexpectedFailure("GetProfileFailedUnexpected",t),e})}function X(e,t){return!(!e||!t)&&(e.upn&&e.upn===t.upn||e.email&&e.email===t.email)}function Z(e,t){(0,a.isEmpty)(e)||(0,a.isEmpty)(t)||e.forEach(function(n,i){var r;if(null===(r=n.curationDetails)||void 0===r?void 0:r.author){var o=(0,a.find)(t,function(e){return X(e,n.curationDetails.author)});o&&(e[i].curationDetails.author=o)}})}var $=E(8424);function ee(e){return"TopicsWebpartDidMountEvent_".concat(e)}$.loadStyles('.a_b_04103875{background-color:"[theme:bodyBackground, default: #ffffff]";border-radius:8px;margin-bottom:0;margin-top:20px;padding:20px}',!0);var te=function(e){function s(){var t=e.call(this)||this;return t.isSuggestedDataLoaded=!1,t.hasGotMaximumRelations=!1,t._hasUpdatedCurationAuthorPropertiesInEditMode=!1,t._updatedCurationAuthorProfiles=[],t.requestMaximumRelations=function(){var e;if(!t.hasGotMaximumRelations&&t.relationCountQueryParamKey){if(t.topicId&&t.topicId!==V.NULL_TOPIC_ENTITY.Id){var n=new x._QosMonitor("".concat(t.qosPrefix,".requestMaximumRelations"));return t._topicEntityDataProvider.getTopic(t.topicId,!0,(e={},e[t.relationCountQueryParamKey]=i.lO,e),(0,Q.wN)(t.context.serviceScope)).then(O.hK).then(function(e){t.hasGotMaximumRelations=!0,t.topicDataService.currentTopicEntity=e,t._feedSuggestedAndFeedbackDataToWebPart(e)}).then(function(){return n.writeSuccess({relationType:t.relationCountQueryParamKey}),i.lO}).catch(function(e){throw n.writeUnexpectedFailure("RequestMaximumRelationsFail",e,{stack:e.stack,relationType:t.relationCountQueryParamKey}),e})}return Promise.resolve(void 0)}return Promise.resolve(i.lO)},t._logRenderError=function(e,n){var a;null===(a=t._renderQosMonitor)||void 0===a||a.writeUnexpectedFailure(n||"FailedToRender",e,t._extraQosData(e))},t._logRenderSuccess=function(){var e;null===(e=t._renderQosMonitor)||void 0===e||e.writeSuccess(t._extraQosData())},t._handleTopicLoaded=function(e){var n=e.topic;if(!n||n.Id===t.topicId)try{t.isSuggestedDataLoaded=!0,s._currentTopicEntity=n,t._initializeEngagementLogger(n),t._feedSuggestedAndFeedbackDataToWebPart(n)}catch(e){t.renderCompleted(e)}},t._endPerfMarkWhenAllWebPartsAreReady=function(){t._isEveryTopicWebPartReadyInPerfLog()&&N._PerformanceLogger.endMarkForComponent("TopicPageLayoutComponent")},t._refreshCurationDetailsPeopleProfile=function(){var e,n,i,r;(0,a.isEmpty)(t.properties.curated)||(t._setUpdatedFlagInEditMode(),function(e,t,n){return Promise.all(e.map(function(e){return J(e,t,n)}))}((e=t.properties.curated,r=null!==(i=null===(n=null==e?void 0:e.map(function(e){var t;return null===(t=e.curationDetails)||void 0===t?void 0:t.author}))||void 0===n?void 0:n.filter(function(e){return!(0,a.isEmpty)(e)}))&&void 0!==i?i:[],(0,a.uniqBy)(r,function(e){return e.upn||e.email})),t.getPeopleDataProvider(),t.qosPrefix).then(function(e){!(0,o.S1)()&&t.isDisposed||e.length>0&&(t._updatedCurationAuthorProfiles=e,Z(t.properties.curated,e),t.render())}).catch(function(e){x._TraceLogger.logError(x._LogSource.create("".concat(t.qosPrefix,".UpdateCurationAuthorProfile")),e)}))},t._dispatchTopicPublishTeachingBubbleEvent=(0,a.debounce)(t._dispatchTopicPublishTeachingBubbleEvent,3e3),t}return(0,t.__extends)(s,e),s.prototype.render=function(){((0,o.U5)()||this&&this.domElement)&&(this.onUpdateAccessibleTitle(),this.webPartContext?R.render(F.createElement(this.webPartContext.Provider,{value:this.webPartContextData},this._renderContent()),this.domElement):R.render(this._renderContent(),this.domElement))},Object.defineProperty(s.prototype,"inheritedProperties",{get:function(){var e,t,n,a;if(this.context&&(null===(t=null===(e=this.topicDataService)||void 0===e?void 0:e.topicPageMultilingualInfo)||void 0===t?void 0:t.isTranslation)){var i=null===(a=null===(n=this.topicDataService)||void 0===n?void 0:n.inheritedWebPartsDataMap)||void 0===a?void 0:a.get(this.context.instanceId);return(null==i?void 0:i.properties)&&j._PropertyMetadataProcessor.reInstateServerProcessedData(this.propertiesMetadata,i.properties,i.serverProcessedContent,this.context.manifest),null==i?void 0:i.properties}},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"isOnTranslationPage",{get:function(){var e;return null===(e=this.topicDataService.topicPageMultilingualInfo)||void 0===e?void 0:e.isTranslation},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"showEditOnDefaultAction",{get:function(){return Boolean(this.displayMode===n.DisplayMode.Edit&&this.useInheritedPropertiesForTranslationPage&&this.isOnTranslationPage)},enumerable:!1,configurable:!0}),s.prototype.onUpdateRecentActivities=function(){},Object.defineProperty(s.prototype,"isWebPartEmpty",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"viewModeContainerClass",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"webPartContext",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"relationCountQueryParamKey",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"webPartContextData",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"useInheritedPropertiesForTranslationPage",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"disableEntityRelationsForTranslationPage",{get:function(){return!1},enumerable:!1,configurable:!0}),s.prototype.getRemovedItemsFromTopicEntity=function(e){},s.prototype.isReadyToCompleteRender=function(){return!this.isRenderAsync||this.isSuggestedDataLoaded},s.prototype.onInit=function(){var t=this;return this._renderQosMonitor=new x._QosMonitor("".concat(this.qosPrefix,".ComponentRender")),this.onInitInheritedProperties(),(0,o.kR)()&&this._registerTopicLoadedEventListener(),e.prototype.onInit.call(this).then(function(){!(0,o.jF)()&&t.isDisposed||(t.onAsyncUpdateAndRender(),(0,o.kR)()||t._registerTopicLoadedEventListener())})},s.prototype.onBeforeSerialize=function(){this.isOnTranslationPage&&((0,r.yn)()?this.disableEntityRelationsForTranslationPage:this.useInheritedPropertiesForTranslationPage)||(this.onUpdateEntityRelations(),(0,r.Bd)()&&this.onUpdateRecentActivities()),this._checkAddedCuratedAndDisplayFRE(),e.prototype.onBeforeSerialize.call(this)},s.prototype.onAfterDeserialize=function(e,t){return this.displayMode!==n.DisplayMode.Edit||this._hasUpdatedCurationAuthorPropertiesInEditMode||Z(e.curated,this._updatedCurationAuthorProfiles),this._setUpdatedFlagInEditMode(),e},s.prototype.onDispose=function(){e.prototype.onDispose.call(this),s._currentTopicEntity=void 0,s._afterLoadSuggestedListeners.clear(),this._unregisterTopicLoadedSPEventListeners()},s.prototype.getCurrentTopicEntity=function(){return s._currentTopicEntity?Promise.resolve(s._currentTopicEntity):Promise.resolve(void 0)},s.prototype.onUpdateAccessibleTitle=function(){if(this.displayMode===n.DisplayMode.Edit){var e=this.accessibleTitle||this._getDefaultAccessibleTitle();if(e){var t="cswpAccessibleLabelContextual_".concat(this.context.instanceId),a=this.domElement.querySelector("#".concat(t));a&&a.textContent!==e&&(a.textContent=e)}}},s.prototype.onAsyncUpdateAndRender=function(){!(0,o.S1)()&&this.isDisposed||this._refreshCurationDetailsPeopleProfile()},s.prototype.renderCompleted=function(t,n,a){this._firstRenderCompleteTime||(this._firstRenderCompleteTime=Date.now()),t?this._logRenderError(t,a):this._logRenderSuccess(),this._endPerfMarkWhenAllWebPartsAreReady(),e.prototype.renderCompleted.call(this,t,!!n)},Object.defineProperty(s.prototype,"isRenderAsync",{get:function(){return!0},enumerable:!1,configurable:!0}),s.prototype.isTopicPreviewPage=function(){return(0,S.cI)()},Object.defineProperty(s.prototype,"topicDataService",{get:function(){return this._topicDataService||(this._topicDataService=this.context.serviceScope.consume(V.TopicDataService.serviceKey)),this._topicDataService},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"initialRelationCount",{get:function(){return i.E3?i.lO:i.Kc},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"topicId",{get:function(){var e;return null===(e=this.topicDataService.currentTopicEntity)||void 0===e?void 0:e.Id},enumerable:!1,configurable:!0}),s.prototype.getPeopleDataProvider=function(){var e=this;return this._peopleDataProvider||(this._peopleDataProvider=C.load(this.qosPrefix).then(function(t){return new t(e.context.serviceScope,e.qosPrefix)})),this._peopleDataProvider},s.prototype.onInitInheritedProperties=function(){var e,t;this.isOnTranslationPage&&this.useInheritedPropertiesForTranslationPage&&(this.properties.curated=(null===(e=this.inheritedProperties)||void 0===e?void 0:e.curated)||[],this.properties.removed=(null===(t=this.inheritedProperties)||void 0===t?void 0:t.removed)||[])},s.prototype._dispatchTopicPublishTeachingBubbleEvent=function(){document.dispatchEvent(new CustomEvent(i.Oy.showTopicPublishTeachingBubbleEventName))},s.prototype._checkAddedCuratedAndDisplayFRE=function(){var e,t=this;if(this._firstRenderCompleteTime){var n=Date.now();(null===(e=this.properties.curated)||void 0===e?void 0:e.some(function(e){var a;if(!(null===(a=e.curationDetails)||void 0===a?void 0:a.time))return!1;var i=new Date(e.curationDetails.time).getTime();return n-i<5e3&&t._firstRenderCompleteTime<i}))&&this._dispatchTopicPublishTeachingBubbleEvent()}},s.prototype._renderContent=function(){var e=this;return this.onInitInheritedProperties(),F.createElement(Y,{isReadyToCompleteRender:this.isReadyToCompleteRender(),onRenderSuccess:this.renderCompleted,onRenderFailure:this.renderCompleted,onDidMount:function(){n._SPEventManager.instance.raiseEvent(ee(e.manifest.id),{})}},this.displayMode!==n.DisplayMode.Edit?!this.isWebPartEmpty&&F.createElement("div",{className:(0,z.css)("a_b_04103875",this.viewModeContainerClass)},this.contentElement):this.contentElement)},s.prototype._feedSuggestedAndFeedbackDataToWebPart=function(e){var t=e?this.getSuggestedItemsFromTopicEntity(e):void 0,n=e?this.getRemovedItemsFromTopicEntity(e):void 0;this.onAfterLoadSuggestedAndFeedback(t,n),this.render()},Object.defineProperty(s.prototype,"_topicEntityDataProvider",{get:function(){return this._substrateDataProvider||(this._substrateDataProvider=new k(this.context.serviceScope)),this._substrateDataProvider},enumerable:!1,configurable:!0}),s.prototype._extraQosData=function(e){return(0,t.__assign)({isSuggestedDataLoaded:this.isSuggestedDataLoaded},e&&{errorCode:e.name,errorMessage:e.message,errorStack:e.stack})},s.prototype._unregisterTopicLoadedSPEventListeners=function(){n._SPEventManager.instance.unregisterEvent(i.Oy.currentTopicLoadedEvent,this,this._handleTopicLoaded)},s.prototype._registerTopicLoadedEventListener=function(){n._SPEventManager.instance.registerEvent(i.Oy.currentTopicLoadedEvent,this,this._handleTopicLoaded)},s.prototype._initializeEngagementLogger=function(e){e&&(this.engagementLogger=new q(this.context.serviceScope,e))},s.prototype._isEveryTopicWebPartReadyInPerfLog=function(){var e=[];return N._PerformanceLogger.getExpectedControls().forEach(function(t){return e.push(t)}),[v.U.TITLE_REGION_WP_ID,v.U.OVERVIEW_RTE_INSTANCE_ID,v.U.RELATED_PEOPLE_WP_ID,v.U.GRAPH_WP_ID,v.U.RELATED_DOCS_WP_ID,v.U.RELATED_SITES_WP_ID].filter(function(e){return!!e}).every(function(t){return e.some(function(e){return e.indexOf(t)>-1})})},s.prototype._setUpdatedFlagInEditMode=function(){this.displayMode===n.DisplayMode.Edit&&(this._hasUpdatedCurationAuthorPropertiesInEditMode=!0)},s._afterLoadSuggestedListeners=new Map,s}(B.BaseClientSideWebPart),ne="MyTopicsFeedback",ae="".concat(ne,".DP"),ie=function(e){function a(t,a,i,r){var o;return e.call(this,t,{siteId:a.site.id,webId:a.web.id,listId:null===(o=a.list)||void 0===o?void 0:o.id,uniqueId:n.Guid.tryParse(i)||n.Guid.empty},r)||this}return(0,t.__extends)(a,e),a.initialize=function(e,t,n){return(0,S.hp)(e,ae).then(function(i){return new a(e,t,i||"",n)})},a.prototype.sendFeedback=function(t,n){var a;return e.prototype.processFeedback.call(this,t,{QuestionType:"IsPersonRelated",ResponseType:"ConfirmConnection"===n?"Yes":"No",RelatedEntity:{Type:"Person",Name:this.pageContext.user.displayName,EntityIdentity:{ObjectId:null===(a=this.pageContext.aadInfo)||void 0===a?void 0:a.userId.toString(),UserPrincipalName:this.pageContext.user.loginName}}})},Object.defineProperty(a.prototype,"qosTag",{get:function(){return ne},enumerable:!1,configurable:!0}),a}(D),re=E(4241),oe=E(8926);$.loadStyles('.j_c_04103875{border:0;padding:0}.j_c_04103875:hover{background-color:"[theme:neutralLighter, default: #f3f2f1]"}.j_c_04103875 .k_c_04103875{color:"[theme:themePrimary, default: #0078d4]"}',!0);const se=JSON.parse('{"D":"提供反馈","Q":"向项目发送电子邮件 Cortex 主题体验团队"}');var ce="projecthedleyfeedback@service.microsoft.com";function de(e){var n=e.topicId,a=e.topicName,i=e.pageContext,r=e.source,o=e.className,s=e.buttonStyles,c=e.mailSubject,d=e.mailBody,l=e.extraDebugStrings,u=e.onClickFeedback,f=F.useCallback(function(){x._EngagementLogger.logEventWithLogEntry(new x._LogEntry("TopicCard","CSIKM.TopicCard.GiveFeedbackEmail",x._LogType.Event,{topicId:n},!0))},[n]);return F.createElement(oe.DefaultButton,{iconProps:{iconName:"Emoji2",className:"k_c_04103875"},onClick:null!=u?u:f,href:(0,S.d6)({feedbackEmail:ce,topicId:n,topicName:a,buildNumber:N._Telemetry.buildNumber,source:r,pageContext:i,mailSubject:c,mailBody:d,extraDebugStrings:l}),className:(0,z.css)("j_c_04103875",o),title:se.Q,styles:(0,t.__assign)((0,t.__assign)({},s),{label:{fontWeight:"normal"}})},se.D)}var le=F.lazy(function(){return E.e(830).then(E.bind(E,7640))}),ue=F.forwardRef(function(e,n){return F.createElement(F.Suspense,{fallback:F.createElement(F.Fragment,null)},F.createElement(le,(0,t.__assign)({},e,{ref:n})))});function fe(e){return V.Icons.getIconUrl(e.split(".").pop()||"")}var pe=E(8418);function me(e,n,a,i,r){var o={};i&&(o.topicId=i,o.topicOrigin=(0,pe.A)(i)),r&&(o.topicCurated=r),x._EngagementLogger.logEventWithLogEntry(new x._LogEntry(n,e,x._LogType.Event,(0,t.__assign)((0,t.__assign)({},a),o),!0))}var _e=E(9061),he=E(7206),be=E(6563),ge=function(e){function n(t){var n=e.call(this,t,!1)||this;return n._pastDays=30,n}return(0,t.__extends)(n,e),n.prototype.getDashboardDataByLifecycleState=function(e){return this._managedTopicState=e,this.getRequest()},n.prototype.getDashboardData=function(e){return this._pastDays=null!=e?e:30,this.getRequest()},Object.defineProperty(n.prototype,"apiName",{get:function(){return(0,r._N)()?"Topics/ManagedDashboardV2":"Topics/ManagedDashboard"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"qosTag",{get:function(){return(0,r._N)()?"ManagedDashboard":"GetManagedDashboardByLifecycleState"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"xScenario",{get:function(){return"SPPages.TopicManagementV3.Dashboard"},enumerable:!1,configurable:!0}),n.prototype.getCustomRequestOptions=function(e){var t;(0,r._N)()?t={PastDays:this._pastDays}:(e.headers["X-ODataQuery"]="true",t={ManagedTopicState:this._managedTopicState,PastDays:this._pastDays}),e.body=JSON.stringify(t)},n}(e.A),ve=function(e){function n(t,n,a){void 0===n&&(n=!0);var i=e.call(this,t,n,a)||this;return i._language=i.pageContext.cultureInfo.currentUICultureName,i}return(0,t.__extends)(n,e),n.prototype.requestMyTopics=function(t,n){if(t&&(this._sortOption=t),n&&(this._sortDirection=n),(0,w.X)()){var a=this._getTABMockData();return Promise.resolve(a?JSON.parse(a):{CanEdit:!0,Suggested:[],Confirmed:[]})}return e.prototype.getRequest.call(this)},Object.defineProperty(n.prototype,"isPost",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"apiName",{get:function(){return"Topics/My"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"qosTag",{get:function(){return"GetMyTopics"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"apiParams",{get:function(){return""},enumerable:!1,configurable:!0}),n.prototype.getCustomRequestOptions=function(t){var n,a=new URL(window.location.href).searchParams;if((0,o.M2)()||"true"===(null!==(n=a.get("allowUnlicensedUsersInMyTopics"))&&void 0!==n?n:"false").toLowerCase()&&(t.headers["X-Debug-EnableMyTopicsForUnlicensedUsers"]="true"),this._sortOption&&this._sortDirection){var i={};i.Confirmed={Sort:{Field:this._sortOption,Direction:this._sortDirection}},t.body=JSON.stringify(i)}else e.prototype.getCustomRequestOptions.call(this,t)},n.prototype._getTABMockData=function(){return window.sessionStorage.getItem("MOCK_MY_TOPICS_RESPONSE")},n}(e.A),ye=E(9276),Se=E(8118);const De=JSON.parse('{"lL":"源 {0}","$1":"维基百科","l9":"CC-BY-SA 许可证相关文本"}');function Ie(e){return F.createElement(ye.Stack,{className:e.className},F.createElement(ye.Stack,null,e.source.title&&(e.source.url?F.createElement(V.RichTextFormatter,{template:De.lL,values:[F.createElement(Se.Link,{key:e.source.url,href:e.source.url,target:"_blank","data-interception":"off",title:e.source.title,onClick:e.onSourceClick},e.source.title)],className:"i_a_04103875"}):F.createElement("span",null,e.source.title))))}function xe(e){var t=e.stacked;return F.createElement(V.RichTextFormatter,{template:De.lL,className:(0,z.css)("a_a_04103875",e.className,t&&"b_a_04103875"),values:[F.createElement(Se.Link,{key:e.source.url,href:e.source.url,target:"_blank",title:e.source.url,className:"f_a_04103875"},De.$1),F.createElement(Se.Link,{key:"1",href:"https://creativecommons.org/licenses/by-sa/3.0/",target:"_blank",className:(0,z.css)(t?"h_a_04103875":"c_a_04103875","g_a_04103875")},De.l9)]})}function Ce(e){return F.createElement(ye.Stack,null,F.createElement("span",null,e.languageSourceMessage))}$.loadStyles(".a_a_04103875{display:flex}.a_a_04103875.b_a_04103875{display:block}[dir=ltr] .a_a_04103875 .c_a_04103875{margin-left:12px}[dir=rtl] .a_a_04103875 .c_a_04103875{margin-right:12px}[dir=ltr] .a_a_04103875 .e_a_04103875{margin-right:4px}[dir=ltr] .a_a_04103875 .f_a_04103875,[dir=rtl] .a_a_04103875 .e_a_04103875{margin-left:4px}[dir=rtl] .a_a_04103875 .f_a_04103875{margin-right:4px}.a_a_04103875 .g_a_04103875{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.a_a_04103875 .h_a_04103875{display:block}.i_a_04103875{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}",!0);var Oe=E(3372),we=E(4721);function Ee(e){var t=e.serviceScope,n=e.shouldShowError,a=e.requiredField;F.useEffect(function(){t.whenFinished(function(){t.consume(V.TopicDataService.serviceKey).missingRequiredFields[a]=n})},[t,n,a])}var Ae=E(9305);function Le(e,n){var i=(0,t.__read)(H().useState(""),2),o=i[0],c=i[1];return H().useEffect(function(){var i,o,d,l;e.curatedTypeId?(o=e.curatedTypeId,d=n,l=new URL(window.location.href).searchParams,(0,Ae.getTopicsSdk)(d,(0,Q.wN)(d)).then(function(e){return e.searchTopicsTypes(void 0,[o],void 0,void 0,{headers:(0,t.__assign)({},(0,r.hp)()&&l.has(s.rk)?{"X-Debug-KnowledgebasePipelineOverride":l.get(s.rk)}:{})}).then(function(e){return(null==e?void 0:e.length)?e[0].DisplayName:""})})).then(function(e){c(e)}).catch(a.noop):(0,S.cI)()&&e.currentTopicEntity.HasPrimaryType&&c((null===(i=(0,a.find)(e.currentTopicEntity.TopicTypes,"IsPrimary"))||void 0===i?void 0:i.DisplayName)||"")},[e.curatedTypeId,n,e.currentTopicEntity,e.topicPageMultilingualInfo]),o}var ke=E(7669);function Me(e,t,n,a){void 0===a&&(a=!0);var i=(0,Ae.tryGetTopicsSdk)();function r(e){e.logEvent(t,n,{isIntentional:a})}i?r(i):(0,Ae.getTopicsSdk)(e).then(r)}const Pe=JSON.parse('{"x6":"建议","ib":"已确认","Sz":"已发布","vT":"已删除","wO":"已合并","j9":"由 AI 标识的主题","Xx":"由 AI 标识的已批准主题","VJ":"手动创建或特选的主题","Eb":"主题被拒绝，对查看者不可见","c_":"已合并的主题，仅对知识管理员可见。"}');var Te={UserSuggested:"Suggested",Suggested:"Suggested",Confirmed:"Confirmed",Published:"Published",Removed:"Removed"},Ue={UserSuggested:Pe.x6,Suggested:Pe.x6,Confirmed:Pe.ib,Published:Pe.Sz,Removed:Pe.vT,Merged:Pe.wO},Fe={Suggested:Pe.j9,Confirmed:Pe.Xx,Published:Pe.VJ,Removed:Pe.Eb,Merged:Pe.c_},He={homePage:{layout:"KnowledgeCenterHomePageLayout",myTopics:"KnowledgeCenterMyTopics"},topicsManagement:{layout:"KnowledgeCenterTopicsManagementLayout",webPart:"KnowledgeCenterTopicsManagementWebPart"},topicsIntro:{layout:"KnowledgeCenterTopicsIntroLayout",canvas:"KnowledgeCenterTopicsIntroCanvas"}};function Re(e,t){return"linear-gradient(180deg, transparent 0%, ".concat(e," 40%), radial-gradient(56.32% 644.53% at -62.32% 50.43%, ").concat(e," 0%, ").concat(t," 1000%)")}var Ne=E(4706);function Be(e){return e.Title+(e.Extension?"."+e.Extension:"")}var je=function(e){function n(t,n){return e.call(this,t,void 0,n)||this}return(0,t.__extends)(n,e),n.prototype.getEventMetrics=function(e){return this._metricsRequest=e,this.getRequest()},Object.defineProperty(n.prototype,"qosTag",{get:function(){return"GetEventMetrics"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"apiName",{get:function(){return"Metrics"},enumerable:!1,configurable:!0}),n.prototype.getCustomRequestOptions=function(t){e.prototype.getCustomRequestOptions.call(this,t),t.body=JSON.stringify(this._metricsRequest)},n}(e.A);function Ve(e,t){n.Validate.isNotNullOrUndefined(e,"serviceScope"),n.Validate.isNotNullOrUndefined(t,"newEditors"),e.consume(V.VerifiedTopicAllowedEditorsService.serviceKey).editorsContainer=t}function ze(e){n.Validate.isNotNullOrUndefined(e,"serviceScope"),e.consume(V.VerifiedTopicAllowedEditorsService.serviceKey).editorsContainer=[]}function Ge(e,t){n.Validate.isNotNullOrUndefined(e,"serviceScope"),n.Validate.isNotNullOrUndefined(t,"newHiddenHighlights"),e.consume(V.HiddenHighlightsInfoService.serviceKey).spHiddenHighlightsMetadata=t}function Ke(e){n.Validate.isNotNullOrUndefined(e,"serviceScope"),e.consume(V.HiddenHighlightsInfoService.serviceKey).spHiddenHighlightsMetadata=[]}function We(e,t){n.Validate.isNotNullOrUndefined(e,"serviceScope"),n.Validate.isNotNullOrUndefined(t,"newHideListEditor"),e.consume(V.HiddenHighlightsInfoService.serviceKey).spHideListEditorMetadata=t}function qe(e){n.Validate.isNotNullOrUndefined(e,"serviceScope"),e.consume(V.HiddenHighlightsInfoService.serviceKey).spHideListEditorMetadata="null"}})(),L})())})();