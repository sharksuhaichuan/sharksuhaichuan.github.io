define("32b9363b-09ff-4959-929a-cab2663fb223_3.0.2",["tslib"],e=>(()=>{"use strict";var t={908:(e,t)=>{t.M=void 0;var n=function(){function e(e){void 0===e&&(e=[]),this.middlewareOptions=new Map;for(var t=0,n=e;t<n.length;t++){var a=n[t],i=a.constructor;this.middlewareOptions.set(i,a)}}return e.prototype.getMiddlewareOptions=function(e){return this.middlewareOptions.get(e)},e.prototype.setMiddlewareOptions=function(e,t){this.middlewareOptions.set(e,t)},e}();t.M=n}
,105:(e,t,n)=>{t.qr=void 0,n(280),t.qr=function(e,t,n,a){var i,r;"undefined"!=typeof Request&&e instanceof Request?e.headers.append(n,a):void 0!==t&&(void 0===t.headers?t.headers=new Headers(((i={})[n]=a,i)):"undefined"!=typeof Headers&&t.headers instanceof Headers?t.headers.append(n,a):t.headers instanceof Array?t.headers.push([n,a]):void 0===t.headers?t.headers=((r={})[n]=a,r):void 0===t.headers[n]?t.headers[n]=a:t.headers[n]+=", ".concat(a))}}
,280:t=>{t.exports=e}},n={};function a(e){var i=n[e];if(void 0!==i)return i.exports;var r=n[e]={exports:{}};return t[e](r,r.exports,a),r.exports}a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{a.r(i),a.d(i,{AuthenticationHandler:()=>I,AuthenticationHandlerOptions:()=>v,BatchRequestContent:()=>n,BatchResponseContent:()=>r,ChaosHandler:()=>T,ChaosHandlerOptions:()=>k,ChaosStrategy:()=>S,Client:()=>ee,CustomAuthenticationProvider:()=>Q,FeatureUsageFlag:()=>y,FileUpload:()=>z,GraphClientError:()=>s,GraphError:()=>Y,GraphRequest:()=>X,HTTPMessageHandler:()=>x,LargeFileUploadTask:()=>V,MiddlewareControl:()=>te.M,MiddlewareFactory:()=>L,OneDriveLargeFileUploadTask:()=>K,PageIterator:()=>q,Range:()=>B,RedirectHandler:()=>E,RedirectHandlerOptions:()=>w,ResponseType:()=>U,RetryHandler:()=>O,RetryHandlerOptions:()=>C,StreamUpload:()=>W,TelemetryHandler:()=>A,TelemetryHandlerOptions:()=>D,UploadResult:()=>j,appendRequestHeader:()=>ne.qr,getValidRangeSize:()=>G});var e,t=a(280);!function(e){e.GET="GET",e.PATCH="PATCH",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(e||(e={}));class n{constructor(e){if(this.requests=new Map,void 0!==e){const t=n.requestLimit;if(e.length>t){const e=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}for(const t of e)this.addRequest(t)}}static validateDependencies(e){if(0===e.size){const e=new Error("Empty requests map, Please provide at least one request.");throw e.name="Empty Requests Error",e}return(e=>{const t=e.entries();let n=t.next();for(;!n.done;){const e=n.value[1];if(void 0!==e.dependsOn&&e.dependsOn.length>0)return!1;n=t.next()}return!0})(e)||(e=>{const t=e.entries();let n=t.next();const a=n.value[1];if(void 0!==a.dependsOn&&a.dependsOn.length>0)return!1;let i=n;for(n=t.next();!n.done;){const e=n.value[1];if(void 0===e.dependsOn||1!==e.dependsOn.length||e.dependsOn[0]!==i.value[1].id)return!1;i=n,n=t.next()}return!0})(e)||(e=>{const t=e.entries();let n=t.next();const a=n.value[1];let i;if(void 0===a.dependsOn||0===a.dependsOn.length)i=a.id;else{if(1!==a.dependsOn.length)return!1;{const t=a.dependsOn[0];if(t===a.id||!e.has(t))return!1;i=t}}for(n=t.next();!n.done;){const e=n.value[1];if((void 0===e.dependsOn||0===e.dependsOn.length)&&i!==e.id)return!1;if(void 0!==e.dependsOn&&0!==e.dependsOn.length){if(1===e.dependsOn.length&&(e.id===i||e.dependsOn[0]!==i))return!1;if(e.dependsOn.length>1)return!1}n=t.next()}return!0})(e)}static getRequestData(a){return(0,t.__awaiter)(this,void 0,void 0,function*(){const t={url:""},i=new RegExp("^https?://");t.url=i.test(a.url)?"/"+a.url.split(/.*?\/\/.*?\//)[1]:a.url,t.method=a.method;const r={};return a.headers.forEach((e,t)=>{r[t]=e}),Object.keys(r).length&&(t.headers=r),a.method!==e.PATCH&&a.method!==e.POST&&a.method!==e.PUT||(t.body=yield n.getRequestBody(a)),t})}static getRequestBody(e){return(0,t.__awaiter)(this,void 0,void 0,function*(){let t,n=!1;try{const a=e.clone();t=yield a.json(),n=!0}catch(e){}if(!n)try{if("undefined"!=typeof Blob){const n=yield e.blob(),a=new FileReader;t=yield new Promise(e=>{a.addEventListener("load",()=>{const t=a.result,n=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(t);e(n[4])},!1),a.readAsDataURL(n)})}else"undefined"!=typeof Buffer&&(t=(yield e.buffer()).toString("base64"));n=!0}catch(e){}return t})}addRequest(e){const t=n.requestLimit;if(""===e.id){const e=new Error("Id for a request is empty, Please provide an unique id");throw e.name="Empty Id For Request",e}if(this.requests.size===t){const e=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}if(this.requests.has(e.id)){const t=new Error(`Adding request with duplicate id ${e.id}, Make the id of the requests unique`);throw t.name="Duplicate RequestId Error",t}return this.requests.set(e.id,e),e.id}removeRequest(e){const t=this.requests.delete(e),n=this.requests.entries();let a=n.next();for(;!a.done;){const t=a.value[1].dependsOn;if(void 0!==t){const n=t.indexOf(e);-1!==n&&t.splice(n,1),0===t.length&&delete a.value[1].dependsOn}a=n.next()}return t}getContent(){return(0,t.__awaiter)(this,void 0,void 0,function*(){const e=[],t={requests:e},a=this.requests.entries();let i=a.next();if(i.done){const e=new Error("No requests added yet, Please add at least one request.");throw e.name="Empty Payload",e}if(!n.validateDependencies(this.requests)){const e=new Error("Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.");throw e.name="Invalid Dependency",e}for(;!i.done;){const t=i.value[1],r=yield n.getRequestData(t.request);if(void 0!==r.body&&(void 0===r.headers||void 0===r.headers["content-type"])){const e=new Error(`Content-type header is not mentioned for request #${t.id}, For request having body, Content-type header should be mentioned`);throw e.name="Invalid Content-type header",e}r.id=t.id,void 0!==t.dependsOn&&t.dependsOn.length>0&&(r.dependsOn=t.dependsOn),e.push(r),i=a.next()}return t.requests=e,t})}addDependency(e,t){if(!this.requests.has(e)){const t=new Error(`Dependent ${e} does not exists, Please check the id`);throw t.name="Invalid Dependent",t}if(void 0!==t&&!this.requests.has(t)){const e=new Error(`Dependency ${t} does not exists, Please check the id`);throw e.name="Invalid Dependency",e}if(void 0!==t){const n=this.requests.get(e);if(void 0===n.dependsOn&&(n.dependsOn=[]),-1!==n.dependsOn.indexOf(t)){const n=new Error(`Dependency ${t} is already added for the request ${e}`);throw n.name="Duplicate Dependency",n}n.dependsOn.push(t)}else{const n=this.requests.entries();let a,i=n.next();for(;!i.done&&i.value[1].id!==e;)a=i,i=n.next();if(void 0===a){const e=new Error(`Can't add dependency ${t}, There is only a dependent request in the batch`);throw e.name="Invalid Dependency Addition",e}{const t=a.value[0];if(void 0===i.value[1].dependsOn&&(i.value[1].dependsOn=[]),-1!==i.value[1].dependsOn.indexOf(t)){const n=new Error(`Dependency ${t} is already added for the request ${e}`);throw n.name="Duplicate Dependency",n}i.value[1].dependsOn.push(t)}}}removeDependency(e,t){const n=this.requests.get(e);if(void 0===n||void 0===n.dependsOn||0===n.dependsOn.length)return!1;if(void 0!==t){const e=n.dependsOn.indexOf(t);return-1!==e&&(n.dependsOn.splice(e,1),!0)}return delete n.dependsOn,!0}}n.requestLimit=20;class r{constructor(e){this.responses=new Map,this.update(e)}createResponseObject(e){const t=e.body,n={};if(n.status=e.status,void 0!==e.statusText&&(n.statusText=e.statusText),n.headers=e.headers,void 0!==n.headers&&void 0!==n.headers["Content-Type"]&&"application/json"===n.headers["Content-Type"].split(";")[0]){const e=JSON.stringify(t);return new Response(e,n)}return new Response(t,n)}update(e){this.nextLink=e["@odata.nextLink"];const t=e.responses;for(let e=0,n=t.length;e<n;e++)this.responses.set(t[e].id,this.createResponseObject(t[e]))}getResponseById(e){return this.responses.get(e)}getResponses(){return this.responses}*getResponsesIterator(){const e=this.responses.entries();let t=e.next();for(;!t.done;)yield t.value,t=e.next()}}const o=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn","canary.graph.microsoft.com"]);class s extends Error{constructor(e){super(e),Object.setPrototypeOf(this,s.prototype)}static setGraphClientError(e){let t;return e instanceof Error?t=e:(t=new s,t.customError=e),t}}const c=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],d=e=>{const t=e&&e.constructor&&e.constructor.name;if("Buffer"===t||"Blob"===t||"File"===t||"FormData"===t||"string"==typeof e)return e;if("ArrayBuffer"===t)e=Buffer.from(e);else if("Int8Array"===t||"Int16Array"===t||"Int32Array"===t||"Uint8Array"===t||"Uint16Array"===t||"Uint32Array"===t||"Uint8ClampedArray"===t||"Float32Array"===t||"Float64Array"===t||"DataView"===t)e=Buffer.from(e.buffer);else try{e=JSON.stringify(e)}catch(e){throw new Error("Unable to stringify the content")}return e},l=e=>f(e),u=(e,t)=>(t.forEach(e=>p(e)),f(e,t)),f=(e,t=o)=>{if(-1!==(e=e.toLowerCase()).indexOf("https://")){const n=(e=e.replace("https://","")).indexOf(":"),a=e.indexOf("/");let i="";if(-1!==a)return-1!==n&&n<a?(i=e.substring(0,n),t.has(i)):(i=e.substring(0,a),t.has(i))}return!1},p=e=>{if(-1!==e.indexOf("/"))throw new s("Please add only hosts or hostnames to the CustomHosts config. If the url is `http://example.com:3000/`, host is `example:3000`")};class m{constructor(e=[]){this.middlewareOptions=new Map;for(const t of e){const e=t.constructor;this.middlewareOptions.set(e,t)}}getMiddlewareOptions(e){return this.middlewareOptions.get(e)}setMiddlewareOptions(e,t){this.middlewareOptions.set(e,t)}}const _=()=>{let e="";for(let t=0;t<32;t++)8!==t&&12!==t&&16!==t&&20!==t||(e+="-"),e+=Math.floor(16*Math.random()).toString(16);return e},h=(e,t,n)=>{let a=null;if("undefined"!=typeof Request&&e instanceof Request)a=e.headers.get(n);else if(void 0!==t&&void 0!==t.headers)if("undefined"!=typeof Headers&&t.headers instanceof Headers)a=t.headers.get(n);else if(t.headers instanceof Array){const e=t.headers;for(let t=0,i=e.length;t<i;t++)if(e[t][0]===n){a=e[t][1];break}}else void 0!==t.headers[n]&&(a=t.headers[n]);return a},b=(e,t,n,a)=>{if("undefined"!=typeof Request&&e instanceof Request)e.headers.set(n,a);else if(void 0!==t)if(void 0===t.headers)t.headers=new Headers({[n]:a});else if("undefined"!=typeof Headers&&t.headers instanceof Headers)t.headers.set(n,a);else if(t.headers instanceof Array){let e=0;const i=t.headers.length;for(;e<i;e++){const i=t.headers[e];if(i[0]===n){i[1]=a;break}}e===i&&t.headers.push([n,a])}else Object.assign(t.headers,{[n]:a})},g=(e,t,n,a)=>{"undefined"!=typeof Request&&e instanceof Request?e.headers.append(n,a):void 0!==t&&(void 0===t.headers?t.headers=new Headers({[n]:a}):"undefined"!=typeof Headers&&t.headers instanceof Headers?t.headers.append(n,a):t.headers instanceof Array?t.headers.push([n,a]):void 0===t.headers?t.headers={[n]:a}:void 0===t.headers[n]?t.headers[n]=a:t.headers[n]+=`, ${a}`)};class v{constructor(e,t){this.authenticationProvider=e,this.authenticationProviderOptions=t}}var y,S;!function(e){e[e.NONE=0]="NONE",e[e.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",e[e.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",e[e.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"}(y||(y={}));class D{constructor(){this.featureUsage=y.NONE}static updateFeatureUsageFlag(e,t){let n;e.middlewareControl instanceof m?n=e.middlewareControl.getMiddlewareOptions(D):e.middlewareControl=new m,void 0===n&&(n=new D,e.middlewareControl.setMiddlewareOptions(D,n)),n.setFeatureUsage(t)}setFeatureUsage(e){this.featureUsage=this.featureUsage|e}getFeatureUsage(){return this.featureUsage.toString(16)}}class I{constructor(e){this.authenticationProvider=e}execute(e){return(0,t.__awaiter)(this,void 0,void 0,function*(){const t="string"==typeof e.request?e.request:e.request.url;if(l(t)||e.customHosts&&u(t,e.customHosts)){let t,n,a;e.middlewareControl instanceof m&&(t=e.middlewareControl.getMiddlewareOptions(v)),t&&(n=t.authenticationProvider,a=t.authenticationProviderOptions),n||(n=this.authenticationProvider);const i=`Bearer ${yield n.getAccessToken(a)}`;g(e.request,e.options,I.AUTHORIZATION_HEADER,i),D.updateFeatureUsageFlag(e,y.AUTHENTICATION_HANDLER_ENABLED)}else e.options.headers&&delete e.options.headers[I.AUTHORIZATION_HEADER];return yield this.nextMiddleware.execute(e)})}setNext(e){this.nextMiddleware=e}}I.AUTHORIZATION_HEADER="Authorization";class x{execute(e){return(0,t.__awaiter)(this,void 0,void 0,function*(){e.response=yield fetch(e.request,e.options)})}}class C{constructor(e=C.DEFAULT_DELAY,t=C.DEFAULT_MAX_RETRIES,n=C.defaultShouldRetry){if(e>C.MAX_DELAY&&t>C.MAX_MAX_RETRIES){const e=new Error(`Delay and MaxRetries should not be more than ${C.MAX_DELAY} and ${C.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e>C.MAX_DELAY){const e=new Error(`Delay should not be more than ${C.MAX_DELAY}`);throw e.name="MaxLimitExceeded",e}if(t>C.MAX_MAX_RETRIES){const e=new Error(`MaxRetries should not be more than ${C.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e<0&&t<0){const e=new Error("Delay and MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}if(e<0){const e=new Error("Delay should not be negative");throw e.name="MinExpectationNotMet",e}if(t<0){const e=new Error("MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}this.delay=Math.min(e,C.MAX_DELAY),this.maxRetries=Math.min(t,C.MAX_MAX_RETRIES),this.shouldRetry=n}getMaxDelay(){return C.MAX_DELAY}}C.DEFAULT_DELAY=3,C.DEFAULT_MAX_RETRIES=3,C.MAX_DELAY=180,C.MAX_MAX_RETRIES=10,C.defaultShouldRetry=()=>!0;class O{constructor(e=new C){this.options=e}isRetry(e){return-1!==O.RETRY_STATUS_CODES.indexOf(e.status)}isBuffered(t,n){const a="string"==typeof t?n.method:t.method;return a!==e.PUT&&a!==e.PATCH&&a!==e.POST||"application/octet-stream"!==h(t,n,"Content-Type")}getDelay(e,t,n){const a=()=>Number(Math.random().toFixed(3)),i=void 0!==e.headers?e.headers.get(O.RETRY_AFTER_HEADER):null;let r;return r=null!==i?Number.isNaN(Number(i))?Math.round((new Date(i).getTime()-Date.now())/1e3):Number(i):t>=2?this.getExponentialBackOffTime(t)+n+a():n+a(),Math.min(r,this.options.getMaxDelay()+a())}getExponentialBackOffTime(e){return Math.round(.5*(Math.pow(2,e)-1))}sleep(e){return(0,t.__awaiter)(this,void 0,void 0,function*(){const t=1e3*e;return new Promise(e=>setTimeout(e,t))})}getOptions(e){let t;return e.middlewareControl instanceof m&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),void 0===t&&(t=Object.assign(new C,this.options)),t}executeWithRetry(e,n,a){return(0,t.__awaiter)(this,void 0,void 0,function*(){if(yield this.nextMiddleware.execute(e),n<a.maxRetries&&this.isRetry(e.response)&&this.isBuffered(e.request,e.options)&&a.shouldRetry(a.delay,n,e.request,e.options,e.response)){++n,b(e.request,e.options,O.RETRY_ATTEMPT_HEADER,n.toString());const t=this.getDelay(e.response,n,a.delay);return yield this.sleep(t),yield this.executeWithRetry(e,n,a)}})}execute(e){return(0,t.__awaiter)(this,void 0,void 0,function*(){const t=this.getOptions(e);return D.updateFeatureUsageFlag(e,y.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(e,0,t)})}setNext(e){this.nextMiddleware=e}}O.RETRY_STATUS_CODES=[429,503,504],O.RETRY_ATTEMPT_HEADER="Retry-Attempt",O.RETRY_AFTER_HEADER="Retry-After";class w{constructor(e=w.DEFAULT_MAX_REDIRECTS,t=w.defaultShouldRedirect){if(e>w.MAX_MAX_REDIRECTS){const e=new Error(`MaxRedirects should not be more than ${w.MAX_MAX_REDIRECTS}`);throw e.name="MaxLimitExceeded",e}if(e<0){const e=new Error("MaxRedirects should not be negative");throw e.name="MinExpectationNotMet",e}this.maxRedirects=e,this.shouldRedirect=t}}w.DEFAULT_MAX_REDIRECTS=5,w.MAX_MAX_REDIRECTS=20,w.defaultShouldRedirect=()=>!0;class E{constructor(e=new w){this.options=e}isRedirect(e){return-1!==E.REDIRECT_STATUS_CODES.indexOf(e.status)}hasLocationHeader(e){return e.headers.has(E.LOCATION_HEADER)}getLocationHeader(e){return e.headers.get(E.LOCATION_HEADER)}isRelativeURL(e){return-1===e.indexOf("://")}shouldDropAuthorizationHeader(e,t){const n=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,a=n.exec(e);let i,r;null!==a&&(i=a[0]);const o=n.exec(t);return null!==o&&(r=o[0]),void 0!==i&&void 0!==r&&i!==r}updateRequestUrl(e,n){return(0,t.__awaiter)(this,void 0,void 0,function*(){var a,i;n.request="string"==typeof n.request?e:yield(a=e,i=n.request,(0,t.__awaiter)(void 0,void 0,void 0,function*(){const e=i.headers.get("Content-Type")?yield i.blob():yield Promise.resolve(void 0),{method:t,headers:n,referrer:r,referrerPolicy:o,mode:s,credentials:c,cache:d,redirect:l,integrity:u,keepalive:f,signal:p}=i;return new Request(a,{method:t,headers:n,body:e,referrer:r,referrerPolicy:o,mode:s,credentials:c,cache:d,redirect:l,integrity:u,keepalive:f,signal:p})}))})}getOptions(e){let t;return e.middlewareControl instanceof m&&(t=e.middlewareControl.getMiddlewareOptions(w)),void 0===t&&(t=Object.assign(new w,this.options)),t}executeWithRedirect(n,a,i){return(0,t.__awaiter)(this,void 0,void 0,function*(){yield this.nextMiddleware.execute(n);const t=n.response;if(a<i.maxRedirects&&this.isRedirect(t)&&this.hasLocationHeader(t)&&i.shouldRedirect(t)){if(++a,t.status===E.STATUS_CODE_SEE_OTHER)n.options.method=e.GET,delete n.options.body;else{const e=this.getLocationHeader(t);!this.isRelativeURL(e)&&this.shouldDropAuthorizationHeader(t.url,e)&&delete n.options.headers[E.AUTHORIZATION_HEADER],yield this.updateRequestUrl(e,n)}yield this.executeWithRedirect(n,a,i)}})}execute(e){return(0,t.__awaiter)(this,void 0,void 0,function*(){const t=this.getOptions(e);return e.options.redirect=E.MANUAL_REDIRECT,D.updateFeatureUsageFlag(e,y.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(e,0,t)})}setNext(e){this.nextMiddleware=e}}E.REDIRECT_STATUS_CODES=[301,302,303,307,308],E.STATUS_CODE_SEE_OTHER=303,E.LOCATION_HEADER="Location",E.AUTHORIZATION_HEADER="Authorization",E.MANUAL_REDIRECT="manual";class A{execute(e){return(0,t.__awaiter)(this,void 0,void 0,function*(){const t="string"==typeof e.request?e.request:e.request.url;if(l(t)||e.customHosts&&u(t,e.customHosts)){let t=h(e.request,e.options,A.CLIENT_REQUEST_ID_HEADER);t||(t=_(),b(e.request,e.options,A.CLIENT_REQUEST_ID_HEADER,t));let n,a=`${A.PRODUCT_NAME}/3.0.2`;if(e.middlewareControl instanceof m&&(n=e.middlewareControl.getMiddlewareOptions(D)),n){const e=n.getFeatureUsage();a+=` (${A.FEATURE_USAGE_STRING}=${e})`}g(e.request,e.options,A.SDK_VERSION_HEADER,a)}else delete e.options.headers[A.CLIENT_REQUEST_ID_HEADER],delete e.options.headers[A.SDK_VERSION_HEADER];return yield this.nextMiddleware.execute(e)})}setNext(e){this.nextMiddleware=e}}A.CLIENT_REQUEST_ID_HEADER="client-request-id",A.SDK_VERSION_HEADER="SdkVersion",A.PRODUCT_NAME="graph-js",A.FEATURE_USAGE_STRING="featureUsage";class L{static getDefaultMiddlewareChain(e){const t=[],n=new I(e),a=new O(new C),i=new A,r=new x;if(t.push(n),t.push(a),"object"==typeof process){const e=new E(new w);t.push(e)}return t.push(i),t.push(r),t}}!function(e){e[e.MANUAL=0]="MANUAL",e[e.RANDOM=1]="RANDOM"}(S||(S={}));class k{constructor(e=S.RANDOM,t="Some error Happened",n,a,i,r){if(this.chaosStrategy=e,this.statusCode=n,this.statusMessage=t,this.chaosPercentage=void 0!==a?a:10,this.responseBody=i,this.headers=r,this.chaosPercentage>100)throw new Error("Error Pecentage can not be more than 100")}}const M={GET:[429,500,502,503,504],POST:[429,500,502,503,504,507],PUT:[429,500,502,503,504,507],PATCH:[429,500,502,503,504],DELETE:[429,500,502,503,504,507]},P={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Too Early",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",510:"Not Extended",511:"Network Authentication Required"};class T{constructor(e=new k,t){this.options=e,this.manualMap=t}createResponseHeaders(e,t,n){const a=e.headers?new Headers(e.headers):new Headers;return a.append("Cache-Control","no-store"),a.append("request-id",t),a.append("client-request-id",t),a.append("x-ms-ags-diagnostic",""),a.append("Date",n),a.append("Strict-Transport-Security",""),429===e.statusCode&&a.append("retry-after","3"),a}createResponseBody(e,t,n){if(e.responseBody)return e.responseBody;let a;return a=e.statusCode>=400?{error:{code:P[e.statusCode],message:e.statusMessage,innerError:{"request-id":t,date:n}}}:{},a}createResponse(e,t){const n=t.request,a=_(),i=new Date,r=this.createResponseHeaders(e,a,i.toString()),o=this.createResponseBody(e,a,i.toString()),s={url:n,status:e.statusCode,statusText:e.statusMessage,headers:r};t.response=new Response("string"==typeof o?o:JSON.stringify(o),s)}sendRequest(e,n){return(0,t.__awaiter)(this,void 0,void 0,function*(){this.setStatusCode(e,n.request,n.options.method),e.chaosStrategy===S.MANUAL&&!this.nextMiddleware||Math.floor(100*Math.random())<e.chaosPercentage?this.createResponse(e,n):this.nextMiddleware&&(yield this.nextMiddleware.execute(n))})}getRandomStatusCode(e){const t=M[e];return t[Math.floor(Math.random()*t.length)]}getRelativeURL(e){const t=/https?:\/\/graph\.microsoft\.com\/[^/]+(.+?)(\?|$)/;let n;return null!==t.exec(e)&&(n=t.exec(e)[1]),n}setStatusCode(e,t,n){if(e.chaosStrategy===S.MANUAL){if(void 0===e.statusCode){const a=this.getRelativeURL(t);void 0!==this.manualMap.get(a)?void 0!==this.manualMap.get(a).get(n)&&(e.statusCode=this.manualMap.get(a).get(n)):this.manualMap.forEach((t,i)=>{new RegExp(i+"$").test(a)&&void 0!==this.manualMap.get(i).get(n)&&(e.statusCode=this.manualMap.get(i).get(n))})}}else e.statusCode=this.getRandomStatusCode(n)}getOptions(e){let t;return e.middlewareControl instanceof m&&(t=e.middlewareControl.getMiddlewareOptions(k)),void 0===t&&(t=Object.assign(new k,this.options)),t}execute(e){return(0,t.__awaiter)(this,void 0,void 0,function*(){const t=this.getOptions(e);return yield this.sendRequest(t,e)})}setNext(e){this.nextMiddleware=e}}var U,F,H,R;!function(e){e.ARRAYBUFFER="arraybuffer",e.BLOB="blob",e.DOCUMENT="document",e.JSON="json",e.RAW="raw",e.STREAM="stream",e.TEXT="text"}(U||(U={})),function(e){e.TEXT_HTML="text/html",e.TEXT_XML="text/xml",e.APPLICATION_XML="application/xml",e.APPLICATION_XHTML="application/xhtml+xml"}(F||(F={})),function(e){e.TEXT_PLAIN="text/plain",e.APPLICATION_JSON="application/json"}(H||(H={})),function(e){e.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",e.IMAGE="^image\\/.+"}(R||(R={}));class N{static parseDocumentResponse(e,t){return"undefined"!=typeof DOMParser?new Promise((n,a)=>{e.text().then(e=>{try{const a=(new DOMParser).parseFromString(e,t);n(a)}catch(e){a(e)}})}):Promise.resolve(e.body)}static convertResponse(e,n){return(0,t.__awaiter)(this,void 0,void 0,function*(){if(204===e.status)return Promise.resolve();let t;const a=e.headers.get("Content-type");switch(n){case U.ARRAYBUFFER:t=yield e.arrayBuffer();break;case U.BLOB:t=yield e.blob();break;case U.DOCUMENT:t=yield N.parseDocumentResponse(e,F.TEXT_XML);break;case U.JSON:t=yield e.json();break;case U.STREAM:t=yield Promise.resolve(e.body);break;case U.TEXT:t=yield e.text();break;default:if(null!==a){const n=a.split(";")[0];t=new RegExp(R.DOCUMENT).test(n)?yield N.parseDocumentResponse(e,n):new RegExp(R.IMAGE).test(n)?e.blob():n===H.TEXT_PLAIN?yield e.text():n===H.APPLICATION_JSON?yield e.json():Promise.resolve(e.body)}else t=Promise.resolve(e.body)}return t})}static getResponse(e,n,a){return(0,t.__awaiter)(this,void 0,void 0,function*(){if(n===U.RAW)return Promise.resolve(e);{const t=yield N.convertResponse(e,n);if(!e.ok)throw t;if("function"!=typeof a)return t;a(null,t)}})}}class B{constructor(e=-1,t=-1){this.minValue=e,this.maxValue=t}}class j{constructor(e,t){this._location=t,this._responseBody=e}get location(){return this._location}set location(e){this._location=e}get responseBody(){return this._responseBody}set responseBody(e){this._responseBody=e}static CreateUploadResult(e,t){return new j(e,t.get("location"))}}class V{constructor(e,t,n,a={}){if(this.DEFAULT_FILE_SIZE=5242880,this.client=e,!t.sliceFile)throw new s("Please pass the FileUpload object, StreamUpload object or any custom implementation of the FileObject interface");this.file=t,this.file=t,a.rangeSize||(a.rangeSize=this.DEFAULT_FILE_SIZE),this.options=a,this.uploadSession=n,this.nextRange=new B(0,this.options.rangeSize-1)}static createUploadSession(e,n,a,i={}){return(0,t.__awaiter)(this,void 0,void 0,function*(){const t=yield e.api(n).headers(i).post(a);return{url:t.uploadUrl,expiry:new Date(t.expirationDateTime),isCancelled:!1}})}parseRange(e){const t=e[0];if(void 0===t||""===t)return new B;const n=t.split("-"),a=parseInt(n[0],10);let i=parseInt(n[1],10);return Number.isNaN(i)&&(i=this.file.size-1),new B(a,i)}updateTaskStatus(e){this.uploadSession.expiry=new Date(e.expirationDateTime),this.nextRange=this.parseRange(e.nextExpectedRanges)}getNextRange(){if(-1===this.nextRange.minValue)return this.nextRange;const e=this.nextRange.minValue;let t=e+this.options.rangeSize-1;return t>=this.file.size&&(t=this.file.size-1),new B(e,t)}sliceFile(e){if(console.warn("The LargeFileUploadTask.sliceFile() function has been deprecated and moved into the FileObject interface."),this.file.content instanceof ArrayBuffer||this.file.content instanceof Blob||this.file.content instanceof Uint8Array)return this.file.content.slice(e.minValue,e.maxValue+1);throw new s("The LargeFileUploadTask.sliceFile() function expects only Blob, ArrayBuffer or Uint8Array file content. Please note that the sliceFile() function is deprecated.")}upload(){return(0,t.__awaiter)(this,void 0,void 0,function*(){const e=this.options&&this.options.uploadEventHandlers;for(;!this.uploadSession.isCancelled;){const t=this.getNextRange();if(-1===t.maxValue){const e=new Error("Task with which you are trying to upload is already completed, Please check for your uploaded file");throw e.name="Invalid Session",e}const n=yield this.file.sliceFile(t),a=yield this.uploadSliceGetRawResponse(n,t,this.file.size);if(!a)throw new s("Something went wrong! Large file upload slice response is null.");const i=yield N.getResponse(a);if(201===a.status||200===a.status&&i.id)return j.CreateUploadResult(i,a.headers);const r={expirationDateTime:i.expirationDateTime||i.ExpirationDateTime,nextExpectedRanges:i.NextExpectedRanges||i.nextExpectedRanges};this.updateTaskStatus(r),e&&e.progress&&e.progress(t,e.extraCallbackParam)}})}uploadSlice(e,n,a){return(0,t.__awaiter)(this,void 0,void 0,function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":""+(n.maxValue-n.minValue+1),"Content-Range":`bytes ${n.minValue}-${n.maxValue}/${a}`,"Content-Type":"application/octet-stream"}).put(e)})}uploadSliceGetRawResponse(e,n,a){return(0,t.__awaiter)(this,void 0,void 0,function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":""+(n.maxValue-n.minValue+1),"Content-Range":`bytes ${n.minValue}-${n.maxValue}/${a}`,"Content-Type":"application/octet-stream"}).responseType(U.RAW).put(e)})}cancel(){return(0,t.__awaiter)(this,void 0,void 0,function*(){const e=yield this.client.api(this.uploadSession.url).responseType(U.RAW).delete();return 204===e.status&&(this.uploadSession.isCancelled=!0),e})}getStatus(){return(0,t.__awaiter)(this,void 0,void 0,function*(){const e=yield this.client.api(this.uploadSession.url).get();return this.updateTaskStatus(e),e})}resume(){return(0,t.__awaiter)(this,void 0,void 0,function*(){return yield this.getStatus(),yield this.upload()})}getUploadSession(){return this.uploadSession}}class z{constructor(e,t,n){if(this.content=e,this.name=t,this.size=n,!e||!t||!n)throw new s("Please provide the upload content, name of the file and size of the file")}sliceFile(e){return this.content.slice(e.minValue,e.maxValue+1)}}const G=(e=5242880)=>{const t=62914560;return e>t&&(e=t),(n=e)>327680&&(n=320*Math.floor(n/327680)*1024),n;var n};class K extends V{constructor(e,t,n,a){super(e,t,n,a)}static constructCreateSessionUrl(e,t=K.DEFAULT_UPLOAD_PATH){return e=e.trim(),""===(t=t.trim())&&(t="/"),"/"!==t[0]&&(t=`/${t}`),"/"!==t[t.length-1]&&(t=`${t}/`),`/me/drive/root:${t.split("/").map(e=>encodeURIComponent(e)).join("/")}${encodeURIComponent(e)}:/createUploadSession`}static getFileInfo(e,t){let n,a;if("undefined"!=typeof Blob&&e instanceof Blob)n=new File([e],t),a=n.size;else if("undefined"!=typeof File&&e instanceof File)n=e,a=n.size;else if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array){const t=e;a=t.byteLength,n=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}return{content:n,size:a}}static create(e,n,a){return(0,t.__awaiter)(this,void 0,void 0,function*(){if(!e||!n||!a)throw new s("Please provide the Graph client instance, file object and OneDriveLargeFileUploadOptions value");const t=a.fileName,i=K.getFileInfo(n,t),r=new z(i.content,t,i.size);return this.createTaskWithFileObject(e,r,a)})}static createTaskWithFileObject(e,n,a){return(0,t.__awaiter)(this,void 0,void 0,function*(){if(!e||!n||!a)throw new s("Please provide the Graph client instance, FileObject interface implementation and OneDriveLargeFileUploadOptions value");const t=K.constructCreateSessionUrl(a.fileName,a.path),i={fileName:a.fileName,fileDescription:a.fileDescription,conflictBehavior:a.conflictBehavior},r=yield K.createUploadSession(e,t,i),o=G(a.rangeSize);return new K(e,n,r,{rangeSize:o,uploadEventHandlers:a.uploadEventHandlers})})}static createUploadSession(e,n,a){const i=Object.create(null,{createUploadSession:{get:()=>super.createUploadSession}});return(0,t.__awaiter)(this,void 0,void 0,function*(){const t={item:{"@microsoft.graph.conflictBehavior":(null==a?void 0:a.conflictBehavior)||"rename",name:null==a?void 0:a.fileName,description:null==a?void 0:a.fileDescription}};return i.createUploadSession.call(this,e,n,t)})}commit(e,n="rename"){return(0,t.__awaiter)(this,void 0,void 0,function*(){const t={name:this.file.name,"@microsoft.graph.conflictBehavior":n,"@microsoft.graph.sourceUrl":this.uploadSession.url};return yield this.client.api(e).put(t)})}}K.DEFAULT_UPLOAD_PATH="/";class W{constructor(e,t,n){if(this.content=e,this.name=t,this.size=n,!e||!t||!n)throw new s("Please provide the Readable Stream content, name of the file and size of the file")}sliceFile(e){return(0,t.__awaiter)(this,void 0,void 0,function*(){let t=e.maxValue-e.minValue+1;const n=[];if(this.previousSlice){if(e.minValue<this.previousSlice.range.minValue)throw new s("An error occurred while uploading the stream. Please restart the stream upload from the first byte of the file.");if(e.minValue<this.previousSlice.range.maxValue){const a=this.previousSlice.range.minValue,i=this.previousSlice.range.maxValue;if(e.minValue===a&&e.maxValue===i)return this.previousSlice.fileSlice;if(e.maxValue===i)return this.previousSlice.fileSlice.slice(e.minValue,e.maxValue+1);n.push(this.previousSlice.fileSlice.slice(e.minValue,i+1)),t=e.maxValue-i}}if(!this.content||!this.content.readable)throw new s("Stream is not readable.");this.content.readableLength>=t?n.push(this.content.read(t)):n.push(yield this.readNBytesFromStream(t));const a=Buffer.concat(n);return this.previousSlice={fileSlice:a,range:e},a})}readNBytesFromStream(e){return new Promise((t,n)=>{const a=[];let i=e,r=0;this.content.on("end",()=>{if(i>0)return n(new s("Stream ended before reading required range size"))}),this.content.on("readable",()=>{let o;for(;r<e&&null!==(o=this.content.read(i));)r+=o.length,a.push(o),i>0&&(i=e-r);return r===e?t(Buffer.concat(a)):this.content&&this.content.readable?void 0:n(new s("Error encountered while reading the stream during the upload"))})})}}class q{constructor(e,t,n,a){this.client=e,this.collection=t.value,this.nextLink=t["@odata.nextLink"],this.deltaLink=t["@odata.deltaLink"],this.callback=n,this.complete=!1,this.requestOptions=a}iterationHelper(){if(void 0===this.collection)return!1;let e=!0;for(;e&&0!==this.collection.length;){const t=this.collection.shift();e=this.callback(t)}return e}fetchAndUpdateNextPageData(){return(0,t.__awaiter)(this,void 0,void 0,function*(){let e=this.client.api(this.nextLink);this.requestOptions&&(this.requestOptions.headers&&(e=e.headers(this.requestOptions.headers)),this.requestOptions.middlewareOptions&&(e=e.middlewareOptions(this.requestOptions.middlewareOptions)),this.requestOptions.options&&(e=e.options(this.requestOptions.options)));const t=yield e.get();this.collection=t.value,this.nextLink=t["@odata.nextLink"],this.deltaLink=t["@odata.deltaLink"]})}getDeltaLink(){return this.deltaLink}iterate(){return(0,t.__awaiter)(this,void 0,void 0,function*(){let e=this.iterationHelper();for(;e;)void 0!==this.nextLink?(yield this.fetchAndUpdateNextPageData(),e=this.iterationHelper()):e=!1;void 0===this.nextLink&&0===this.collection.length&&(this.complete=!0)})}resume(){return(0,t.__awaiter)(this,void 0,void 0,function*(){return this.iterate()})}isComplete(){return this.complete}}class Q{constructor(e){this.provider=e}getAccessToken(){return(0,t.__awaiter)(this,void 0,void 0,function*(){return new Promise((e,n)=>{this.provider((a,i)=>(0,t.__awaiter)(this,void 0,void 0,function*(){if(i)e(i);else{a||(a=new s("Access token is undefined or empty.\t\t\t\t\t\tPlease provide a valid token.\t\t\t\t\t\tFor more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md"));const e=yield s.setGraphClientError(a);n(e)}}))})})}}class Y extends Error{constructor(e=-1,t,n){super(t||n&&n.message),Object.setPrototypeOf(this,Y.prototype),this.statusCode=e,this.code=null,this.requestId=null,this.date=new Date,this.body=null,this.stack=n?n.stack:this.stack}}class J{static constructError(e,t){const n=new Y(t,"",e);return void 0!==e.name&&(n.code=e.name),n.body=e.toString(),n.date=new Date,n}static constructErrorFromResponse(e,t){const n=e.error,a=new Y(t,n.message);return a.code=n.code,void 0!==n.innerError&&(a.requestId=n.innerError["request-id"],a.date=new Date(n.innerError.date)),a.body=JSON.stringify(n),a}static getError(e=null,n=-1,a){return(0,t.__awaiter)(this,void 0,void 0,function*(){let t;if(e&&e.error?t=J.constructErrorFromResponse(e,n):e instanceof Error?t=J.constructError(e,n):(t=new Y(n),t.body=e),"function"!=typeof a)return t;a(t,null)})}}class X{constructor(e,t,n){this.parsePath=e=>{if(-1!==e.indexOf("https://")){const t=(e=e.replace("https://","")).indexOf("/");-1!==t&&(this.urlComponents.host="https://"+e.substring(0,t),e=e.substring(t+1,e.length));const n=e.indexOf("/");-1!==n&&(this.urlComponents.version=e.substring(0,n),e=e.substring(n+1,e.length))}"/"===e.charAt(0)&&(e=e.substr(1));const t=e.indexOf("?");if(-1===t)this.urlComponents.path=e;else{this.urlComponents.path=e.substr(0,t);const n=e.substring(t+1,e.length).split("&");for(const e of n)this.parseQueryParameter(e)}},this.httpClient=e,this.config=t,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(n)}addCsvQueryParameter(e,t,n){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";let a=[];n.length>1&&"string"==typeof t?a=Array.prototype.slice.call(n):"string"==typeof t?a.push(t):a=a.concat(t),this.urlComponents.oDataQueryParams[e]+=a.join(",")}buildFullUrl(){const e=(e=>{const t=e=>e.replace(/^\/+/,"");return Array.prototype.slice.call(e).reduce((e,n)=>{return[(a=e,a.replace(/\/+$/,"")),t(n)].join("/");var a})})([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}createQueryString(){const e=this.urlComponents,t=[];if(0!==Object.keys(e.oDataQueryParams).length)for(const n in e.oDataQueryParams)Object.prototype.hasOwnProperty.call(e.oDataQueryParams,n)&&t.push(n+"="+e.oDataQueryParams[n]);if(0!==Object.keys(e.otherURLQueryParams).length)for(const n in e.otherURLQueryParams)Object.prototype.hasOwnProperty.call(e.otherURLQueryParams,n)&&t.push(n+"="+e.otherURLQueryParams[n]);if(0!==e.otherURLQueryOptions.length)for(const n of e.otherURLQueryOptions)t.push(n);return t.length>0?"?"+t.join("&"):""}parseQueryParameter(e){if("string"==typeof e)if("?"===e.charAt(0)&&(e=e.substring(1)),-1!==e.indexOf("&")){const t=e.split("&");for(const e of t)this.parseQueryParamenterString(e)}else this.parseQueryParamenterString(e);else if(e.constructor===Object)for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&this.setURLComponentsQueryParamater(t,e[t]);return this}parseQueryParamenterString(e){if(this.isValidQueryKeyValuePair(e)){const t=e.indexOf("="),n=e.substring(0,t),a=e.substring(t+1);this.setURLComponentsQueryParamater(n,a)}else this.urlComponents.otherURLQueryOptions.push(e)}setURLComponentsQueryParamater(e,t){if(-1!==c.indexOf(e)){const n=this.urlComponents.oDataQueryParams[e],a=n&&("$expand"===e||"$select"===e||"$orderby"===e);this.urlComponents.oDataQueryParams[e]=a?n+","+t:t}else this.urlComponents.otherURLQueryParams[e]=t}isValidQueryKeyValuePair(e){const t=e.indexOf("=");return-1!==t&&!(-1!==e.indexOf("(")&&e.indexOf("(")<t)}updateRequestOptions(e){const t=Object.assign({},e.headers);if(void 0!==this.config.fetchOptions){const t=Object.assign({},this.config.fetchOptions);Object.assign(e,t),void 0!==typeof this.config.fetchOptions.headers&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),void 0!==e.headers&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}send(e,n,a){var i;return(0,t.__awaiter)(this,void 0,void 0,function*(){let t;const r=new m(this._middlewareOptions);this.updateRequestOptions(n);const o=null===(i=this.config)||void 0===i?void 0:i.customHosts;try{return t=(yield this.httpClient.sendRequest({request:e,options:n,middlewareControl:r,customHosts:o})).response,yield N.getResponse(t,this._responseType,a)}catch(e){if(e instanceof s)throw e;let n;throw t&&(n=t.status),yield J.getError(e,n,a)}})}setHeaderContentType(){if(!this._headers)return void this.header("Content-Type","application/json");const e=Object.keys(this._headers);for(const t of e)if("content-type"===t.toLowerCase())return;this.header("Content-Type","application/json")}header(e,t){return this._headers[e]=t,this}headers(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._headers[t]=e[t]);return this}option(e,t){return this._options[e]=t,this}options(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._options[t]=e[t]);return this}middlewareOptions(e){return this._middlewareOptions=e,this}version(e){return this.urlComponents.version=e,this}responseType(e){return this._responseType=e,this}select(e){return this.addCsvQueryParameter("$select",e,arguments),this}expand(e){return this.addCsvQueryParameter("$expand",e,arguments),this}orderby(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}filter(e){return this.urlComponents.oDataQueryParams.$filter=e,this}search(e){return this.urlComponents.oDataQueryParams.$search=e,this}top(e){return this.urlComponents.oDataQueryParams.$top=e,this}skip(e){return this.urlComponents.oDataQueryParams.$skip=e,this}skipToken(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}count(e=!0){return this.urlComponents.oDataQueryParams.$count=e.toString(),this}query(e){return this.parseQueryParameter(e)}get(n){return(0,t.__awaiter)(this,void 0,void 0,function*(){const t=this.buildFullUrl(),a={method:e.GET};return yield this.send(t,a,n)})}post(n,a){return(0,t.__awaiter)(this,void 0,void 0,function*(){const t=this.buildFullUrl(),i={method:e.POST,body:d(n)};return"FormData"===(n&&n.constructor&&n.constructor.name)?i.headers={}:(this.setHeaderContentType(),i.headers=this._headers),yield this.send(t,i,a)})}create(e,n){return(0,t.__awaiter)(this,void 0,void 0,function*(){return yield this.post(e,n)})}put(n,a){return(0,t.__awaiter)(this,void 0,void 0,function*(){const t=this.buildFullUrl();this.setHeaderContentType();const i={method:e.PUT,body:d(n)};return yield this.send(t,i,a)})}patch(n,a){return(0,t.__awaiter)(this,void 0,void 0,function*(){const t=this.buildFullUrl();this.setHeaderContentType();const i={method:e.PATCH,body:d(n)};return yield this.send(t,i,a)})}update(e,n){return(0,t.__awaiter)(this,void 0,void 0,function*(){return yield this.patch(e,n)})}delete(n){return(0,t.__awaiter)(this,void 0,void 0,function*(){const t=this.buildFullUrl(),a={method:e.DELETE};return yield this.send(t,a,n)})}del(e){return(0,t.__awaiter)(this,void 0,void 0,function*(){return yield this.delete(e)})}getStream(n){return(0,t.__awaiter)(this,void 0,void 0,function*(){const t=this.buildFullUrl(),a={method:e.GET};return this.responseType(U.STREAM),yield this.send(t,a,n)})}putStream(n,a){return(0,t.__awaiter)(this,void 0,void 0,function*(){const t=this.buildFullUrl(),i={method:e.PUT,headers:{"Content-Type":"application/octet-stream"},body:n};return yield this.send(t,i,a)})}}class Z{constructor(...e){if(!e||!e.length){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Please provide a default middleware chain or custom middleware chain",e}this.setMiddleware(...e)}setMiddleware(...e){e.length>1?this.parseMiddleWareArray(e):this.middleware=e[0]}parseMiddleWareArray(e){e.forEach((t,n)=>{n<e.length-1&&t.setNext(e[n+1])}),this.middleware=e[0]}sendRequest(e){return(0,t.__awaiter)(this,void 0,void 0,function*(){if("string"==typeof e.request&&void 0===e.options){const e=new Error;throw e.name="InvalidRequestOptions",e.message="Unable to execute the middleware, Please provide valid options for a request",e}return yield this.middleware.execute(e),e})}}class ${static createWithAuthenticationProvider(e){const t=new I(e),n=new O(new C),a=new A,i=new x;if(t.setNext(n),"object"==typeof process){const e=new E(new w);n.setNext(e),e.setNext(a)}else n.setNext(a);return a.setNext(i),$.createWithMiddleware(t)}static createWithMiddleware(...e){return new Z(...e)}}class ee{constructor(e){this.config={baseUrl:"https://graph.microsoft.com/",debugLogging:!1,defaultVersion:"v1.0"},(()=>{if("undefined"==typeof Promise&&"undefined"==typeof fetch){const e=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof Promise){const e=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof fetch){const e=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}})();for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this.config[t]=e[t]);let t;if(void 0!==e.authProvider&&void 0!==e.middleware){const e=new Error;throw e.name="AmbiguityInInitialization",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",e}if(void 0!==e.authProvider)t=$.createWithAuthenticationProvider(e.authProvider);else{if(void 0===e.middleware){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",e}t=new Z(...[].concat(e.middleware))}this.httpClient=t}static init(e){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]="authProvider"===n?new Q(e[n]):e[n]);return ee.initWithMiddleware(t)}static initWithMiddleware(e){return new ee(e)}api(e){return new X(this.httpClient,this.config,e)}}var te=a(908),ne=a(105)})(),i})());