(()=>{var e=document.currentScript;define("16dc6880-3e5b-4b96-b33f-13ed051a642b_0.1.0",["react","@ms/sp-fluentui-v9-utilities-bundle","tslib","@microsoft/sp-core-library","@microsoft/sp-http","@microsoft/microsoft-graph-client","@ms/odsp-utilities-bundle","@microsoft/sp-http-base","@microsoft/sp-page-context","@microsoft/sp-lodash-subset","@ms/sp-fluentui-v9-react-image-bundle","@ms/sp-fluentui-v9-react-spinner-bundle","@ms/sp-fluentui-v9-react-text-bundle","@ms/sp-fluentui-v9-react-button-bundle","@ms/sp-fluentui-v9-react-combobox-bundle","@ms/sp-fluentui-v9-react-tabs-bundle","@ms/sp-fluentui-v9-react-divider-bundle","@ms/sp-fluentui-v9-react-search-bundle","@ms/sp-fluentui-v9-react-tooltip-bundle","@ms/sp-fluentui-v9-react-popover-bundle","@ms/odsp-core-bundle","@ms/sp-fluentui-v9-react-positioning-bundle","@ms/sp-fluentui-v9-react-tags-bundle","@ms/sp-fluentui-v9-react-tag-picker-bundle"],(t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D,I,x)=>(()=>{var C,O={748:(e,t,n)=>{var a=n(698);e.exports=a.OdspErrorHelper}
,856:(e,t,n)=>{var a=n(698);e.exports=a.PairedEventBase}
,658:e=>{"use strict";e.exports=o},676:e=>{"use strict";e.exports=i},909:e=>{"use strict";e.exports=r},737:e=>{"use strict";e.exports=c},529:e=>{"use strict";e.exports=l},408:e=>{"use strict";e.exports=d},698:e=>{"use strict";e.exports=S},939:e=>{"use strict";e.exports=s},533:e=>{"use strict";e.exports=m},908:e=>{"use strict";e.exports=_},538:e=>{"use strict";e.exports=b},822:e=>{"use strict";e.exports=u},670:e=>{"use strict";e.exports=y},214:e=>{"use strict";e.exports=D},565:e=>{"use strict";e.exports=g},614:e=>{"use strict";e.exports=f},837:e=>{"use strict";e.exports=h},190:e=>{"use strict";e.exports=x},194:e=>{"use strict";e.exports=I},144:e=>{"use strict";e.exports=p},76:e=>{"use strict";e.exports=v},215:e=>{"use strict";e.exports=n},959:e=>{"use strict";e.exports=t},280:e=>{"use strict";e.exports=a}},w={};function E(e){var t=w[e];if(void 0!==t)return t.exports;var n=w[e]={exports:{}};return O[e](n,n.exports,E),n.exports}E.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return E.d(t,{a:t}),t},E.d=(e,t)=>{for(var n in t)E.o(t,n)&&!E.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},E.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),E.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},C=e?e.src:"",E.p=C.slice(0,C.lastIndexOf("/")+1);var A={};return(()=>{"use strict";E.r(A),E.d(A,{AttachmentIconSize:()=>be,AttachmentPicker:()=>we,AttachmentPickerTabs:()=>n,AttachmentType:()=>t,Attachments:()=>Mn,AttachmentsIcon:()=>ye,MeetingSeriesAttachments:()=>zn,MeetingType:()=>a,SensitivityLabel:()=>kn,SensitivityLabelsContextProvider:()=>On,useAttachments:()=>Vn,useSensitivityLabel:()=>En});var e={};E.r(e),E.d(e,{optionalDiagnostic:()=>ct,requiredDiagnostic:()=>st,requiredService:()=>dt});var t,n,a,i,r={};E.r(r),E.d(r,{indexedDB:()=>Mt,localStorage:()=>kt,none:()=>Pt}),function(e){e[e.File=0]="File",e[e.Meeting=1]="Meeting",e[e.MeetingSeries=2]="MeetingSeries",e[e.Markdown=3]="Markdown"}(t||(t={})),function(e){e.All="All",e.Files="Files",e.Meetings="Meetings",e.MeetingSeries="Meeting series"}(n||(n={})),function(e){e.Occurrence="occurrence",e.Single="single",e.Exception="exception"}(a||(a={})),function(e){e[e.Querying=0]="Querying",e[e.Succeed=1]="Succeed",e[e.Failed=2]="Failed"}(i||(i={}));var o=E(959),s=E.n(o),c=E(670),d=E(215),l=(0,d.makeStyles)({popoverSurface:{padding:0}}),u=E(280);const f=JSON.parse('{"fG":"{0} modified at {1}","UF":"Modified at {0}","gm":"{0} • {1}","Lq":"{0} • {1} • Recorded","q$":"Search","iq":"Load More","nF":"No suggestions available","kz":"You have reached the end","ki":"Clear and try a different search","HT":"Search results","Wi":"Dismiss"}');var p=E(837),m=E(538),_=E(565),h=E(76),b=(0,d.makeStyles)({searchContainer:{display:"flex",flexDirection:"column",width:"440px"},referenceContainer:{display:"flex",flexDirection:"column",padding:"0 12px",gap:"2px"},referenceSearchBox:{padding:"0px 10px 0 10px"},referenceSearchBoxPlaceholder:{"&::placeholder":{color:"var(--colorNeutralForeground3)"}},suggestionContainer:{display:"flex",flexDirection:"column",padding:"6px",gap:"2px"},suggestionItemContainer:{display:"flex",flexDirection:"column",maxHeight:"184px",overflowY:"auto"},divider:{width:"100%",padding:"0px 0 12px 0"},TabContainer:{alignItems:"flex-start",display:"flex",flexDirection:"column",justifyContent:"flex-start",rowGap:"20px"}}),g=E(676);const v=o.createContext(void 0),y={},S=(v.Provider,(0,d.__styles)({root:{mc9l5x:"f1w7gpdv",Bg96gwp:"fez10in",ycbfsm:"fg4l7m0"},rtl:{Bz10aip:"f13rod7r"}},{d:[".f1w7gpdv{display:inline;}",".fez10in{line-height:0;}",".f13rod7r{-webkit-transform:scaleX(-1);-moz-transform:scaleX(-1);-ms-transform:scaleX(-1);transform:scaleX(-1);}"],t:["@media (forced-colors: active){.fg4l7m0{forced-color-adjust:auto;}}"]})),D=(e,t)=>{const{title:n,primaryFill:a="currentColor",...i}=e,r={...i,title:void 0,fill:a},s=S(),c=o.useContext(v)?o.useContext(v):y;return r.className=(0,d.mergeClasses)(s.root,(null==t?void 0:t.flipInRtl)&&"rtl"===(null==c?void 0:c.textDirection)&&s.rtl,r.className),n&&(r["aria-label"]=n),r["aria-label"]||r["aria-labelledby"]?r.role="img":r["aria-hidden"]=!0,r},I=(e,t,n,a)=>{const i="1em"===t?"20":t,r=o.forwardRef((e,r)=>{const s={...D(e,{flipInRtl:null==a?void 0:a.flipInRtl}),ref:r,width:t,height:t,viewBox:`0 0 ${i} ${i}`,xmlns:"http://www.w3.org/2000/svg"};return o.createElement("svg",s,...n.map(e=>o.createElement("path",{d:e,fill:s.fill})))});return r.displayName=e,r},x=I("DismissRegular","1em",["m4.09 4.22.06-.07a.5.5 0 0 1 .63-.06l.07.06L10 9.29l5.15-5.14a.5.5 0 0 1 .63-.06l.07.06c.18.17.2.44.06.63l-.06.07L10.71 10l5.14 5.15c.18.17.2.44.06.63l-.06.07a.5.5 0 0 1-.63.06l-.07-.06L10 10.71l-5.15 5.14a.5.5 0 0 1-.63.06l-.07-.06a.5.5 0 0 1-.06-.63l.06-.07L9.29 10 4.15 4.85a.5.5 0 0 1-.06-.63l.06-.07-.06.07Z"]);var C=E(908),O=E(614),w=E(144),L=E(909),k=E(658),M=function(){function e(e){this._graphClientFactory=e.consume(L.MSGraphClientFactory.serviceKey),this._graphClientPromise=this._graphClientFactory.getClientInternal("3")}return e.prototype.requestData=function(e){return(0,u.__awaiter)(this,void 0,void 0,function(){var t,a;return(0,u.__generator)(this,function(i){switch(i.label){case 0:if(e.searchingContentType!==n.Files)return[3,5];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this._postSearchData(e)];case 2:return t=i.sent(),a=this._handlePaginationInfo(e,t),[2,{attachments:this._processSearchedDriveItemData(t,e),nextPaginationInfo:a}];case 3:return i.sent(),[2,{attachments:[],nextPaginationInfo:e.paginationInfo}];case 4:return[3,6];case 5:throw new Error("Invalid search ".concat(e.searchingContentType));case 6:return[2]}})})},e.prototype._handlePaginationInfo=function(e,t){var n=e.paginationInfo;if(null!=t&&null!=t.value&&t.value.length>0&&t.value[0].hitsContainers.length>0&&t.value[0].hitsContainers[0].moreResultsAvailable){var a=n.skip+20;return(0,u.__assign)((0,u.__assign)({},n),{skip:a,canLoadMore:!0,isLoading:!1})}return(0,u.__assign)((0,u.__assign)({},n),{canLoadMore:!1,isLoading:!1})},e.prototype._processSearchedDriveItemData=function(e,n){var a;if(null===(a=n.abortSignal)||void 0===a?void 0:a.aborted){var i=new Error("action is aborted");throw i.name="AbortError",i}if(0===e.value.length)return[];if(e.value[0].hitsContainers&&0===e.value[0].hitsContainers.length)return[];var r=e.value[0].hitsContainers[0];return r&&0===r.total?[]:r.hits.map(function(e){return e.resource}).map(function(e){var n,a;return{type:t.File,id:e.id,name:e.name,sharepointIds:{uniqueId:e.listItem.fields.uniqueId,driveId:e.listItem.fields.driveId,listId:e.listItem.fields.listId,listItemUniqueId:e.listItem.fields.uniqueId,webId:e.listItem.fields.webId,siteId:e.listItem.fields.siteId,webUrl:e.webUrl},extension:(null===(a=null===(n=e.name)||void 0===n?void 0:n.split("."))||void 0===a?void 0:a.pop())||"",createdBy:e.createdBy,createdDateTime:e.createdDateTime,lastModifiedBy:e.lastModifiedBy,lastModifiedDateTime:e.lastModifiedDateTime}})},e.prototype._postSearchData=function(e){var t=this._buildPostBody(e);return this._graphClientPromise.then(function(e){return e.api("search/query").responseType(k.ResponseType.JSON).post(t)})},e.prototype._buildPostBody=function(e){var t=e,n=t.queryString,a=t.extensions,i=t.ignoredAttachmentsIds,r=t.paginationInfo,o=["({searchterms})"];if(a.length>0){var s=a.map(function(e){return"FileExtension:".concat(e)}).join(" OR ");o.push("(".concat(s,")"))}if(i.length>0){var c=i.filter(function(e){return!!e}).map(function(e){return"NOT(UniqueId:".concat(e,")")}).join(" AND ");o.push("(".concat(c,")"))}return JSON.stringify({requests:[{entityTypes:["driveItem"],query:{queryString:n,queryTemplate:o.join(" AND ")},from:r.skip,size:20,fields:["id","name","webUrl","uniqueId","driveId","listId","listItemId","webId","siteId","createdBy","createdDateTime","lastModifiedBy","lastModifiedDateTime"]}]})},e}(),P=E(939),T=function(e,t){return void 0===t&&(t=void 0),(t=t||new Date).setDate(t.getDate()+e),t.setHours(0,0,0,0),t},U=function(e){var t=e.match(/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})/);return t?t[0]+"Z":e},F=function(e){switch(e.type){case t.Meeting:return new Date(U(e.start.dateTime));case t.MeetingSeries:return new Date(U(e.meetings[0].start.dateTime));case t.File:return new Date(e.lastModifiedDateTime);default:throw new Error("Unsupported attachment type")}},H=function(e){return""===e.trim()?{startDateTime:T(-30).toISOString(),endDateTime:T(1).toISOString(),skip:0,canLoadMore:!1,isLoading:!1}:{startDateTime:T(-180).toISOString(),endDateTime:T(1).toISOString(),skip:0,canLoadMore:!1,isLoading:!1}},R=function(){function e(e){this._graphClientFactory=e.consume(L.MSGraphClientFactory.serviceKey),this._graphClientPromise=this._graphClientFactory.getClientInternal("3")}return e.prototype.requestData=function(e){return(0,u.__awaiter)(this,void 0,void 0,function(){var t;return(0,u.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this._getCalendarView(e)];case 1:return t=n.sent(),[2,this._processGraphCalendarViewData(t,e)];case 2:return n.sent(),[2,{nextPaginationInfo:e.paginationInfo,attachments:[]}];case 3:return[2]}})})},e.prototype._calculatePagination=function(e,t){var a=t.paginationInfo,i=t.searchingContentType;if(null!=e["@odata.nextLink"]){var r=new URL(e["@odata.nextLink"]),o=parseInt(r.searchParams.get("$skip")||"0",10);return(0,u.__assign)((0,u.__assign)({},a),{skip:o,isLoading:!1,canLoadMore:!0})}return function(e,t){var a=t;if(void 0===a||void 0===a.startDateTime)return(0,u.__assign)((0,u.__assign)({},t),{canLoadMore:!1,isLoading:!1});if((e===n.MeetingSeries||e===n.Meetings)&&new Date(a.startDateTime).getTime()<=T(-180).getTime())return(0,u.__assign)((0,u.__assign)({},t),{canLoadMore:!1,isLoading:!1});var i=(new Date(a.startDateTime).getTime()-new Date(a.endDateTime).getTime())/864e5;return{skip:0,startDateTime:T(i,new Date(a.startDateTime)).toISOString(),endDateTime:a.startDateTime,canLoadMore:!0,isLoading:!1}}(i,a)},e.prototype._filterByOrganizersName=function(e,t){var n,a,i;return!(t.filterByOrganizersName.length>0)||t.filterByOrganizersName.map(function(e){return e.toLocaleLowerCase()}).includes(null===(i=null===(a=null===(n=e.organizer)||void 0===n?void 0:n.emailAddress)||void 0===a?void 0:a.name)||void 0===i?void 0:i.toLocaleLowerCase())},e.prototype._processMeetingSeriesData=function(e,n){var i=this,r=n.ignoredAttachmentsIds,o=e.value.filter(function(e){return!e.isCancelled}).filter(function(e){return null!=e.seriesMasterId}).filter(function(e){return e.seriesMasterId&&-1===r.indexOf(e.seriesMasterId)}).filter(function(e){return i._filterByOrganizersName(e,n)}).map(function(e){if(null==e.seriesMasterId)throw new Error("seriesMasterId is null");return{type:t.Meeting,id:e.id,name:e.subject,seriesMasterId:e.seriesMasterId,start:e.start,end:e.end,sensitivity:e.sensitivity,meetingType:a.Occurrence,organizer:e.organizer,isOrganizer:e.isOrganizer,isOnlineMeeting:e.isOnlineMeeting,onlineMeeting:e.onlineMeeting}}).reduce(function(e,t){return e[t.seriesMasterId]?e[t.seriesMasterId].push(t):e[t.seriesMasterId]=[t],e},{});return Object.values(o).map(function(e){return e.sort(function(e,t){return new Date(t.end.dateTime).getTime()-new Date(e.end.dateTime).getTime()}),{meetings:e,type:t.MeetingSeries,id:e[0].id,name:e[0].name,seriesMasterId:e[0].seriesMasterId}})},e.prototype._processMeetingEventData=function(e,n){var i=this,r=n.ignoredAttachmentsIds,o=new Date;return e.value.filter(function(e){return!e.isCancelled&&-1===r.indexOf(e.id)&&i._filterByOrganizersName(e,n)&&new Date(U(e.end.dateTime))<o}).map(function(e){var n;return n="occurrence"===e.type?a.Occurrence:"singleInstance"===e.type?a.Single:a.Exception,{type:t.Meeting,id:e.id,name:e.subject,start:e.start,end:e.end,sensitivity:e.sensitivity,meetingType:n,organizer:e.organizer,isOrganizer:e.isOrganizer,isOnlineMeeting:e.isOnlineMeeting,onlineMeeting:e.onlineMeeting}})},e.prototype._processGraphCalendarViewData=function(e,t){var a;if(null===(a=t.abortSignal)||void 0===a?void 0:a.aborted){var i=new Error("action is aborted");throw i.name="AbortError",i}var r,o=this._calculatePagination(e,t);if(0===e.value.length&&(r=[]),t.searchingContentType===n.MeetingSeries)r=this._processMeetingSeriesData(e,t);else{if(t.searchingContentType!==n.Meetings)throw new Error("Unsupported searching content type:"+t.searchingContentType);r=this._processMeetingEventData(e,t)}return{nextPaginationInfo:o,attachments:r}},e.prototype._getCalendarView=function(e){return(0,u.__awaiter)(this,void 0,void 0,function(){return(0,u.__generator)(this,function(t){switch(t.label){case 0:return[4,this._getRawClientResponse(e)];case 1:return[2,t.sent()]}})})},e.prototype._getRawClientResponse=function(e){var t=this;return this._graphClientPromise.then(function(n){return n.api(t._getCalendarViewUrl(e)).responseType(k.ResponseType.JSON).get()})},e.prototype._getCalendarViewUrl=function(e){var t,a=e.filterByOrganizersName,i=e.queryString,r=e.searchingContentType,o=e.paginationInfo,s="";if(""===i.trim()&&a.length>0)for(var c=!0,d=0;d<a.length;d++){var l=a[d];if(""!==l.trim()){var u=encodeURIComponent(l);c?(c=!1,s+="$filter=organizer/emailAddress/name eq '".concat(u,"'")):s+=" or organizer/emailAddress/name eq '".concat(u,"'")}}else if(s="$filter=isCancelled ne true",r===n.MeetingSeries&&(s+=" and seriesMasterId ne null"),(null===(t=null==i?void 0:i.trim())||void 0===t?void 0:t.length)>0){var f=encodeURIComponent(i.trim());s+=" and contains(subject, '".concat(f,"')")}return"".concat("me/calendarView","?top=").concat(function(e){return e===n.MeetingSeries?40:20}(r)).concat(function(e){var t="&";return"startDateTime"in e&&"endDateTime"in e&&(t+="startdatetime=".concat(e.startDateTime,"&enddatetime=").concat(e.endDateTime)),"skip"in e&&(t+="&skip=".concat(e.skip)),t}(o),"&").concat(s,"&").concat("$select=isCancelled,id,seriesMasterId,isOnlineMeeting,isOrganizer,organizer,onlineMeeting,start,end,sensitivity,type,subject,hasAttachments,isAllDay","&$orderby=start/dateTime desc")},e}(),N=E(737),B=E(408),j=new Map([[n.Meetings,"Event"],[n.Files,"File"]]),V=["Powerpoint","Word","Loop","Pdf"];function z(e){return{type:t.Meeting,id:e.EventId.Id.replace(/\+/g,"_").replace(/\//g,"-"),name:e.Subject,start:{dateTime:e.Start,timeZone:"UTC"},end:{dateTime:e.End,timeZone:"UTC"},meetingType:e.SeriesMasterId?a.Occurrence:a.Single,organizer:{emailAddress:{name:e.OrganizerName,address:e.OrganizerAddress}},hasRecording:e.HasRecording||!1}}function G(e){var n=e.SpoId.split("_"),a=n[1],i=n[2],r=atob(a).split(","),o=r[0],s=r[1],c=r[2];return{type:t.File,id:i,name:e.FileName,extension:e.FileExtension,sharepointIds:{siteId:o,webId:s,listId:c,driveId:"",webUrl:e.AccessUrl,listItemUniqueId:e.SpoUniqueId},createdBy:{user:{displayName:e.Author,email:""}},createdDateTime:e.DateCreated,lastModifiedBy:{user:{displayName:e.ModifiedByDisplayName,email:e.ModifiedBy}},lastModifiedDateTime:e.DateModified}}var K=function(){function e(e){this._tokenProvider=N._AadTokenProviders.configurable,this._serviceScope=e,this._substrateHost=e.consume(B.PageContext.serviceKey).legacyPageContext.substrateEndpointUrl}return e.prototype.requestData=function(e,t,n){return(0,u.__awaiter)(this,void 0,void 0,function(){var a,i,r,o,s,c=this;return(0,u.__generator)(this,function(d){switch(d.label){case 0:return d.trys.push([0,2,,3]),[4,this._tokenProvider._getTokenInternal("".concat(this._substrateHost).concat("/search"),N._AadTokenProviders.preAuthorizedConfiguration)];case 1:return a=d.sent(),i=JSON.stringify({scenario:{name:"SharePoint.AuthoringCopilot"},entityRequests:t.map(function(t){var n={entityType:t,query:{queryString:e}};return g._SPKillSwitch.isActivated("06eb46f0-31c3-4370-b60c-d0e481750b1c")||"File"===t&&(n.filter=c._getFileTypeFilter()),n}),timeZone:"UTC",cvid:null!=n?n:g.Guid.newGuid().toString()}),(r=new Headers).set("Authorization","Bearer "+a),r.set("Content-Type","application/json"),r.set("Accept","application/json"),o={credentials:"same-origin",headers:r,body:i},s=new L.HttpClientConfiguration(L.HttpClient.configurations.v1),[2,this._serviceScope.consume(L.HttpClient.serviceKey).post("".concat(this._substrateHost).concat("/search/api/v1/suggestions"),s,o).then(function(e){return e.json()})];case 2:return d.sent(),[2,{Groups:[]}];case 3:return[2]}})})},e.prototype.getRequestEntities=function(e,t){return(e===n.All?t.filter(function(e){return e!==n.All}):[e]).map(function(e){return j.get(e)||""}).filter(function(e){return""!==e})},e.prototype._getFileTypeFilter=function(){return{And:[{Or:V.map(function(e){return{Term:{FileType:e}}})}]}},e}(),W=function(e){return(0,u.__awaiter)(void 0,void 0,void 0,function(){var a,i,r,o,s,c,d,l,f,p,m,_,h,b,g,v,y,S,D,I,x,C;return(0,u.__generator)(this,function(O){switch(O.label){case 0:a=e.serviceScope,i=e.queryString,r=e.activatedTab,o=e.displayTabs,s=e.loadedAttachments,c=e.abortSignal,d=e.filterByOrganizersName,l=e.paginationInfo,f=new M(a),p=new R(a),m=[],_=l,h=s.map(function(e){return e.type===t.File?e.sharepointIds.listItemUniqueId||"":e.type===t.Meeting?e.id||"":e.type===t.MeetingSeries&&e.seriesMasterId||""}),b=r===n.All?o:[r],g=[],v=0,y=b,O.label=1;case 1:if(!(v<y.length))return[3,11];switch(S=y[v]){case n.Files:return[3,2];case n.Meetings:return[3,3];case n.MeetingSeries:return[3,4];case n.All:return[3,8]}return[3,9];case 2:return g.push(f.requestData({queryString:i||"*",extensions:["doc","docx","ppt","pptx","pdf","loop"],ignoredAttachmentsIds:h,searchingContentType:S,abortSignal:c,paginationInfo:l})),[3,10];case 3:return g.push(p.requestData({ignoredAttachmentsIds:h,searchingContentType:S,paginationInfo:l,queryString:i,abortSignal:c,filterByOrganizersName:d})),[3,10];case 4:D=!0,I=m.length,O.label=5;case 5:return D?[4,p.requestData({ignoredAttachmentsIds:h,searchingContentType:S,paginationInfo:_,queryString:i,abortSignal:c,filterByOrganizersName:d})]:[3,7];case 6:return x=O.sent(),m=(0,u.__spreadArray)((0,u.__spreadArray)([],m,!0),x.attachments,!0),_=x.nextPaginationInfo,D=_.canLoadMore&&m.length===I,I=m.length,[3,5];case 7:case 8:return[3,10];case 9:throw new Error("Unsupported searching content type");case 10:return v++,[3,1];case 11:return[4,Promise.all(g)];case 12:return C=O.sent(),r!==n.All&&1===C.length&&(_=C[0].nextPaginationInfo),m=C.reduce(function(e,t){return(0,u.__spreadArray)((0,u.__spreadArray)([],e,!0),t.attachments,!0)},m),r===n.All&&0===i.length&&(m=m.sort(function(e,t){return F(t).getTime()-F(e).getTime()}).slice(0,20)),[2,{attachments:m,nextPaginationInfo:_}]}})})},q=function(e){return(0,u.__awaiter)(void 0,void 0,void 0,function(){var t,a,i,r,o,s,c,d,l,f,p,m,_,h;return(0,u.__generator)(this,function(b){switch(b.label){case 0:return t=e.serviceScope,a=e.queryString,i=e.activatedTab,r=e.displayTabs,o=e.abortSignal,s=e.paginationInfo,c=e.cvid,[4,(d=new K(t)).requestData(a,d.getRequestEntities(i,r),c)];case 1:if(l=b.sent(),null==o?void 0:o.aborted)throw(f=new Error("action is aborted")).name="AbortError",f;for(p=[],m=0,_=l.Groups;m<_.length;m++)switch((h=_[m]).Type){case"File":p.push.apply(p,h.Suggestions.map(G));break;case"Event":p.push.apply(p,h.Suggestions.map(z))}return i===n.All&&0===a.length&&p.sort(function(e,t){return F(t).getTime()-F(e).getTime()}),[2,{attachments:p,nextPaginationInfo:(0,u.__assign)((0,u.__assign)({},s),{canLoadMore:!1})}]}})})},Q=E(529),Y=E(533),J={accdb:{extensions:["accdb","mdb"]},archive:{extensions:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","z"]},album:{},audio:{extensions:["aif","aiff","aac","alac","amr","ape","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","oga","ra","rm","wav","wma","wv"]},calendar:{extensions:["ical","icalendar","ics","ifb","vcs"]},classifier:{extensions:["classifier"]},clipchamp:{extensions:["clipchamp"]},cliptemplate:{extensions:["cliptemplate"]},code:{extensions:["abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","cbl","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","config","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","h","h++","haml","handlebars","hbs","hcp","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsproj","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","mak","make","manifest","master","md","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","ps1xml","psd1","psm1","pss","pt","py","pyw","r","rake","rb","rbx","rc","rdf","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","ruby","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","shtml","sml","svn-base","swift","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","vmg","webpart","wsp","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"]},contact:{extensions:["vcf"]},copilot:{extensions:["copilot"]},csv:{extensions:["csv"]},designer:{extensions:["design"]},desktopfolder:{},docset:{},documentsfolder:{},docx:{extensions:["doc","docm","docx","docb"]},dotx:{extensions:["dot","dotm","dotx"]},email:{extensions:["eml","msg","oft","ost","pst"]},exe:{extensions:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"]},favoritesfolder:{},folder:{},font:{extensions:["ttf","otf","woff"]},form:{},genericfile:{},html:{extensions:["htm","html","mht","mhtml"]},ipynb:{extensions:["nnb","ipynb"]},link:{extensions:["lnk","link","url","website","webloc"]},linkedfolder:{},listform:{},listitem:{},loop:{extensions:["fluid","loop","note"]},loopworkspace:{},officescript:{extensions:["osts"]},splist:{},mcworld:{extensions:["mcworld"]},mctemplate:{extensions:["mctemplate"]},model:{extensions:["3ds","3mf","blend","cool","dae","df","dwfx","dwg","dxf","fbx","glb","gltf","holo","layer","layout","max","mtl","obj","off","ply","skp","stp","stl","t","thl","x"]},mpp:{extensions:["mpp"]},mpt:{extensions:["mpt"]},multiple:{},one:{extensions:["one","onepart"]},onetoc:{extensions:["ms-one-stub","onetoc","onetoc2","onepkg"]},pbiapp:{},pdf:{extensions:["pdf"]},photo:{extensions:["arw","bmp","cr2","crw","dic","dicm","dcm","dcm30","dcr","dds","dib","dng","erf","gif","heic","heif","ico","jfi","jfif","jif","jpe","jpeg","jpg","jxr","kdc","mrw","nef","orf","pct","pict","png","pns","psb","psd","raw","tga","tif","tiff","wdp"]},photo360:{},picturesfolder:{},planner:{},portfolio:{},potx:{extensions:["pot","potm","potx"]},powerbi:{extensions:["pbids","pbix"]},ppsx:{extensions:["pps","ppsm","ppsx"]},pptx:{extensions:["ppt","pptm","pptx","sldx","sldm"]},presentation:{extensions:["odp","gslides","key"]},pub:{extensions:["pub"]},spo:{extensions:["aspx"]},sponews:{},spreadsheet:{extensions:["odc","ods","gsheet","numbers","tsv"]},rtf:{extensions:["epub","gdoc","odt","rtf","wri","pages"]},sharedfolder:{},playlist:{},sway:{},sysfile:{extensions:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","ldt","lrprev","pkpass","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xlb","xll"]},todoitem:{},txt:{extensions:["dif","diff","readme","out","plist","properties","text","txt"]},vaultclosed:{},vaultopen:{},vector:{extensions:["ai","ait","cvs","dgn","gdraw","pd","emf","eps","fig","ind","indd","indl","indt","indb","ps","svg","svgz","wmf","oxps","xps","xd","sketch"]},video:{extensions:["3g2","3gp","3gp2","3gpp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4","mp4v","mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"]},video360:{},vsdx:{extensions:["vdx","vsd","vsdm","vsdx","vsw","vdw"]},vssx:{extensions:["vss","vssm","vssx"]},vstx:{extensions:["vst","vstm","vstx","vsx"]},whiteboard:{extensions:["whiteboard","wbtx"]},xlsx:{extensions:["xlc","xls","xlsb","xlsm","xlsx","xlw"]},xltx:{extensions:["xlt","xltm","xltx"]},xml:{extensions:["xaml","xml","xsl"]},xsn:{extensions:["xsn"]},zip:{extensions:["zip"]}},X="#207347",Z="#C8C8C8",$="#2B579A",ee="#094AB2",te="#0078d4",ne="#D04727",ae="#3A56A0",ie={};[{color:"#A23739",extensions:["accdb","mdb"]},{color:ee,extensions:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","rar","z"]},{color:"#038387",extensions:["aspx"]},{color:Z,extensions:["aif","aiff","aac","amr","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","ogg","oga","ra","rm","wav","wma","wv"]},{color:Z,extensions:["asp","bat","c","coffee","config","cpp","cs","cshtml","css","dat","fsx","h","inf","ini","java","js","json","less","log","manifest","master","nfo","php","prefs","preferences","ps","ps1","pss","py","rb","rdf","reg","ruby","sql","svn-base","vmg","webpart","wsp","vb"]},{color:X,extensions:["csv"]},{color:$,extensions:["doc","docm","docx"]},{color:$,extensions:["dot","dotm","dotx"]},{color:Z,extensions:["eml","msg","ost","pst"]},{color:Z,extensions:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"]},{color:Z,extensions:["ttf","otf","woff"]},{color:te,extensions:["htm","html","mht"]},{color:te,extensions:["lnk","link","url","website","webloc"]},{color:Z,extensions:["3mf","3ds","blend","cool","dae","df","dwfx","dwg","dxf","fbx","gltf","glb","layout","obj","off","max","ply","skp","stp","stl","t","thl","x"]},{color:X,extensions:["mpp"]},{color:X,extensions:["mpt"]},{color:X,extensions:["ods"]},{color:$,extensions:["odt"]},{color:"#803A7A",extensions:["one","onepkg","ms-one-stub","onetoc","onetoc2"]},{color:"#D76244",extensions:["pdf"]},{color:Z,extensions:["arw","bmp","cr2","crw","dcr","dds","dib","dng","erf","gif","ico","jfi","jfif","jif","jpe","jpeg","jpg","kdc","mrw","nef","orf","pct","pict","png","pns","psd","raw","tga","tif","tiff","wdp"]},{color:ne,extensions:["pot","potm","potx"]},{color:ne,extensions:["pps","ppsm","ppsx"]},{color:ne,extensions:["ppt","pptm","pptx"]},{color:"#077568",extensions:["pub"]},{color:Z,extensions:["epub","rtf","wri"]},{color:Z,extensions:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","kdc","ldt","lrprev","obj","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xll"]},{color:Z,extensions:["log","md","readme","text","txt"]},{color:ae,extensions:["ai","dgn","pd","emf","eps","indd","indt","ps","svg","svgz","wmf"]},{color:Z,extensions:["3gp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4","mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"]},{color:ae,extensions:["vsd","vsdm","vsdx","vdw"]},{color:Z,extensions:["vss","vssm","vssx"]},{color:ae,extensions:["vst","vstm","vstx"]},{color:X,extensions:["xls","xlsb","xlsm","xlsx"]},{color:Z,extensions:["xlt","xltm","xltx"]},{color:Z,extensions:["xaml","xml","xsl"]},{color:"#0EB5ED",extensions:["oxps","xps"]},{color:"#6A3889",extensions:["xsn"]},{color:ee,extensions:["zip"]}].forEach(function(e){e.extensions&&e.extensions.forEach(function(t){ie[t]=e})});var re=Object.keys(J),oe={};re.forEach(function(e){(J[e].extensions||[]).forEach(function(t){oe[t]=e})});const se=E.p+"odm_newsCarousel1_2f061610.png";var ce="folder",de="item-types",le="".concat(g._FluentIconVersionedCdnPath,"/assets/"),ue="https://res-1.cdn.office.net".concat(le);const fe=function(){function e(){}return e.getIconColorFromExtension=function(e){return(ie[e]||{color:Z}).color},e.getIconUrl=function(t,n){void 0===n&&(n=32);var a,i="",r=window.devicePixelRatio;r>1&&r<=1.5?i="_1.5x":r>1.5&&r<=2?i="_2x":r>2&&r<=3?i="_3x":r>3&&(i="_4x"),a=t===ce?ce:"listItem"===t?"splist":oe[t]||"genericfile",n>32&&r>1&&r===Math.floor(r)&&(n=e._mapToValidIconSize(n/r));var o=ue+de;if(!sessionStorage.getItem("spfx-debug")&&g.Environment.type===g.EnvironmentType.SharePoint){var s=new P.Uri(se);o=P.Uri.concatenate(s.getLeftPart(P.UriPartial.authority),le+de)}return"".concat(o,"/").concat(n).concat(i,"/").concat(a,".png")},e._mapToValidIconSize=function(e){var t=[16,20,24,32,40,48,64,96,Number.MAX_VALUE],n=t.filter(function(n,a){return e>=n&&a<t.length-1&&e<t[a+1]});return 0===n.length?16:n[0]},e}();var pe=E(822);const me=I("AddCircleRegular","1em",["M6 10c0-.28.22-.5.5-.5h3v-3a.5.5 0 0 1 1 0v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3A.5.5 0 0 1 6 10Zm4 8a8 8 0 1 0 0-16 8 8 0 0 0 0 16Zm0-1a7 7 0 1 1 0-14 7 7 0 0 1 0 14Z"]),_e=I("CalendarLtrRegular","1em",["M7 11a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm1 2a1 1 0 1 1-2 0 1 1 0 0 1 2 0Zm2-2a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm1 2a1 1 0 1 1-2 0 1 1 0 0 1 2 0Zm2-2a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm4-5.5A2.5 2.5 0 0 0 14.5 3h-9A2.5 2.5 0 0 0 3 5.5v9A2.5 2.5 0 0 0 5.5 17h9a2.5 2.5 0 0 0 2.5-2.5v-9ZM4 7h12v7.5c0 .83-.67 1.5-1.5 1.5h-9A1.5 1.5 0 0 1 4 14.5V7Zm1.5-3h9c.83 0 1.5.67 1.5 1.5V6H4v-.5C4 4.67 4.67 4 5.5 4Z"]),he=I("CalendarSyncRegular","1em",["M14.5 3A2.5 2.5 0 0 1 17 5.5v4.1c-.32-.16-.65-.3-1-.4V7H4v7.5c0 .83.67 1.5 1.5 1.5h3.7c.1.35.24.68.4 1H5.5A2.5 2.5 0 0 1 3 14.5v-9A2.5 2.5 0 0 1 5.5 3h9Zm0 1h-9C4.67 4 4 4.67 4 5.5V6h12v-.5c0-.83-.67-1.5-1.5-1.5ZM10 14.5a4.5 4.5 0 1 0 9 0 4.5 4.5 0 0 0-9 0Zm6.5-3c.28 0 .5.22.5.5v1.5a.5.5 0 0 1-.5.5H15a.5.5 0 0 1 0-1h.47a1.97 1.97 0 0 0-.94-.25 2 2 0 0 0-1.44.59.5.5 0 0 1-.71-.71 3 3 0 0 1 3.62-.48V12c0-.28.22-.5.5-.5Zm-.88 5.53a3 3 0 0 1-2.62-.18V17a.5.5 0 0 1-1 0v-1.5c0-.28.22-.5.5-.5H14a.5.5 0 0 1 0 1h-.47a1.97 1.97 0 0 0 .94.25 2 2 0 0 0 1.44-.59.5.5 0 0 1 .71.71 3 3 0 0 1-1 .66Z"]);var be,ge="20",ve=(0,d.makeStyles)({meetingIconLarge:{width:"".concat(ge,"px"),height:"".concat(ge,"px"),minWidth:"".concat(ge,"px")},meetingIconExtraLarge:{width:"".concat("24","px"),height:"".concat("24","px"),minWidth:"".concat(ge,"px")}});function ye(e){var n=e.size,i=e.attachment,r=n===be.Large?20:24,o=ve(),c=null;if(i.type===t.File){var d=i.extension;c=s().createElement(pe.Image,{src:fe.getIconUrl(d),height:r,width:r,role:"presentation"})}else if(i.type===t.MeetingSeries){var l=n===be.Large?o.meetingIconLarge:o.meetingIconExtraLarge;c=s().createElement(he,{className:l})}else{if(i.type!==t.Meeting)throw new Error("Unsupported attachment type: ".concat(i.type));l=n===be.Large?o.meetingIconLarge:o.meetingIconExtraLarge,c=i.meetingType===a.Occurrence?s().createElement(he,{className:l}):s().createElement(_e,{className:l})}return s().createElement(s().Fragment,null,c)}!function(e){e.Large="large",e.extraLarge="extra-large"}(be||(be={}));var Se=(0,d.makeStyles)({spinner:{alignContent:"center",alignItems:"center",justifyContent:"center",height:"184px"},attachmentOptionContainer:{display:"flex",flexDirection:"row",width:"100%",overflow:"hidden",alignItems:"center"},attachmentInfo:{padding:"0 var(--spacingHorizontalS)"},attachmentName:{width:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontSize:"var(--fontSizeBase300)",lineHeight:"var(--lineHeightBase300)",height:"var(--lineHeightBase300)"},attachmentActivity:{width:"100%",fontSize:"var(--fontSizeBase100)",lineHeight:"var(--lineHeightBase100)",height:"var(--lineHeightBase100)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"var(--colorNeutralForeground3)"},clearContainer:{display:"flex",flexDirection:"column",marginTop:"10px",paddingLeft:"6px",paddingRight:"6px"},noResultsFound:{marginBottom:"12px",paddingLeft:"10px",fontFamily:"var(--fontFamilyBase)"},clearButton:{backgroundColor:"var(--colorNeutralBackground3)",color:"var(--colorBrandForeground1)",border:"1px",borderRadius:"4px",padding:"10px",justifyContent:"left"}}),De=function(e){var n=e.searchResult,a=e.queryString,r=e.handleItemClick,o=e.handleClearAndTryAgain,c=e.loadingComponent,d=Se();if(n.status===i.Querying)return s().createElement(O.Spinner,{className:d.spinner});if(n.status===i.Succeed){if(0===n.results.length&&(null==a?void 0:a.length)>0)return s().createElement("div",{className:d.clearContainer},s().createElement(w.Text,{className:d.noResultsFound},f.nF),s().createElement(Y.Button,{className:d.clearButton,onClick:o},f.ki));var l=n.results.map(function(e){var n,a,i,o,c,l,u,p="";if(e.type===t.File)p=(null===(n=(m=e).lastModifiedBy)||void 0===n?void 0:n.user.displayName)?P.StringHelper.format(f.fG,null===(i=null===(a=m.lastModifiedBy)||void 0===a?void 0:a.user)||void 0===i?void 0:i.displayName,(0,P.getFriendlyDateTimeStringPast)(new Date(m.lastModifiedDateTime||""))):P.StringHelper.format(f.UF,(0,P.getFriendlyDateTimeStringPast)(new Date(m.lastModifiedDateTime||"")));else if(e.type===t.MeetingSeries){var m=e.meetings[0];p=P.StringHelper.format(f.gm,(o=m.start.dateTime,c=m.end.dateTime,l=(0,P.getHumanizedDateTimeStringPast)(new Date(U(o)),!1,P.Locale.language,!0),u=(0,P.getHumanizedDateTimeStringPast)(new Date(U(c)),!1,P.Locale.language,!0),l&&u&&-1!==l.indexOf("at")&&-1!==u.indexOf("at")&&l.split("at")[0]===u.split("at")[0]?"".concat(l," -").concat(u.split("at")[1]):"".concat(l," - ").concat(u)),m.organizer.emailAddress.name)}else{if(e.type!==t.Meeting)throw new Error("Unsupported attachment type:"+e.type);m=e,p=P.StringHelper.format(e.hasRecording?f.Lq:f.gm,function(e,t){var n=new Date(U(e)),a=new Date(U(t)),i=(0,P.getFriendlyDateStringPast)(n,P.Locale.language),r=(0,P.toLocaleTimeString)(n,{hour:"numeric",minute:"numeric",hour12:!0},!0),o=(0,P.toLocaleTimeString)(a,{hour:"numeric",minute:"numeric",hour12:!0},!0);return"".concat(i," ").concat(r," - ").concat(o)}(m.start.dateTime,m.end.dateTime),m.organizer.emailAddress.name)}return s().createElement(C.Option,{text:e.name,key:e.id,value:e.id,checkIcon:null,"data-automation-id":"sp-pages-content-panel-search-box-dropdown-option",onClick:r(e)},s().createElement("div",{className:d.attachmentOptionContainer},s().createElement(ye,{size:be.Large,attachment:e}),s().createElement("div",{className:d.attachmentInfo},s().createElement("div",{className:d.attachmentName},e.name),s().createElement("div",{className:d.attachmentActivity},p))))});return s().createElement("div",null,s().createElement("div",{role:"listbox","aria-label":f.HT},l),s().createElement(s().Fragment,null,c))}throw new Error("Unsupported search status")},Ie=(0,d.makeStyles)({loadMoreBtn:{display:"flex",justifyContent:"center",padding:"8px 0px",cursor:"pointer"},loadMoreSpinner:{alignContent:"center",alignItems:"center",justifyContent:"center",height:"28px",display:"flex",width:"100%"},reachTheEndText:{color:"var(--colorNeutralForeground3)",alignContent:"center",alignItems:"center",justifyContent:"center",display:"flex"}});function xe(){return g._SPFlight.isEnabled(60696)}function Ce(e){var t=this,a=e.searchResult,i=e.activatedTab,r=e.serviceScope,c=e.dropdownViewboxRef,d=e.displayTabs,l=e.filterByOrganizersName,p=e.queryString,m=e.paginationInfo,_=e.cvid,h=e.setPaginationInfo,b=e.setQueryString,g=e.handleOptionSelected,v=e.setSearchResult,y=s().useRef(null),S=s().useRef(void 0),D=function(){return(0,u.__awaiter)(t,void 0,void 0,function(){var e,t,o,s,c,f,b,g;return(0,u.__generator)(this,function(y){switch(y.label){case 0:return i===n.All?[2]:(h((0,u.__assign)((0,u.__assign)({},m),{isLoading:!0})),[4,(xe()?q:W)({serviceScope:r,queryString:p,activatedTab:i,displayTabs:d,paginationInfo:m,abortSignal:null===(f=S.current)||void 0===f?void 0:f.signal,loadedAttachments:a.results||[],filterByOrganizersName:l,cvid:_})]);case 1:if(e=y.sent(),t=e.attachments,o=e.nextPaginationInfo,null===(g=null===(b=S.current)||void 0===b?void 0:b.signal)||void 0===g?void 0:g.aborted)throw(s=new Error("action is aborted")).name="AbortError",s;return c=(0,u.__spreadArray)((0,u.__spreadArray)([],a.results,!0),t,!0),h(o),v((0,u.__assign)((0,u.__assign)({},a),{results:c})),[2]}})})};!function(e){var t=e.dropdownViewboxRef,n=e.loadMoreRef,a=e.onScrollEnd;(0,o.useEffect)(function(){var e=null==t?void 0:t.current;if(null!=e){var i=(0,Q.debounce)(function(){var e=null==t?void 0:t.current,i=null==n?void 0:n.current;if(null!=e&&null!=i){var r=e.getBoundingClientRect(),o=i.getBoundingClientRect();o.bottom-2*o.height<=r.bottom&&a()}},200);return e.addEventListener("scroll",i),function(){e.removeEventListener("scroll",i),i.cancel()}}},[t,n,a])}({dropdownViewboxRef:c,loadMoreRef:y,onScrollEnd:function(){return(0,u.__awaiter)(t,void 0,void 0,function(){return(0,u.__generator)(this,function(e){switch(e.label){case 0:return!0!==m.canLoadMore||!1!==m.isLoading?[3,2]:[4,D()];case 1:e.sent(),e.label=2;case 2:return[2]}})})}}),(0,o.useEffect)(function(){var e=new AbortController;return S.current=e,function(){e.abort()}},[S]);var I,x=Ie();return I=!0===m.canLoadMore&&i!==n.All?!0===m.isLoading?s().createElement(C.Option,{text:"",ref:y},s().createElement(O.Spinner,{size:"small",className:x.loadMoreSpinner})):s().createElement(C.Option,{className:x.loadMoreBtn,onClick:D,ref:y},f.iq):s().createElement("div",{className:x.reachTheEndText},s().createElement(w.Text,null,f.kz)),s().createElement(De,{searchResult:a,queryString:p,loadingComponent:I,handleItemClick:function(e){return function(t){g&&g(t,e)}},handleClearAndTryAgain:function(){b("")}})}function Oe(e){var t=this,a=b(),r=e.serviceScope,c=e.selectedAttachments,d=e.displayTabs,l=e.filterByOrganizersName,v=e.onSelect,y=s().useState({status:i.Querying}),S=y[0],D=y[1],I=s().useState(""),C=I[0],O=I[1],w=s().useState(H("")),E=w[0],A=w[1],L=s().useState(g.Guid.newGuid().toString()),k=L[0],M=L[1],P=s().useRef(null),T=s().useState(d[0]||n.Files),U=T[0],F=T[1];return function(e){var t=this,n=e.serviceScope,a=e.queryString,r=e.activatedTab,c=e.displayTabs,d=e.filterByOrganizersName,l=e.cvid,f=e.setSearchResult,p=e.setPaginationInfo,m=s().useRef(null);(0,o.useEffect)(function(){m.current&&(m.current.abort(),m.current=null),f({status:i.Querying});var e=new AbortController,o=e.signal;m.current=e;var s=(0,Q.debounce)(function(){return(0,u.__awaiter)(t,void 0,void 0,function(){var e,t,s,m;return(0,u.__generator)(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),o.aborted?[2]:[4,(xe()?q:W)({serviceScope:n,paginationInfo:H(a),queryString:a,activatedTab:r,displayTabs:c,abortSignal:o,loadedAttachments:[],filterByOrganizersName:d,cvid:l})];case 1:return e=u.sent(),t=e.attachments,s=e.nextPaginationInfo,f({status:i.Succeed,queryString:a,results:t}),p(s),[3,3];case 2:return"AbortError"!==(m=u.sent()).name&&(f({status:i.Failed,error:m}),p(H(a))),[3,3];case 3:return[2]}})})},300);return s(),function(){var e;null===(e=m.current)||void 0===e||e.abort(),m.current=null}},[r,a])}({serviceScope:r,selectedAttachments:c,queryString:C,activatedTab:U,displayTabs:d,filterByOrganizersName:l,cvid:k,setSearchResult:D,setPaginationInfo:A}),s().createElement("div",{role:"search",className:a.searchContainer},s().createElement("div",{className:a.referenceContainer},s().createElement("div",{className:a.TabContainer},s().createElement(p.TabList,{selectedValue:U,onTabSelect:function(e,t){F(t.value),A(H(C))}},d.map(function(e){var t=function(e){var t="";switch(e){case n.All:t="sp-pages-content-panel-attachments-all-tab-btn";break;case n.Files:t="sp-pages-content-panel-attachments-file-tab-btn";break;case n.Meetings:t="sp-pages-content-panel-attachments-meeting-tab-btn";break;case n.MeetingSeries:t="sp-pages-content-panel-attachments-meeting-series-tab-btn";break;default:throw new Error("Unsupported searching content type")}return t}(e);return s().createElement(p.Tab,{key:e,value:e,"data-automation-id":t},e)}))),s().createElement(m.Divider,{className:a.divider}),s().createElement(_.SearchBox,{value:C,onInput:function(e){O(e.target.value),A(H(e.target.value))},className:a.referenceSearchBox,input:{className:a.referenceSearchBoxPlaceholder},placeholder:f.q$,dismiss:{"aria-label":f.Wi,children:s().createElement(h.Tooltip,{content:f.Wi,relationship:"label",withArrow:!0},s().createElement(x,null)),onClick:function(){O(""),M(g.Guid.newGuid().toString())}}})),s().createElement("div",{className:a.suggestionContainer},s().createElement("div",{className:a.suggestionItemContainer,ref:P},s().createElement(Ce,{dropdownViewboxRef:P,searchResult:S,activatedTab:U,queryString:C,paginationInfo:E,serviceScope:r,selectedAttachments:c,displayTabs:d,filterByOrganizersName:l,cvid:k,handleOptionSelected:function(e,n){return(0,u.__awaiter)(t,void 0,void 0,function(){var e;return(0,u.__generator)(this,function(t){return S.status===i.Succeed&&(e=S.results.find(function(e){return e.id===n.id}))&&(v(e),M(g.Guid.newGuid().toString())),[2]})})},setSearchResult:D,setPaginationInfo:A,setQueryString:O}))))}function we(e){var t=e.serviceScope,n=e.selectedAttachments,a=e.filterByOrganizersName,i=e.onAttachmentSelect,r=e.displayTabs,o=e.children,d=s().useState(!1),u=d[0],f=d[1],p=l();return s().createElement(c.Popover,{open:u,onOpenChange:function(t,n){e.disabled||f(n.open)},positioning:"below-start"},s().createElement(c.PopoverTrigger,{disableButtonEnhancement:!0},s().createElement("div",null,o)),s().createElement(c.PopoverSurface,{className:p.popoverSurface},s().createElement(Oe,{filterByOrganizersName:a||[],serviceScope:t,onSelect:function(e){i(e),f(!1)},displayTabs:r,selectedAttachments:n})))}var Ee=E(194);const Ae=JSON.parse('{"qs":"Attachments","T0":"Remove","c6":"Only up to {0} files can be added currently","Dc":"Add Resources for better results","aW":"More"}');var Le,ke,Me,Pe,Te=1024,Ue=772,Fe=480,He=("@media screen and (min-width: ".concat(Te,"px)"),"@media screen and (min-width: ".concat(Ue,"px) and (max-width: ").concat(Te,"px)"),"@media screen and (min-width: ".concat(Fe,"px) and (max-width: ").concat(Ue,"px)"),"@media screen and (min-width: ".concat(360,"px) and (max-width: ").concat(Fe,"px)"),"@media screen and (max-width: ".concat(Fe,"px)"),"@media screen and (min-width: ".concat(Te,"px)"),"@media screen and (max-width: ".concat(Te,"px)"),"@media screen and (min-width: ".concat(Ue,"px)")),Re="@media screen and (max-width: ".concat(Ue,"px)"),Ne=("@media screen and (min-width: ".concat(Fe,"px)"),"@media screen and (max-width: ".concat(Fe,"px)"),"@media screen and (min-width: ".concat(360,"px)"),"@media screen and (max-width: ".concat(360,"px)"),"@media screen and (max-height: ".concat(359,"px)"),"@media screen and (min-height: ".concat(359,"px)"),"@media screen and (max-height: ".concat(359,"px)"),(0,d.makeStyles)({tagGroup:(Le={flexWrap:"wrap",rowGap:"var(--spacingVerticalS)",width:"100%"},Le[Re]={flexDirection:"column"},Le),attachmentTag:(ke={},ke[He]={maxWidth:"calc(50% - var(--spacingHorizontalS))"},ke.padding="0",ke),attachmentTagShadow:{boxShadow:"var(--shadow2)"},attachmentTagLarge:{height:"".concat(40,"px")},attachmentTagExtraLarge:{height:"".concat(40,"px")},attachmentTagPrimary:(Me={flex:1,minWidth:"0",backgroundColor:"var(--colorNeutralBackground1)"},Me[":hover"]={backgroundColor:"var(--colorNeutralBackground1Hover)"},Me[":active"]={backgroundColor:"var(--colorNeutralBackground1Pressed)"},Me),attachmentTagPrimaryBorderless:{border:"none"},attachmentTagPrimaryLarge:{paddingLeft:"13px"},attachmentTagPrimaryExtraLarge:{paddingLeft:"12px"},attachmentTagPrimaryText:{maxWidth:"100%",display:"flex",flexDirection:"row",overflow:"hidden",alignItems:"center",paddingBottom:"0"},attachmentTagPrimaryTextLarge:{fontSize:"var(--fontSizeBase300)",fontWeight:"var(--fontWeightSemibold)"},attachmentTagPrimaryTextExtraLarge:{fontSize:"var(--fontSizeBase400)",fontWeight:"var(--fontWeightSemibold)"},attachmentName:{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginRight:"var(--spacingHorizontalXS)"},attachmentTagSecondary:(Pe={backgroundColor:"var(--colorNeutralBackground1)"},Pe[":hover"]={backgroundColor:"var(--colorNeutralBackground1Hover)"},Pe[":active"]={backgroundColor:"var(--colorNeutralBackground1Pressed)"},Pe),attachmentTagSecondaryBorderless:{borderTop:"none",borderRight:"none",borderBottom:"none"},attachmentTagSecondaryLarge:{fontSize:"12px",paddingRight:"12px"},attachmentTagSecondaryExtraLarge:{fontSize:"16px",paddingRight:"12px"},attachmentPicker:{padding:"0"},button:{border:"dashed 1px var(--colorBrandForeground1)",":hover":{border:"dashed 1px var(--colorBrandForeground1)"},":focus":{border:"dashed 1px var(--colorBrandForeground1)"},":active":{border:"dashed 1px var(--colorBrandForeground1)"}},buttonDisabled:{border:"dashed 1px var(--colorNeutralForegroundDisabled)",":hover":{border:"dashed 1px var(--colorNeutralForegroundDisabled)"},":focus":{border:"dashed 1px var(--colorNeutralForegroundDisabled)"},":active":{border:"dashed 1px var(--colorNeutralForegroundDisabled)"}},buttonLarge:{paddingLeft:"6px",paddingRight:"12px"},buttonExtraLarge:{paddingLeft:"12px",paddingRight:"17px"},icon:{color:"var(--colorBrandForeground1)",":hover":{color:"var(--colorBrandForeground1)"},":focus":{color:"var(--colorBrandForeground1)"},":active":{color:"var(--colorBrandForeground1)"}},iconDisabled:{color:"var(--colorNeutralForegroundDisabled)",":hover":{color:"var(--colorNeutralForegroundDisabled)"},":focus":{color:"var(--colorNeutralForegroundDisabled)"},":active":{color:"var(--colorNeutralForegroundDisabled)"}}})),Be=E(214);const je=(0,d.__styles)({base:{B2u0y6b:"f2rbwfs",z8tnut:"f1ywm7hm",z189sj:["f7x41pl","fruq291"],Byoj8tv:"f14wxoun",uwmqm3:["fruq291","f7x41pl"]}},{d:[".f2rbwfs{max-width:256px;}",".f1ywm7hm{padding-top:var(--spacingVerticalXS);}",".f7x41pl{padding-right:var(--spacingHorizontalXS);}",".fruq291{padding-left:var(--spacingHorizontalXS);}",".f14wxoun{padding-bottom:var(--spacingVerticalXS);}"]}),Ve=o.forwardRef((e,t)=>{const n=((e,t)=>(0,c.usePopoverSurface_unstable)(e,t))(e,t);return(e=>{const t=je();e.root.className=(0,d.mergeClasses)("fai-PreviewSurface",t.base,e.root.className),(0,c.usePopoverSurfaceStyles_unstable)(e)})(n),(e=>(0,c.renderPopoverSurface_unstable)(e))(n)});Ve.displayName="PreviewSurface";const ze=[];function Ge(e){let t=ze.findIndex(t=>t.id===e);for(;-1!==t;)ze.splice(t,1),t=ze.findIndex(t=>t.id===e)}const Ke=e=>"focus"===e||"blur"===e?0:500,We=(0,d.createContext)(void 0).Provider,qe=e=>(e=>{const{appearance:t,arrowRef:n,contentRef:a,inertTrapFocus:i,inline:r,isPreviewLocked:s,mountNode:d,open:l,openOnContext:u,openOnHover:f,setOpen:p,size:m,toggleOpen:_,trapFocus:h,triggerRef:b,withArrow:g}=e;return o.createElement(We,{value:{appearance:t,arrowRef:n,contentRef:a,inertTrapFocus:i,inline:r,isPreviewLocked:s,mountNode:d,open:l,openOnContext:u,openOnHover:f,setOpen:p,size:m,toggleOpen:_,trapFocus:h,triggerRef:b,withArrow:g}},(0,c.renderPopover_unstable)(e))})((e=>{const{onOpenChange:t,open:n,unstable_disableAutoFocus:a}=e,i=o.Children.toArray(e.children),{targetDocument:r}=(0,d.useFluent_unstable)(),[s,l]=(0,d.useTimeout)(),[u,f]=o.useState(!0),{current:p}=o.useRef({openByClick:!1,openByHoverOverTrigger:!1,openByHoverOverPopover:!1,openByKeyboard:!1}),m=o.useRef(!1),_=()=>p.openByClick||p.openByHoverOverTrigger||p.openByHoverOverPopover||p.openByKeyboard,[h,b]=o.useState(!1),g=o.useRef(!1);let v,y;2===i.length?(v=i[0],y=i[1]):1===i.length&&(y=i[0]);const S=(0,d.useId)("preview-surface",null==y?void 0:y.props.id),D=()=>{p.openByClick=!1,p.openByHoverOverTrigger=!1,p.openByHoverOverPopover=!1,p.openByKeyboard=!1,b(_())};if(o.useEffect(()=>()=>{Ge(S)},[S]),y&&v){const e=e=>{p.openByHoverOverTrigger=!0,m.current=!0,p.openByClick||p.openByKeyboard||h||(f(!0),null==t||t(e,{open:!0}),function(e){for(const t of ze)t.id!==e&&t.closeCallback();ze.length=0}(S),function(e,t){ze.push({id:e,closeCallback:t})}(S,D)),b(_())},n=e=>{p.openByHoverOverTrigger=!1,m.current=!1,s(()=>{b(_()),p.openByClick||p.openByKeyboard||p.openByHoverOverPopover||!h||(null==t||t(e,{open:!1}),Ge(S))},Ke(e.type))},a=e=>{g.current=!0,f(!1);const n=p.openByHoverOverTrigger;p.openByClick=!p.openByKeyboard&&!p.openByClick,p.openByHoverOverTrigger=!1,p.openByHoverOverPopover=!1,p.openByKeyboard=!1,m.current?(p.openByClick=!1,m.current=!1):e.preventDefault(),n||null==t||t(e,{open:p.openByClick}),_()||Ge(S),b(_())},i=e=>{if("Enter"===e.key){l(),e.preventDefault(),f(!1);const n=p.openByHoverOverTrigger;p.openByKeyboard=!p.openByClick&&!p.openByKeyboard,p.openByClick=!1,p.openByHoverOverTrigger=!1,p.openByHoverOverPopover=!1,n||null==t||t(e,{open:p.openByKeyboard}),_()||Ge(S),b(_())}},r=e=>{p.openByHoverOverPopover=!0,b(_())},c=e=>{p.openByHoverOverPopover=!1,s(()=>{b(_()),p.openByClick||p.openByKeyboard||p.openByHoverOverTrigger||(null==t||t(e,{open:!1}),Ge(S))},Ke(e.type))};var I;v=o.cloneElement(v,{...v.props,children:o.cloneElement(v.props.children,{...v.props.children.props,onBlur:(0,d.mergeCallbacks)(v.props.children.props.onBlur,n),onClick:(0,d.mergeCallbacks)(v.props.children.props.onClick,a),onKeyDown:(0,d.mergeCallbacks)(v.props.children.props.onKeyDown,i),onMouseEnter:(0,d.mergeCallbacks)(v.props.children.props.onMouseEnter,e),onMouseLeave:(0,d.mergeCallbacks)(v.props.children.props.onMouseLeave,n)})}),y=o.cloneElement(y,{...y.props,"aria-labelledby":(null!==(I=y.props["aria-labelledby"])&&void 0!==I?I:y.props["aria-label"])?void 0:S,id:S,onMouseEnter:(0,d.mergeCallbacks)(y.props.onMouseEnter,r),onMouseLeave:(0,d.mergeCallbacks)(y.props.onMouseLeave,c),onFocus:(0,d.mergeCallbacks)(y.props.onFocus,r)})}(0,d.useIsomorphicLayoutEffect)(()=>{if(h){const e=e=>{!p.openByClick&&!p.openByKeyboard&&"Escape"===e.key&&(l(),f(!0),D(),Ge(S),null==t||t(e,{open:!1}),e.stopPropagation())};return null==r||r.addEventListener("keydown",e,{capture:!0}),()=>{null==r||r.removeEventListener("keydown",e,{capture:!0})}}},[r,h]);let x=i;return y&&(x=v?[v,y]:y),{...(0,c.usePopover_unstable)({...e,children:x,onOpenChange:(e,n)=>{g.current||(n.open||(l(),D(),Ge(S)),null==t||t(e,n)),g.current=!1},open:null!=n?n:h,unstable_disableAutoFocus:null!=a?a:u}),isPreviewLocked:p.openByClick||p.openByKeyboard}})(e));qe.displayName="Preview";const Qe=e=>{const t=(e=>(0,c.usePopoverTrigger_unstable)(e))(e);return(e=>(0,c.renderPopoverTrigger_unstable)(e))(t)};Qe.displayName="PreviewTrigger";const Ye=(0,d.__resetStyles)("r3uexl1","rbb2gfj",[".r3uexl1{color:var(--colorNeutralForeground3);display:flex;flex-direction:column;padding-top:var(--spacingVerticalS);padding-right:var(--spacingHorizontalS);padding-bottom:var(--spacingVerticalS);padding-left:var(--spacingHorizontalS);row-gap:var(--spacingVerticalXS);word-break:break-word;font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase200);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase200);}",".rbb2gfj{color:var(--colorNeutralForeground3);display:flex;flex-direction:column;padding-top:var(--spacingVerticalS);padding-left:var(--spacingHorizontalS);padding-bottom:var(--spacingVerticalS);padding-right:var(--spacingHorizontalS);row-gap:var(--spacingVerticalXS);word-break:break-word;font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase200);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase200);}"]),Je=o.forwardRef((e,t)=>{const n=((e,t)=>({components:{root:"div"},root:d.slot.always((0,d.getIntrinsicElementProps)("div",{ref:t,...e}),{elementType:"div"})}))(e,t);return(e=>{const t=Ye();e.root.className=(0,d.mergeClasses)("fai-PreviewContent",t,e.root.className)})(n),(e=>((0,d.assertSlots)(e),(0,d.jsx)(e.root,{})))(n)});Je.displayName="PreviewContent";const Xe=(0,d.__styles)({root:{},heading:{Bahqtrf:"fk6fouc",Be2twd7:"fy9rknc",Bhrd7zp:"flh3ekv",Bg96gwp:"fwrc4pm",sj55zd:"f19n0e5"},message:{},previewSurface:{B2u0y6b:"fwf794f"},trigger:{}},{d:[".fk6fouc{font-family:var(--fontFamilyBase);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".flh3ekv{font-weight:var(--fontWeightBold);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".f19n0e5{color:var(--colorNeutralForeground1);}",".fwf794f{max-width:293px;}"]}),Ze=o.forwardRef((e,t)=>{const n=((e,t)=>({positioning:{offset:8,...(0,Be.resolvePositioningShorthand)(e.positioning)},components:{root:"span",heading:"span",message:"span",previewSurface:Ve,trigger:"span"},root:d.slot.always((0,d.getIntrinsicElementProps)("span",{ref:t,...e}),{elementType:"span"}),heading:d.slot.optional(e.heading,{elementType:"span"}),message:d.slot.optional(e.message,{elementType:"span"}),previewSurface:d.slot.optional(e.previewSurface,{defaultProps:{tabIndex:0},elementType:Ve,renderByDefault:!0}),trigger:d.slot.optional(e.trigger,{elementType:"span",defaultProps:{children:e.children},renderByDefault:!0})}))(e,t);return(e=>{const t=Xe();e.root.className=(0,d.mergeClasses)("fai-SensitivityTooltip",t.root,e.root.className),e.heading&&(e.heading.className=(0,d.mergeClasses)("fai-SensitivityTooltip__heading",t.heading,e.heading.className)),e.message&&(e.message.className=(0,d.mergeClasses)("fai-SensitivityTooltip__message",t.message,e.message.className)),e.previewSurface&&(e.previewSurface.className=(0,d.mergeClasses)("fai-SensitivityTooltip__previewSurface",t.previewSurface,e.previewSurface.className)),e.trigger&&(e.trigger.className=(0,d.mergeClasses)("fai-SensitivityTooltip__trigger",t.trigger,e.trigger.className))})(n),(e=>((0,d.assertSlots)(e),(0,d.jsx)(e.root,{children:e.previewSurface&&(0,d.jsxs)(qe,{trapFocus:!0,positioning:e.positioning,children:[(0,d.jsx)(Qe,{children:e.trigger&&(0,d.jsx)(e.trigger,{})}),(0,d.jsx)(e.previewSurface,{children:(0,d.jsxs)(Je,{children:[e.heading&&(0,d.jsx)(e.heading,{}),e.message&&(0,d.jsx)(e.message,{})]})})]})})))(n)});Ze.displayName="SensitivityTooltip";const $e=I("Shield16Filled","16",["M7.65 2.15c.2-.2.5-.2.7 0A5.71 5.71 0 0 0 12.5 4c.28 0 .5.22.5.5v3c0 3.22-1.64 5.4-4.84 6.47a.5.5 0 0 1-.32 0C4.64 12.91 3 10.72 3 7.5v-3c0-.28.22-.5.5-.5 1.53 0 2.9-.61 4.15-1.85Z"]),et=I("Shield16Regular","16",["M7.65 2.15c.2-.2.5-.2.7 0A5.71 5.71 0 0 0 12.5 4c.28 0 .5.22.5.5v3c0 3.22-1.64 5.4-4.84 6.47a.5.5 0 0 1-.32 0C4.64 12.91 3 10.72 3 7.5v-3c0-.28.22-.5.5-.5 1.53 0 2.9-.61 4.15-1.85ZM8 3.19a6.65 6.65 0 0 1-4 1.8V7.5c0 1.43.36 2.57 1.02 3.45.64.85 1.61 1.54 2.98 2.02a6.13 6.13 0 0 0 2.98-2.02A5.57 5.57 0 0 0 12 7.5V4.98a6.64 6.64 0 0 1-4-1.8Z"]),tt=I("ShieldLock16Filled","16",["M8.35 2.15a.5.5 0 0 0-.7 0A5.72 5.72 0 0 1 3.5 4a.5.5 0 0 0-.5.5v3c0 2.92 1.35 5 4 6.15V10a2 2 0 0 1 1.5-1.94V8A3 3 0 0 1 13 5.4v-.9a.5.5 0 0 0-.5-.5c-1.53 0-2.9-.61-4.15-1.85ZM9.5 9V8a2 2 0 1 1 4 0v1h.5a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-4a1 1 0 0 1 1-1h.5Zm1-1v1h2V8a1 1 0 1 0-2 0Zm1.75 4a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Z"]),nt=I("ShieldLock16Regular","16",["M7.65 2.15c.2-.2.5-.2.7 0A5.71 5.71 0 0 0 12.5 4c.28 0 .5.22.5.5v.9c-.3-.17-.64-.3-1-.36v-.06a6.64 6.64 0 0 1-4-1.8 6.65 6.65 0 0 1-4 1.8V7.5c0 1.43.36 2.57 1.02 3.45A5.54 5.54 0 0 0 7 12.55v1.1A6.24 6.24 0 0 1 3 7.5v-3c0-.28.22-.5.5-.5 1.53 0 2.9-.61 4.15-1.85ZM9.5 8v1H9a1 1 0 0 0-1 1v4a1 1 0 0 0 1 1h5a1 1 0 0 0 1-1v-4a1 1 0 0 0-1-1h-.5V8a2 2 0 1 0-4 0Zm1 1V8a1 1 0 1 1 2 0v1h-2Zm1 2.25a.75.75 0 1 1 0 1.5.75.75 0 0 1 0-1.5Z"]),at=(0,d.__styles)({root:{mc9l5x:"f14t3ns0",qhf8xq:"f10pi13n",a9b677:"fjw5fx7",Bqenvij:"fd461yt"},backgroundIcon:{qhf8xq:"f1euv43f",Bj3rh1h:"f11zp4z2"},foregroundIcon:{qhf8xq:"f1euv43f",Bj3rh1h:"f19g0ac",sj55zd:"f19n0e5"}},{d:[".f14t3ns0{display:inline-block;}",".f10pi13n{position:relative;}",".fjw5fx7{width:16px;}",".fd461yt{height:16px;}",".f1euv43f{position:absolute;}",".f11zp4z2{z-index:0;}",".f19g0ac{z-index:1;}",".f19n0e5{color:var(--colorNeutralForeground1);}"]}),it=o.forwardRef((e,t)=>{const n=((e,t)=>{var n,a;const{fillColor:i,withLock:r=!1,role:s="img"}=e,c={components:{root:"span",foregroundIcon:"span",backgroundIcon:"span"},root:d.slot.always((0,d.getIntrinsicElementProps)("span",{ref:t,role:s,...e}),{elementType:"span"}),foregroundIcon:d.slot.optional(e.foregroundIcon,{renderByDefault:!0,elementType:"span"}),backgroundIcon:d.slot.optional(e.backgroundIcon,{renderByDefault:!0,elementType:"span"})};return!!o.Children.count(null===(n=c.foregroundIcon)||void 0===n?void 0:n.children)||!!o.Children.count(null===(a=c.backgroundIcon)||void 0===a?void 0:a.children)||(c.foregroundIcon&&(c.foregroundIcon.children=r?o.createElement(nt,null):o.createElement(et,null)),c.backgroundIcon&&i&&(c.backgroundIcon.children=r?o.createElement(tt,{primaryFill:i}):o.createElement($e,{primaryFill:i}))),c})(e,t);return(e=>{const t=at();e.root.className=(0,d.mergeClasses)("fai-SensitivityIcon",t.root,e.root.className),e.foregroundIcon&&(e.foregroundIcon.className=(0,d.mergeClasses)("fai-SensitivityIcon__foregroundIcon",t.foregroundIcon,e.foregroundIcon.className)),e.backgroundIcon&&(e.backgroundIcon.className=(0,d.mergeClasses)("fai-SensitivityIcon__backgroundIcon",t.backgroundIcon,e.backgroundIcon.className))})(n),(e=>((0,d.assertSlots)(e),(0,d.jsxs)(e.root,{children:[e.backgroundIcon&&(0,d.jsx)(e.backgroundIcon,{}),e.foregroundIcon&&(0,d.jsx)(e.foregroundIcon,{}),e.root.children]})))(n)});it.displayName="SensitivityIcon";var rt=E(698),ot=E(856),st="requiredDiagnostic",ct="optionalDiagnostic",dt="requiredService",lt=e,ut=(0,ot.createPairedEvent)({eventName:"Api,Qos,",shortEventName:"Api"},{url:1,privacyClassification:{isPrefixingDisabled:!0,type:1}},rt.Qos).withData({privacyClassification:lt.requiredService});function ft(e){return function(e){return!!e&&!0===e.__isPrivacyDataWrapper}(e)?e._value:e}var pt=function(e){void 0===e&&(e={});var t,n,a=e.message,i=e.innerError;a&&("string"==typeof a?t=a:(t=ft(a))&&(n=a)),!t&&i&&(t=i.message,i.loggableMessage&&(n=i.loggableMessage));var r=new Error(t);for(var o in this.message=r.message,this.innerError=i,this.loggableMessage=n||function(e,t){if(void 0!==e&&""!==e)return{_value:ft(e),_type:"unsafe",__isPrivacyDataWrapper:!0}}(this.message),this.stack=r.stack,this.name=r.name,this)Object.prototype.hasOwnProperty.call(this,o)&&(r[o]=this[o]);var s=Object.getPrototypeOf(this);if(Error.captureStackTrace&&Error.captureStackTrace(r,s),Object.setPrototypeOf)return Object.setPrototypeOf(r,s),r};Object.setPrototypeOf&&(pt.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(pt,Error));var mt=function(e){function t(t){var n=e.call(this,t)||this;n.name="ApiError";var a=t.innerError||void 0,i=a?(0,u.__assign)((0,u.__assign)((0,u.__assign)((0,u.__assign)((0,u.__assign)({},"string"==typeof a.correlationId?{correlationId:a.correlationId}:{}),"boolean"==typeof a.isExpected?{isExpected:a.isExpected}:{}),"string"==typeof a.name?{code:a.name}:{}),"string"==typeof a.code?{code:a.code}:{}),"object"==typeof a.extraData?{extraData:a.extraData}:{}):{},r=t.correlationId,o=void 0===r?i.correlationId:r,s=t.isExpected,c=void 0===s?i.isExpected:s,d=t.extraData;return n.correlationId=o,n.isExpected=!!c,n.code="function"==typeof t.code?t.code(i.code)||"":t.code||i.code||"",n.extraData=(0,u.__assign)((0,u.__assign)({},i.extraData||{}),d||{}),n}return(0,u.__extends)(t,e),t}(pt),_t=function(e){function t(t,n){var a=this,i=n.response,r=(void 0===i?{}:i).error,o=(void 0===r?{}:r).innerError,s=(void 0===o?{}:o).stackTrace,c=void 0===s?"":s,d=n.response,l=n.request,f=n.status,p=n.code,m=void 0===p?bt(d,f,function(e){return"".concat(e)})||"unhandled":p,_=(0,u.__assign)({innerError:t,code:m},n);return(a=e.call(this,_)||this).name="GraphError",a.response=d,a.status=f,a.serverStack=c,a.request=l,a.error=t,a}return(0,u.__extends)(t,e),t}(mt);function ht(e){var t={};if(t.errorMessage=e.message,function(e){return!!e&&e instanceof _t}(e)){t.vroomStatus=e.status;var n=e.response;if(n&&n.error){var a=n.error;t.vroomErrorCode=a.code,t.vroomErrorMessage=a.message;var i=a.innerError||a.innererror;i&&(t.vroomErrorInnerCode=i.code,t.vroomErrorInnerMessage=i.message,t.vroomErrorInnerDebugMessage=i.debugMessage,t.vroomErrorInnerStack=i.stackTrace)}}return t}function bt(e,t,n){if(e){for(var a=[],i=e.error;i;)a.push(i),i=i.innerError||i.innererror;for(;i=a.pop();)if(void 0!==i.code){var r=n(i.code);if(void 0!==r)return r}}return n(t)}var gt=E(748),vt="Authorization";function yt(e){var t=new P.SimpleUri(e);return"".concat(t.authority,"/{ length: ").concat(t.path.length,", segments: ").concat(t.segments.length," }")}function St(e){var t,n,a=null!==(n=null===(t=e.getAllResponseHeaders())||void 0===t?void 0:t.toLowerCase())&&void 0!==n?n:"";return a.indexOf("sprequestguid")>=0&&e.getResponseHeader("sprequestguid")||a.indexOf("request-id")>=0&&e.getResponseHeader("request-id")||void 0}function Dt(e){var t,n;return(null!==(n=null===(t=e.getAllResponseHeaders())||void 0===t?void 0:t.toLowerCase())&&void 0!==n?n:"").indexOf("ms-cv:")>=0&&e.getResponseHeader("MS-CV")||void 0}var It=!rt.KillSwitch.isActivated("EB2DD8AB-1C38-40FA-AFFC-05AD9C808734"),xt=!rt.KillSwitch.isActivated("884C4D49-FAA1-41DA-AB27-76D985D391FF"),Ct=rt.KillSwitch.isActivated("32629518-3CBD-4B34-8DAC-52AC471DCC11"),Ot=window&&window.performance,wt={activityLimitReached:!0,malwareDetected:!0,nameAlreadyExists:!0,resourceModified:!0,resyncRequired:!0,quotaLimitReached:!0,accessRestricted:!0,childItemCountExceeded:!0,entityTagDoesNotMatch:!0,fragmentOutOfOrder:!0,fragmentOverlap:!0,hipCheckRequired:!0,insufficientVaultQuota:!0,lockMismatch:!0,lockNotFoundOrAlreadyExpired:!0,lockOwnerMismatch:!0,maxDocumentCountExceeded:!0,maxFileSizeExceeded:!0,maxFolderCountExceeded:!0,maxItemCountExceeded:!0,nameContainsInvalidCharacters:!0,pathIsTooLong:!0,pathTooDeep:!0,pathIsTooDeep:!0,propertyNotUpdateable:!0,resyncApplyDifferences:!0,resyncUploadDifferences:!0,serviceReadOnly:!0,throttledRequest:!0,unlockRequired:!0,versionNumberDoesNotMatch:!0,virusSuspicious:!0,authFailure:!1},Et="Bearer",At=function(){function e(e,t){this._sendSyncClientHeadersKs=rt.KillSwitch.isActivated("00babe87-7679-4e02-94f0-4c05915282ca","3/29/2023");var n=e.alwaysSendContentType,a=void 0!==n&&n,i=t.sessionManagementProvider,r=t.urlDataSource,o=t.apiEvent,s=void 0===o?ut:o,c=t.cookieOrigin,d=t.isOffline,l=t.dataSyncClient;this._sessionManagementProvider=i,this._alwaysSendContentType=a,this._apiEvent=s,this._apiName=r&&"function"==typeof r.getApiName?r.getApiName():"Vroom",this._urlDataSource=r,this._cookieOrigin=c,this._isOffline=d,this._dataSyncClient=l,this._encodingFixEnabled=!rt.KillSwitch.isActivated("179f8622-1596-43df-a186-a4b42e1d7917","08/04/2020","Decode unicode characters in graph errors")&&!rt.FeatureOverrides.isFeatureEnabled({ODC:"GraphEncodingFixKillswitch"}),this._driveIdUrlCheckEnabled=!rt.KillSwitch.isActivated("16BE6F20-C2C6-46AF-8EA5-6D43B30F7112","06/09/2022","Validate driveUrl against driveId")}return e.prototype.send=function(e){var t=this,n=function(n){var a,i,r,o,s=e.headers,c=void 0===s?{}:s,d=e.driveUrl,l=e.driveId,f=e.apiName,p=e.disableLogging,m=void 0!==p&&p,_=e.timeout,h=e.onProgress,b=e.onUploadProgress,g=e.qosExtraData,v=e.apiVersion,y=void 0===v?"v2.0":v,S=e.needsAuthorization,D=void 0===S||S,I=e.useStrongAuthToken,x=void 0!==I&&I,C=e.postProcessQos,O=e.breakCache,w=e.allowCookies,E=e.hasContentType,A=void 0===E||E,L=e.useMultiPart,k=void 0!==L&&L,M=e.getErrorAsMessage,T=void 0!==M&&M,U=e.expectedErrors,F=e.endpoint,H=n.path,R=n.accessToken,N=n.forceContentType,B=void 0!==N&&N,j=n.useExactAuthToken,V=void 0!==j&&j,z=n.headers;if(!F){var G="v2.1"===y?y:void 0;F=t._urlDataSource?"function"==typeof t._urlDataSource.getApiBaseUrl?t._urlDataSource.getApiBaseUrl({apiVersion:G,driveId:l}):null===(i=(a=t._urlDataSource).getVroomApiBaseUrl)||void 0===i?void 0:i.call(a):void 0}var K=null===(o=null===(r=t._urlDataSource)||void 0===r?void 0:r.getRoutingKey)||void 0===o?void 0:o.call(r);if(t._driveIdUrlCheckEnabled&&d&&l&&("me"!==l?"".concat(F,"/drives/").concat(l):d)!==d)throw new mt({code:"DriveIdAndDriveUrlMismatch"});var W=(0,u.__assign)((0,u.__assign)({},wt),e.expectedErrorCodes||{}),q=e.requestType,Q=void 0===q?"GET":q,Y=t._cookieOrigin,J=new P.SimpleUri(H).authority?H:"".concat(F).concat(H),X=function(n){var a,i,r,o="",s={};k?(o=rt.Guid.generate(),s={"Content-Type":"multipart/form-data;boundary=".concat(o)}):s=(0,u.__assign)((0,u.__assign)((0,u.__assign)((0,u.__assign)((0,u.__assign)((0,u.__assign)((0,u.__assign)({Accept:"application/json"},(e.postData||t._alwaysSendContentType)&&A||B?{"Content-Type":"application/json"}:{}),n.useCookies&&n.digestValue?{"x-requestdigest":n.digestValue}:{}),It&&K?{"X-FDROUTEKEYHEADER":K}:{}),T?{prefer:"rich-error-as-message"}:{}),rt.KillSwitch.isActivated("99EE4BC8-A7CF-47FA-9104-3CBB7479E126","01/10/2024","Killswitch to enable locale for accept language")?{}:{"Accept-Language":rt.Locale.language}),c),t._sendSyncClientHeadersKs?{}:z),n.sessionToken&&n.sessionToken.tokenUrl&&0===H.indexOf("/drive/")?r=new rt.Uri("".concat(n.sessionToken.tokenUrl,"/").concat(H.substring(7))):(r=new rt.Uri(H),F&&!r.getScheme()&&(r=new rt.Uri(F+H))),k&&(r.setQueryParameter("ump","1"),"POST"!==Q&&(c["X-HTTP-Method-Override"]=Q),Q="POST");var d,l,p=function(e){var t=e.sessionToken,n=e.useExactAuthToken;if(t){var a=t.accessToken,i=t.proofToken,r=t.wlidToken,o=t.isBadger;if(r)return{name:vt,value:"wlid1.1 ".concat(r)};if(a)return{name:vt,value:n?a:"".concat(o?"badger":"bearer"," ").concat(a)};if(i)return{name:"X-PROOF_TOKEN",value:i}}}({sessionToken:n.sessionToken,useExactAuthToken:V});if(k||p&&(s=(0,u.__assign)((0,u.__assign)({},s),((a={})[p.name]=p.value,a))),k){if(d="",d+="--".concat(o,"\r\n"),d+="Content-Disposition: form-data;name=data\r\n",c)for(var v=0,y=Object.keys(c);v<y.length;v++){var S=y[v];d+="".concat(S,": ").concat(c[S],"\r\n")}d+="Content-Type: application/json\r\n",p&&(d+="".concat(p.name,": ").concat(p.value,"\r\n")),T&&(d+="prefer: rich-error-as-message\r\n"),d+="\r\n",d+="".concat(void 0!==e.postData?e.postData:"","\r\n"),d+="--".concat(o,"--")}O&&r.setQueryParameter("r",Math.random().toFixed(8)),(null===(i=n.sessionToken)||void 0===i?void 0:i.authKey)&&r.setQueryParameter("authKey",n.sessionToken.authKey);var D="".concat(t._apiName,"DataRequest.").concat(f);if(!m){var I={url:yt(r.toString()),name:D,extraData:g};l=new t._apiEvent(I)}var x=r.toString(),w=Ot&&Ot.now();return P.XHRPromise.start({url:x,headers:s,method:Q,json:d||e.postData||"",requestTimeoutInMS:_,withCredentials:n.useCookies,onProgress:h,onUploadProgress:b,responseType:e.responseType||void 0}).then(function(t){var n=(0,P.getRequestEntryDurationMetrics)(x,w);if(l){var a=St(t),i={resultType:rt.ResultTypeEnum.Success,extraData:(0,u.__assign)((0,u.__assign)({},g||{}),{rawRequestDuration:n.duration,performanceEntry:JSON.stringify(n),requestId:a,CorrelationId:a,MSCorrelationVector:Dt(t)})};l.end(i)}return e.parseResponse?e.parseResponse(t):0===t.responseText.length?null:JSON.parse(t.responseText)},function(e){return(0,u.__awaiter)(t,void 0,void 0,function(){var t,a,i,o,s,c,d,f,p,m,_,h,b,v,y,S,I,O,E,A,L,k,M;return(0,u.__generator)(this,function(F){switch(F.label){case 0:return t=function(e,t){return C&&(e=C(e,t)),l&&l.end(e),rt.Promise.reject(t)},a=(0,P.getRequestEntryDurationMetrics)(x,w),e instanceof Error?(i=rt.Promise.isCanceled(e),o=i?rt.ResultTypeEnum.ExpectedFailure:rt.ResultTypeEnum.Failure,s={error:e.message,resultCode:i?"Canceled":"",resultType:o,extraData:{rawRequestDuration:a.duration,performanceEntry:JSON.stringify(a)}},[2,t(s,e)]):[3,1];case 1:if(("text"===e.responseType||""===e.responseType)&&e.responseText)try{c=JSON.parse(e.responseText)}catch(e){}if(Ct||"blob"!==e.responseType||!(e.response.size>0))return[3,5];F.label=2;case 2:return F.trys.push([2,4,,5]),f=(d=JSON).parse,[4,e.response.text()];case 3:return c=f.apply(d,[F.sent()]),[3,5];case 4:return F.sent(),[3,5];case 5:if(T)try{"string"==typeof(p=null===(M=null==c?void 0:c.error)||void 0===M?void 0:M.message)&&(m=this._encodingFixEnabled?JSON.parse(decodeURIComponent(escape(atob(p)))):JSON.parse(atob(p)),c={error:m})}catch(e){}return _=e.status,h=e.statusText,b=(c||{}).error,y=(v=void 0===b?{}:b).message,S=void 0===y?"":y,I=v.innerError,E=(O=void 0===I?{}:I).stackTrace,A=void 0===E?"":E,L=O.debugMessage,k=void 0===L?"":L,[2,(_||!this._isOffline?rt.Promise.resolve(!1):this._isOffline()).then(function(i){var o=St(e),s=i||!!bt(c,_,function(e){return W[e]||!(!U||!(0,gt.isExpectedError)({code:"".concat(e),message:S},U))||void 0}),d=function(e){var t=e.error,n=e.isOffline,a=(null==t?void 0:t.message)||"",i=a;return("string"!=typeof i&&i.value?i.value:a)||(n?"Offline":"")}({error:null==c?void 0:c.error,isOffline:i}),l=new _t(new Error(d),{response:c,status:_,request:e,correlationId:o,isExpected:s,extraData:{apiEventName:D}}),f={resultType:s?rt.ResultTypeEnum.ExpectedFailure:rt.ResultTypeEnum.Failure,error:S,resultCode:l.code,extraData:(0,u.__assign)((0,u.__assign)((0,u.__assign)({},g||{}),ht(l)),{stack:A,httpStatus:_,httpStatusText:h,requestId:o,CorrelationId:o,MSCorrelationVector:Dt(e),debugMessage:k,accessTokenLength:n.sessionToken&&n.sessionToken.accessToken?n.sessionToken.accessToken.length:-1,urlLength:r.toString().length,useCookies:!!n.useCookies,isOffline:i,rawRequestDuration:a.duration,performanceEntry:JSON.stringify(a)})};return t(f,l)})]}})})})},Z=t._sessionManagementProvider;if(D){if(R)return X({sessionToken:R});if(xt&&x&&Z&&Z.getToken)return Z.getToken(y,J,{apiQosName:f,useStrongAuthToken:!0}).then(function(e){return X({sessionToken:e})});var $=new P.SimpleUri(J).authority;if(w&&$&&Y&&$===Y){if("GET"===Q)return X({useCookies:!0});if(Z&&Z.getFormDigest)return Z.getFormDigest(J).then(function(e){return X({digestValue:e,useCookies:!0})})}if(Z&&Z.getSessionToken){var ee={apiVersion:y,endpoint:F,driveUrl:d,path:J,apiQosName:f};return rt.Promise.resolve(Z.getSessionToken(ee)).then(function(e){return X({sessionToken:e}).catch(function(t){return Z.getSessionToken&&e&&function(e){if(e instanceof _t){var t=e.request,n=t&&t.getResponseHeader("WWW-Authenticate");if(n&&n.slice(0,Et.length)===Et&&n.indexOf('error="insufficient_claims"')>-1)return!0}return!1}(t)?Z.getSessionToken((0,u.__assign)((0,u.__assign)({},ee),{claimsChallenge:{sessionToken:e,claims:Lt(t),error:t}})).then(function(n){return n.accessToken!==e.accessToken?X({sessionToken:n}):rt.Promise.reject(t)}):rt.Promise.reject(t)})})}if(Z&&Z.getToken)return Z.getToken(y,J,{apiQosName:f}).then(function(e){return X({sessionToken:e})})}return X({})},a=(0,u.__assign)({},e);return!rt.KillSwitch.isActivated("83F9234E-0E49-4110-943D-2F0394E9F9FF","5/24/2022","Route graph calls to Nucleus")&&this._dataSyncClient?function(e){var t=e.dataSyncClient,n=e.options,a=e.getData,i=function(){return a(n)};return rt.Promise.resolve(t).then(function(t){return t?function(t){return t.getData({url:n.path,method:n.requestType},function(t){var n=t.endpoint,i=t.headers,r=t.onComplete,o=(0,u.__assign)((0,u.__assign)({},e.options),{path:n.url,accessToken:{accessToken:n.authToken},forceContentType:!0,useExactAuthToken:!0,headers:i,onComplete:r});return a(o)},i)}(t):i()})}({dataSyncClient:this._dataSyncClient,options:a,getData:n}):n(a)},e}();function Lt(e){var t=e.request&&e.request.getResponseHeader("WWW-Authenticate"),n='claims="';if(t){var a=t.indexOf(n);if(a>-1){var i=t.indexOf('"',a+n.length);if(i>-1){var r=t.slice(a+n.length,i);return rt.KillSwitch.isActivated("93E9F77D-7B3B-4760-B58F-1154E9E530ED","06/02/2022","Decode claims from base64")?r:atob(r)}}}}var kt=0,Mt=1,Pt=2,Tt=r;function Ut(e,t){for(var n="";n.length<e;){var a=16*(null!=t?t:Math.random)();n+=(a|=0).toString(16)}return n}function Ft(e){var t=[];t.push(Ut(8,e)),t.push(Ut(4,e));var n="4"+Ut(3,e);t.push(n);var a=Ut(4,e),i=parseInt(a[0],16);return i&=3,a=(i|=8).toString(16)+a.substr(1),t.push(a),t.push(Ut(12,e)),t.join("-")}var Ht,Rt="undefined"==typeof window?self:window,Nt=rt.KillSwitch.isActivated("18a3d374-cced-4d7f-be15-3b0a8dda8152"),Bt=rt.KillSwitch.isActivated("9ed80e27-f0bc-4d9b-ad35-6407121dbfbb");!function(e){e.success="success",e.error="error"}(Ht||(Ht={}));var jt="app",Vt="app_lastRead",zt="ODSP_DB",Gt="ODSP_DB_TABLE",Kt="lastModified",Wt="lastRead",qt="ODSP_DB_METADATA_TABLE",Qt="database_metadata",Yt="parentKey",Jt="reads",Xt=(new function(e){var t="undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0;e||(e=t&&t.navigator&&navigator.userAgent||"");var n,a=e,i=e.toLowerCase(),r=function(e){var t;function n(n){return t=RegExp("".concat(n,"(\\d+)([\\d.]*)")).exec(e)}e=e.toLowerCase();var a=n("msie ")||n("trident.*rv:"),i=t&&"9"===t[1],r=!t&&n("(?:edge|edgios)/"),o=!t&&n("edg/"),s=!t&&n("fxios|firefox/"),c=!t&&n("(?:chrome|crios)/"),d=!t&&/safari\/(\d+)/.test(e);d&&n("version/");var l=!t&&/compatible; [a-z]+;/.test(e);return l&&n("trident/"),{browserName:a||l?"IE":r?"Edge":o?"EdgeChromium":s?"Firefox":c?"Chrome":d?"Safari":"NA",isChrome:!!c,isEdge:!!r,isEdgeChromium:!!o,isFirefox:!!s,isIE:!!a||!!l,isIE9:!!i,isSafari:!!d,matchedBrowser:t}}(i),o={browserMajor:(n=r.matchedBrowser)&&parseInt(n[1],10)||0,browserMinor:n&&n[2]&&n[2].slice(1)||"0"},s=function(e){e=e.toLowerCase();var t=/windows phone|wpdesktop/.test(e),n=t||/ipad|iphone|ipod|android/.exec(e),a=n&&n[0],i="android"===a,r="ipad"===a,o=!!a&&!i,s=!n&&e.indexOf("macintosh")>-1,c=!n&&e.indexOf("windows nt")>-1;return{isAndroid:i,isIOS:o,isIPad:r,isMac:s,isWindows:c,isWinPhone:!!t,isMobile:!!n,osName:c?"Windows":t?"Windows Phone":s?"OSX":o?"IOS":i?"Android":"NA"}}(i),c=s.isMobile,d=/electron\/\\d+[\\d.]*/.test(i),l=i.indexOf("winappwipenabled")>-1,f=!("undefined"==typeof window||!window.matchMedia)&&(window.matchMedia("(display-mode: standalone)").matches||window.matchMedia("(display-mode: minimal-ui)").matches),p=/[\s\(](os|os x|windows (?:phone|nt)|android) ([\d._]+)/.exec(i),m=!1,_=!1,h=!1,b=!1;if(t&&t.document){var g=document.createElement("style");g.type="text/css",m=!g.styleSheet,_="addBehavior"in HTMLDivElement.prototype;var v=document.createElement("input");v.type="file";var y=t.File,S=y&&y.prototype;b=!(!S||!(S.slice||S.mozSlice||S.webkitSlice)),h="webkitdirectory"in v&&!d}return(0,u.__assign)((0,u.__assign)((0,u.__assign)((0,u.__assign)({},r),o),s),{isElectron:d,osVersion:p?p[2]:"NA",isWindows81:!c&&/windows (?:8\.1|nt 6\.3)/.test(i),isWindows10:!c&&i.indexOf("windows nt 10")>-1,isWindows7:!c&&i.indexOf("windows nt 6.1")>-1,isWinAppWipEnabled:l,isPWA:f,areCSS3TransitionsSupported:!r.isIE||o.browserMajor>9,areTouchEventsSupported:!!t&&"ontouchstart"in t,isFolderUploadSupported:h,isHtml5FileUploadSupported:b,isRetinaSupported:!!t&&t.devicePixelRatio>1,isUnlimitedStyleSheetsSupported:m,isWebDavSupported:_,userAgent:a})}).isFirefox,Zt="indexedDB is not supported",$t=function(){function e(t){if(!("indexedDB"in Rt)||!Rt.indexedDB)throw new Error(Zt);var n,a;this._logger=t,e._openDBPromise||(Nt||(n=this._logger({name:"PersistentCacheIDB.openDB"}),a=Date.now()),e._openDBPromise=this._openIndexedDB().then(function(t){return Nt||n&&n({resultType:rt.ResultTypeEnum.Success,extraData:{dbOpen:Math.round(Date.now()-a)}}),e._db=t,t}).catch(function(e){throw Nt||n&&n({resultType:rt.ResultTypeEnum.Failure,error:e.message?e.message:e.toString()}),e}))}return e.prototype.freeSpace=function(t,n){return(0,u.__awaiter)(this,void 0,void 0,function(){var a,i,r,o=this;return(0,u.__generator)(this,function(s){switch(s.label){case 0:return i=e,(r=e._db)?[3,2]:[4,e._openDBPromise];case 1:r=s.sent(),s.label=2;case 2:return a=i._db=r,[2,new Promise(function(e,i){var r=a.transaction([Gt],"readwrite").objectStore(Gt).index(Vt).openCursor();r.onsuccess=function(a){var i=r.result;i?(i.value.app===t&&n>0&&(n-=i.value.size,i.delete()),n>0?i.continue():e()):e()},r.onerror=function(e){o._errorHandling(e,i)}})]}})})},e.prototype.read=function(e){return(0,u.__awaiter)(this,void 0,void 0,function(){return(0,u.__generator)(this,function(t){return[2,this._readInternal(Gt,function(t){return t.get(e)})]})})},e.prototype.rangeQuery=function(t){return(0,u.__awaiter)(this,void 0,void 0,function(){var n,a,i,r,o,s,c,d,l,f,p,m,_,h=this;return(0,u.__generator)(this,function(u){switch(u.label){case 0:return n={},i=e,(r=e._db)?[3,2]:[4,e._openDBPromise];case 1:r=u.sent(),u.label=2;case 2:return a=i._db=r,o=a.transaction([Gt],"readonly"),s=o.objectStore(Gt),c=[],d=t.index,l=t.range,f=t.direction,p=t.count,m=s.index(d),(_=m.openKeyCursor(l,f)).onerror=function(e){h._errorHandling(e,n.reject)},_.onsuccess=function(e){var t=e.target.result;t?(c.push(t.primaryKey),c.length>=p?n.resolve(c):t.continue()):n.resolve(c)},[2,new Promise(function(e,t){n.resolve=e,n.reject=t})]}})})},e.prototype.write=function(e){return(0,u.__awaiter)(this,void 0,void 0,function(){var t;return(0,u.__generator)(this,function(n){return t=e.key,void 0!==e.data?[2,this._writeInternal({tableName:Gt,key:t,row:(0,u.__assign)((0,u.__assign)({},e),{lastModified:Date.now()})})]:void 0!==e.parentKey?[2,this._deleteDataRows(e.parentKey)]:[2,this._writeInternal({tableName:Gt,key:t,row:void 0})]})})},e.prototype.statistics=function(){return(0,u.__awaiter)(this,void 0,void 0,function(){var e,t;return(0,u.__generator)(this,function(n){switch(n.label){case 0:return this._dbMetaData?[3,2]:[4,this._readAndSetMetadataDB()];case 1:e=n.sent(),this._dbMetaData=e,n.label=2;case 2:return[4,this._iterate(Gt,function(e){return e.size})];case 3:return t=n.sent(),[2,{metaData:this._dbMetaData,count:t.length,totalBytes:t.reduce(function(e,t){return e+t},0)}]}})})},e.prototype._openIndexedDB=function(){var t=this;return new Promise(function(n,a){if(e._db)n(e._db);else{var i=Bt&&Xt?indexedDB.open(zt,{version:4,storage:"temporary"}):indexedDB.open(zt,4);i.onerror=function(e){t._errorHandling(e,a)},i.onsuccess=function(t){var a=e._db=i.result;n(a)},i.onupgradeneeded=function(e){var n=e.target.result;n.onerror=function(e){t._errorHandling(e,a)};var r=e.oldVersion;t._handleDBUpgrade(i,n,r)}}})},e.prototype._handleDBUpgrade=function(e,t,n){var a;n<1&&((a=t.createObjectStore(Gt,{keyPath:"key"})).createIndex(Kt,Kt,{unique:!1}),a.createIndex(Jt,Jt,{unique:!1}),t.createObjectStore(qt,{keyPath:"key"})),n<2&&((a=a||e.transaction.objectStore(Gt)).createIndex(jt,jt,{unique:!1}),a.createIndex(Wt,Wt,{unique:!1}),a.createIndex(Vt,[jt,Wt],{unique:!1})),n<3&&((a=a||e.transaction.objectStore(Gt)).createIndex("app_lastModified",[jt,Kt],{unique:!1}),a.createIndex("app_reads",[jt,Jt],{unique:!1})),n<4&&((a=a||e.transaction.objectStore(Gt)).createIndex(Yt,Yt,{unique:!1}),a.createIndex("parentKey_app",[Yt,jt],{unique:!1}),a.createIndex("parentKey_app_lastModified",[Yt,jt,Kt],{unique:!1}),a.createIndex("parentKey_app_lastRead",[Yt,jt,Wt],{unique:!1}),a.createIndex("parentKey_app_reads",[Yt,jt,Jt],{unique:!1}))},e.prototype._readAndSetMetadataDB=function(){var e=this;return this._readInternal(qt,function(e){return e.get(Qt)}).then(function(t){if(t)return t.data;var n={id:Ft(),created:Date.now(),cacheType:Tt.indexedDB};return e._writeInternal({tableName:qt,key:Qt,row:{key:Qt,data:n}}).then(function(){return n})})},e.prototype._readInternal=function(t,n){return(0,u.__awaiter)(this,void 0,void 0,function(){var a,i,r,o=this;return(0,u.__generator)(this,function(s){switch(s.label){case 0:return i=e,(r=e._db)?[3,2]:[4,e._openDBPromise];case 1:r=s.sent(),s.label=2;case 2:return a=i._db=r,[2,new Promise(function(e,i){var r=o._logger({name:"PersistentCacheIDB.readInternal"}),s=Date.now(),c=a.transaction([t],"readonly").objectStore(t),d=n(c);d.onsuccess=function(t){r({resultType:rt.ResultTypeEnum.Success,extraData:{io:Math.round(Date.now()-s)}}),e(d.result)},d.onerror=function(e){r({resultType:rt.ResultTypeEnum.Failure,extraData:{io:Math.round(Date.now()-s)}}),o._errorHandling(e,i)}})]}})})},e.prototype._iterate=function(t,n){return(0,u.__awaiter)(this,void 0,void 0,function(){var a,i,r,o,s=this;return(0,u.__generator)(this,function(c){switch(c.label){case 0:return i=e,(r=e._db)?[3,2]:[4,e._openDBPromise];case 1:r=c.sent(),c.label=2;case 2:return a=i._db=r,o=[],[2,new Promise(function(e,i){var r=a.transaction([t],"readonly").objectStore(t).openCursor();r.onsuccess=function(t){var a=r.result;a?(o.push(n(a.value)),a.continue()):e(o)},r.onerror=function(e){s._errorHandling(e,i)}})]}})})},e.prototype._writeInternal=function(t){return(0,u.__awaiter)(this,void 0,void 0,function(){var n,a,i,r,o,s,c=this;return(0,u.__generator)(this,function(d){switch(d.label){case 0:return n=t.tableName,a=t.key,i=t.row,o=e,(s=e._db)?[3,2]:[4,e._openDBPromise];case 1:s=d.sent(),d.label=2;case 2:return r=o._db=s,[2,new Promise(function(e,t){try{var o=r.transaction([n],"readwrite"),s=o.objectStore(n);o.oncomplete=function(){},o.onerror=function(e){c._errorHandling(e,t)};var d=i?s.put(i):s.delete(a);d.onsuccess=function(t){e()},d.onerror=function(e){c._errorHandling(e,t)}}catch(e){throw e}})]}})})},e.prototype._deleteDataRows=function(e){return(0,u.__awaiter)(this,void 0,void 0,function(){var t,n=this;return(0,u.__generator)(this,function(a){return t=e.slice(0,e.length-1)+String.fromCharCode(e.charCodeAt(e.length-1)+1),[2,this.rangeQuery({index:Yt,range:IDBKeyRange.bound(e,t,!1,!0),direction:"next"}).then(function(e){return Promise.all(e.map(function(e){return n._writeInternal({tableName:Gt,key:e,row:void 0})}))}).then(function(){})]})})},e.prototype._errorHandling=function(e,t){if(e.type===Ht.error){var n=e.target.error;t({name:n.name,message:n.message,code:n.code})}},e}(),en="PersistentCache",tn="PersistentCache_metadata",nn=function(){function e(){try{if("localStorage"in Rt&&Rt.localStorage&&(this._localStorage=Rt.localStorage,!this._localStorage.getItem(tn))){var e={id:Ft(),created:Date.now(),cacheType:Tt.localStorage};this._localStorage.setItem(tn,JSON.stringify(e))}}catch(e){}if(!this._localStorage)throw new Error("localStorage is not supported")}return e.prototype.freeSpace=function(e,t){throw new Error("Method not implemented.")},e.prototype.read=function(e){return JSON.parse(this._localStorage.getItem(this._cacheKey(e)))},e.prototype.write=function(e){var t=e.key;if(void 0!==e.data){var n=(0,u.__assign)((0,u.__assign)({},e),{lastModified:Date.now()});this._localStorage.setItem(this._cacheKey(t),JSON.stringify(n))}else this._localStorage.removeItem(this._cacheKey(t))},e.prototype.statistics=function(){var e=[];for(var t in this._localStorage)if(0===t.indexOf(en)){var n=this._localStorage.getItem(t);e.push(n?n.length:0)}return{metaData:JSON.parse(this._localStorage.getItem(tn)),count:e.length,totalBytes:e.reduce(function(e,t){return e+t},0)}},e.prototype.rangeQuery=function(e){return(0,u.__awaiter)(this,void 0,void 0,function(){return(0,u.__generator)(this,function(e){return[2,void 0]})})},e.prototype._cacheKey=function(e){return"".concat(en,"_").concat(e)},e}(),an=0,rn=function(){function e(){this._queue={}}return e.prototype.enqueue=function(e,t){var n=this._queue[e]=this._queue[e]||[],a=!0,i=[];n.length>0&&(n[0].schedule?(i=n.slice(1),this._queue[e]=[n[0]],a=!1):(i=this._queue[e],this._queue[e]=[]));var r=this._createUpateTask(e,t);return i.length>0&&(r.signal=i[0].signal),this._queue[e].push(r),a&&this._scheduleTask(e),r},e.prototype._createUpateTask=function(e,t){var n=this,a={};a.promise=new Promise(function(e,t){a.resolve=e,a.reject=t});var i={execute:function(){return(0,u.__awaiter)(n,void 0,void 0,function(){var e;return(0,u.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),[4,t()];case 1:return n.sent(),[3,4];case 2:return e=n.sent(),i.error=e,[3,4];case 3:return this._completeTask(i),[7];case 4:return[2]}})})},schedule:0,id:an++,key:e,signal:a};return i},e.prototype._scheduleTask=function(e){var t=this._queue[e];if(t&&t.length>0){var n=t[0];n.schedule=Rt.setTimeout(n.execute,5)}},e.prototype._completeTask=function(e){var t=e.id,n=e.key,a=this._queue[n],i=a[0],r=a.slice(1);if(i.id!==t)throw new Error("this should not happen, currently running task must be the top of the queue");this._queue[n]=r,this._scheduleTask(n),e.error?e.signal.reject(e.error):e.signal.resolve()},e}();function on(){return Rt.performance&&performance.now?Math.round(performance.now()):Date.now()}var sn="_odspcache_",cn="_____",dn={cacheType:Tt.indexedDB},ln=function(){function e(e){var t=e.cacheType,n=void 0===t?dn.cacheType:t,a=(0,u.__rest)(e,["cacheType"]);if(this._config=(0,u.__assign)((0,u.__assign)({},a),{cacheType:n}),this._cacheSecret=this._config.secret,this._dataIsEncrypted=!!this._cacheSecret,this._crypto=this._config.crypto,this._dataIsEncrypted&&!this._crypto)throw new Error("When data needs encryption, crypto implementing ICrypto has to be provided when initiating PersistentCache.");this._cacheType=this._config.cacheType,this._app=e.app,this._cacheUpdateTaskManager=new rn,this._qos=this._config.telemetry&&this._config.telemetry.qos,this._initLocalStorage(this._cacheType)}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this._config},enumerable:!1,configurable:!0}),e.prototype.read=function(e){return(0,u.__awaiter)(this,void 0,void 0,function(){var t,n,a,i,r,o,s;return(0,u.__generator)(this,function(c){switch(c.label){case 0:t=e.cacheKey,n=e.validBufferTime,a=this._logQos({name:"PersistentCache.read"}),r=on(),Date.now(),c.label=1;case 1:return c.trys.push([1,4,,5]),(o=this._getStorageKey(t))?[4,this._getData({cacheKey:t,storageKey:o,validBufferTime:n})]:[3,3];case 2:i=c.sent(),c.label=3;case 3:return i=i||{key:{original:t,encoded:o},app:this._app,data:void 0,cacheStats:{lastModified:NaN,lastRead:NaN,reads:0},cacheType:this._cacheType,performance:{total:Math.round(on()-r)}},[3,5];case 4:throw s=c.sent(),a({resultType:rt.ResultTypeEnum.Failure,error:s.message?s.message:s.toString(),extraData:{cacheResult:"miss"}}),s;case 5:return a({resultType:rt.ResultTypeEnum.Success,extraData:{cacheResult:"".concat(void 0!==i.data?"hit":"miss")}}),[2,Promise.resolve(i)]}})})},e.prototype.rangeQuery=function(e){return(0,u.__awaiter)(this,void 0,void 0,function(){var t,n,a,i,r,o,s,c=this;return(0,u.__generator)(this,function(d){if(this._cacheType!==Tt.indexedDB)throw new Error("Only indexedDB supports range query, your storage does not support!");t=this._logQos({name:"PersistentCache.rangeQuery"}),n=0,a=on(),i=Date.now(),o={lastModified:NaN,lastRead:i,reads:1};try{s=on(),r=this._storage.rangeQuery(e).then(function(e){return n=Math.round(on()-s),{key:void 0,app:void 0,data:e.map(function(e){return{original:c._getOriginalKeyFromCacheKey(e),encoded:e}}),cacheStats:o,cacheType:c._cacheType,performance:{io:n,total:Math.round(on()-a)}}})}catch(e){throw t({resultType:rt.ResultTypeEnum.Failure,error:e.message?e.message:e.toString()}),e}return t({resultType:rt.ResultTypeEnum.Success}),[2,r||Promise.resolve({key:void 0,app:void 0,data:[],cacheStats:o,cacheType:this._cacheType,performance:{io:n,total:Math.round(on()-a)}})]})})},e.prototype.update=function(e){return(0,u.__awaiter)(this,void 0,void 0,function(){var t,n,a,i=this;return(0,u.__generator)(this,function(r){switch(r.label){case 0:return t=e.cacheKey,n=e.data,a=this._getStorageKey(t),[4,this._cacheUpdateTaskManager.enqueue(a,function(){return i._doCacheUpdate(t,n)}).signal.promise];case 1:return r.sent(),this._logCacheStats(),[2]}})})},e.prototype.remove=function(e){var t=e.cacheKey;return(0,u.__awaiter)(this,void 0,void 0,function(){return(0,u.__generator)(this,function(e){return[2,this.update({cacheKey:t,data:void 0})]})})},e.prototype.freeSpace=function(e,t){return(0,u.__awaiter)(this,void 0,void 0,function(){return(0,u.__generator)(this,function(n){return[2,this._storage.freeSpace(e,t)]})})},e.prototype.readAndUpdate=function(e){return(0,u.__awaiter)(this,void 0,void 0,function(){var t,n,a,i,r,o,s,c,d=this;return(0,u.__generator)(this,function(l){switch(l.label){case 0:t=e.cacheKey,n=e.getData,a=on(),i=Date.now(),r=this._logQos({name:"PersistentCache.readAndUpdate"}),o=n().then(function(e){var n={app:d._app,key:{original:t,encoded:d._getStorageKey(t)},data:e,cacheType:Tt.none,cacheStats:{lastModified:void 0,lastRead:i,reads:1},performance:{total:Math.round(on()-a)}};return d.update({cacheKey:t,data:e}),n}),l.label=1;case 1:l.trys.push([1,8,,9]),l.label=2;case 2:return l.trys.push([2,4,,5]),[4,Promise.race([this.read(e),o])];case 3:return s=l.sent(),[3,5];case 4:return l.sent(),[3,5];case 5:return!s||s.cacheType!==Tt.none&&void 0===s.data?[4,o]:[3,7];case 6:s=l.sent(),l.label=7;case 7:return[3,9];case 8:throw c=l.sent(),r({resultType:rt.ResultTypeEnum.Failure,error:c.message?c.message:c.toString()}),c;case 9:return r({resultType:rt.ResultTypeEnum.Success}),[2,s]}})})},e.prototype._initLocalStorage=function(e){if(e===Tt.localStorage)this._storage=new nn;else try{this._storage=new $t(this._logQos.bind(this))}catch(e){e.message===Zt&&(this._storage=new nn,this._cacheType=Tt.localStorage)}},e.prototype._getStorageKey=function(e){var t=encodeURIComponent("".concat(e.key).concat(e.user?cn+e.user:""));return"".concat(sn).concat(this._dataIsEncrypted?btoa(t):t)},e.prototype._getOriginalKeyFromCacheKey=function(e){var t=e.replace(sn,""),n=this._dataIsEncrypted?atob(t):t,a=decodeURIComponent(n);if(a.indexOf(cn)>=0){var i=a.split(cn);return{key:i[0],user:i[1]}}return{key:a}},e.prototype._getData=function(t){var n,a;return(0,u.__awaiter)(this,void 0,void 0,function(){var i,r,o,s,c,d,l,f,p,m,_,h,b,g,v,y,S,D,I,x,C=this;return(0,u.__generator)(this,function(O){switch(O.label){case 0:return i=t.cacheKey,r=t.storageKey,o=t.validBufferTime,s=on(),(c=e._buffer[r])&&o&&s-c.readTime<o?[2,c.data]:(d=on(),l=Date.now(),[4,this._storage.read(r)]);case 1:if(f=O.sent(),p=Math.round(on()-d),m={lastModified:(null==f?void 0:f.lastModified)||NaN,lastRead:l,reads:((null==f?void 0:f.reads)||0)+1},_=void 0,h=function(t){var n=(0,u.__assign)({cacheStats:m,cacheType:C._cacheType,app:(null==f?void 0:f.app)||C._app,key:{original:i,encoded:(null==f?void 0:f.key)||r},performance:{io:p,crypto:_,total:Math.round(on()-s)}},t);return e._buffer[r]={data:n,readTime:d},n},!f)return[2,h({data:void 0})];if(f.lastModified&&(null===(a=null===(n=null==c?void 0:c.data)||void 0===n?void 0:n.cacheStats)||void 0===a?void 0:a.lastModified)===f.lastModified)return[2,h(c.data)];if(void 0===(b=f.data))return[2,h({data:void 0})];if(!this._dataIsEncrypted)return[2,h({data:b})];g=b,v=this._cacheSecret,y=v.CurrentKey.Key,S=v.PreviousKey.Key,D=on(),O.label=2;case 2:return O.trys.push([2,4,,7]),[4,this._crypto.decrypt({encryptedData:g,encryptionSecret:y})];case 3:return I=O.sent(),[3,7];case 4:return(x=O.sent())&&x.message&&x.message.indexOf("wrong secret or signature.")>=0?[4,this._crypto.decrypt({encryptedData:g,encryptionSecret:S})]:[3,6];case 5:void 0!==(I=O.sent())&&this.update({cacheKey:i,data:I}),O.label=6;case 6:if(void 0===I)throw x;return[3,7];case 7:return _=Math.round(on()-D),[2,h({data:I})]}})})},e.prototype._doCacheUpdate=function(t,n){var a;return(0,u.__awaiter)(this,void 0,void 0,function(){var i,r,o,s,c,d,l;return(0,u.__generator)(this,function(f){switch(f.label){case 0:i=this._logQos({name:"PersistentCache.update"}),f.label=1;case 1:return f.trys.push([1,9,,10]),r=this._getStorageKey(t),void 0===n?[3,6]:(o=(0,u.__assign)((0,u.__assign)({cacheStats:{lastModified:NaN,lastRead:on(),reads:1}},null===(a=e._buffer[r])||void 0===a?void 0:a.data),{data:n,app:this._app,cacheType:this._cacheType,key:{original:t,encoded:r}}),e._buffer[r]={data:o,readTime:on()},s=n,c=NaN,this._dataIsEncrypted?(d=this._cacheSecret.CurrentKey.Key,[4,this._crypto.encrypt({encryptionSecret:d,data:n,doSerialize:this._cacheType===Tt.localStorage})]):[3,3]);case 2:return s=f.sent(),c=s.cipherText?s.cipherText.byteLength:0,[3,4];case 3:try{c="string"==typeof n?n.length:JSON.stringify(n).length}catch(e){}f.label=4;case 4:return[4,this._storage.write({app:this._app,key:r,data:s,lastRead:o.cacheStats.lastRead,parentKey:t.parentKey,reads:o.cacheStats.reads,size:c})];case 5:return f.sent(),[3,8];case 6:return delete e._buffer[r],[4,this._storage.write({key:r,app:void 0,data:void 0,lastRead:void 0,parentKey:t.parentKey,reads:void 0,size:void 0})];case 7:f.sent(),f.label=8;case 8:return[3,10];case 9:throw l=f.sent(),i({resultType:rt.ResultTypeEnum.Failure,error:l.message?l.message:l.toString()}),l;case 10:return i({resultType:rt.ResultTypeEnum.Success}),[2]}})})},e.prototype._logCacheStats=function(){return(0,u.__awaiter)(this,void 0,void 0,function(){var e=this;return(0,u.__generator)(this,function(t){return this._logStatsTimer||(this._logStatsTimer=setTimeout(function(){return(0,u.__awaiter)(e,void 0,void 0,function(){return(0,u.__generator)(this,function(e){switch(e.label){case 0:return[4,this._storage.statistics()];case 1:return e.sent(),[2]}})})},3e4)),[2]})})},e.prototype._logQos=function(e){if(this._qos){var t=this._app;e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t;var n=new this._qos(e);return function(e){e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t,n.end(e)}}return function(e){}},e._buffer={},e}(),un=function(){function e(e,t){this._getDataPromises={},this._isDistinguishDataSourcesKSActivated=rt.KillSwitch.isActivated("6f03f183-611a-404f-8e80-e7b6f3abdfcb");var n=e.id,a=e.dataSourceName,i=e.cacheType,r=void 0===i?Tt.indexedDB:i,o=(t.pageContext||{}).aadUserId;this._id=n,this._userId=o;var s=a||n,c=rt.Qos.withData(function(e){return e.name&&s&&!e.name.startsWith(s)?(0,u.__assign)((0,u.__assign)({},e),{name:"".concat(s,".").concat(e.name)}):e});this._cache=new ln({cacheType:r,telemetry:{qos:c}})}return e.prototype.getDataUtilizingCache=function(e){var t=this,n=e,a=n.cacheRequestKey,i=n.cachingStrategy,r=void 0===i?0:i,o=n.cacheTimeoutTime,s=void 0===o?864e5:o,c=n.getData,d=n.returnStatistics,l=void 0!==d&&d,u=n.cacheRequestParentKey,f=n.callback,p={key:a,user:this._userId,parentKey:u},m=function(){var e=t._getDataPromises[a];if(!e){var n=c();t._getDataPromises[a]=n,e=n.then(function(e){return t._cache.update({cacheKey:p,data:e}).catch(function(){}),delete t._getDataPromises[a],e}).catch(function(e){throw delete t._getDataPromises[a],e})}return e.then(function(e){return l?{data:e,cacheStats:{lastModified:NaN,lastRead:Date.now(),reads:1,dataSourceType:t._isDistinguishDataSourcesKSActivated?void 0:"request"}}:e})};return 2===r?rt.Promise.resolve(this._cache.read({cacheKey:p})).then(function(e){var t=e||{},n=t.data,a=t.cacheStats;return null==n?null:l?{data:n,cacheStats:a}:n}).catch(function(){return null}):rt.Promise.resolve(this._cache.read({cacheKey:p})).then(function(e){var n=e||{},a=n.data,i=n.cacheStats;if(null==a)return m();!t._isDistinguishDataSourcesKSActivated&&i&&(i.dataSourceType="cache");var o=l?{data:a,cacheStats:i}:a,c=t._isCacheExpired(i.lastModified,s);switch(r){case 4:return o;case 0:return c&&m(),o;case 1:return c?m():o;case 5:return c?m().catch(function(){return o}):o;case 6:return m().then(f),o;default:return m()}},function(){return m()})},e.prototype.getRequestKey=function(e,t,n){var a=[];return a.push(e),a.push(t),n&&a.push(n.toString()),a.join(",")},Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!1,configurable:!0}),e.prototype.flushCache=function(e,t){var n={key:e,user:this._userId,parentKey:t};delete this._cache[e],this._cache.remove({cacheKey:n})},e.prototype.updateCache=function(e,t){var n={key:e,user:this._userId};this._cache.update({cacheKey:n,data:t})},e.prototype._isCacheExpired=function(e,t){return e<=(new Date).valueOf()-t},e}(),fn=rt.KillSwitch.isActivated("074dd45f-7a6c-4380-96b0-1908ddadecd3"),pn=rt.KillSwitch.isActivated("0b87858b-d63c-4252-9f55-d3c55ed9e0fc"),mn=rt.KillSwitch.isActivated("8d7a8d27-52ef-45fd-904a-cb4ae0e05989"),_n=rt.KillSwitch.isActivated("e43bfa56-e434-4c69-ab17-4e77f2b8e82f"),hn=rt.KillSwitch.isActivated("ecdc359b-47ac-402f-b41f-d529fa813171"),bn=rt.KillSwitch.isActivated("f5cb7242-2b1c-4d77-9891-269a05072013"),gn=rt.KillSwitch.isActivated("0F22FC56-CC8D-418F-BA2D-CD0880BD96B5"),vn=rt.KillSwitch.isActivated("d30d7d78-8704-424f-bc30-19fbe9bc9948"),yn=rt.KillSwitch.isActivated("8548e37c-464a-47ce-b9d0-5d3a72739e9f"),Sn=rt.KillSwitch.isActivated("4f8b4a16-9d3e-4c8f-b7b0-5f6d8a3c1e27"),Dn="Manual",In="Privileged",xn=function(){function e(e,t){var n=t.pageContext,a=t.graphDataRequestor;this._pageContext=n;var i=mn?{}:{dataSyncClient:this._pageContext.dataSyncClient};this._graphDataRequestor=a||new At({},i),this._getOAuthToken=e.getOAuthToken,this._getOAuthToken2=t.getOAuthToken,this._cache=new un({id:"SensitivityLabelsDataSource"},{pageContext:n})}return e.prototype.getSensitivityLabels=function(e){return(0,u.__awaiter)(this,void 0,void 0,function(){var t=this;return(0,u.__generator)(this,function(n){return gn?[2,this._cache.getDataUtilizingCache({cachingStrategy:0,cacheRequestKey:"SensitivityLabelsDataSource",getData:function(){return t._getSensitivityLabels(e)}}).catch(function(){return null})]:[2,this._cache.getDataUtilizingCache({cachingStrategy:0,cacheRequestKey:"SensitivityLabelsDataSource",getData:function(){return t._getSensitivityLabels(e)}})]})})},e.prototype.flushSensitiveLabelsCache=function(){return(0,u.__awaiter)(this,void 0,void 0,function(){return(0,u.__generator)(this,function(e){return this._cache.flushCache("SensitivityLabelsDataSource"),[2]})})},e.prototype.getDocLibSensitivityLabelsCached=function(e){return(0,u.__awaiter)(this,void 0,void 0,function(){var t=this;return(0,u.__generator)(this,function(n){return gn?[2,this._cache.getDataUtilizingCache({cachingStrategy:pn?0:3,cacheRequestKey:"SensitivityLabelsDataSourceDocLib",getData:function(){return t.getDocLibSensitivityLabels(e)}}).catch(function(){return null})]:[2,this._cache.getDataUtilizingCache({cachingStrategy:pn?0:3,cacheRequestKey:"SensitivityLabelsDataSourceDocLib",getData:function(){return t.getDocLibSensitivityLabels(e)}})]})})},e.prototype.getDocLibSensitivityLabels=function(e){return(0,u.__awaiter)(this,void 0,rt.Promise,function(){var t,n,a,i,r,o,s,c=this;return(0,u.__generator)(this,function(d){switch(d.label){case 0:return t="".concat(this._pageContext.msGraphEndpointUrl),this._getOAuthToken?[4,this._getOAuthToken(["InformationProtection.Read.All"],t)]:[3,2];case 1:return a=d.sent(),[3,4];case 2:return[4,this._getOAuthToken2(t)];case 3:a=d.sent(),d.label=4;case 4:return n=a,e&&(n||(this._getOAuthToken&&this._getOAuthToken2?e.end({resultType:rt.ResultTypeEnum.Failure,error:"failed to get sensitivitylabels because no token provided"}):e.end({resultType:rt.ResultTypeEnum.Failure,error:"no get auth callback passed in"}))),i=_n?"$expand=sensitivityPolicySettings,sublabels($expand=sensitivityPolicySettings)":"$expand=sensitivityPolicySettings,sublabels($expand=sensitivityPolicySettings)&$filter=applicableto has 'file'",r=hn?"beta":"v1.0",o=fn?"".concat(t,"/").concat(r,"/me/informationprotection/sensitivityLabels"):"".concat(t,"/").concat(r,"/me/informationprotection/sensitivityLabels?").concat(i),this._sensitivityLabels?(s=this._sensitivityLabels,[3,7]):[3,5];case 5:return[4,this._graphDataRequestor.send({endpoint:t,path:o,apiName:"GraphDataProvider.getSensitivityLabels",accessToken:{accessToken:n},requestType:"GET",useAuthorizationHeaders:!0,qosExtraData:{host:"Document libraries"},parseResponse:function(e){var t=JSON.parse(e.responseText).value;return c._sensitivityLabels=t,t}})];case 6:s=d.sent(),d.label=7;case 7:return[2,s]}})})},e.prototype.setSensitivityLabel=function(e,t,n,a,i){return(0,u.__awaiter)(this,void 0,void 0,function(){var r,o,s,c;return(0,u.__generator)(this,function(d){switch(d.label){case 0:return r={id:n,assignmentMethod:In,justificationText:a||"",actionSource:Dn},this._getOAuthToken||this._getOAuthToken2?(o="".concat(this._pageContext.msGraphEndpointUrl),this._getOAuthToken?[4,this._getOAuthToken(["InformationProtection.Read.All"],o)]:[3,2]):(null==i||i.end({resultType:rt.ResultTypeEnum.Failure,error:"no get auth callback passed in"}),[2,Promise.resolve("")]);case 1:return c=d.sent(),[3,4];case 2:return[4,this._getOAuthToken2(o)];case 3:c=d.sent(),d.label=4;case 4:return s=c,[4,this._graphDataRequestor.send({endpoint:o,path:"".concat(o,"/beta/drives/").concat(e,"/items/").concat(t,"/setSensitivityLabel"),apiName:"GraphDataProvider.setSensitivityLabel",postData:JSON.stringify(r),accessToken:{accessToken:s},requestType:"POST",useAuthorizationHeaders:!0,qosExtraData:{host:"Document libraries"},parseResponse:function(e){return null==e?void 0:e.responseText}})];case 5:return[2,d.sent()]}})})},e.prototype.setSensitivityLabelVroom=function(e,t,n,a,i,r){return(0,u.__awaiter)(this,void 0,void 0,function(){var o,s,c,d,l,f;return(0,u.__generator)(this,function(u){switch(u.label){case 0:return o={id:n,assignmentMethod:In,justificationText:i||"",actionSource:Dn},this._getOAuthToken||this._getOAuthToken2?(s=decodeURIComponent(this._pageContext.webAbsoluteUrl),c="".concat(s)+"/_api/v2.1"+(a?"/sites/"+a:""),this._getOAuthToken?[4,this._getOAuthToken(["InformationProtection.Read.All"],s)]:[3,2]):(null==r||r.end({resultType:rt.ResultTypeEnum.Failure,error:"no get auth callback passed in"}),[2,Promise.resolve("")]);case 1:return l=u.sent(),[3,4];case 2:return[4,this._getOAuthToken2(s)];case 3:l=u.sent(),u.label=4;case 4:return d=l,f=c+"/drives/".concat(e,"/items/").concat(t,"/setSensitivityLabel"),[4,this._graphDataRequestor.send({path:f,apiName:"VroomDataProvider.setSensitivityLabel",postData:JSON.stringify(o),requestType:"POST",apiVersion:"v2.1",qosExtraData:{host:"Document libraries"},accessToken:{accessToken:d},parseResponse:function(e){return null==e?void 0:e.responseText}})];case 5:return[2,u.sent()]}})})},e.prototype.parseSensitivityLabelsForProdEndpoint=function(e){var t=[];return e.filter(function(e){return!0===e.isEnabled}).sort(function(e,t){return e.priority&&t.priority?e.priority>t.priority?1:-1:0}).forEach(function(e){var n,a;(null===(n=e.sublabels)||void 0===n?void 0:n.length)||t.push((0,u.__assign)((0,u.__assign)({id:e.id,name:e.displayName||"",tooltip:e.toolTip,description:e.description,hasIRMProtection:e.hasIRMProtection,displayName:e.displayName},!Sn&&{color:e.color}),!vn&&{applicableTo:e.applicableTo})),null===(a=e.sublabels)||void 0===a||a.forEach(function(n){t.push((0,u.__assign)((0,u.__assign)((0,u.__assign)({id:yn?n.name:n.id,name:yn?n.displayName||"":n.name,tooltip:n.toolTip},!Sn&&{color:n.color}),{description:n.description,parent:{name:e.displayName||""},hasIRMProtection:n.hasIRMProtection,displayName:yn?void 0:n.displayName}),!vn&&{applicableTo:n.applicableTo}))})}),t},e.prototype._getSensitivityLabels=function(e){return(0,u.__awaiter)(this,void 0,rt.Promise,function(){var t,n,a,i,r,o=this;return(0,u.__generator)(this,function(s){switch(s.label){case 0:return this._getOAuthToken||this._getOAuthToken2?(t=bn?"beta":"v1.0",n=bn?"security/informationProtection/sensitivityLabels":"informationProtection/sensitivityLabels",a="".concat(this._pageContext.msGraphEndpointUrl),this._getOAuthToken?[4,this._getOAuthToken(["InformationProtection.Read.All"],a)]:[3,2]):(null==e||e.end({resultType:rt.ResultTypeEnum.Failure,error:"no get auth callback passed in"}),[2,rt.Promise.resolve([])]);case 1:return r=s.sent(),[3,4];case 2:return[4,this._getOAuthToken2(a)];case 3:r=s.sent(),s.label=4;case 4:return(i=r)?[4,this._graphDataRequestor.send({endpoint:a,path:"".concat(a,"/").concat(t,"/me/").concat(n),apiName:"GraphDataProvider.getSensitivityLabels",accessToken:{accessToken:i},requestType:"GET",useAuthorizationHeaders:!0,parseResponse:function(e){return bn?JSON.parse(e.responseText).value.filter(function(e){return!0===e.isActive}).sort(function(e,t){return e.sensitivity>t.sensitivity?1:-1}):o.parseSensitivityLabelsForProdEndpoint(JSON.parse(e.responseText).value)}})]:(null==e||e.end({resultType:rt.ResultTypeEnum.Failure,error:"failed to get sensitivitylabels because no token provided"}),[2,rt.Promise.resolve([])]);case 5:return[2,s.sent()]}})})},e}(),Cn=s().createContext({sensitivityLabels:[]});function On(e){var t=this,n=function(e){var t=s().useState(void 0),n=t[0],a=t[1];return s().useEffect(function(){e.whenFinished(function(){a(e.consume(B.PageContext.serviceKey))})},[e]),n}(e.serviceScope),a=s().useState([]),i=a[0],r=a[1];return(0,o.useEffect)(function(){var e=!1;return(0,u.__awaiter)(t,void 0,void 0,function(){var t,a,i;return(0,u.__generator)(this,function(o){switch(o.label){case 0:return n?(a=new N.AadTokenProvider(N._AadTokenProviders.preAuthorizedConfiguration),[4,(i=new xn({},{pageContext:n.legacyPageContext,getOAuthToken:function(e){return a.getToken(e,{})}})).getSensitivityLabels()]):[2];case 1:return t=o.sent(),e?[2]:!t||t[0].color?[3,4]:[4,i.flushSensitiveLabelsCache()];case 2:return o.sent(),[4,i.getSensitivityLabels()];case 3:t=o.sent(),o.label=4;case 4:return r(t),[2]}})}),function(){e=!0}},[n,r]),s().createElement(Cn.Provider,{value:{sensitivityLabels:i}},e.children)}function wn(){return s().useContext(Cn)}function En(e){var t=wn().sensitivityLabels;if(e)return An(t,e)}function An(e,t){if(t){for(var n,a=0,i=e;a<i.length;a++){var r=i[a];if(r.id===t){n=r;break}if(r.sublabels&&r.sublabels.length>0)for(var o=0,s=r.sublabels;o<s.length;o++){var c=s[o];if(c.id===t){n=c;break}}}return n}}var Ln=(0,d.makeStyles)({sensitivityTooltip:{fontFamily:d.tokens.fontFamilyBase,padding:"5px 0 0 0"},sensitivityTooltipLarge:{padding:"0",width:"16px",height:"16px"},sensitivityTooltipExtraLarge:{width:"20px",height:"20px"},sensitivityLabelIcon:{top:0,left:0,width:"100%",height:"100%"},sensitivityLabelIconLarge:{transform:"scale(1)"},sensitivityLabelIconExtraLarge:{transform:"scale(1.25)"}});function kn(e){var t=Ln(),n=e.size,a=e.sensitivityLabel,i="large"===n?t.sensitivityLabelIconLarge:t.sensitivityLabelIconExtraLarge,r=En(null==a?void 0:a.id);return a?""===a.id?s().createElement(s().Fragment,null):r?s().createElement(Ze,{message:r.tooltip,heading:a.displayName,"data-automation-id":"sp-pages-content-panel-attachment-file-sensitivity-label",className:(0,d.mergeClasses)(t.sensitivityTooltip,"large"===n?t.sensitivityTooltipLarge:t.sensitivityTooltipExtraLarge)},s().createElement(it,{"aria-label":a.displayName,fillColor:r.color,withLock:a.protectionEnabled,backgroundIcon:{className:i},foregroundIcon:{className:i}})):s().createElement(O.Spinner,{size:"extra-tiny"}):s().createElement(O.Spinner,{size:"extra-tiny"})}function Mn(e){var a,i=e.serviceScope,r=e.size,s=void 0===r?"large":r,c=e.decoration,l=void 0===c?"none":c,u=e.attachments,f=e.displayTabs,p=e.pickLabel,m=e.onAttachmentSelect,_=e.onAttachmentRemove,b=Ne(),v="large"===s?20:24,y=u.length>=5,S=o.createElement(Y.Button,{shape:"circular",appearance:"transparent",icon:o.createElement(me,{className:y?b.iconDisabled:b.icon,width:v,height:v}),size:"large","data-automation-id":"sp-pages-content-panel-attachments-pick-button",disabled:y,className:(0,d.mergeClasses)(y?b.buttonDisabled:b.button,"large"===s?b.buttonLarge:b.buttonExtraLarge)},0===u.length?p||Ae.Dc:Ae.aW);return o.createElement(Ee.TagGroup,{className:b.tagGroup,onDismiss:function(e,t){var n=u.find(function(e){return e.id===t.value});n&&_(n)},"aria-label":Ae.qs,role:"group"},u.map(function(e){return o.createElement(Ee.InteractionTag,{shape:"circular",appearance:"outline",key:e.id,value:e.id,"data-size":s,className:(0,d.mergeClasses)(b.attachmentTag,"large"===s?b.attachmentTagLarge:b.attachmentTagExtraLarge)},o.createElement(Ee.InteractionTagPrimary,{"data-size":s,hasSecondaryAction:!0,media:o.createElement(ye,{size:be.Large,attachment:e}),className:(0,d.mergeClasses)(b.attachmentTagPrimary,"none"===l?b.attachmentTagPrimaryBorderless:"","large"===s?b.attachmentTagPrimaryLarge:b.attachmentTagPrimaryExtraLarge),primaryText:{className:(0,d.mergeClasses)(b.attachmentTagPrimaryText,"large"===s?b.attachmentTagPrimaryTextLarge:b.attachmentTagPrimaryTextExtraLarge)}},o.createElement(h.Tooltip,{content:e.name,relationship:"label"},o.createElement("span",{className:b.attachmentName},e.name)),e.type===t.File&&o.createElement(kn,{size:s,sensitivityLabel:e.sensitiveLabel})),o.createElement(Ee.InteractionTagSecondary,{"aria-label":Ae.T0,className:(0,d.mergeClasses)(b.attachmentTagSecondary,"none"===l?b.attachmentTagSecondaryBorderless:"","large"===s?b.attachmentTagSecondaryLarge:b.attachmentTagSecondaryExtraLarge)}))}),o.createElement(we,{serviceScope:i,size:s,displayTabs:null!=f?f:[n.MeetingSeries],selectedAttachments:u,onAttachmentSelect:m},y?o.createElement(h.Tooltip,{content:null!==(a=g.Text.format(Ae.c6,5))&&void 0!==a?a:"",relationship:"description",withArrow:!0},S):S))}var Pn=E(190);const Tn=JSON.parse('{"W":"Select Attachment","xx":"Selected Attachments","T0":"Remove"}');function Un(e){var n=e.attachment,a=!1;return n.type===t.File?a=null==n.sensitiveLabel:n.type===t.MeetingSeries?a=null==n.calendarId:n.type===t.Meeting&&(a=!1),s().createElement(s().Fragment,null,a&&s().createElement(O.Spinner,{size:"extra-tiny"}))}var Fn,Hn,Rn=(0,d.makeStyles)({tagGroup:{flexWrap:"wrap",rowGap:"var(--spacingVerticalS)",width:"100%"},tagPickerGroup:{maxWidth:"90%"},attachmentTag:{overflow:"hidden",textOverflow:"ellipsis",display:"flex",padding:"var(--Vertical-XXS, 2px) var(--Horizontal-None, 0px)",alignItems:"center"},attachmentTagShadow:{boxShadow:"var(--shadow2)"},attachmentTagLarge:{height:"".concat(26,"px")},attachmentTagExtraLarge:{height:"".concat(30,"px")},attachmentTagPrimary:(Fn={flex:1,minWidth:"0",backgroundColor:"var(--colorNeutralBackground1)"},Fn[":hover"]={backgroundColor:"var(--colorNeutralBackground1Hover)"},Fn[":active"]={backgroundColor:"var(--colorNeutralBackground1Pressed)"},Fn),attachmentTagPrimaryBorderless:{border:"none"},attachmentTagPrimaryLarge:{paddingLeft:"13px"},attachmentTagPrimaryExtraLarge:{paddingLeft:"12px"},attachmentTagPrimaryText:{maxWidth:"100%",display:"flex",flexDirection:"row",overflow:"hidden",alignItems:"center",height:"20px"},attachmentTagPrimaryTextLarge:{fontSize:"var(--fontSizeBase300)",fontWeight:"var(--fontWeightRegular)"},attachmentTagPrimaryTextExtraLarge:{fontSize:"var(--fontSizeBase400)",fontWeight:"var(--fontWeightRegular)"},attachmentName:{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginRight:"var(--spacingHorizontalXS)"},attachmentSecondary:{display:"flex",alignItems:"center",justifyContent:"center",padding:"0"},attachmentTagSecondary:(Hn={backgroundColor:"var(--colorNeutralBackground1)"},Hn[":hover"]={backgroundColor:"var(--colorNeutralBackground1Hover)"},Hn[":active"]={backgroundColor:"var(--colorNeutralBackground1Pressed)"},Hn),attachmentTagSecondaryBorderless:{borderTop:"none",borderRight:"none",borderBottom:"none"},attachmentTagSecondaryLarge:{fontSize:"16px",paddingRight:"8px"},attachmentTagSecondaryExtraLarge:{fontSize:"16px",paddingRight:"8px"},attachmentPicker:{padding:"0"},button:{border:"dashed 1px var(--colorBrandForeground1)",":hover":{border:"dashed 1px var(--colorBrandForeground1)"},":focus":{border:"dashed 1px var(--colorBrandForeground1)"},":active":{border:"dashed 1px var(--colorBrandForeground1)"}},buttonDisabled:{border:"dashed 1px var(--colorNeutralForegroundDisabled)",":hover":{border:"dashed 1px var(--colorNeutralForegroundDisabled)"},":focus":{border:"dashed 1px var(--colorNeutralForegroundDisabled)"},":active":{border:"dashed 1px var(--colorNeutralForegroundDisabled)"}},buttonLarge:{paddingLeft:"6px",paddingRight:"8px"},icon:{color:"var(--colorBrandForeground1)",":hover":{color:"var(--colorBrandForeground1)"},":focus":{color:"var(--colorBrandForeground1)"},":active":{color:"var(--colorBrandForeground1)"}},iconDisabled:{color:"var(--colorNeutralForegroundDisabled)",":hover":{color:"var(--colorNeutralForegroundDisabled)"},":focus":{color:"var(--colorNeutralForegroundDisabled)"},":active":{color:"var(--colorNeutralForegroundDisabled)"}}}),Nn=function(){function e(e){this._graphClientFactory=e.consume(L.MSGraphClientFactory.serviceKey),this._graphClientPromise=this._graphClientFactory.getClientInternal("3")}return e.prototype.requestData=function(e){return(0,u.__awaiter)(this,void 0,void 0,function(){var t;return(0,u.__generator)(this,function(n){switch(n.label){case 0:return[4,this._getCalendarId(e)];case 1:return t=n.sent(),[2,{calendarId:this._processCalendarIdData(t)}]}})})},e.prototype._processCalendarIdData=function(e){if(e&&e["calendar@odata.navigationLink"]){var t=e["calendar@odata.navigationLink"].match(/calendars\('([^']+)'\)/);if(t&&t.length>0)return t[1]}throw new Error("Calendar Id not found")},e.prototype._getCalendarId=function(e){var t=this;return this._graphClientPromise.then(function(n){return n.api(t._getCalendarIdUrl(e)).responseType(k.ResponseType.JSON).get()})},e.prototype._getCalendarIdUrl=function(e){var t=e.seriesMasterId;return"me/events/".concat(t,"?$select=calendar")},e}(),Bn={displayName:"None",id:"",protectionEnabled:!1},jn=function(){function e(e){this._graphClientFactory=e.consume(L.MSGraphClientFactory.serviceKey),this._graphClientPromise=this._graphClientFactory.getClientInternal("3")}return e.prototype.requestData=function(e){return(0,u.__awaiter)(this,void 0,void 0,function(){var t;return(0,u.__generator)(this,function(n){switch(n.label){case 0:return[4,this._getSensitiveLabel(e)];case 1:return t=n.sent(),[2,this._processSensitiveData(t)]}})})},e.prototype._processSensitiveData=function(e){if(e&&e.sensitivityLabel)return e.sensitivityLabel},e.prototype._getSensitiveLabel=function(e){var t=this;return new Promise(function(n,a){var i;null===(i=e.abortSignal)||void 0===i||i.addEventListener("abort",function(){var e=new Error("action is aborted");e.name="AbortError",a(e)});var r=e.driveId.length>0?t._getSensitiveLabelUrlByDrive(e):t._getSensitiveLabelUrlBySiteAndList(e);t._graphClientPromise.then(function(e){return e.api(r).responseType(k.ResponseType.JSON).get().then(n).catch(function(e){n({sensitivityLabel:Bn})})})})},e.prototype._getSensitiveLabelUrlByDrive=function(e){var t=e.driveId,n=e.itemId;return"drives/".concat(t,"/items/").concat(null==n?void 0:n.replace(/{|}/g,""),"?$select=sensitivityLabel")},e.prototype._getSensitiveLabelUrlBySiteAndList=function(e){var t=e.siteId,n=e.listId,a=e.itemId;return"sites/".concat(t,"/lists/").concat(n,"/items/").concat(null==a?void 0:a.replace(/{|}/g,""),"/driveItem?$select=sensitivityLabel")},e}();function Vn(e){var n=this,a=e.multiSelection,i=e.defaultAttachments,r=e.serviceScope,c=(0,o.useState)(i),d=c[0],l=c[1],f=(0,o.useState)(function(e){var n=0;return e?(e.forEach(function(e){e.type!==t.File||e.sensitiveLabel||(n+=1)}),n):n}(i)),p=f[0],m=f[1],_=wn().sensitivityLabels,h=s().useRef({}),b=function(e,t){l(function(n){return n.map(function(n){return n.id===e&&null!=t?(0,u.__assign)((0,u.__assign)({},n),{calendarId:t}):n})}),m(function(e){return e-1})},g=function(e,t){l(function(n){return n.map(function(n){return n.id===e?(0,u.__assign)((0,u.__assign)({},n),{sensitiveLabel:t}):n})}),m(function(e){return e-1})},v=function(e){return(0,u.__awaiter)(n,void 0,void 0,function(){var n,a,i,o,s;return(0,u.__generator)(this,function(c){switch(c.label){case 0:if(e.type!==t.File)return[3,5];if((i=e).sensitiveLabel||h.current[e.id])return[3,4];m(function(e){return e+1}),c.label=1;case 1:return c.trys.push([1,3,,4]),h.current[e.id]=new AbortController,n={driveId:i.sharepointIds.driveId,itemId:i.sharepointIds.listItemUniqueId,abortSignal:h.current[i.id].signal,siteId:i.sharepointIds.siteId,listId:i.sharepointIds.listId},[4,new jn(r).requestData(n)];case 2:return a=c.sent(),g(i.id,a||Bn),[3,4];case 3:return"AbortError"!==c.sent().name&&g(e.id,Bn),[3,4];case 4:return[3,9];case 5:if(e.type!==t.MeetingSeries)return[3,9];if(e.type!==t.MeetingSeries)return[3,9];m(function(e){return e+1}),i=e,c.label=6;case 6:return c.trys.push([6,8,,9]),h.current[e.id]=new AbortController,o=h.current[e.id].signal,[4,new Nn(r).requestData({seriesMasterId:i.seriesMasterId,abortSignal:o})];case 7:return s=c.sent().calendarId,b(e.id,s),[3,9];case 8:return"AbortError"!==c.sent().name&&b(e.id,""),[3,9];case 9:return[2]}})})};return(0,o.useEffect)(function(){var e=h.current;return function(){Object.keys(e).forEach(function(t){var n=e[t];n&&(n.abort(),delete e[t])})}},[]),(0,o.useEffect)(function(){i.forEach(function(e){return(0,u.__awaiter)(n,void 0,void 0,function(){return(0,u.__generator)(this,function(t){switch(t.label){case 0:return[4,v(e)];case 1:return t.sent(),[2]}})})})},[]),{internalAttachments:d,loadingAttachmentCount:p,addAttachment:function(e){return(0,u.__awaiter)(n,void 0,void 0,function(){return(0,u.__generator)(this,function(t){switch(t.label){case 0:return l(function(t){return t.find(function(t){return t.id===e.id})?t:a?(0,u.__spreadArray)((0,u.__spreadArray)([],t,!0),[e],!1):[e]}),[4,v(e)];case 1:return t.sent(),[2]}})})},removeAttachment:function(e){l(function(t){var n=t.filter(function(t){return t.id!==e.id});return h.current[e.id]&&(h.current[e.id].abort(),delete h.current[e.id]),n})},checkSensitivity:function(){var e=0,n=!0,a=0,i=_[_.length-1];return d.forEach(function(r){if(r.type===t.File){var o=r.sensitiveLabel;if((null==o?void 0:o.protectionEnabled)&&(e+=1),void 0===o&&(n=!1),null==o?void 0:o.id){var s=An(_,o.id);if(s){var c=(null==i?void 0:i.parent)?i.parent.name:i.displayName;((null==s?void 0:s.parent)?s.parent.name:s.displayName)===c&&(null==o?void 0:o.protectionEnabled)&&(a+=1)}}}}),{isSensitiveBarVisible:e>0,isHighlySensitiveBarVisible:a>0,isAllFetched:n}}}}function zn(e){var t=e.serviceScope,a=e.size,i=void 0===a?"large":a,r=e.decoration,s=void 0===r?"none":r,c=e.defaultAttachments,l=e.displayTabs,u=e.multiSelection,f=e.filterByOrganizersName,p=e.onAttachmentsSelect,m=Vn({serviceScope:e.serviceScope,multiSelection:!!u,defaultAttachments:c}),_=m.internalAttachments,h=m.loadingAttachmentCount,b=m.addAttachment,g=m.removeAttachment,v=function(e){return function(t){t.stopPropagation(),g(e)}};(0,o.useEffect)(function(){0===h&&p(_)},[_,h,p]);var y=Rn();return o.createElement(we,{serviceScope:t,size:i,displayTabs:null!=l?l:[n.MeetingSeries],selectedAttachments:_,filterByOrganizersName:f,disabled:e.disabled,onAttachmentSelect:b},o.createElement(Pn.TagPicker,{noPopover:!0,selectedOptions:_.map(function(e){return e.name}),disabled:e.disabled},o.createElement(Pn.TagPickerControl,null,o.createElement(Pn.TagPickerGroup,{"aria-label":Tn.xx,onClick:function(e){e.stopPropagation()},className:(0,d.mergeClasses)(y.tagPickerGroup)},_.map(function(e,t){return o.createElement(Ee.InteractionTag,{shape:"rounded",appearance:"outline",key:e.id,value:e.id,"data-size":i,className:(0,d.mergeClasses)(y.attachmentTag,"large"===i?y.attachmentTagLarge:y.attachmentTagExtraLarge)},o.createElement(Ee.InteractionTagPrimary,{className:y.buttonLarge,media:o.createElement(ye,{size:be.Large,attachment:e}),hasSecondaryAction:!0,primaryText:{className:(0,d.mergeClasses)(y.attachmentTagPrimaryText,"large"===i?y.attachmentTagPrimaryTextLarge:y.attachmentTagPrimaryTextExtraLarge)}},o.createElement("div",{className:y.attachmentName},e.name),o.createElement("div",{className:y.attachmentSecondary},o.createElement(Un,{attachment:e}))),o.createElement(Ee.InteractionTagSecondary,{"aria-label":Tn.T0,className:(0,d.mergeClasses)(y.attachmentTagSecondary,"none"===s?y.attachmentTagSecondaryBorderless:"","large"===i?y.attachmentTagSecondaryLarge:y.attachmentTagSecondaryExtraLarge),onClick:v(e)}))})),o.createElement(Pn.TagPickerInput,{"aria-label":Tn.W}))))}})(),A})())})();