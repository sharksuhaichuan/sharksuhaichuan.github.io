define("11e47fa8-b458-44f3-a54c-d523d44ec5fc_0.1.0",["tslib","react","@microsoft/sp-core-library","@microsoft/sp-lodash-subset","@ms/sp-image-shapes-read","@ms/sp-rich-image","@microsoft/sp-image-helper","@ms/sp-coachmark-utility","@ms/sp-fluentui-v9-react-teaching-popover-bundle","@microsoft/load-themed-styles","@microsoft/sp-diagnostics","@ms/sp-edit-customer-promise"],(e,t,n,a,i,r,o,s,c,d,l,u)=>(()=>{"use strict";var f={424:e=>{e.exports=d},676:e=>{e.exports=n},207:e=>{e.exports=l},949:e=>{e.exports=o},529:e=>{e.exports=a},241:e=>{e.exports=s},952:e=>{e.exports=u},492:e=>{e.exports=c},254:e=>{e.exports=i},491:e=>{e.exports=r},959:e=>{e.exports=t},280:t=>{t.exports=e}},p={};function m(e){var t=p[e];if(void 0!==t)return t.exports;var n=p[e]={exports:{}};return f[e](n,n.exports,m),n.exports}m.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return m.d(t,{a:t}),t},m.d=(e,t)=>{for(var n in t)m.o(t,n)&&!m.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},m.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),m.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var _={};return(()=>{m.r(_),m.d(_,{ImageShapesEditRef:()=>F});var e=m(280),t=m(959),n=m.n(t),a=m(676),i=m(529),r=m(254),o=m(491),s={M:"M",L:"L",T:"T",H:"H",V:"V",C:"C",S:"S",Q:"Q",A:"A",Z:"Z"};function c(t,n){return(0,e.__awaiter)(this,void 0,void 0,function(){var a,i,r,o,s,c,d,l,f,m,_,h,y,S,D,I,x,C;return(0,e.__generator)(this,function(e){switch(e.label){case 0:if(a=t.image,i=t.fullImage,r=t.overlayWidth,o=t.zoom,s=t.overrideImgTransform,c=t.saveBlobCallback,d=t.offsetX,l=void 0===d?0:d,f=t.offsetY,m=void 0===f?0:f,_=t.imageType,h=void 0===_?"webp":_,(y=document.createElement("canvas")).width=i.width,y.height=i.height,S=r/100,null===(D=y.getContext("2d")))return[2,void 0];if(n.length<=0)throw new Error("coordinates missing or incorrect length");for(D.beginPath(),D.globalAlpha=0,D.moveTo(n[0][0]*S+l,n[0][1]*S+m),I=1;I<n.length;I++)D.lineTo(n[I][0]*S+l,n[I][1]*S+m);return D.closePath(),D.stroke(),D.clip(),s?v(s,D):g(a,i,o,D),D.globalAlpha=1,D.drawImage(i,0,0,i.width,i.height),D.restore(),x=b(y,D,y.width,y.height),C=void 0,c?[4,u(x,x.width,x.height,c,h)]:[3,2];case 1:C=e.sent(),e.label=2;case 2:return[2,{dataUrl:C||x.toDataURL(p(h),.95),width:x.width,height:x.height}]}})})}function d(t,n){return(0,e.__awaiter)(this,void 0,void 0,function(){var a,i,r,o,s,c,d,l,f,m,_,h,y,S,D,I,x,C,O,w,E;return(0,e.__generator)(this,function(e){switch(e.label){case 0:if(a=t.image,i=t.fullImage,r=t.overlayWidth,o=t.zoom,s=t.overrideImgTransform,c=t.saveBlobCallback,d=t.offsetX,l=void 0===d?0:d,f=t.offsetY,m=void 0===f?0:f,_=t.imageType,h=void 0===_?"webp":_,(y=document.createElement("canvas")).width=i.width,y.height=i.height,S=r/100,null===(D=y.getContext("2d")))return[2,void 0];if(4!==n.length)throw new Error("pathData missing or incorrect length");return I=S*n[2]+l,x=S*n[3]+m,C=S*n[0],O=S*n[1],D.beginPath(),D.globalAlpha=0,D.ellipse(I,x,C,O,0,0,2*Math.PI),D.closePath(),D.clip(),s?v(s,D):g(a,i,o,D),D.globalAlpha=1,D.drawImage(i,0,0,i.width,i.height),D.restore(),w=b(y,D,y.width,y.height),E=void 0,c?[4,u(w,w.width,w.height,c,h)]:[3,2];case 1:E=e.sent(),e.label=2;case 2:return[2,{dataUrl:E||w.toDataURL(p(h),.95),width:w.width,height:w.height}]}})})}function l(t,n,a){return(0,e.__awaiter)(this,void 0,void 0,function(){var i,r,o,c,d,l,m,_,h,y,S,D,I,x,C,O,w,E,A,L,k,M,P,T,U,F,H,R,N,B,j,V,z,G,K,W,q,Q,Y,J,X,Z;return(0,e.__generator)(this,function($){switch($.label){case 0:if(i=t.image,r=t.fullImage,o=t.overlayWidth,c=t.zoom,d=t.overrideImgTransform,l=t.saveBlobCallback,m=t.offsetX,_=void 0===m?0:m,h=t.offsetY,y=void 0===h?0:h,S=t.imageType,D=void 0===S?"webp":S,I=r.naturalWidth*c,x=r.naturalHeight*c,(C=document.createElement("canvas")).width=r.naturalWidth,C.height=r.naturalHeight,null===(O=C.getContext("2d")))return[2,void 0];if(w=function(t){var n,a=function(t){var n=t.match(/[a-df-z][^a-df-z]*/gi);if(null!==n)return n.map(function(t){var n=function(e){return s[e]}(t.charAt(0).toUpperCase()),a=t.slice(1).trim().split(/,|\s|(?=-)/).map(parseFloat),i={commandType:n,x:0,y:0,x2:0,y2:0,x3:0,y3:0,rx:0,ry:0,angle:0,largeArcFlag:0,sweepFlag:0};switch(n){case"M":case"L":case"T":i.x=a[0],i.y=a[1];break;case"H":i.x=a[0];break;case"V":i.y=a[0];break;case"C":i.x=a[4],i.y=a[5],i.x2=a[0],i.y2=a[1],i.x3=a[2],i.y3=a[3];break;case"S":case"Q":i.x=a[2],i.y=a[3],i.x2=a[0],i.y2=a[1];break;case"A":i.rx=a[0],i.ry=a[1],i.angle=a[2],i.largeArcFlag=a[3],i.sweepFlag=a[4],i.x=a[5],i.y=a[6];break;case"Z":break;default:throw new Error("Command type is not valid ".concat(n))}return(0,e.__assign)({},i)})}(t);if(a){for(var i=a[0].x,r=a[0].x,o=a[0].y,c=a[0].y,d=0,l=0,u=0,p=0,m=0,_=0,h=0,b=a;h<b.length;h++){var g=b[h];if(g)switch(g.commandType){case"M":case"L":case"T":d=g.x,l=g.y;break;case"H":d=g.x;break;case"V":l=g.y;break;case"C":d=g.x3,l=g.y3;break;case"S":case"Q":d=g.x2,l=g.y2;break;case"A":d=(n=f(g,d,l)).x,l=n.y,u=n.rx,p=n.ry,m=n.cx,_=n.cy}i=Math.min(i,d-u-m),r=Math.max(r,d+u+m),o=Math.min(o,l-p-_),c=Math.max(c,l+p+_)}return{x:i,y:o,width:r-i,height:c-o}}}(n),!w)return[3,3];for(E=a&&a.x>0?a.x:1,A=a&&a.y>0?a.y:1,L=(o||r.width)/w.width*(w.width*E),k=(o||r.height)/w.height*(w.height*A),M=new DOMMatrix,P=new Path2D(n),(T=new Path2D).addPath(P,M.scale(L,k)),O.translate(_,y),O.fill(T),O.restore(),O.globalCompositeOperation="source-in",d?v(d,O):g(i,r,c,O),O.drawImage(r,0,0,I,x),O.globalCompositeOperation="source-over",U=O.getImageData(0,0,C.width,C.height),F=C.width,H=C.height,R=0,N=0,B=0;B<C.height;B++)for(j=0;j<C.width;j++)V=4*(B*C.width+j),U.data[V+3]>0&&(j<F&&(F=j),B<H&&(H=B),j>R&&(R=j),B>N&&(N=B));return z=(F+R)/2,G=(H+N)/2,K=C.width/2,W=C.height/2,q=K-z,Q=W-G,(Y=document.createElement("canvas")).width=C.width,Y.height=C.height,(J=Y.getContext("2d"))?(J.translate(q,Q),J.drawImage(C,0,0,C.width,C.height),X=b(Y,J,Y.width,Y.height),Z=void 0,l?[4,u(X,X.width,X.height,l,D)]:[3,2]):[3,3];case 1:Z=$.sent(),$.label=2;case 2:return[2,{dataUrl:Z||X.toDataURL(p(D),.95),width:X.width,height:X.height}];case 3:return[2,void 0]}})})}function u(e,t,n,a,i){return new Promise(function(r,o){e.toBlob(function(e){e?a(e,t,n).then(function(e){r(e)}).catch(function(e){o(e)}):o("Blob is null and not able to be saved")},p(i),.95)})}function f(e,t,n){var a=0,i=0,r=e.rx,o=e.ry,s=e.angle*Math.PI/180,c=Math.cos(s),d=Math.sin(s),l=t,u=n,f=(l-(a=e.x))/2,p=(u-(i=e.y))/2,m=c*f+d*p,_=-d*f+c*p,h=r*r,b=o*o,g=m*m,v=_*_,y=h*b-h*v-b*g,S=h*v+b*g,D=Math.sqrt(Math.abs(y/S));return e.largeArcFlag!==e.sweepFlag&&(D=-D),{x:a=(l+a)/2,y:i=(u+i)/2,rx:r,ry:o,cx:D*r*_/o,cy:-D*o*m/r}}function p(e){return"png"===e?"image/png":"image/webp"}function h(t,n,a){return(0,e.__awaiter)(this,void 0,void 0,function(){return(0,e.__generator)(this,function(e){return[2,new Promise(function(e,i){var r=new Image;n&&a&&(r.width=n,r.height=a),r.onload=function(){e(r)},r.onerror=function(e){i(e)},r.crossOrigin="anonymous",r.src=t})]})})}function b(e,t,n,a){for(var i=t.getImageData(0,0,n,a).data,r=n,o=a,s=0,c=0,d=0;d<i.length;d+=4)if(0!==i[d+3]){var l=d/4%n,u=Math.floor(d/(4*n));l<r&&(r=l),u<o&&(o=u),l>s&&(s=l),u>c&&(c=u)}var f=s-r+1,p=c-o+1,m=document.createElement("canvas");m.width=f,m.height=p;var _=m.getContext("2d");return _&&(null==_||_.drawImage(e,r,o,f,p,0,0,f,p)),m}function g(t,n,a,i){var r=getComputedStyle(t).getPropertyValue("transform");""===r&&(r="matrix(1,0,0,1,0,0)");var o,s,c={translateX:(s=null!==(o=r.match(/matrix\((.+)\)/))?o[1].split(",").map(parseFloat):[])[4],translateY:s[5],scaleX:Math.sqrt(s[0]*s[0]+s[1]*s[1]),scaleY:Math.sqrt(s[2]*s[2]+s[3]*s[3]),angle:Math.atan2(s[1],s[0])*(180/Math.PI)},d=n.naturalHeight*a/t.height,l=n.naturalWidth*a/t.width;!function(t,n){if(t){var a=(0,e.__assign)({},t),i=a.translateX,r=a.translateY,o=a.scaleX,s=a.scaleY,c=a.angle,d=o*Math.cos(c),l=o*Math.sin(c),u=-s*Math.sin(c),f=s*Math.cos(c),p=i,m=r;n.setTransform(d,l,u,f,p,m)}}({translateX:c.translateX*l,translateY:c.translateY*d,angle:c.angle,scaleX:c.scaleX,scaleY:c.scaleY},i)}function v(t,n){var a=function(e){for(var t=0,n=0,a=0,i=1,r=1,o=/(\w+)\(([^\)]+)\)/g,s=o.exec(e);s;){var c=s[1],d=s[2];switch(c){case"translate":var l=d.split(",");t+=parseFloat(l[0])||0,n+=parseFloat(l[1])||0;break;case"rotate":a+=parseFloat(d)||0;break;case"scale":var u=d.split(",");i*=parseFloat(u[0])||1,r*=parseFloat(u[1])||1}s=o.exec(e)}return{translateX:t,translateY:n,angle:a,scaleX:i,scaleY:r}}(t);if(a){var i=(0,e.__assign)({},a),r=i.translateX,o=i.translateY,s=i.scaleX,c=i.scaleY,d=i.angle,l=s*Math.cos(d),u=s*Math.sin(d),f=-c*Math.sin(d),p=c*Math.cos(d),m=r,_=o;n.setTransform(l,u,f,p,m,_)}}var y=m(949);function S(){return a._SPKillSwitch.isActivated("dc5d80a8-1048-4f97-9fa1-e4f77ec4c3ed")}function D(){return a._SPKillSwitch.isActivated("0506fc87-f576-451c-8118-1736aacbea1c")}function I(){return a._SPKillSwitch.isActivated("5a79da60-74ad-4fdc-820d-7009ea501a38")}const x=JSON.parse('{"k_":"{1} 的 {0}","s9":"{0} 中的图像","iO":"使用 Shift 进行移动或缩放","ij":"按住 Shift，改变图像在形状中显示的部分，然后:","kW":"通过拖动图像来将其移动","xc":"通过滚动来放大或缩小图像","yt":"明白了"}');var C=m(492),O=m(241),w="ImageShapeTeachingPopover",E=function(e){var a=e.shapeRef,i=e.serviceScope,r=e.isShapePopoverVisible,o=e.setShapePopoverVisible,s=function(){o&&o(!1),(0,O.getCoachmarkUtility)(i).dismiss(w)},c=n().createElement(C.TeachingPopoverSurface,{style:{position:"absolute",width:"320px"}},n().createElement(C.TeachingPopoverHeader,{icon:null,onClick:s}),n().createElement(C.TeachingPopoverTitle,null,x.iO),n().createElement("div",null,x.ij,n().createElement("div",{style:{marginTop:"10px"}},n().createElement("li",null,x.kW),n().createElement("li",null,x.xc))),n().createElement(C.TeachingPopoverFooter,{primary:x.yt,onClick:s})),d={type:"TeachingPopover",content:void 0,targetElement:a.current?a.current:void 0,serviceScope:i,localStorageKey:w,popoverProps:{withArrow:!0,open:r,onOpenChange:o?function(e,t){return o(t.open)}:void 0,positioning:{target:a.current,position:"after"},children:c}},l=(0,O.useTeachingPopover)(d),u=l.open,f=l.close;return(0,t.useEffect)(function(){if(!r)return function(){f()};u().catch(function(e){if(e)return Promise.reject(e)})},[u,f,r]),n().createElement(n().Fragment,null)},A=function(t){var i=a.Guid.newGuid().toString(),s=(0,e.__assign)({},t),c=s.imgSrc,d=s.serviceScope,l=s.imageData,u=s.width,f=s.height,p=s.callerId,m=s.children,_=s.buttonOffset,h=void 0===_?0:_,b=s.setImageRef,g=s.setOverlayRef,v=s.transformData,S=s.thumbnailWidth,C=s.cacheBuster,O=s.autoSaveCallback,w=s.onImageLoad,A=s.onImageLoadFailure,L=s.getDefaultImage,k=s.isShapeCentered,M=void 0===k||k,P=s.isShapePopoverVisible,T=s.setShapePopoverVisible,U=n().useMemo(function(){return Math.min(u,f)},[f,u]),F=n().useMemo(function(){return(null==v?void 0:v.translateX)?(0,r.getTranslatedValue)(v.translateX,v.imgWidth,u):0},[v.imgWidth,u]),H=n().useMemo(function(){return(null==v?void 0:v.translateY)?(0,r.getTranslatedValue)(v.translateY,v.imgHeight,f):0},[f,v.imgHeight]),R=h>0?20:0,N=n().useState(!1),B=N[0],j=N[1],V=n().useState(F),z=V[0],G=V[1],K=n().useState(H),W=K[0],q=K[1],Q=n().useState(F),Y=Q[0],J=Q[1],X=n().useState(H),Z=X[0],$=X[1],ee=n().useState(F),te=ee[0],ne=ee[1],ae=n().useState(H),ie=ae[0],re=ae[1],oe=n().useState((null==v?void 0:v.zoom)||1),se=oe[0],ce=oe[1],de=n().useState(0),le=de[0],ue=de[1],fe=n().createRef(),pe=n().createRef();n().useEffect(function(){G(F),J(F),ne(F)},[F]),n().useEffect(function(){q(H),$(H),re(H)},[H]);var me=n().useCallback(function(){fe&&b(fe)},[fe,b]),_e=n().useCallback(function(){pe&&(g(pe),ue(1))},[pe,g]),he=n().useCallback(function(e){!e.target||e.target instanceof HTMLButtonElement||!e.shiftKey||(e.preventDefault(),e.stopPropagation(),j(!0),J(e.clientX-te),$(e.clientY-ie))},[te,ie]),be=n().useCallback(function(e){var t=z,n=W,i=se,r=a._SPKillSwitch.isActivated("dfce0629-b926-4c19-b4e1-9d72b1199a88")?20:40;if(e.shiftKey){switch(e.key){case"ArrowUp":n-=r;break;case"ArrowDown":n+=r;break;case"ArrowLeft":t+=r;break;case"ArrowRight":t-=r;break;case"+":i=se+.1;break;case"_":i>.4&&(i=se-.1);break;default:return}e.preventDefault(),e.stopPropagation(),j(!0),G(t),q(n),ce(i),O({zoom:i,translateX:t,translateY:n,imgWidth:u,imgHeight:f})}},[O,z,W,f,u,se]),ge=n().useRef(null),ve=n().useCallback(function(e){ge.current=e},[ge]);n().useEffect(function(){if(!D()&&ge.current)return ge.current.addEventListener("keydown",be),function(){var e;return null===(e=ge.current)||void 0===e?void 0:e.removeEventListener("keydown",be)}},[be,ge]);var ye=n().useCallback(function(e){e.target&&B&&e.target instanceof HTMLImageElement&&e.shiftKey&&(e.preventDefault(),e.stopPropagation(),G(e.clientX-Y),q(e.clientY-Z),ne(z),re(W))},[z,W,Y,Z,B]),Se=n().useCallback(function(e){e.target&&B&&(e.preventDefault(),e.stopPropagation(),j(!1),J(z),$(W),O({zoom:se,translateX:z,translateY:W,imgWidth:u,imgHeight:f}))},[O,z,W,f,B,u,se]),De=n().useCallback(function(e){if(e.target&&e.shiftKey){e.preventDefault(),e.stopPropagation();var t=se;e.deltaY>0&&se>.4?(t=se-.1*Math.sign(e.deltaY),ce(t)):ce(t=se+.1),O({zoom:t,translateX:z,translateY:W,imgWidth:u,imgHeight:f})}},[O,z,W,f,u,se]);return n().createElement(n().Fragment,null,n().createElement("div",{id:"container-".concat(i),onWheel:De,onMouseMove:ye,onMouseUp:Se,onMouseDown:he},n().createElement("div",{id:"image-preview-".concat(i)},n().createElement("div",{id:"img-wrapper-".concat(i),style:{width:"".concat(u,"px"),height:"".concat(f,"px"),display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden",position:"relative",margin:M?"0 auto":"0",padding:"0 auto"}},n().createElement("div",{id:"image-overlay-".concat(i),style:{width:"calc(".concat(U,"px - ").concat(h,"px)"),height:"calc(".concat(U,"px - ").concat(h,"px)"),inset:"".concat(R,"px"),backgroundColor:"transparent"},ref:pe,onLoad:_e},a._SPKillSwitch.isActivated("27459c2c-82cc-4621-baa9-cb65c0861f59")?n().createElement("img",{id:"imagePreview-".concat(i),src:c,style:{width:"".concat(u*se,"px"),height:"".concat(f*se,"px"),transform:"translate(".concat(z,"px, ").concat(W,"px)"),position:"absolute",top:0,left:0},ref:fe,onLoad:me,onWheel:De,alt:"Shape Demo"}):n().createElement(o.SPImg,{id:"imagePreview-".concat(i),imgRef:I()||D()?void 0:ve,tabIndex:D()?void 0:0,"data-sp-originalimgsrc":l.imageUrl,imageData:l,serviceScope:d,width:u,height:f,callerId:p,alt:l.isDecorative?"":l.altText?a.Text.format(x.k_,l.altText,(0,r.getImageShapeForAltText)(t.imageShape)):a.Text.format(x.s9,(0,r.getImageShapeForAltText)(t.imageShape)),onMouseDown:he,getDefaultImage:L,onImageLoad:function(e){var t=null==e?void 0:e.currentTarget;t&&(fe.current=t,b(fe),null==w||w())},onImageLoadFailure:A,thumbnailWidth:a._SPKillSwitch.isActivated("5cbbd14e-8869-4c13-b8b6-7a234db2a4a4")?S:Math.max(y.CACHE_BREAKPOINT_S,S||0),cacheBuster:C,style:{width:"".concat(u*se,"px"),height:"".concat(f*se,"px"),transform:"translate(".concat(z,"px, ").concat(W,"px)"),position:"absolute",top:0,left:0,opacity:le,outline:"none"}}),!I()&&n().createElement(E,{shapeRef:ge,serviceScope:d,isShapePopoverVisible:P,setShapePopoverVisible:T})),m)),n().createElement("svg",{id:"svgClips-".concat(i),"aria-hidden":"true",style:{position:"absolute",width:0,height:0,overflow:"hidden",zIndex:-1},version:"1.1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid slice"},n().createElement("clipPath",{id:"heart",clipPathUnits:"objectBoundingBox",transform:"scale(0.01, 0.01)"},n().createElement("path",{d:"M 10,30 A 20,20 0,0,1 50,30 A 20,20 0,0,1 90,30 Q 90,60 50,90 Q 10,60 10,30 z"})),n().createElement("clipPath",{id:"leave",clipPathUnits:"objectBoundingBox",transform:"scale(1, 1)"},n().createElement("path",{d:"M0.989,0.131 c-0.108,-0.082,-0.275,-0.131,-0.446,-0.131 c-0.211,0,-0.384,0.074,-0.473,0.202 c-0.042,0.06,-0.065,0.132,-0.069,0.212 c-0.003,0.072,0.009,0.151,0.036,0.237 c0.093,-0.278,0.352,-0.495,0.651,-0.495 c0,0,-0.28,0.074,-0.455,0.301 c0,0,-0.002,0.003,-0.006,0.009 c-0.035,0.047,-0.066,0.101,-0.089,0.162 c-0.039,0.093,-0.075,0.22,-0.075,0.373 h0.125 c0,0,-0.019,-0.119,0.014,-0.257 c0.055,0.007,0.104,0.011,0.148,0.011 c0.115,0,0.197,-0.025,0.258,-0.078 c0.054,-0.048,0.084,-0.112,0.116,-0.18 c0.048,-0.104,0.103,-0.222,0.263,-0.313 c0.009,-0.005,0.015,-0.015,0.016,-0.025 s-0.004,-0.021,-0.012,-0.027"})),n().createElement("clipPath",{id:"baloon",clipPathUnits:"objectBoundingBox",transform:"scale(1, 1)"},n().createElement("path",{d:"M0.417,0 v0 c0.23,0,0.417,0.17,0.417,0.379 s-0.187,0.379,-0.417,0.379 c-0.022,0,-0.044,-0.002,-0.065,-0.005 c-0.089,0.1,-0.193,0.118,-0.296,0.121 v-0.025 c0.056,-0.031,0.101,-0.086,0.101,-0.15 c0,-0.009,-0.001,-0.018,-0.002,-0.026 c-0.094,-0.07,-0.154,-0.176,-0.154,-0.295 c0,-0.209,0.187,-0.379,0.417,-0.379 M0.865,0.85 c0,0.055,0.032,0.102,0.08,0.129 v0.021 c-0.09,-0.002,-0.172,-0.018,-0.249,-0.104 c-0.018,0.003,-0.037,0.004,-0.056,0.004 c-0.083,0,-0.159,-0.025,-0.22,-0.067 c0.126,0,0.244,-0.046,0.334,-0.128 c0.045,-0.041,0.081,-0.09,0.106,-0.144 c0.027,-0.057,0.04,-0.119,0.04,-0.182 c0,-0.01,0,-0.02,-0.001,-0.03 c0.063,0.059,0.102,0.138,0.102,0.226 c0,0.102,-0.052,0.193,-0.134,0.253 c-0.001,0.007,-0.002,0.015,-0.002,0.022"})),n().createElement("clipPath",{id:"marker",clipPathUnits:"objectBoundingBox",transform:"scale(0.0625, 0.0625)"},n().createElement("path",{d:"M0,0.8v9c0,0.4,0.3,1,0.8,1.3l6.5,4.4c0.4,0.3,1.1,0.3,1.5,0l6.5-4.4c0.4-0.3,0.8-0.9,0.8-1.3v-9C16,0.3,15.5,0,14.9,0H1.1 C0.5,0,0,0.3,0,0.8L0,0.8z"})),n().createElement("clipPath",{id:"checkmark",clipPathUnits:"objectBoundingBox",transform:"scale(0.021739130434782608, 0.021739130434782608)"},n().createElement("path",{d:"M20.687,38.332c-2.072,2.072-5.434,2.072-7.505,0L1.554,26.704c-2.072-2.071-2.072-5.433,0-7.504 c2.071-2.072,5.433-2.072,7.505,0l6.928,6.927c0.523,0.522,1.372,0.522,1.896,0L36.642,7.368c2.071-2.072,5.433-2.072,7.505,0 c0.995,0.995,1.554,2.345,1.554,3.752c0,1.407-0.559,2.757-1.554,3.752L20.687,38.332z"})),n().createElement("clipPath",{id:"cog",clipPathUnits:"objectBoundingBox",transform:"scale(0.021739130434782608, 0.021739130434782608)"},n().createElement("path",{d:"M43.454,18.443h-2.437c-0.453-1.766-1.16-3.42-2.082-4.933l1.752-1.756c0.473-0.473,0.733-1.104,0.733-1.774 c0-0.669-0.262-1.301-0.733-1.773l-2.92-2.917c-0.947-0.948-2.602-0.947-3.545-0.001l-1.826,1.815 C30.9,6.232,29.296,5.56,27.529,5.128V2.52c0-1.383-1.105-2.52-2.488-2.52h-4.128c-1.383,0-2.471,1.137-2.471,2.52v2.607 c-1.766,0.431-3.38,1.104-4.878,1.977l-1.825-1.815c-0.946-0.948-2.602-0.947-3.551-0.001L5.27,8.205 C4.802,8.672,4.535,9.318,4.535,9.978c0,0.669,0.259,1.299,0.733,1.772l1.752,1.76c-0.921,1.513-1.629,3.167-2.081,4.933H2.501 C1.117,18.443,0,19.555,0,20.935v4.125c0,1.384,1.117,2.471,2.501,2.471h2.438c0.452,1.766,1.159,3.43,2.079,4.943l-1.752,1.763 c-0.474,0.473-0.734,1.106-0.734,1.776s0.261,1.303,0.734,1.776l2.92,2.919c0.474,0.473,1.103,0.733,1.772,0.733 s1.299-0.261,1.773-0.733l1.833-1.816c1.498,0.873,3.112,1.545,4.878,1.978v2.604c0,1.383,1.088,2.498,2.471,2.498h4.128 c1.383,0,2.488-1.115,2.488-2.498v-2.605c1.767-0.432,3.371-1.104,4.869-1.977l1.817,1.812c0.474,0.475,1.104,0.735,1.775,0.735 c0.67,0,1.301-0.261,1.774-0.733l2.92-2.917c0.473-0.472,0.732-1.103,0.734-1.772c0-0.67-0.262-1.299-0.734-1.773l-1.75-1.77 c0.92-1.514,1.627-3.179,2.08-4.943h2.438c1.383,0,2.52-1.087,2.52-2.471v-4.125C45.973,19.555,44.837,18.443,43.454,18.443z M22.976,30.85c-4.378,0-7.928-3.517-7.928-7.852c0-4.338,3.55-7.85,7.928-7.85c4.379,0,7.931,3.512,7.931,7.85 C30.906,27.334,27.355,30.85,22.976,30.85z"})),n().createElement("clipPath",{id:"user",clipPathUnits:"objectBoundingBox",transform:"scale(0.021739130434782608, 0.021739130434782608)"},n().createElement("path",{d:"M22.766,0.001C10.194,0.001,0,10.193,0,22.766s10.193,22.765,22.766,22.765c12.574,0,22.766-10.192,22.766-22.765 S35.34,0.001,22.766,0.001z M22.766,6.808c4.16,0,7.531,3.372,7.531,7.53c0,4.159-3.371,7.53-7.531,7.53 c-4.158,0-7.529-3.371-7.529-7.53C15.237,10.18,18.608,6.808,22.766,6.808z M22.761,39.579c-4.149,0-7.949-1.511-10.88-4.012 c-0.714-0.609-1.126-1.502-1.126-2.439c0-4.217,3.413-7.592,7.631-7.592h8.762c4.219,0,7.619,3.375,7.619,7.592 c0,0.938-0.41,1.829-1.125,2.438C30.712,38.068,26.911,39.579,22.761,39.579z"})),n().createElement("clipPath",{id:"pebble",clipPathUnits:"objectBoundingBox",transform:"scale(.0048, .0048)"},n().createElement("path",{d:"M118.711 204.152C90.4117 199.858 68.2038 170.531 45.5708 143.416C22.8514 116.434 -0.419418 91.5659 0.00574051 65.79C0.30468 39.9278 24.3859 13.0188 51.224 3.92098C78.1552 -5.30934 107.817 3.04633 133.094 15.6229C158.371 28.1994 179.403 45.0963 192.357 71.1174C205.404 97.0127 210.539 132.344 195.871 160.154C181.123 188.103 146.918 208.578 118.711 204.152Z"})),n().createElement("clipPath",{id:"triangle",clipPathUnits:"objectBoundingBox",transform:"scale(.0043, .00483)"},n().createElement("path",{d:"M114.371 1.45335C115.322 -0.213234 117.725 -0.213273 118.676 1.45331L232.717 201.251C233.66 202.903 232.467 204.958 230.565 204.958L2.48262 204.958C0.580001 204.958 -0.613222 202.903 0.329938 201.251L114.371 1.45335Z"})),n().createElement("clipPath",{id:"hexagon",clipPathUnits:"objectBoundingBox",transform:"scale(0.00397, 0.00452)"},n().createElement("path",{d:"M190.048 216.997C189.333 218.236 188.01 218.999 186.579 218.997L65.1978 218.858C63.7671 218.856 62.4462 218.091 61.7337 216.85L1.14698 111.359C0.436963 110.123 0.438588 108.602 1.15124 107.367L61.9652 2.00286C62.6804 0.763707 64.003 0.000919501 65.4337 0.00241143L186.802 0.12897C188.233 0.130462 189.554 0.896168 190.266 2.13701L250.853 107.641C251.563 108.877 251.562 110.398 250.849 111.632L190.048 216.997Z"})),n().createElement("clipPath",{id:"teardrop",clipPathUnits:"objectBoundingBox",transform:"scale(.00488, .00488)"},n().createElement("path",{d:"M0 102C0 45.667 45.667 0 102 0V0C158.333 0 204 45.667 204 102V188.308C204 196.974 196.974 204 188.308 204H102C45.667 204 0 158.333 0 102V102Z"})),n().createElement("clipPath",{id:"square",clipPathUnits:"objectBoundingBox",transform:"scale(0.00454, 0.00454)"},n().createElement("path",{d:"M 4 0 H 214.558 A 4 4 0 0 1 218.558 4 V 214.558 A 4 4 0 0 1 214.558 218.558 H 4 A 4 4 0 0 1 0 214.558 V 4 A 4 4 0 0 1 4 0 Z"})),n().createElement("clipPath",{id:"circle",clipPathUnits:"objectBoundingBox",transform:"scale(.00489, .00489)"},n().createElement("path",{d:"M 203.472 101.736 a 101.736 101.736 0 1 0 -203.472 0 a 101.736 101.736 0 1 0 203.472 0"})))))};m(424).loadStyles('.a_a_4c80d407{align-items:center;background-color:transparent;border:var(--app-inp-brd);border-radius:.25rem;display:inline-flex;flex:0 0 60px;flex-direction:column;font-size:xx-small;height:60px;margin:0 .25rem .25rem 0;overflow:hidden;position:relative}.a_a_4c80d407:before{border-radius:50%;content:"";display:inline-block;height:8px;left:2px;position:absolute;top:2px;width:8px}.a_a_4c80d407:focus,.a_a_4c80d407:hover{background-color:#ddd}.a_a_4c80d407 div{background-color:#333;height:32px;margin:.25rem 0;pointer-events:none;width:32px}.b_a_4c80d407{background:hsla(0,0%,39%,.5);border:0;border-radius:50%;color:#fff;cursor:move;height:40px;outline:none;position:absolute;width:40px}.b_a_4c80d407:focus,.b_a_4c80d407:hover{background:rgba(90,90,90,.9)}.b_a_4c80d407:focus{box-shadow:inset 0 0 0 4px #333}',!0);var L=function(t){var a=(0,e.__assign)({},t),i=a.index,r=a.offsetLeft,o=a.offsetTop,s=a.offsetX,c=a.offsetY,d=a.overlayRect,l=a.presetType,u=a.updateCoordinates,f=a.addNewPoint,p=a.deletePoint,m=d?d.width/100:1,_=s*m+r,h=c*m+o,b=n().useCallback(function(e){if(e.target){var t=e.target;if(i>=0){var n=[s||0,c||0],a=n[0],d=n[1];switch(e.key){case"ArrowDown":e.preventDefault(),e.ctrlKey?d+=.1:d++;break;case"ArrowLeft":e.preventDefault(),e.ctrlKey?a-=.1:a--;break;case"ArrowRight":e.preventDefault(),e.ctrlKey?a+=.1:a++;break;case"ArrowUp":e.preventDefault(),e.ctrlKey?d-=.1:d--;break;case"Delete":case"-":return void p(i);case"+":return void f(i)}a=Math.min(Math.max(a,0),100),d=Math.min(Math.max(d,0),100),t.style.left="".concat(a*m+r,"px"),t.style.top="".concat(d*m+o,"px"),u(i,[a,d])}}},[i,s,c,m,r,o,u,p,f]);return n().createElement(n().Fragment,null,n().createElement("button",{className:"b_a_4c80d407","data-index":i,"data-presettype":l,type:"button",style:{left:"".concat(_,"px"),top:"".concat(h,"px")},onKeyDown:b},i))},k=function(t){var a=(0,e.__assign)({},t),i=a.coordinates,r=a.overlayRect,o=a.maskType,s=a.offsetTop,c=a.offsetLeft,d=a.updateClipPath,l=a.addNewPoint,u=a.deletePoint,f=n().useState(void 0),p=f[0],m=f[1],_=n().useState(!1),h=_[0],b=_[1],g=n().useRef(null),v=n().useCallback(function(e,t){i.splice(e,1,t),d&&d(i)},[i,d]),y=n().useCallback(function(e){var t,n,a,i,d;if(e.target&&p&&h&&r){e.stopPropagation(),e.preventDefault();var l=(null===(t=null==p?void 0:p.dataset)||void 0===t?void 0:t.index)?parseInt(p.dataset.index,10):-1;if(l>=0&&r){var u=e.clientX-r.left,f=e.clientY-r.top,m=r.width/100,_=(null===(n=null==p?void 0:p.dataset)||void 0===n?void 0:n.x)?parseInt(null===(a=null==p?void 0:p.dataset)||void 0===a?void 0:a.x,10):-1,b=(null===(i=null==p?void 0:p.dataset)||void 0===i?void 0:i.y)?parseInt(null===(d=null==p?void 0:p.dataset)||void 0===d?void 0:d.y,10):-1;u<0&&(u=0),f<0&&(f=0),u+0>r.width&&(u=r.width-0),f+0>r.height&&(f=r.height-0),e.altKey&&_>0&&(u=_),e.shiftKey&&b>0&&(f=b+s),p.dataset.x=u.toString(),p.dataset.y=f.toString(),p.style.left="ellipse"===o&&1===l?p.style.left:"".concat(u+c,"px"),p.style.top="ellipse"===o&&2===l?p.style.top:"".concat(f+s,"px"),v(l,[Math.ceil(u/m),Math.ceil(f/m)])}}},[p,h,r,o,c,s,v]),S=n().useCallback(function(e){var t;if(e.target&&e.target instanceof HTMLButtonElement){e.stopPropagation(),e.preventDefault();var n=e.target;((null===(t=null==n?void 0:n.dataset)||void 0===t?void 0:t.index)?parseInt(n.dataset.index,10):-1)>=0&&(m(n),b(!0))}},[]),D=n().useCallback(function(e){var t;window&&window.getSelection&&(null===(t=window.getSelection())||void 0===t||t.removeAllRanges()),m(void 0)},[]),I=n().useCallback(function(e){e.target&&(e.stopPropagation(),e.preventDefault(),m(void 0),b(!1))},[]);return n().createElement("div",{ref:g,onPointerMove:y,onPointerDown:S,onPointerLeave:D,onPointerUp:I},i.map(function(e,t){return o?n().createElement(L,{key:t,index:t,presetType:o,offsetX:e[0],offsetY:e[1],overlayRect:r,offsetTop:s,offsetLeft:c,updateCoordinates:v,width:40,addNewPoint:l,deletePoint:u}):n().createElement(n().Fragment,null)}))},M=m(207),P=m(952),T="ImageShapesEdit";function U(t){return(0,e.__awaiter)(this,void 0,void 0,function(){var n,a,i,o,s,u;return(0,e.__generator)(this,function(f){switch(f.label){case 0:switch(n=t.fullImage.naturalWidth,a=t.fullImage.naturalHeight,i=Math.max(n,a)/2,o=a>n?i-n/2:0,s=n>a?i-a/2:0,u=Math.min(n,a),t.mask.maskType){case"polygon":return[3,1];case"ellipse":return[3,3];case"url":return[3,5]}return[3,7];case 1:return[4,c((0,e.__assign)((0,e.__assign)({},t),{overlayWidth:u,offsetX:s,offsetY:o}),t.mask.coordinates).catch(function(e){throw e})];case 2:case 4:case 6:return[2,f.sent()];case 3:return[4,d((0,e.__assign)((0,e.__assign)({},t),{overlayWidth:u,offsetX:s,offsetY:o}),t.mask.clipData||(0,r.getEmptyNumberArray)()).catch(function(e){throw e})];case 5:return[4,l((0,e.__assign)((0,e.__assign)({},t),{overlayWidth:u,offsetX:s,offsetY:o,imageType:"png"}),t.mask.pathData||"",t.mask.svgScale).catch(function(e){throw e})];case 7:return[2,void 0]}})})}var F=t.forwardRef(function(n,s){var c=n.imageData,d=n.imageShape,l=n.width,u=n.height,f=n.callerId,p=n.serviceScope,m=n.thumbnailWidth,_=n.imageTransformData,b=n.previouslySavedShape,g=n.isShapeCentered,v=n.onRenderComplete,y=n.handleSave,D=n.getDefaultImage,x=n.onImageLoad,C=n.onImageLoadFailure,O=n.cacheBuster,w=l||0,E=u||0,L=Math.max(w,E)/2,F=E>w?L-w/2:0,H=w>E?L-E/2:0,R=(0,o.useFallback)({imageData:c,callerId:f,thumbnailWidth:m,onImageLoad:x,onImageLoadFailure:C,getServices:function(){return(0,o.getDefaultServices)({callerId:f,serviceScope:p,imageData:c,getDefaultImage:D,thumbnailWidth:m,disableBlobRevoke:!1,cacheBuster:c.cacheBuster})}}).src,N=(0,o.useFallback)({imageData:c,callerId:f,thumbnailWidth:99999,onImageLoad:x,onImageLoadFailure:C,getServices:function(){return(0,o.getDefaultServices)({callerId:f,serviceScope:p,imageData:c,getDefaultImage:D,thumbnailWidth:99999,disableBlobRevoke:!1,cacheBuster:a.Guid.newGuid().toString()})}}).src,B=t.useState(null),j=B[0],V=B[1],z=t.useState(null),G=z[0],K=z[1],W=t.useState(null),q=W[0],Q=W[1],Y=t.useState(),J=Y[0],X=Y[1],Z=t.useState(!1),$=Z[0],ee=Z[1],te=t.useState(b),ne=te[0],ae=te[1],ie=t.useState(_||{zoom:1,translateX:0,translateY:0,imgWidth:w,imgHeight:E}),re=ie[0],oe=ie[1],se=t.useState(!1),ce=se[0],de=se[1],le=t.useState({executeCropData:{image:G,fullImage:q,mask:J},imageTransformData:re,handleSave:y}),ue=le[0],fe=le[1],pe=t.useCallback(function(e){e&&e.current&&J&&(e.current.style.clipPath=J.clipPath,V(e.current))},[J]),me=t.useMemo(function(){return null==j?void 0:j.getBoundingClientRect()},[j]),_e=function(t,n){return(0,e.__awaiter)(void 0,void 0,void 0,function(){var a,i,r,o,s;return(0,e.__generator)(this,function(c){switch(c.label){case 0:return t.executeCropData.image&&t.executeCropData.fullImage&&t.executeCropData.mask&&t.handleSave&&n?(I()||de(!0),a=function(n,a,i){return(0,e.__awaiter)(void 0,void 0,void 0,function(){return(0,e.__generator)(this,function(e){return n&&t.handleSave?[2,t.handleSave(n,a,i,t.imageTransformData,"png")]:[2]})})},i=(0,e.__assign)((0,e.__assign)({},t.executeCropData),{image:t.executeCropData.image,fullImage:t.executeCropData.fullImage,mask:t.executeCropData.mask,zoom:t.imageTransformData.zoom,saveBlobCallback:a}),r="SaveShape",o=function(e,t){return{errorModuleName:"ImageShapesEdit SaveShape Failure",logFailure:t.consume(P._EditModeCustomerPromiseHandler.serviceKey).logFailure}}(0,p),s=new M._QosMonitorShareFailureWithCP("".concat(T,".").concat(r),!1,[o]),[4,U(i).then(function(e){S()||(e?s.writeSuccess():s.writeUnexpectedFailure("".concat(T,".").concat(r,".ExecuteCropFailure"),new Error("No clip response from executeCrop")))}).catch(function(e){if(!S()){var t={imageShape:d,maskType:i.mask.maskType};throw s.writeUnexpectedFailure("".concat(T,".").concat(r,".ExecuteCropFailure"),e,t),e}})]):[3,2];case 1:c.sent(),ee(!1),c.label=2;case 2:return[2]}})})},he=t.useMemo(function(){return(0,i.debounce)(function(t,n){return(0,e.__awaiter)(void 0,void 0,void 0,function(){return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,_e(t,n)];case 1:return e.sent(),[2]}})})},800)},[]),be=function(){$?he(ue,$):ee(!0)},ge=function(){ce||de(!1)};t.useImperativeHandle(s,function(){return{externalSaveShape:be,saveShapePopoverVisibility:ge}}),t.useEffect(function(){(function(){return(0,e.__awaiter)(this,void 0,void 0,function(){var t;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,h(N||R||"")];case 1:return t=e.sent(),Q(t),[2]}})})})().catch(function(e){})},[N,R]),t.useEffect(function(){if(G&&q&&J&&$&&y){var t=(0,e.__assign)((0,e.__assign)({},ue),{executeCropData:{image:G,fullImage:q,mask:J}});fe(t),he(ue,$)}},[G,q,J]);var ve=t.useCallback(function(e){e&&e.current&&K(e.current)},[]);t.useEffect(function(){var e,t,n,a=d,i=r.Shapes.find(function(e){return e.name===(null==a?void 0:a.toLowerCase())});if(i){var o={maskType:i.maskType,coordinates:(0,r.getCoordinates)(i.coordData[0]),clipPath:i.coordData[0].clipPath,pathData:"url"===i.coordData[0].coordType?null===(e=i.coordData[0])||void 0===e?void 0:e.pathData:void 0,clipData:"ellipse"===i.coordData[0].coordType?null===(t=i.coordData[0])||void 0===t?void 0:t.clipData:void 0,svgScale:"url"===i.coordData[0].coordType?null===(n=i.coordData[0])||void 0===n?void 0:n.svgScale:void 0};X(o);var s=o.clipPath;j&&s&&(j.style.clipPath=s,V(j)),$||ne===a||(ae(a),ee(!0))}},[d,$,j,ne]),t.useEffect(function(){v&&v()},[]);var ye=t.useCallback(function(t){if(j&&J)if("polygon"===J.maskType){var n=t.map(function(e){var t=e[0],n=e[1];return"".concat(t,"% ").concat(n,"%")}).join(","),a="polygon(".concat(n,")");j.style.clipPath=a,X((0,e.__assign)((0,e.__assign)({},J),{coordinates:t,clipPath:a})),V(j)}else if("ellipse"===J.maskType){var i=t[0],r=t[1],o=t[2],s=r[0]-50,c=50-i[1];a="ellipse(".concat(s,"% ").concat(c,"% at ").concat(o.join("% "),"%)"),j.style.clipPath=a,X((0,e.__assign)((0,e.__assign)({},J),{coordinates:t,clipPath:a,clipData:[s,c,o[0],o[1]]})),V(j)}},[J,j]),Se=t.useCallback(function(e){if("polygon"!==(null==J?void 0:J.maskType))return!1;var t=J.coordinates,n=e+1<t.length?e+1:0,a=t[e],i=a[0],r=a[1],o=t[n],s=o[0],c=o[1];t.splice(n,0,[(i+s)/2,(r+c)/2]),ye(t)},[null==J?void 0:J.coordinates,null==J?void 0:J.maskType,ye]),De=t.useCallback(function(e){if("polygon"!==(null==J?void 0:J.maskType))return!1;var t=J.coordinates;t.length>3&&(t.splice(e,1),ye(t))},[null==J?void 0:J.coordinates,null==J?void 0:J.maskType,ye]);return R?t.createElement(t.Fragment,null,t.createElement(A,{imgSrc:R,imageData:c,imageShape:d,serviceScope:p,callerId:f,getDefaultImage:D,onImageLoad:x,onImageLoadFailure:C,thumbnailWidth:m,cacheBuster:O,transformData:re,autoSaveCallback:function(t){G&&J&&y&&(oe(t),fe((0,e.__assign)((0,e.__assign)({},ue),{imageTransformData:t})),$?he((0,e.__assign)((0,e.__assign)({},ue),{imageTransformData:t}),$):ee(!0))},setOverlayRef:pe,setImageRef:ve,width:l||0,height:u||0,isShapeCentered:g,isShapePopoverVisible:ce,setShapePopoverVisible:de},(null==J?void 0:J.maskType)&&(null==J?void 0:J.coordinates)&&t.createElement(k,{maskType:J.maskType,coordinates:J.coordinates,overlayRect:me,updateClipPath:ye,addNewPoint:Se,deletePoint:De,offsetTop:F,offsetLeft:H}))):t.createElement(t.Fragment,null)})})(),_})());