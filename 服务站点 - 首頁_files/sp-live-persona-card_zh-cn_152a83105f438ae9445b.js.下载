(()=>{var e=document.currentScript;define("7d834519-e86f-4d2b-ad52-b9b35dab66f1_0.1.0",["tslib","react","@microsoft/sp-diagnostics","@microsoft/sp-core-library","@ms/office-ui-fabric-react-bundle","@microsoft/load-themed-styles","@ms/sp-component-utilities","@microsoft/sp-loader"],(t,n,a,i,r,o,s,c)=>(()=>{"use strict";var d,l,u,f={424:e=>{e.exports=o},676:e=>{e.exports=i},207:e=>{e.exports=a},414:e=>{e.exports=c},141:e=>{e.exports=r},773:e=>{e.exports=s},959:e=>{e.exports=n},280:e=>{e.exports=t}},p={};function m(e){var t=p[e];if(void 0!==t)return t.exports;var n=p[e]={exports:{}};return f[e](n,n.exports,m),n.exports}m.m=f,m.d=(e,t)=>{for(var n in t)m.o(t,n)&&!m.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},m.f={},m.e=e=>Promise.all(Object.keys(m.f).reduce((t,n)=>(m.f[n](e,t),t),[])),m.u=e=>"chunk."+(863===e?"live-persona-card-loader":e)+"_none_"+{617:"ea361f7294168d3a51c7",863:"d8af4e961d38e88f4d95"}[e]+".js",m.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),m.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),d={},l="7d834519-e86f-4d2b-ad52-b9b35dab66f1_0.1.0:",m.l=(e,t,n,a)=>{if(d[e])d[e].push(t);else{var i,r;if(void 0!==n)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var c=o[s];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==l+n){i=c;break}}i||(r=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,m.nc&&i.setAttribute("nonce",m.nc),i.setAttribute("data-webpack",l+n),i.src=e,0!==i.src.indexOf(window.location.origin+"/")&&(i.crossOrigin="anonymous")),d[e]=[t];var u=(t,n)=>{i.onerror=i.onload=null,clearTimeout(f);var a=d[e];if(delete d[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach(e=>e(n)),t)return t(n)},f=setTimeout(u.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=u.bind(null,i.onerror),i.onload=u.bind(null,i.onload),r&&document.head.appendChild(i)}},m.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u=e?e.src:"",m.p=u.slice(0,u.lastIndexOf("/")+1),m.f.compat=(e,t)=>{for(var n=function(e){return{863:[{i:"1c4541f7-5c31-41aa-9fa8-fbc9dc14c0a8",v:"1.21.0",m:408},{i:"cc2cc925-b5be-41bb-880a-f0f8030c6aff",v:"5.6.346",m:939},{i:"8217e442-8ed3-41fd-957d-b112e841286a",v:"0.33.41",m:27},{i:"a68dd513-949e-48c1-b210-23ad37dbbe13",v:"0.1.0",m:305},{i:"2e09fb9b-13bb-48f2-859f-97d6fff71176",v:"1.4.346",m:698}]}[e]||[]}(e),a=0;a<n.length;a++)m.m[n[a].m]||(e=>{t.push(_.SPComponentLoader.loadComponentById(e.i,e.v).then(t=>{m.m[e.m]=e=>e.exports=t}))})(n[a])};var _=m(414);(()=>{var e={541:0};m.f.j=(t,n)=>{var a=m.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise((n,i)=>a=e[t]=[n,i]);n.push(a[2]=i);var r=m.p+m.u(t),o=new Error;m.l(r,n=>{if(m.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",o.name="ChunkLoadError",o.type=i,o.request=r,a[1](o)}},"chunk-"+t,t)}};var t=(t,n)=>{var a,i,[r,o,s]=n,c=0;if(r.some(t=>0!==e[t])){for(a in o)m.o(o,a)&&(m.m[a]=o[a]);s&&s(m)}for(t&&t(n);c<r.length;c++)i=r[c],m.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self["webpackJsonp_7d834519-e86f-4d2b-ad52-b9b35dab66f1_0.1.0"]=self["webpackJsonp_7d834519-e86f-4d2b-ad52-b9b35dab66f1_0.1.0"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var h={};return(()=>{m.r(h),m.d(h,{LivePersonaCard:()=>_,TopicCardHoverTarget:()=>b,bootstrapLPC:()=>f});var e=m(280),t=m(959),n=m(207),a=m(676),i=m(141),r=m(424);(0,r.loadStyles)([{rawString:".ms-odsp-screenReaderAlert{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}]);const o=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,e.__extends)(n,t),n.read=function(e,t){if(e){var a=document.createTextNode(e);n._getDedicatedDomNode(t||1).appendChild(a)}},n._getDedicatedDomNode=function(e){n._alertNode&&document.body.removeChild(n._alertNode);var t=document.createElement("div");switch(t.setAttribute("data-automation-id","screen-reader-alert-static"),t.classList.add("ms-odsp-screenReaderAlert"),e){case 1:t.setAttribute("aria-live","polite");break;case 2:t.setAttribute("role","alert"),t.setAttribute("aria-live","assertive")}return document.body.appendChild(t),n._alertNode=t,n._alertNode},n.prototype.componentDidMount=function(){n.read(this.props.message,this.props.readingMode)},n.prototype.componentDidUpdate=function(e){e.message===this.props.message&&e.indicator===this.props.indicator||n.read(this.props.message,this.props.readingMode)},n.prototype.render=function(){return!1},n}(t.PureComponent);var s=m(773);function c(){if(MouseEvent instanceof Function)return new MouseEvent("mousemove",{bubbles:!0,cancelable:!0});var e=document.createEvent("MouseEvent");return e.initEvent("mousemove",!0,!0),e}r.loadStyles(".a_a_434b99a9{cursor:pointer}.a_a_434b99a9:hover{outline:none}",!0);const d=JSON.parse('{"hT":"将打开{0}的个人资料卡片","dR":"打开个人资料卡片","_Q":"正在获取详细信息…","Pq":"主题 {0}"}');var l="SPPeopleWebPart",u=new(function(){function t(){}return t.prototype.getLPCLoader=function(){return Promise.all([m.e(617),m.e(863)]).then(m.bind(m,441)).then(function(e){return e.default})},(0,e.__decorate)([(0,s.monitor)("LivePersonaCard.Load")],t.prototype,"getLPCLoader",null),t}());function f(e,t,n){return void 0===t&&(t=l),void 0===n&&(n="User"),u.getLPCLoader().then(function(a){return a.bootstrap(e,t,n)})}var p="Mouse";const _=function(r){function f(e){var l=r.call(this,e)||this;return l._isUnMounted=!1,l.openCard=function(e){l._triggerBootstrap(e,p),l._isLPCBundleLoaded()&&l._manuallyDispatchEventToTriggerCallout(c())},l._bootstrapLivePersonaCard=function(e){return!f._isLivePersonaCardFlightEnabled()||a._BrowserUtilities.isMobileWebView()?Promise.resolve():f.livePersonaCardHoverTarget?(l._updateBundleMountedState(null==e?void 0:e.nativeEvent),Promise.resolve()):(l._loadPromise||(l._loadPromise=l._bootstrapCore(null==e?void 0:e.nativeEvent)),l._loadPromise)},l._bootstrapCore=function(e){return n._TraceLogger.logVerbose(l._logSource,"LivePersonaCard._bootstrapCore"),u.getLPCLoader().then(function(e){return e.bootstrap(l.props.serviceScope,l._clientType,l._personaType,l.props.clientScenario,l.props.topicCardProps)}).then(function(){l._isUnMounted||l._updateBundleMountedState(e)}).catch(function(e){n._TraceLogger.logError(l._logSource,e,"BootstrapLivePersonaCard")})},l._manuallyDispatchEventToTriggerCallout=function(e){var t,n,r,o,s,d;if(!a._SPKillSwitch.isActivated("f3b11671-f43f-4e6d-8d17-b66bc86f4838")&&l.props.openCardBySpaceKeyOnly&&l._ref.current)return null===(t=(0,i.getFirstTabbable)(l._ref.current,l._ref.current,!0))||void 0===t||t.focus(),void(null===(n=l._ref.current.firstElementChild)||void 0===n||n.dispatchEvent(c()));"keydown"===(null==e?void 0:e.type)&&l._ref.current&&(null===(r=(0,i.getFirstTabbable)(l._ref.current,l._ref.current,!0))||void 0===r||r.focus(),null===(o=l._ref.current.firstElementChild)||void 0===o||o.dispatchEvent(function(){if(KeyboardEvent instanceof Function)return new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,key:"Enter",code:"Enter",keyCode:13,which:13});var e=document.createEvent("KeyboardEvent");return e.initKeyboardEvent("keydown",!0,!0,window,"Enter","Enter",0,"",!1),e}())),"mouseover"===(null==e?void 0:e.type)&&l._ref.current&&l.state.shouldOpenLpcAfterBundleLoaded&&!l.props.disableHover&&(null===(s=l._ref.current.firstElementChild)||void 0===s||s.dispatchEvent(c())),"click"===(null==e?void 0:e.type)&&l._ref.current&&l.state.shouldOpenLpcAfterBundleLoaded&&!l.props.disableClick&&(null===(d=l._ref.current.firstElementChild)||void 0===d||d.dispatchEvent(function(){if(MouseEvent instanceof Function)return new MouseEvent("click",{bubbles:!0,cancelable:!0});var e=document.createEvent("MouseEvent");return e.initEvent("click",!0,!0),e}()))},l._triggerBootstrap=function(e,t){n._EngagementLogger.logEventWithLogEntry(new n._LogEntry("LivePersonaCard","".concat(l._logScenario,".Trigger"),n._LogType.Event,{hasUPN:Boolean(l.props.legacyUpn||l.props.upn).toString(),source:t,isBundleLoaded:l.state.isBundleLoaded.toString()})),l._isLPCBundleLoaded()||(l.setState({shouldOpenLpcAfterBundleLoaded:!0}),l._bootstrapLivePersonaCard(e).catch(l._traceBootstrapFailure))},l._triggerBootstrapByKeyboard=function(e){"Enter"===e.key&&(l._triggerBootstrap(e,"Keyboard"),l._isLPCBundleLoaded()||(a._SPKillSwitch.isActivated("b0861b96-5b5e-484d-9bca-5f32b00504ac")?s.ScreenReaderAlert.read(d._Q):o.read(d._Q)))},l._handleCardOpen=function(){n._EngagementLogger.logEvent("LivePersonaCard.".concat(l._logScenario),"Open");var e=l.props.onCardOpen;e&&e()},l._traceBootstrapFailure=function(e){n._TraceLogger.logError(l._logSource,e,"LivePersonaCard.bootstrap")},l._logSource=n._LogSource.create("LivePersonaCard"),l._ref=t.createRef(),l.state={isBundleLoaded:!1,shouldOpenLpcAfterBundleLoaded:!1},l}return(0,e.__extends)(f,r),f._isLivePersonaCardFlightEnabled=function(){return a._SPFlight.isEnabled(809)},Object.defineProperty(f,"livePersonaCardHoverTarget",{get:function(){return window.LivePersonaCardHoverTargetV2},enumerable:!1,configurable:!0}),f.prototype.componentWillUnmount=function(){this._isUnMounted=!0},f.prototype.render=function(){var n=this;if(this.props.disabled)return t.Children.only(this.props.children);if(a._BrowserUtilities.isMobileWebView())return t.cloneElement(t.Children.only(this.props.children),{role:"button","data-sp-action":JSON.stringify({key:"viewUserProfileDetails",args:(0,e.__assign)({upn:this.props.legacyUpn},a._BrowserUtilities.isTeamsVivaMobile()&&{displayName:this.props.displayName})}),onClick:function(){}});var r=this.props.useSpan?"span":"div",o=this.props.disableClick?void 0:function(e){return n._triggerBootstrap(e,p)},s=this.props.disableHover?void 0:function(e){return n._triggerBootstrap(e,p)},c=this.props.disableHover?void 0:function(){n.setState({shouldOpenLpcAfterBundleLoaded:!1})};return t.createElement(r,{className:(0,i.css)(this.props.className,"a_a_434b99a9"),onClickCapture:o,onKeyDownCapture:this._triggerBootstrapByKeyboard,onMouseOver:s,onMouseLeave:c,ref:this._ref},this._renderContent())},f.prototype._renderContent=function(){var n,r,o,s={cardParameters:{personaInfo:{identifiers:(0,e.__assign)({PersonaType:this._personaType,Smtp:this.props.legacyUpn||this.props.email,Upn:this.props.legacyUpn||this.props.upn,TopicId:null===(n=this.props.topicCardProps)||void 0===n?void 0:n.topicId},this.props.hostAppPersonaInfo&&{LocationId:this.props.hostAppPersonaInfo.LocationId,OlsPersonaId:this.props.hostAppPersonaInfo.OlsPersonaId,AadObjectId:this.props.hostAppPersonaInfo.PersonaAadObjectId,DisplayName:this.props.hostAppPersonaInfo.PersonaDisplayName}),topicMetadata:null===(r=this.props.topicCardProps)||void 0===r?void 0:r.topicCardMetadata,displayName:this.props.displayName,personaCoinColor:(0,i.getPersonaInitialsColor)({text:this.props.displayName})},externalAppSessionCorrelationId:this.props.externalAppSessionCorrelationId,behavior:{onCardOpen:this._handleCardOpen,onCardClose:this.props.onCardClose,disableHover:this.props.disableHover,disableClick:this.props.disableClick,cardPlacementMode:this.props.cardPlacementMode},ariaLabel:this.props.ariaLabel},tabIndex:this.props.tabIndex},c=Boolean(this.props.legacyUpn||(null===(o=this.props.topicCardProps)||void 0===o?void 0:o.topicId)||this.props.upn||this.props.email);return c&&this._isLPCBundleLoaded()?t.createElement(f.livePersonaCardHoverTarget,(0,e.__assign)({},s,{onCardOpen:this._handleCardOpen}),t.Children.only(this.props.children)):c&&!this._isLPCBundleLoaded()?t.cloneElement(t.Children.only(this.props.children),{tabIndex:0,"data-is-focusable":!0,role:"button","aria-label":this.props.ariaLabel||(this.props.displayName?a.Text.format(d.hT,this.props.displayName):d.dR),"aria-haspopup":"dialog"}):t.Children.only(this.props.children)},f.prototype._isLPCBundleLoaded=function(){return this.state.isBundleLoaded&&!!f.livePersonaCardHoverTarget},Object.defineProperty(f.prototype,"_logScenario",{get:function(){return this.props.clientScenario||"unset"},enumerable:!1,configurable:!0}),f.prototype._updateBundleMountedState=function(e){var t=this;this.setState({isBundleLoaded:!0},function(){return t._manuallyDispatchEventToTriggerCallout(e)})},Object.defineProperty(f.prototype,"_clientType",{get:function(){return this.props.clientType||l},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"_personaType",{get:function(){return this.props.hostAppPersonaInfo&&this.props.hostAppPersonaInfo.PersonaType||"User"},enumerable:!1,configurable:!0}),f}(t.PureComponent);function b(n){var i,r=a.Text.format(d.Pq,n.displayName||""),o=new URL(window.location.href).pathname.toLowerCase();return t.createElement(_,(0,e.__assign)({ref:n.lpcRef},n,{ariaLabel:n.ariaLabel||r},-1!==o.toLowerCase().indexOf("_layouts/15/")&&{topicCardProps:(0,e.__assign)((0,e.__assign)({},n.topicCardProps),{topicCardMetadata:(0,e.__assign)((0,e.__assign)({},null===(i=n.topicCardProps)||void 0===i?void 0:i.topicCardMetadata),{hideFeedbackQuestions:!0,hideEntityAndContextQuestion:!0})})}))}})(),h})())})();